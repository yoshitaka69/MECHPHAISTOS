import{ai as Mr,aj as ol,ak as nl,al as sl,am as xr,an as to,ao as Pr,ap as rl,aq as il,ar as Ar,as as ll,at as Nr,au as al,av as _r,aw as zn,ax as cl,ay as Lr,az as Ht,aA as dl,aB as ao,aC as ie,aD as ul,aE as hl,aF as In,aG as W,aH as fl,aI as gl,aJ as ml,aK as Uo,aL as Z,aM as wl,aN as pl,aO as jn,aP as Un,aQ as Lo,aR as Dr,aS as Mn,aT as Vr,aU as Cl,aV as Sl,aW as Y,aX as oo,aY as bl,aZ as Re,a_ as vl,a$ as Ze,b0 as xe,b1 as we,b2 as ot,b3 as yl,b4 as Rl,b5 as it,b6 as De,b7 as Kn,b8 as ae,b9 as xt,ba as le,bb as Do,bc as Po,bd as xn,K as Gn,be as Fr,bf as Yn,bg as Br,bh as Wr,bi as Vo,bj as Fo,L as $,bk as Ko,bl as kr,bm as me,bn as Xn,bo as pe,bp as $r,bq as qn,br as Tl,bs as Hl,bt as El,bu as Ol,bv as Pn,bw as Bt,bx as Il,by as zr,bz as co,bA as jr,bB as An,bC as Ml,bD as Ur,bE as Go,bF as xl,bG as Cs,bH as Ss,bI as Tt,bJ as Pl,bK as Qe,bL as Pt,bM as qo,bN as Al,bO as Kr,bP as ze,bQ as Gr,bR as Nl,bS as _l,bT as Ll,bU as Yr,bV as Le,bW as At,bX as Zt,bY as Dl,bZ as Vl,b_ as Fl,b$ as Bl,c0 as Xr,c1 as Wl,c2 as kl,c3 as $l,c4 as zl,c5 as jl,c6 as Ul,c7 as Kl,c8 as Gl,c9 as Yl,ca as Xl,cb as ql,cc as Ql,cd as Zl,ce as Jl,cf as ea,cg as ta,ch as oa,ci as na,cj as sa,ck as ra,cl as ia,cm as la,cn as aa,co as ca,cp as da,cq as ua,cr as ha,cs as fa,ct as ga,cu as ma,cv as wa,cw as pa,cx as Ca,cy as Sa,cz as ba,cA as va,cB as ya,cC as Ra,cD as Ta,cE as Ha,cF as Ea,cG as Oa,cH as Ia,cI as Ma,cJ as xa,cK as Pa,cL as Aa,cM as Na,cN as _a,cO as La,cP as Da,cQ as Va,cR as Fa,cS as Ba,cT as Wa,cU as ka,cV as $a,cW as za,cX as ja,cY as Ua,cZ as Ka,c_ as Ga,c$ as Ya,d0 as Xa,d1 as qa,d2 as Qa,d3 as Za,d4 as Ja,d5 as ec,d6 as tc,d7 as oc,d8 as nc,d9 as sc,da as rc,db as ic,dc as lc,dd as ac,de as cc,df as dc,dg as ft,dh as uc,di as hc,dj as fc,dk as gc,dl as mc,dm as St,dn as wc,dp as pc,dq as Cc,dr as Sc,ds as qr,dt as Nn,du as bc,dv as bs,dw as vc,dx as Jt,dy as vs,M as yc,dz as Mt,dA as Rc,dB as Bo,dC as Qr,dD as Tc,P as Zr,dE as Me,dF as Jr,dG as ei,dH as Hc,dI as Qn,dJ as ys,dK as Rs,dL as Ec,dM as Oc,dN as Ic,dO as Mc,dP as xc,U as Ts,Q as Hs,Y as Pc,dQ as Ac,dR as Es,dS as Os,a1 as Nc,a0 as _c,dT as Qo,dU as Lc,dV as Dc,dW as Is,dX as Ms,O as Vc,dY as Fc,dZ as Bc,n as ti,d_ as Wc,o as kc,c as $c,d$ as zc}from"./index-3caee4d8.js";var jc=Mr,Uc=ol,Kc=function(o){if(jc(o)==="Function")return Uc(o)},xs=Kc,Gc=nl,Yc=sl,Xc=xs(xs.bind),qc=function(o,e){return Gc(o),e===void 0?o:Yc?Xc(o,e):function(){return o.apply(e,arguments)}},Qc=TypeError,oi=function(o,e){if(o<e)throw new Qc("Not enough arguments");return o},Zc=xr,Jc=/(?:ipad|iphone|ipod).*applewebkit/i.test(Zc),ed=to,td=Mr,od=td(ed.process)==="process",Te=to,nd=Nr,sd=qc,Ps=Pr,rd=al,ni=rl,As=il,id=Ar,Ns=ll,ld=oi,ad=Jc,cd=od,_n=Te.setImmediate,Ln=Te.clearImmediate,dd=Te.process,Zo=Te.Dispatch,ud=Te.Function,_s=Te.MessageChannel,hd=Te.String,Jo=0,Qt={},Ls="onreadystatechange",eo,lt,en,tn;ni(function(){eo=Te.location});var Zn=function(o){if(rd(Qt,o)){var e=Qt[o];delete Qt[o],e()}},on=function(o){return function(){Zn(o)}},Ds=function(o){Zn(o.data)},Vs=function(o){Te.postMessage(hd(o),eo.protocol+"//"+eo.host)};(!_n||!Ln)&&(_n=function(e){ld(arguments.length,1);var t=Ps(e)?e:ud(e),n=id(arguments,1);return Qt[++Jo]=function(){nd(t,void 0,n)},lt(Jo),Jo},Ln=function(e){delete Qt[e]},cd?lt=function(o){dd.nextTick(on(o))}:Zo&&Zo.now?lt=function(o){Zo.now(on(o))}:_s&&!ad?(en=new _s,tn=en.port2,en.port1.onmessage=Ds,lt=sd(tn.postMessage,tn)):Te.addEventListener&&Ps(Te.postMessage)&&!Te.importScripts&&eo&&eo.protocol!=="file:"&&!ni(Vs)?(lt=Vs,Te.addEventListener("message",Ds,!1)):Ls in Ns("script")?lt=function(o){As.appendChild(Ns("script"))[Ls]=function(){As.removeChild(this),Zn(o)}}:lt=function(o){setTimeout(on(o),0)});var si={set:_n,clear:Ln},fd=_r,gd=to,Fs=si.clear;fd({global:!0,bind:!0,enumerable:!0,forced:gd.clearImmediate!==Fs},{clearImmediate:Fs});var md=typeof Bun=="function"&&Bun&&typeof Bun.version=="string",ri=to,wd=Nr,pd=Pr,Cd=md,Sd=xr,bd=Ar,vd=oi,yd=ri.Function,Rd=/MSIE .\./.test(Sd)||Cd&&function(){var o=ri.Bun.version.split(".");return o.length<3||o[0]==="0"&&(o[1]<3||o[1]==="3"&&o[2]==="0")}(),Td=function(o,e){var t=e?2:1;return Rd?function(n,r){var i=vd(arguments.length,1)>t,s=pd(n)?n:yd(n),a=i?bd(arguments,t):[],c=i?function(){wd(s,this,a)}:s;return e?o(c,r):o(c)}:o},Hd=_r,ii=to,Bs=si.set,Ed=Td,Ws=ii.setImmediate?Ed(Bs,!1):Bs;Hd({global:!0,bind:!0,enumerable:!0,forced:ii.setImmediate!==Ws},{setImmediate:Ws});function uo(o,e){li(o,e),e.add(o)}function Wt(o,e,t){li(o,e),e.set(o,t)}function li(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Et(o,e,t){if(!e.has(o))throw new TypeError("attempted to get private field on non-instance");return t}function U(o,e){var t=ai(o,e,"get");return Od(o,t)}function Od(o,e){return e.get?e.get.call(o):e.value}function kt(o,e,t){var n=ai(o,e,"set");return Id(o,n,t),t}function ai(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function Id(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}const nt=Object.freeze({CELL:"cell",MIXED:"mixed"});var ce=new WeakMap,ho=new WeakMap,fo=new WeakMap,go=new WeakMap,mo=new WeakMap,Wo=new WeakSet,ks=new WeakSet,$s=new WeakSet,zs=new WeakSet;class Md{constructor(e){var t=this;uo(this,zs),uo(this,$s),uo(this,ks),uo(this,Wo),Wt(this,ce,{writable:!0,value:void 0}),Wt(this,ho,{writable:!0,value:void 0}),Wt(this,fo,{writable:!0,value:50}),Wt(this,go,{writable:!0,value:null}),Wt(this,mo,{writable:!0,value:new Map});const n=e.getSettings();kt(this,ce,e),kt(this,ho,n.imeFastEdit?nt.MIXED:nt.CELL),U(this,ce).addHook("afterUpdateSettings",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Et(t,zs,Ad).call(t,...i)}),U(this,ce).addHook("afterSelection",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Et(t,ks,xd).call(t,...i)}),U(this,ce).addHook("afterSelectionEnd",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return Et(t,$s,Pd).call(t,...i)})}getFocusMode(){return U(this,ho)}setFocusMode(e){Object.values(nt).includes(e)?kt(this,ho,e):zn(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return U(this,fo)}setRefocusDelay(e){kt(this,fo,e)}setRefocusElementGetter(e){kt(this,go,e)}getRefocusElement(){if(typeof U(this,go)=="function")return U(this,go).call(this);var e;return(e=U(this,ce).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const t=n=>{var r,i;const s=(r=U(this,ce).getSelectedRangeLast())===null||r===void 0?void 0:r.highlight;if(!s)return;let a=U(this,ce).runHooks("modifyFocusedElement",s.row,s.col,n);a instanceof HTMLElement||(a=n),a&&!((i=U(this,ce).getActiveEditor())!==null&&i!==void 0&&i.isOpened())&&a.focus({preventScroll:!0})};e?t(e):Et(this,Wo,Jn).call(this,n=>t(n))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:U(this,fo);const n=this.getRefocusElement();U(this,ce).getSettings().imeFastEdit&&!((e=U(this,ce).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&n&&(U(this,mo).has(t)||U(this,mo).set(t,cl(()=>{n.select()},t)),U(this,mo).get(t)())}}function Jn(o){var e;const t=(e=U(this,ce).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!t||!U(this,ce).selection.isCellVisible(t)){o(null);return}const n=U(this,ce).getCell(t.row,t.col,!0);n===null?U(this,ce).addHookOnce("afterScroll",()=>{o(U(this,ce).getCell(t.row,t.col,!0))}):o(n)}function xd(){Et(this,Wo,Jn).call(this,o=>{const{activeElement:e}=U(this,ce).rootDocument;e&&Lr(e)&&e.blur(),this.focusOnHighlightedCell(o)})}function Pd(){Et(this,Wo,Jn).call(this,o=>{this.getFocusMode()===nt.MIXED&&o.nodeName==="TD"&&this.refocusToEditorTextarea()})}function Ad(o){o.imeFastEdit&&this.getFocusMode()!==nt.MIXED?this.setFocusMode(nt.MIXED):!o.imeFastEdit&&this.getFocusMode()!==nt.CELL&&this.setFocusMode(nt.CELL)}function Be(o,e,t){Nd(o,e),e.set(o,t)}function Nd(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function x(o,e){var t=ci(o,e,"get");return _d(o,t)}function _d(o,e){return e.get?e.get.call(o):e.value}function Je(o,e,t){var n=ci(o,e,"set");return Ld(o,n,t),t}function ci(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function Ld(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Ee=new WeakMap,nn=new WeakMap,ne=new WeakMap,bt=new WeakMap,wo=new WeakMap,Pe=new WeakMap,sn=new WeakMap,$t=new WeakMap,at=new WeakMap,We=new WeakMap;class Dd{constructor(e,t,n,r,i,s){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Be(this,Ee,{writable:!0,value:void 0}),Be(this,nn,{writable:!0,value:void 0}),Be(this,ne,{writable:!0,value:void 0}),Be(this,bt,{writable:!0,value:void 0}),Be(this,wo,{writable:!0,value:void 0}),Be(this,Pe,{writable:!0,value:void 0}),Be(this,sn,{writable:!0,value:void 0}),Be(this,$t,{writable:!0,value:void 0}),Be(this,at,{writable:!0,value:[null,null]}),Be(this,We,{writable:!0,value:[null,null]}),Je(this,Ee,n),Je(this,nn,t),Je(this,ne,i),Je(this,bt,s),Je(this,wo,a),Je(this,Pe,r),Je(this,sn,e),this.registerEvents()}registerEvents(){x(this,Pe).addEventListener(x(this,ne).holder,"contextmenu",n=>this.onContextMenu(n)),x(this,Pe).addEventListener(x(this,ne).TABLE,"mouseover",n=>this.onMouseOver(n)),x(this,Pe).addEventListener(x(this,ne).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{x(this,Pe).addEventListener(x(this,ne).holder,"touchstart",n=>this.onTouchStart(n)),x(this,Pe).addEventListener(x(this,ne).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),x(this,Pe).addEventListener(x(this,ne).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||x(this,Ee).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,x(this,Ee).getSetting("onAfterMomentumScroll"))},200)})},t=()=>{x(this,Pe).addEventListener(x(this,ne).holder,"mouseup",n=>this.onMouseUp(n)),x(this,Pe).addEventListener(x(this,ne).holder,"mousedown",n=>this.onMouseDown(n))};Ht()?e():(dl()&&e(),t())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(x(this,$t)&&n){const[r,i]=[n.row,x(this,$t).from.row],[s,a]=[n.col,x(this,$t).from.col];return r===i&&s===a}return!1}parentCell(e){const t={},n=x(this,ne).TABLE,r=ao(e,["TD","TH"],n);return r?(t.coords=x(this,ne).getCoords(r),t.TD=r):ie(e,"wtBorder")&&ie(e,"current")?(t.coords=x(this,bt).getFocusSelection().cellRange.highlight,t.TD=x(this,ne).getCell(t.coords)):ie(e,"wtBorder")&&ie(e,"area")&&x(this,bt).getAreaSelection().cellRange&&(t.coords=x(this,bt).getAreaSelection().cellRange.to,t.TD=x(this,ne).getCell(t.coords)),t}onMouseDown(e){const t=x(this,nn).rootDocument.activeElement,n=ul(hl,e.target),r=e.target;if(!["TD","TH"].includes(t.nodeName)&&(r===t||n(0)===t||n(1)===t))return;const i=this.parentCell(r);ie(r,"corner")?x(this,Ee).getSetting("onCellCornerMouseDown",e,r):i.TD&&x(this,Ee).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,i.coords,i.TD),(e.button===0||this.touchApplied)&&i.TD&&(x(this,We)[0]=i.TD,clearTimeout(x(this,at)[0]),x(this,at)[0]=setTimeout(()=>{x(this,We)[0]=null},1e3))}onContextMenu(e){if(x(this,Ee).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!x(this,Ee).has("onCellMouseOver"))return;const t=x(this,ne).TABLE,n=ao(e.target,["TD","TH"],t),r=x(this,wo)||this;n&&n!==r.lastMouseOver&&In(n,t)&&(r.lastMouseOver=n,this.callListener("onCellMouseOver",e,x(this,ne).getCoords(n),n))}onMouseOut(e){if(!x(this,Ee).has("onCellMouseOut"))return;const t=x(this,ne).TABLE,n=ao(e.target,["TD","TH"],t),r=ao(e.relatedTarget,["TD","TH"],t),i=x(this,wo)||this;n&&n!==r&&In(n,t)&&(this.callListener("onCellMouseOut",e,x(this,ne).getCoords(n),n),r===null&&(i.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&x(this,Ee).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),!(e.button!==0&&!this.touchApplied)&&(t.TD===x(this,We)[0]&&t.TD===x(this,We)[1]?(ie(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),x(this,We)[0]=null,x(this,We)[1]=null):t.TD===x(this,We)[0]&&(x(this,We)[1]=t.TD,clearTimeout(x(this,at)[1]),x(this,at)[1]=setTimeout(()=>{x(this,We)[1]=null},500)))}onTouchStart(e){Je(this,$t,x(this,bt).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const n=e.target,r=(t=this.parentCell(n))===null||t===void 0?void 0:t.coords,i=W(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&i&&x(this,Ee).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];fl()&&(gl()||ml())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,n,r){const i=x(this,Ee).getSettingPure(e);i&&i(t,n,r,x(this,sn).call(this))}destroy(){clearTimeout(x(this,at)[0]),clearTimeout(x(this,at)[1]),x(this,Pe).destroy()}}const di=Dd;function rn(o,e,t){return e=Vd(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Vd(o){var e=Fd(o,"string");return typeof e=="symbol"?e:String(e)}function Fd(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Bd{constructor(e,t,n){rn(this,"offset",void 0),rn(this,"total",void 0),rn(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const Wd=Bd;function ln(o,e,t){return e=kd(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function kd(o){var e=$d(o,"string");return typeof e=="symbol"?e:String(e)}function $d(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class zd{constructor(e,t,n){ln(this,"offset",void 0),ln(this,"total",void 0),ln(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const jd=zd,Ud=0,ko=1,$o=2;function po(o,e,t){return e=Kd(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Kd(o){var e=Gd(o,"string");return typeof e=="symbol"?e:String(e)}function Gd(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class js{constructor(){po(this,"currentSize",0),po(this,"nextSize",0),po(this,"currentOffset",0),po(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function an(o,e,t){return e=Yd(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Yd(o){var e=Xd(o,"string");return typeof e=="symbol"?e:String(e)}function Xd(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class qd{constructor(){an(this,"size",new js),an(this,"workingSpace",Ud),an(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof js}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=ko,e.workingSpace=$o,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=$o,e.workingSpace=ko,this.sharedSize=e.getViewSize()}}function vt(o,e,t){return e=Qd(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Qd(o){var e=Zd(o,"string");return typeof e=="symbol"?e:String(e)}function Zd(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class ui{constructor(e,t,n){vt(this,"rootNode",void 0),vt(this,"nodesPool",void 0),vt(this,"sizeSet",new qd),vt(this,"childNodeType",void 0),vt(this,"visualIndex",0),vt(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=n.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let n=0;if(this.isSharedViewSet()){let r=e.firstElementChild;for(;r;){if(r.tagName===this.childNodeType)n+=1;else if(t.isPlaceOn(ko))break;r=r.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,n=this.isSharedViewSet(),{nextSize:r}=t.getViewSize();let i=this.getRenderedChildCount();for(;i<r;){const a=this.nodesPool();!n||n&&t.isPlaceOn($o)?e.appendChild(a):e.insertBefore(a,e.firstChild),i+=1}const s=n&&t.isPlaceOn(ko);for(;i>r;)e.removeChild(s?e.firstChild:e.lastChild),i-=1}render(){const{rootNode:e,sizeSet:t}=this;let n=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn($o)&&(n+=t.sharedSize.nextSize);let r=e.childNodes[n];if(r.tagName!==this.childNodeType){const i=this.nodesPool();e.replaceChild(i,r),r=i}this.collectedNodes.push(r),this.visualIndex+=1}end(){}}class hi extends ui{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Jd(o,e,t){return e=eu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function eu(o){var e=tu(o,"string");return typeof e=="symbol"?e:String(e)}function tu(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class ou{constructor(e){Jd(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function zt(o,e,t){return e=nu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function nu(o){var e=su(o,"string");return typeof e=="symbol"?e:String(e)}function su(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class no{constructor(e,t){zt(this,"nodesPool",null),zt(this,"nodeType",void 0),zt(this,"rootNode",void 0),zt(this,"table",null),zt(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new ou(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function Us(o,e,t){return e=ru(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function ru(o){var e=iu(o,"string");return typeof e=="symbol"?e:String(e)}function iu(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class lu extends no{constructor(){super("TH"),Us(this,"orderViews",new WeakMap),Us(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new hi(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:n,rows:r,cells:i}=this.table;for(let s=0;s<e;s++){const a=this.table.renderedRowToSource(s),c=r.getRenderedNode(s);this.sourceRowIndex=a;const u=this.obtainOrderView(c),f=i.obtainOrderView(c);u.appendView(f).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let g=0;g<n;g++){u.render();const w=u.getCurrentNode();w.className="",w.removeAttribute("style"),Uo(w,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Z(w,[wl(),pl(),jn(g+1),Un(-1)]),t[g](a,w,g)}u.end()}}}class au extends no{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,i=r+t;for(let a=0,c=e;a<c;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<i;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)n.removeChild(n.lastChild),this.renderedNodes-=1}const s=this.rootNode.childNodes.length;if(s>e)for(let a=e;a<s;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&Lo(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Z(this.rootNode,[Dr()]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:n,columnsToRender:r,rowHeadersCount:i}=this.table,s=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Z(s,[Mn(),Vr(t+1)]);for(let a=-1*i;a<r;a+=1){const c=this.table.renderedColumnToSource(a),u=s.childNodes[a+i];u.className="",u.removeAttribute("style"),Uo(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Z(u,[jn(a+1+this.table.rowHeadersCount),Un(-1),Cl(),...a>=0?[Sl()]:[Mn()]]),n[t](c,u,t)}}}}class cu extends no{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,n=e+t;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;for(let r=0;r<t;r++){const i=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getHeaderWidth(i);this.rootNode.childNodes[r].style.width=`${s}px`}for(let r=0;r<e;r++){const i=this.table.renderedColumnToSource(r),s=this.table.columnUtils.getStretchedColumnWidth(i);this.rootNode.childNodes[r+t].style.width=`${s}px`}const n=this.rootNode.firstChild;n&&Y(n,"rowHeader")}}function du(o,e,t){return e=uu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function uu(o){var e=hu(o,"string");return typeof e=="symbol"?e:String(e)}function hu(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}let Ks=!1;class fu extends no{constructor(e){super("TR",e),du(this,"orderView",void 0),this.orderView=new ui(e,t=>this.nodesPool.obtain(t),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!Ks&&e>1e3&&(Ks=!0,zn(oo`Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting\x20
        the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Z(this.rootNode,[Dr()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const i=this.orderView.getCurrentNode(),s=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var t,n;Z(i,[Mn(),Vr(s+((t=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&t!==void 0?t:0)+1)])}}this.orderView.end()}}function Gs(o,e,t){return e=gu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function gu(o){var e=mu(o,"string");return typeof e=="symbol"?e:String(e)}function mu(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class wu extends no{constructor(){super("TD"),Gs(this,"orderViews",new WeakMap),Gs(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new hi(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:n,rowHeaders:r}=this.table;for(let a=0;a<e;a++){const c=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=c;const f=this.obtainOrderView(u),g=r.obtainOrderView(u);f.prependView(g).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let w=0;w<t;w++){f.render();const m=f.getCurrentNode(),v=this.table.renderedColumnToSource(w);if(ie(m,"hide")||(m.className=""),m.removeAttribute("style"),m.removeAttribute("dir"),Uo(m,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(c,v,m),this.table.isAriaEnabled()){var i,s;Z(m,[...m.hasAttribute("role")?[]:[bl()],Un(-1),jn(v+((i=(s=this.table.rowUtils)===null||s===void 0||(s=s.dataAccessObject)===null||s===void 0?void 0:s.rowHeaders.length)!==null&&i!==void 0?i:0)+1)])}}f.end()}}}function se(o,e,t){return e=pu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function pu(o){var e=Cu(o,"string");return typeof e=="symbol"?e:String(e)}function Cu(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Su{constructor(e){let{cellRenderer:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};se(this,"rootNode",void 0),se(this,"rootDocument",void 0),se(this,"rowHeaders",null),se(this,"columnHeaders",null),se(this,"colGroup",null),se(this,"rows",null),se(this,"cells",null),se(this,"rowFilter",null),se(this,"columnFilter",null),se(this,"rowUtils",null),se(this,"columnUtils",null),se(this,"rowsToRender",0),se(this,"columnsToRender",0),se(this,"rowHeaderFunctions",[]),se(this,"rowHeadersCount",0),se(this,"columnHeaderFunctions",[]),se(this,"columnHeadersCount",0),se(this,"cellRenderer",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:n,rows:r,cells:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),t.setTable(this),n.setTable(this),r.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=n,this.rows=r,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let n=0;n<e;n++){const r=t.getRenderedNode(n);if(r.firstChild){const i=this.renderedRowToSource(n),s=this.rowUtils.getHeight(i);s?r.firstChild.style.height=`${s-1}px`:r.firstChild.style.height=""}}}}class bu{constructor(){let{TABLE:e,THEAD:t,COLGROUP:n,TBODY:r,rowUtils:i,columnUtils:s,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Su(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new lu,columnHeaders:new au(t),colGroup:new cu(n),rows:new fu(r),cells:new wu}),this.renderer.setAxisUtils(i,s)}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function cn(o,e,t){return e=vu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function vu(o){var e=yu(o,"string");return typeof e=="symbol"?e:String(e)}function yu(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Ru{constructor(e,t){cn(this,"dataAccessObject",void 0),cn(this,"wtSettings",void 0),cn(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){const t=this.dataAccessObject.wtViewport.columnsRenderCalculator;let n=this.getWidth(e);if(t){const r=t.getStretchedColumnWidth(e,n);r&&(n=r)}return n}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(t=t?Math.max(t,n):n),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this,{wtTable:t,wtViewport:n,cloneSource:r}=this.dataAccessObject,i=r?r.wtTable.holder:t.holder,s=i.offsetHeight<i.scrollHeight?Re():0;let a=e.getSetting("rowHeaderWidth");if(n.columnsRenderCalculator.refreshStretching(n.getViewportWidth()-s),a=e.getSetting("onModifyRowHeaderWidth",a),a!=null){const c=e.getSetting("rowHeaders").length,u=e.getSetting("defaultColumnWidth");for(let f=0;f<c;f++){let g=Array.isArray(a)?a[f]:a;g=g??u,this.headerWidths.set(f,g)}}}}function Ys(o,e,t){return e=Tu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Tu(o){var e=Hu(o,"string");return typeof e=="symbol"?e:String(e)}function Hu(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Eu{constructor(e,t){Ys(this,"dataAccessObject",void 0),Ys(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(t=t===void 0?n:Math.max(t,n)),t}}function ke(o,e,t){return e=Ou(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Ou(o){var e=Iu(o,"string");return typeof e=="symbol"?e:String(e)}function Iu(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Mu{constructor(e,t,n,r,i){ke(this,"wtSettings",null),ke(this,"domBindings",void 0),ke(this,"TBODY",null),ke(this,"THEAD",null),ke(this,"COLGROUP",null),ke(this,"hasTableHeight",!0),ke(this,"hasTableWidth",!0),ke(this,"isTableVisible",!1),ke(this,"tableOffset",0),ke(this,"holderOffset",0),this.domBindings=n,this.isMaster=i==="master",this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,vl(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new Eu(this.dataAccessObject,this.wtSettings),this.columnUtils=new Ru(this.dataAccessObject,this.wtSettings),this.tableRenderer=new bu({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!ie(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Z(n,[Ze()]),n}createHider(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!ie(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Z(n,[Ze()]),n}createHolder(e){const t=e.parentNode;let n;return(!t||t.nodeType!==Node.ELEMENT_NODE||!ie(t,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",t&&t.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Z(n.parentNode,[Ze()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Z(n,[Ze()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:t}=this,{wtOverlays:n,wtViewport:r}=this.dataAccessObject,i=t.getSetting("totalRows"),s=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),c=a.length,u=t.getSetting("columnHeaders"),f=u.length;let g=!1,w=e;if(this.isMaster&&(this.holderOffset=xe(this.holder),w=r.createRenderCalculators(w),c&&!t.getSetting("fixedColumnsStart"))){const v=n.inlineStartOverlay.getScrollPosition(),y=this.correctHeaderWidth;this.correctHeaderWidth=v!==0,y!==this.correctHeaderWidth&&(w=!1)}if(this.isMaster&&(g=n.updateStateOfRendering()),w)this.isMaster&&r.createVisibleCalculators(),n&&n.refresh(!0);else{this.isMaster?this.tableOffset=xe(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const v=i>0?this.getFirstRenderedRow():0,y=s>0?this.getFirstRenderedColumn():0;this.rowFilter=new jd(v,i,f),this.columnFilter=new Wd(y,s,c);let M=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const b={};this.wtSettings.getSetting("beforeDraw",!0,b),M=b.skipRender!==!0}if(M){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is($e)||this.is(st))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let b;if(this.isMaster&&(b=this.dataAccessObject.workspaceWidth,this.dataAccessObject.wtViewport.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is($e))&&this.markOversizedRows(),this.isMaster){this.dataAccessObject.wtViewport.createVisibleCalculators(),this.dataAccessObject.wtOverlays.refresh(!1),this.dataAccessObject.wtOverlays.applyToDOM();const E=we(this.hider),j=we(this.TABLE);E!==0&&j!==E&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),b!==this.dataAccessObject.wtViewport.getWorkspaceWidth()&&(this.dataAccessObject.wtViewport.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is($e)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let m=!1;return this.isMaster&&(m=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(m=n.bottomOverlay.resetFixedPosition()||m),m=n.inlineStartOverlay.resetFixedPosition()||m,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),m?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(w),g&&n.syncScrollWithMaster(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const r=this.wtSettings.getSetting("defaultRowHeight");let i,s,a;const c=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,i=this.getColumnHeaderHeight(n),s=this.getColumnHeader(t,n),s&&(a=ot(s),(!i&&r<a||i<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(c)?c[n]!==null&&c[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=c[n]):isNaN(c)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=c),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(c[n]||c)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=c[n]||c))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let i=0,s=r.length;i<s;i++)if(n[i]){if(!t[i]||t[i].childNodes.length===0)return;t[i].childNodes[0].style.height=`${n[i]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if(!(!this.isMaster&&!this.is($e))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let r=0;r<n;r++){const i=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[i]&&(t.oversizedRows[i]=void 0)}}}getCell(e){let t=e.row,n=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",t,n);if(r&&Array.isArray(r)&&([t,n]=r),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");const s=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!s&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return s}getRow(e){let t=null,n=null;if(e<0){var r;t=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var i;t=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceToRendered(e),n=this.TBODY}return t!==void 0&&n!==void 0?n.childNodes.length<t+1?!1:n.childNodes[t]:!1}getColumnHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[t];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const i=r.childNodes[n];i&&t.push(i)}),t}getRowHeader(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(t>=n)return;const r=this.rowFilter.sourceToRendered(e),i=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,a=(r<0?this.THEAD:this.TBODY).childNodes[i];return a==null?void 0:a.childNodes[t]}getRowHeaders(e){const t=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<n;r++){const i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],s=i==null?void 0:i.childNodes[r];s&&t.push(s)}return t}getCoords(e){let t=e;if(t.nodeName!=="TD"&&t.nodeName!=="TH"&&(t=yl(t,["TD","TH"])),t===null)return null;const n=t.parentNode,r=n.parentNode;let i=Rl(n),s=t.cellIndex;return it(wt,t,this.wtRootElement)||it(gt,t,this.wtRootElement)?r.nodeName==="THEAD"&&(i-=r.childNodes.length):it(st,t,this.wtRootElement)||it($e,t,this.wtRootElement)?i=this.wtSettings.getSetting("totalRows")-r.childNodes.length+i:r===this.THEAD?i=this.rowFilter.visibleColHeadedRowToSourceRow(i):i=this.rowFilter.renderedToSource(i),it(wt,t,this.wtRootElement)||it(mt,t,this.wtRootElement)||it(st,t,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s),this.wot.createCellCoords(i,s)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const t=e*this.wtSettings.getSetting("defaultRowHeight"),n=ot(this.TBODY)-1;let r,i,s,a,c;if(!(t===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,s=this.rowFilter.renderedToSource(e),r=this.getRowHeight(s),a=this.getTrForRow(s),c=a.querySelector("th"),c?i=ot(c):i=ot(a)-1,(!r&&this.wtSettings.getSetting("defaultRowHeight")<i||r<i)&&(i+=1,this.dataAccessObject.wtViewport.oversizedRows[s]=i)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return we(this.TABLE)}getHeight(){return De(this.TABLE)}getTotalWidth(){const e=we(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=De(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Kn(this.TABLE)}_modifyRowHeaderWidth(e){let t=ae(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return typeof e!="number"&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}const Nt=Mu,xu="stickyRowsBottom",fi={getFirstRenderedRow(){const o=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),t=o-e;return o===0||e===0?-1:t<0?0:t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const o=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),o)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};xt(fi,"MIXIN_NAME",xu,{writable:!1,enumerable:!1});const gi=fi,Pu="stickyColumnsStart",mi={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const o=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),o)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};xt(mi,"MIXIN_NAME",Pu,{writable:!1,enumerable:!1});const es=mi;class ts extends Nt{constructor(e,t,n,r){super(e,t,n,r,st)}}le(ts,gi);le(ts,es);const Au=ts,gt="top",$e="bottom",mt="inline_start",wt="top_inline_start_corner",st="bottom_inline_start_corner",Nu=[gt,$e,mt,wt,st],_u=new Map([[gt,`ht_clone_${gt}`],[$e,`ht_clone_${$e}`],[mt,`ht_clone_${mt} ht_clone_left`],[wt,`ht_clone_${wt} ht_clone_top_left_corner`],[st,`ht_clone_${st} ht_clone_bottom_left_corner`]]);function dn(o,e,t){return e=Lu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Lu(o){var e=Du(o,"string");return typeof e=="symbol"?e:String(e)}function Du(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Vu{constructor(e){dn(this,"dataAccessObject",void 0),dn(this,"lastScrolledColumnPos",-1),dn(this,"lastScrolledRowPos",-1),this.dataAccessObject=e}scrollViewport(e,t,n,r,i){const s=this.scrollViewportHorizontally(e.col,n,i),a=this.scrollViewportVertically(e.row,t,r);return s||a}scrollViewportHorizontally(e,t,n){const{drawn:r,totalColumns:i}=this.dataAccessObject;if(!r||!Number.isInteger(e)||e<0||e>i)return!1;const s=this.getFirstVisibleColumn(),a=this.getLastVisibleColumn(),c=t===void 0&&n===void 0,{fixedColumnsStart:u,inlineStartOverlay:f}=this.dataAccessObject;if(c&&e<u)return!1;let g=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),s===-1?g=f.scrollTo(e,c?e>this.lastScrolledColumnPos:t):(c&&(e<s||e>a)||!c)&&(g=f.scrollTo(e,c?e>a:t)),g&&(this.lastScrolledColumnPos=e),g}scrollViewportVertically(e,t,n){const{drawn:r,totalRows:i}=this.dataAccessObject;if(!r||!Number.isInteger(e)||e<0||e>i)return!1;const s=this.getFirstVisibleRow(),a=this.getLastVisibleRow(),c=t===void 0&&n===void 0,{fixedRowsBottom:u,fixedRowsTop:f,topOverlay:g}=this.dataAccessObject;if(c&&(e<f||e>i-u-1))return!1;let w=!1;return e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),s===-1?w=g.scrollTo(e,c?e>this.lastScrolledRowPos:n):(c&&(e<s||e>a)||!c)&&(w=g.scrollTo(e,c?e>a:n)),w&&(this.lastScrolledRowPos=e),w}getFirstVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:n,totalRows:r,fixedRowsTop:i,rootWindow:s}=this.dataAccessObject;let a=t.getFirstVisibleRow();if(e.mainTableScrollableElement===s){const c=xe(t.wtRootElement),u=ot(t.hider),f=ot(s),g=Do(s,s);if(c.top+u-f<=g){let w=n.getColumnHeaderHeight();w+=e.sumCellSizes(0,i);for(let m=r;m>0;m--)if(w+=e.sumCellSizes(m-1,m),c.top+u-w<=g){a=m;break}}}return a}getLastVisibleRow(){const{topOverlay:e,wtTable:t,wtViewport:n,totalRows:r,rootWindow:i}=this.dataAccessObject;let s=t.getLastVisibleRow();if(e.mainTableScrollableElement===i){const a=xe(t.wtRootElement),c=Do(i,i);if(a.top>c){const u=ot(i);let f=n.getColumnHeaderHeight();for(let g=1;g<=r;g++)if(f+=e.sumCellSizes(g-1,g),a.top+f-c>=u){s=g-2;break}}}return s}getFirstVisibleColumn(){const{inlineStartOverlay:e,wtTable:t,wtViewport:n,totalColumns:r,rootWindow:i}=this.dataAccessObject;let s=t.getFirstVisibleColumn();if(e.mainTableScrollableElement===i){const a=xe(t.wtRootElement),c=Po(t.hider),u=Po(i),f=Math.abs(xn(i,i));if(a.left+c-u<=f){let g=n.getRowHeaderWidth();for(let w=r;w>0;w--)if(g+=e.sumCellSizes(w-1,w),a.left+c-g<=f){s=w;break}}}return s}getLastVisibleColumn(){const{wtSettings:e,inlineStartOverlay:t,wtTable:n,wtViewport:r,totalColumns:i,rootWindow:s}=this.dataAccessObject;let a=n.getLastVisibleColumn();if(t.mainTableScrollableElement===s){const c=e.getSetting("rtlMode");let u=null;if(c){const g=n.TABLE.getBoundingClientRect(),m=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;u=Math.abs(g.right-m)}else u=xe(n.wtRootElement).left;const f=Math.abs(xn(s,s));if(u>f){const g=Po(s);let w=r.getRowHeaderWidth();for(let m=1;m<=i;m++)if(w+=t.sumCellSizes(m-1,m),u+w-f>=g){a=m-2;break}}}return a}}const Fu=Vu;function Ae(o,e,t){return e=Bu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Bu(o){var e=Wu(o,"string");return typeof e=="symbol"?e:String(e)}function Wu(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class os{get eventManager(){return new Gn(this)}constructor(e,t){Ae(this,"wtTable",void 0),Ae(this,"wtScroll",void 0),Ae(this,"wtViewport",void 0),Ae(this,"wtOverlays",void 0),Ae(this,"selectionManager",void 0),Ae(this,"wtEvent",void 0),Ae(this,"guid",`wt_${Fr()}`),Ae(this,"drawInterrupted",!1),Ae(this,"drawn",!1),Ae(this,"domBindings",void 0),Ae(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new Fu(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;t<n;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,n){Yn(n,e[t])}])}}createCellCoords(e,t){return new Br(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,n){return new Wr(e,t,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!e&&!this.wtTable.isVisible()?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedRowsBottom"),s=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<s)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<s&&e.row>=n-i){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<s)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-i&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,n,r,i){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,t,n,r,i)}scrollViewportHorizontally(e,t,n){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return e<0?!1:this.wtScroll.scrollViewportVertically(e,t,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function Xs(o,e,t){return e=ku(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function ku(o){var e=$u(o,"string");return typeof e=="symbol"?e:String(e)}function $u(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class zu extends os{constructor(e,t,n){super(e,t),Xs(this,"cloneSource",void 0),Xs(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new di(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function ju(o,e,t){return e=Uu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Uu(o){var e=Ku(o,"string");return typeof e=="symbol"?e:String(e)}function Ku(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class so{constructor(e,t,n,r,i){ju(this,"wtSettings",null),xt(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=r;const{TABLE:s,hider:a,spreader:c,holder:u,wtRootElement:f}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=a,this.spreader=c,this.holder=u,this.wtRootElement=f,this.trimmingContainer=Vo(this.hider.parentNode.parentNode),this.updateStateOfRendering(),this.clone=this.makeClone()}updateStateOfRendering(){const e=this.needFullRender;this.needFullRender=this.shouldBeRendered();const t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Vo(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Fo(e.TABLE)}getRelativeCellPosition(e,t,n){if(this.clone.wtTable.holder.contains(e)===!1){zn(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,i=n<this.wtSettings.getSetting("fixedColumnsStart"),s=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),c=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(c),top:c.offsetTop},f={start:this.getRelativeStartPosition(e),top:e.offsetTop};let g=null;return r?g=this.getRelativeCellPositionWithinWindow(s,i,f,u):g=this.getRelativeCellPositionWithinHolder(s,a,i,f,u),g}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,n,r){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let s=0,a=0;if(!t)s=r.start;else{let c=i.left;this.isRtl()&&(c=this.domBindings.rootWindow.innerWidth-(i.left+i.width+Re())),s=c<=0?-1*c:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top:a=r.top,{start:n.start+s,top:n.top+a}}getRelativeCellPositionWithinHolder(e,t,n,r,i){const s={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,c=0;if(n||(a=s.horizontal-i.start),t){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();c=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(c=s.vertical-i.top);return{start:r.start-a,top:r.top-c}}makeClone(){if(Nu.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=n.createElement("div"),s=n.createElement("table"),a=e.wtRootElement.parentNode;i.className=`${_u.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,t.getSetting("ariaTags")&&Z(i,[Ze()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(s),a.appendChild(i);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===gt||u==="vertical"&&this.type===mt?this.mainTableScrollableElement=r:r.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Fo(e.TABLE),new zu(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}reset(){if(!this.clone)return;const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,r=t.style,i=e.parentNode.style;$([n,r,i],s=>{s.width="",s.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class Gu extends so{constructor(e,t,n,r,i,s){super(e,t,st,n,r),this.bottomOverlay=i,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Au(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset(),s=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${i}px`,t.style.bottom=`${s}px`}else Ko(t),this.repositionOverlay();let n=De(this.clone.wtTable.TABLE);const r=we(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),t.style.height=`${n}px`,t.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=Re(n)),r.style.bottom=`${i}px`}}const Yu="calculatedColumns",wi={getFirstRenderedColumn(){const o=this.dataAccessObject.startColumnRendered;return o===null?-1:o},getFirstVisibleColumn(){const o=this.dataAccessObject.startColumnVisible;return o===null?-1:o},getLastRenderedColumn(){const o=this.dataAccessObject.endColumnRendered;return o===null?-1:o},getLastVisibleColumn(){const o=this.dataAccessObject.endColumnVisible;return o===null?-1:o},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};xt(wi,"MIXIN_NAME",Yu,{writable:!1,enumerable:!1});const ns=wi;class ss extends Nt{constructor(e,t,n,r){super(e,t,n,r,$e)}}le(ss,gi);le(ss,ns);const Xu=ss;function qu(o,e,t){return e=Qu(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Qu(o){var e=Zu(o,"string");return typeof e=="symbol"?e:String(e)}function Zu(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Ju extends so{constructor(e,t,n,r){super(e,t,$e,n,r),qu(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Xu(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let n=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(n=this.getOverlayOffset(),t.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const i=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=Re(n)),r.style.bottom=`${i}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.mainTableScrollableElement===t?(t.scrollTo(kr(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:n,wtSettings:r}=this.wot,i=r.getSetting("defaultRowHeight");let s=e,a=0;for(;s<t;){const c=n.getRowHeight(s);a+=c===void 0?i:c,s+=1}return a}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:n,rootWindow:r}=this.domBindings,i=Re(n),a=this.clone.wtTable.holder.parentNode.style,c=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||c==="horizontal"){let f=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(f-=i),f=Math.min(f,e.wtRootElement.scrollWidth),a.width=`${f}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=De(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let n=this.getTableParentOffset();const i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;t&&i.offsetHeight!==i.clientHeight&&(s=Re(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Do(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),s=r-i,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==t,r=this.wtSettings.getSetting("columnHeaders");let i=!1;if((n||t===0)&&r.length>0){const s=this.wot.wtTable.holder.parentNode,a=ie(s,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(Y(s,"innerBorderBottom"),i=!a):(me(s,"innerBorderBottom"),i=a)}return i}}const eh="calculatedRows",pi={getFirstRenderedRow(){const o=this.dataAccessObject.startRowRendered;return o===null?-1:o},getFirstVisibleRow(){const o=this.dataAccessObject.startRowVisible;return o===null?-1:o},getLastRenderedRow(){const o=this.dataAccessObject.endRowRendered;return o===null?-1:o},getLastVisibleRow(){const o=this.dataAccessObject.endRowVisible;return o===null?-1:o},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};xt(pi,"MIXIN_NAME",eh,{writable:!1,enumerable:!1});const Ci=pi;class rs extends Nt{constructor(e,t,n,r){super(e,t,n,r,mt)}}le(rs,Ci);le(rs,es);const th=rs,is=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});function oh(o,e){Si(o,e),e.add(o)}function qs(o,e,t){Si(o,e),e.set(o,t)}function Si(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function un(o,e,t){if(!e.has(o))throw new TypeError("attempted to get private field on non-instance");return t}function Q(o,e){var t=bi(o,e,"get");return nh(o,t)}function nh(o,e){return e.get?e.get.call(o):e.value}function Qs(o,e,t){var n=bi(o,e,"set");return sh(o,n,t),t}function bi(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function sh(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Ne=new WeakMap,be=new WeakMap,Co=new WeakSet;class rh{constructor(){oh(this,Co),qs(this,Ne,{writable:!0,value:void 0}),qs(this,be,{writable:!0,value:void 0})}setActiveOverlay(e){return Qs(this,be,e),this}setActiveSelection(e){return Qs(this,Ne,e),this}scan(){const e=Q(this,Ne).settings.selectionType,t=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n))):e==="area"?this.scanCellsRange(n=>t.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n)),this.scanCellsRange(n=>t.add(n))):e==="fill"?this.scanCellsRange(n=>t.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanRowsInHeadersRange(n=>t.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>t.add(n)),this.scanRowsInCellsRange(n=>t.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>t.add(n)),this.scanColumnsInCellsRange(n=>t.add(n))),t}scanColumnsInHeadersRange(e){const[t,n,r,i]=Q(this,Ne).getCorners(),{wtTable:s}=Q(this,be),a=s.getRenderedColumnsCount(),c=s.getColumnHeadersCount();let u=0;for(let f=-s.getRowHeadersCount();f<a;f++){const g=s.columnFilter.renderedToSource(f);if(!(g<n||g>i)){for(let w=-c;w<0;w++){if(w<t||w>r)continue;const m=w+c;let v=s.getColumnHeader(g,m);const y=Q(this,be).getSetting("onBeforeHighlightingColumnHeader",g,m,{selectionType:Q(this,Ne).settings.selectionType,columnCursor:u,selectionWidth:i-n+1});y!==null&&(y!==g&&(v=s.getColumnHeader(y,m)),e(v))}u+=1}}}scanRowsInHeadersRange(e){const[t,n,r,i]=Q(this,Ne).getCorners(),{wtTable:s}=Q(this,be),a=s.getRenderedRowsCount(),c=s.getRowHeadersCount();let u=0;for(let f=-s.getColumnHeadersCount();f<a;f++){const g=s.rowFilter.renderedToSource(f);if(!(g<t||g>r)){for(let w=-c;w<0;w++){if(w<n||w>i)continue;const m=w+c;let v=s.getRowHeader(g,m);const y=Q(this,be).getSetting("onBeforeHighlightingRowHeader",g,m,{selectionType:Q(this,Ne).settings.selectionType,rowCursor:u,selectionHeight:r-t+1});y!==null&&(y!==g&&(v=s.getRowHeader(y,m)),e(v))}u+=1}}}scanCellsRange(e){const[t,n,r,i]=Q(this,Ne).getCorners(),{wtTable:s}=Q(this,be);un(this,Co,hn).call(this,(a,c)=>{if(a>=t&&a<=r&&c>=n&&c<=i){const u=s.getCell(Q(this,be).createCellCoords(a,c)),f=Q(this,be).getSetting("onAfterDrawSelection",a,c,Q(this,Ne).settings.layerLevel);typeof f=="string"&&Y(u,f),e(u)}})}scanRowsInCellsRange(e){const[t,,n]=Q(this,Ne).getCorners(),{wtTable:r}=Q(this,be);un(this,Co,hn).call(this,(i,s)=>{if(i>=t&&i<=n){const a=r.getCell(Q(this,be).createCellCoords(i,s));e(a)}})}scanColumnsInCellsRange(e){const[,t,,n]=Q(this,Ne).getCorners(),{wtTable:r}=Q(this,be);un(this,Co,hn).call(this,(i,s)=>{if(s>=t&&s<=n){const a=r.getCell(Q(this,be).createCellCoords(i,s));e(a)}})}}function hn(o){const{wtTable:e}=Q(this,be),t=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let r=0;r<t;r+=1){const i=e.rowFilter.renderedToSource(r);for(let s=0;s<n;s+=1)o(i,e.columnFilter.renderedToSource(s))}}class ih{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=is,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let t=0,n=this.main.childNodes.length;t<n;t++){const r=this.main.childNodes[t];this.eventManager.addEventListener(r,"mouseenter",i=>this.onMouseEnter(i,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Xn(e);const n=this,r=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none";function s(c){if(c.clientY<Math.floor(i.top)||c.clientY>Math.ceil(i.top+i.height)||c.clientX<Math.floor(i.left)||c.clientX>Math.ceil(i.left+i.width))return!0}function a(c){s(c)&&(n.eventManager.removeEventListener(r,"mousemove",a),t.style.display="block")}this.eventManager.addEventListener(r,"mousemove",a)}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const n=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let a=0;a<5;a++){const c=n[a],u=t.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[c]&&this.settings[c].hide&&(u.className+=" hidden"),r=u.style,r.backgroundColor=this.settings[c]&&this.settings[c].color?this.settings[c].color:e.border.color,r.height=this.settings[c]&&this.settings[c].width?`${this.settings[c].width}px`:`${e.border.width}px`,r.width=this.settings[c]&&this.settings[c].width?`${this.settings[c].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Ht()&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let s=i.bordersHolder;s||(s=t.createElement("div"),s.className="htBorders",i.bordersHolder=s,i.spreader.appendChild(s)),s.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const t=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const r={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};pe(r,(s,a)=>{this.selectionHandles.styles.bottomHitArea[a]=s,this.selectionHandles.styles.topHitArea[a]=s});const i={position:"absolute",height:`${t}px`,width:`${t}px`,"border-radius":`${parseInt(t/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};pe(i,(s,a)=>{this.selectionHandles.styles.bottom[a]=s,this.selectionHandles.styles.top[a]=s}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||t!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,t,n,r,i,s){const c=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:f,bottom:g,bottomHitArea:w}=this.selectionHandles.styles,m=parseInt(u.borderWidth,10),v=parseInt(u.width,10),y=parseInt(f.width,10),M=this.wot.wtTable.getWidth(),b=this.wot.wtTable.getHeight();u.top=`${parseInt(n-v-1,10)}px`,u[c]=`${parseInt(r-v-1,10)}px`,f.top=`${parseInt(n-y/4*3,10)}px`,f[c]=`${parseInt(r-y/4*3,10)}px`;const E=Math.min(parseInt(r+i,10),M-v-m*2),j=Math.min(parseInt(r+i-y/4,10),M-y-m*2);g[c]=`${E}px`,w[c]=`${j}px`;const X=Math.min(parseInt(n+s,10),b-v-m*2),z=Math.min(parseInt(n+s-y/4,10),b-y-m*2);g.top=`${X}px`,w.top=`${z}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",f.display="block",this.isPartRange(e,t)?(g.display="none",w.display="none"):(g.display="block",w.display="block")):(u.display="none",g.display="none",f.display="none",w.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",f.zIndex="9999"):(u.zIndex="",f.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:n,rootWindow:r}=this.wot;let i,s,a,c,u,f;const g=t.getRenderedRowsCount();for(let V=0;V<g;V+=1){const l=t.rowFilter.renderedToSource(V);if(l>=e[0]&&l<=e[2]){i=l,u=e[0];break}}for(let V=g-1;V>=0;V-=1){const l=t.rowFilter.renderedToSource(V);if(l>=e[0]&&l<=e[2]){s=l;break}}const w=t.getRenderedColumnsCount();for(let V=0;V<w;V+=1){const l=t.columnFilter.renderedToSource(V);if(l>=e[1]&&l<=e[3]){a=l,f=e[1];break}}for(let V=w-1;V>=0;V-=1){const l=t.columnFilter.renderedToSource(V);if(l>=e[1]&&l<=e[3]){c=l;break}}if(i===void 0||a===void 0){this.disappear();return}let m=t.getCell(this.wot.createCellCoords(i,a));const v=i!==s||a!==c,y=v?t.getCell(this.wot.createCellCoords(s,c)):m,M=xe(m),b=v?xe(y):M,E=xe(t.TABLE),j=we(t.TABLE),X=M.top,z=M.left,O=this.wot.wtSettings.getSetting("rtlMode");let L=0,te=0;if(O){const V=we(m),l=r.innerWidth-E.left-j;te=z+V-b.left,L=r.innerWidth-z-V-l-1}else te=b.left+we(y)-z,L=z-E.left-1;if(this.isEntireColumnSelected(i,s)){const V=this.getDimensionsFromHeader("columns",a,c,u,E);let l=null;V&&([l,L,te]=V),l&&(m=l)}let Ce=X-E.top-1,de=b.top+De(y)-X;if(this.isEntireRowSelected(a,c)){const V=this.getDimensionsFromHeader("rows",i,s,f,E);let l=null;V&&([l,Ce,de]=V),l&&(m=l)}const ro=$r(m,r);parseInt(ro.borderTopWidth,10)>0&&(Ce+=1,de=de>0?de-1:0),parseInt(ro[O?"borderRightWidth":"borderLeftWidth"],10)>0&&(L+=1,te=te>0?te-1:0);const je=O?"right":"left";this.topStyle.top=`${Ce}px`,this.topStyle[je]=`${L}px`,this.topStyle.width=`${te}px`,this.topStyle.display="block",this.startStyle.top=`${Ce}px`,this.startStyle[je]=`${L}px`,this.startStyle.height=`${de}px`,this.startStyle.display="block";const _t=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${Ce+de-_t}px`,this.bottomStyle[je]=`${L}px`,this.bottomStyle.width=`${te}px`,this.bottomStyle.display="block",this.endStyle.top=`${Ce}px`,this.endStyle[je]=`${L+te-_t}px`,this.endStyle.height=`${de+1}px`,this.endStyle.display="block";let Ue=this.settings.border.cornerVisible;Ue=typeof Ue=="function"?Ue(this.settings.layerLevel):Ue;const pt=this.wot.getSetting("onModifyGetCellCoords",s,c);let[Lt,io]=[s,c];if(pt&&Array.isArray(pt)&&([,,Lt,io]=pt),Ht()||!Ue||this.isPartRange(Lt,io))this.cornerStyle.display="none";else{this.cornerStyle.top=`${Ce+de+this.cornerCenterPointOffset-1}px`,this.cornerStyle[je]=`${L+te+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let V=Vo(t.TABLE);const l=V===r;l&&(V=n.documentElement);const d=parseInt(this.cornerDefaultStyle.width,10)/2,h=parseInt(this.cornerDefaultStyle.height,10)/2;if(c===this.wot.getSetting("totalColumns")-1){const C=l?y.getBoundingClientRect().left:y.offsetLeft;let p=!1,S=0;O?(S=C-parseInt(this.cornerDefaultStyle.width,10)/2,p=S<0):(S=C+we(y)+parseInt(this.cornerDefaultStyle.width,10)/2,p=S>=Po(V)),p&&(this.cornerStyle[je]=`${Math.floor(L+te+this.cornerCenterPointOffset-d)}px`,this.cornerStyle[O?"borderLeftWidth":"borderRightWidth"]=0)}s===this.wot.getSetting("totalRows")-1&&(l?y.getBoundingClientRect().top:y.offsetTop)+De(y)+parseInt(this.cornerDefaultStyle.height,10)/2>=ot(V)&&(this.cornerStyle.top=`${Math.floor(Ce+de+this.cornerCenterPointOffset-h)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}Ht()&&this.updateMultipleSelectionHandlesPosition(s,c,Ce,L,te,de)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,n,r,i){const{wtTable:s}=this.wot,a=s.wtRootElement.parentNode;let c=null,u=null,f=null,g=null,w=null,m=null,v=null,y=null;switch(e){case"rows":c=function(){return s.getRowHeader(...arguments)},u=function(){return De(...arguments)},f="ht__selection--rows",m="top";break;case"columns":c=function(){return s.getColumnHeader(...arguments)},u=function(){return we(...arguments)},f="ht__selection--columns",m="left";break}if(a.classList.contains(f)){const M=this.wot.getSetting("columnHeaders").length;if(v=c(t,M-r),y=c(n,M-r),!v||!y)return!1;const b=xe(v),E=xe(y);return v&&y&&(g=b[m]-i[m]-1,w=E[m]+u(y)-b[m]),[v,g,w]}return!1}changeBorderStyle(e,t){const n=this[e].style,r=t[e];!r||r.hide?Y(this[e],"hidden"):(ie(this[e],"hidden")&&me(this[e],"hidden"),n.backgroundColor=r.color,(e==="top"||e==="bottom")&&(n.height=`${r.width}px`),(e==="start"||e==="end")&&(n.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const t={width:1,color:"#000"},n=this[e].style;n.backgroundColor=t.color,n.width=`${t.width}px`,n.height=`${t.width}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?Y(this[e],"hidden"):me(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Ht()&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}const Zs=ih;function lh(o,e){vi(o,e),e.add(o)}function yt(o,e,t){vi(o,e),e.set(o,t)}function vi(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ah(o,e,t){if(!e.has(o))throw new TypeError("attempted to get private field on non-instance");return t}function N(o,e){var t=yi(o,e,"get");return ch(o,t)}function ch(o,e){return e.get?e.get.call(o):e.value}function Js(o,e,t){var n=yi(o,e,"set");return dh(o,n,t),t}function yi(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function dh(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var he=new WeakMap,ye=new WeakMap,fn=new WeakMap,qt=new WeakMap,gn=new WeakMap,ct=new WeakMap,er=new WeakSet;class uh{constructor(e){lh(this,er),yt(this,he,{writable:!0,value:void 0}),yt(this,ye,{writable:!0,value:void 0}),yt(this,fn,{writable:!0,value:new rh}),yt(this,qt,{writable:!0,value:new WeakMap}),yt(this,gn,{writable:!0,value:new WeakSet}),yt(this,ct,{writable:!0,value:new Map}),Js(this,ye,e)}setActiveOverlay(e){return Js(this,he,e),N(this,fn).setActiveOverlay(N(this,he)),N(this,qt).has(N(this,he))||N(this,qt).set(N(this,he),new Set),this}getFocusSelection(){return N(this,ye)!==null?N(this,ye).getFocus():null}getAreaSelection(){return N(this,ye)!==null?N(this,ye).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(N(this,ct).has(e)){const n=N(this,ct).get(e);if(n.has(N(this,he)))return n.get(N(this,he));const r=new Zs(N(this,he),e.settings);return n.set(N(this,he),r),r}const t=new Zs(N(this,he),e.settings);return N(this,ct).set(e,new Map([[N(this,he),t]])),t}getBorderInstances(e){var t,n;return Array.from((t=(n=N(this,ct).get(e))===null||n===void 0?void 0:n.values())!==null&&t!==void 0?t:[])}destroyBorders(e){N(this,ct).get(e).forEach(t=>t.destroy()),N(this,ct).delete(e)}render(e){if(N(this,ye)===null)return;e&&ah(this,er,hh).call(this);const t=Array.from(N(this,ye)),n=new Map,r=new Map;for(let i=0;i<t.length;i++){const s=t[i],{className:a,headerAttributes:c,createLayers:u,selectionType:f}=s.settings;N(this,gn).has(s)||(N(this,gn).add(s),s.addLocalHook("destroy",()=>this.destroyBorders(s)));const g=this.getBorderInstance(s);if(s.isEmpty()){g==null||g.disappear();continue}a&&N(this,fn).setActiveSelection(s).scan().forEach(v=>{if(n.has(v)){const y=n.get(v);y.has(a)&&u===!0?y.set(a,y.get(a)+1):y.set(a,1)}else n.set(v,new Map([[a,1]]));c&&(r.has(v)||r.set(v,[]),v.nodeName==="TH"&&r.get(v).push(...c))});const w=s.getCorners();N(this,he).getSetting("onBeforeDrawBorders",w,f),g==null||g.appear(w)}n.forEach((i,s)=>{var a;const c=Array.from(i).map(u=>{let[f,g]=u;return g===1?f:[f,...Array.from({length:g-1},(w,m)=>`${f}-${m+1}`)]}).flat();c.forEach(u=>N(this,qt).get(N(this,he)).add(u)),Y(s,c),s.nodeName==="TD"&&Array.isArray((a=N(this,ye).options)===null||a===void 0?void 0:a.cellAttributes)&&Z(s,N(this,ye).options.cellAttributes)}),Array.from(r.keys()).forEach(i=>{Z(i,[...r.get(i)])})}}function hh(){const o=N(this,qt).get(N(this,he)),e=N(this,he).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let t=0;t<e.length;t++)o.add(e[t]);o.forEach(t=>{var n,r;const i=N(this,he).wtTable.TABLE.querySelectorAll(`.${t}`);let s=[];Array.isArray((n=N(this,ye).options)===null||n===void 0?void 0:n.cellAttributes)&&(s=N(this,ye).options.cellAttributes.map(a=>a[0])),Array.isArray((r=N(this,ye).options)===null||r===void 0?void 0:r.headerAttributes)&&(s=[...s,...N(this,ye).options.headerAttributes.map(a=>a[0])]);for(let a=0,c=i.length;a<c;a++)me(i[a],t),Uo(i[a],s)}),o.clear()}class fh extends so{constructor(e,t,n,r){super(e,t,mt,n,r)}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new th(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,n=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer===t&&(!r||r!=="horizontal")?(i=this.getOverlayOffset()*(this.isRtl()?-1:1),qn(n,`${i}px`,"0px")):(i=this.getScrollPosition(),Ko(n));const s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Tl(t)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultColumnWidth");let r=e,i=0;for(;r<t;)i+=this.wot.wtTable.getStretchedColumnWidth(r)||n,r+=1;return i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:n}=this.domBindings,r=Re(t),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=r),u=Math.min(u,e.wtRootElement.scrollHeight),s.height=`${u}px`}else s.height="";this.clone.wtTable.holder.style.height=s.height;const c=we(this.clone.wtTable.TABLE);s.width=`${c}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(is.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[t]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let n=this.getTableParentOffset();const i=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let s=0;if(t){const a=this.wot.wtTable.getColumnWidth(e),c=this.wot.wtViewport.getViewportWidth();a>c&&(t=!1)}return t&&i.offsetWidth!==i.clientWidth&&(s=Re(this.domBindings.rootDocument)),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),n+=s,this.setScrollPosition(n)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let t=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs(xn(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),i=this.clone.wtTable.getTotalWidth(),s=r-i;n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){const t=this.wot.wtTable.holder.parentNode,n=this.wtSettings.getSetting("rowHeaders"),r=this.wtSettings.getSetting("fixedColumnsStart");this.wtSettings.getSetting("totalRows")?me(t,"emptyRows"):Y(t,"emptyRows");let s=!1;if(r&&!n.length)Y(t,"innerBorderLeft innerBorderInlineStart");else if(!r&&n.length){const a=ie(t,"innerBorderInlineStart");e?(Y(t,"innerBorderLeft innerBorderInlineStart"),s=!a):(me(t,"innerBorderLeft innerBorderInlineStart"),s=a)}return s}}const gh="stickyRowsTop",Ri={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const o=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),o)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};xt(Ri,"MIXIN_NAME",gh,{writable:!1,enumerable:!1});const Ti=Ri;class ls extends Nt{constructor(e,t,n,r){super(e,t,n,r,wt)}}le(ls,Ti);le(ls,es);const mh=ls;function tr(o,e,t){return e=wh(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function wh(o){var e=ph(o,"string");return typeof e=="symbol"?e:String(e)}function ph(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Ch extends so{constructor(e,t,n,r,i,s){super(e,t,wt,n,r),tr(this,"topOverlay",void 0),tr(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=s}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new mh(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();qn(e,`${r}px`,`${i}px`)}else Ko(e);let t=De(this.clone.wtTable.TABLE);const n=we(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${n}px`,!1}}class as extends Nt{constructor(e,t,n,r){super(e,t,n,r,gt)}}le(as,Ti);le(as,ns);const Sh=as;function bh(o,e,t){return e=vh(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function vh(o){var e=yh(o,"string");return typeof e=="symbol"?e:String(e)}function yh(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Rh extends so{constructor(e,t,n,r){super(e,t,gt,n,r),bh(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Sh(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let r=0,i=!1;if(this.trimmingContainer===t&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,c=a.hider.getBoundingClientRect(),u=Math.ceil(c.bottom),f=e.offsetHeight;i=u===f,r=this.getOverlayOffset(),qn(e,"0px",`${r}px`)}else r=this.getScrollPosition(),Ko(e);const s=this.adjustHeaderBordersPosition(r,i);return this.adjustElementsSize(),s}setScrollPosition(e){const t=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(kr(t),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const n=this.wtSettings.getSetting("defaultRowHeight");let r=e,i=0;for(;r<t;){const s=this.wot.wtTable.getRowHeight(r);i+=s===void 0?n:s,r+=1}return i}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:n}=this.domBindings,r=Re(t),s=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=r),u=Math.min(u,e.wtRootElement.scrollWidth),s.width=`${u}px`}else s.width="";this.clone.wtTable.holder.style.width=s.width;let c=De(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(c=0),s.height=`${c}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(is.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:n,wtSettings:r}=this,s=(n.cloneSource?n.cloneSource:n).wtTable.holder;let a=this.getTableParentOffset(),c=0;if(t){const u=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();u>f&&(t=!1)}if(t&&s.offsetHeight!==s.clientHeight&&(c=Re(this.domBindings.rootDocument)),t){const u=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=n.wtViewport.getViewportHeight()-this.sumCellSizes(f-u,f),a+=1}else a+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return a+=c,this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return Do(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!t||t!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),i=this.clone.wtTable.getTotalHeight(),s=r-i;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>s&&(n=0)}return n}adjustHeaderBordersPosition(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.wot.wtTable.holder.parentNode;this.wtSettings.getSetting("totalColumns")?me(n,"emptyColumns"):Y(n,"emptyColumns");let i=!1;if(!t){const s=this.wtSettings.getSetting("fixedRowsTop"),a=this.cachedFixedRowsTop!==s,c=this.wtSettings.getSetting("columnHeaders");if((a||s===0)&&c.length>0){const u=ie(n,"innerBorderTop");this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop"),e||this.wtSettings.getSetting("totalRows")===0?(Y(n,"innerBorderTop"),i=!u):(me(n,"innerBorderTop"),i=u)}}return i}}function Xe(o,e,t){return e=Th(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Th(o){var e=Hh(o,"string");return typeof e=="symbol"?e:String(e)}function Hh(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Eh{constructor(e,t,n,r,i,s){Xe(this,"wot",null),Xe(this,"topOverlay",null),Xe(this,"bottomOverlay",null),Xe(this,"inlineStartOverlay",null),Xe(this,"topInlineStartCornerOverlay",null),Xe(this,"bottomInlineStartCornerOverlay",null),Xe(this,"browserLineHeight",void 0),Xe(this,"wtSettings",null),Xe(this,"resizeObserver",new ResizeObserver(f=>{Hl(()=>{!Array.isArray(f)||!f.length||this.wtSettings.getSetting("onContainerElementResize")})})),this.wot=e,this.wtSettings=r,this.domBindings=n,this.facadeGetter=t,this.wtTable=s;const{rootDocument:a,rootWindow:c}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=Re(a);const u=c.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?s.holder:Fo(s.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=c.scrollX,this.lastScrollY=c.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=[this.topOverlay,this.topInlineStartCornerOverlay,this.inlineStartOverlay,this.bottomOverlay,this.bottomInlineStartCornerOverlay];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,n=e.getComputedStyle(t.body),r=parseInt(n.lineHeight,10),i=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=r||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Rh(...e),this.bottomOverlay=new Ju(...e),this.inlineStartOverlay=new fh(...e),this.topInlineStartCornerOverlay=new Ch(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Gu(...e,this.bottomOverlay,this.inlineStartOverlay)}updateStateOfRendering(){let e=this.topOverlay.updateStateOfRendering();return e=this.bottomOverlay.updateStateOfRendering()||e,e=this.inlineStartOverlay.updateStateOfRendering()||e,this.inlineStartOverlay.needFullRender&&(this.topOverlay.needFullRender&&(e=this.topInlineStartCornerOverlay.updateStateOfRendering()||e),this.bottomOverlay.needFullRender&&(e=this.bottomInlineStartCornerOverlay.updateStateOfRendering()||e)),e}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",g=>this.onKeyDown(g)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",g=>this.onTableScroll(g),{passive:!0}),n!==r&&this.eventManager.addEventListener(r,"scroll",g=>this.onTableScroll(g),{passive:!0});const i=t.devicePixelRatio&&t.devicePixelRatio>1,s=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),c={passive:s};(a||i||!El())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",g=>this.onCloneWheel(g,a),c),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(g=>{if(g&&g.needFullRender){const{holder:w}=g.clone.wtTable;this.eventManager.addEventListener(w,"wheel",m=>this.onCloneWheel(m,a),c)}});let f;this.eventManager.addEventListener(t,"resize",()=>{clearTimeout(f),f=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize")},200)}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(r!==t&&i!==t&&!e.target.contains(r)||n!==t&&i!==t&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:n}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target,a=i!==n&&s!==n&&!s.contains(i),c=r!==n&&s!==n&&!s.contains(r);if(this.keyPressed&&(a||c))return;const u=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Ol(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,t+=t*this.browserLineHeight);const r=this.scrollVertically(t),i=this.scrollHorizontally(n);return r||i}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[r,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==r||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=r;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=r)}this.verticalScrolling&&(n.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Fo(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,n=e.clientHeight,r=t!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=n),r}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtViewport:t}=this.wot,{wtTable:n}=this,r=this.wtSettings.getSetting("totalColumns"),i=this.wtSettings.getSetting("totalRows"),s=t.getRowHeaderWidth(),a=t.getColumnHeaderHeight(),c=n.hider.style;if(c.width=`${s+this.inlineStartOverlay.sumCellSizes(0,r)}px`,c.height=`${a+this.topOverlay.sumCellSizes(0,i)+1}px`,this.scrollbarSize>0){const{scrollHeight:u,scrollWidth:f}=n.wtRootElement,{scrollHeight:g,scrollWidth:w}=n.holder;this.hasScrollbarRight=u<g,this.hasScrollbarBottom=f<w,this.hasScrollbarRight&&n.hider.scrollWidth+this.scrollbarSize>f?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&n.hider.scrollHeight+this.scrollbarSize>u&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(e),this.inlineStartOverlay.adjustElementsSize(e),this.bottomOverlay.adjustElementsSize(e)}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return $(t,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(n=r.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];$(t,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}const Oh=Eh;function or(o,e,t){return e=Ih(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Ih(o){var e=Mh(o,"string");return typeof e=="symbol"?e:String(e)}function Mh(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class xh{constructor(e){or(this,"settings",{}),or(this,"defaults",Object.freeze(this.getDefaults())),pe(this.defaults,(t,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(t===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=t}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,n)=>{const r=this.getSetting("data",e,t);Yn(n,r??"")},columnWidth(){},rowHeight(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return t===void 0?pe(e,(n,r)=>{this.settings[r]=n}):this.settings[e]=t,this}getSetting(e,t,n,r,i){return typeof this.settings[e]=="function"?this.settings[e](t,n,r,i):t!==void 0&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class cs extends Nt{constructor(e,t,n,r){super(e,t,n,r,"master")}alignOverlaysWithTrimmingContainer(){const e=Vo(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,r=Pn(e,"height",t),i=Pn(e,"overflow",t),s=this.holder.style,{scrollWidth:a,scrollHeight:c}=e;let u=e.offsetWidth,f=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(i)){const w=e.cloneNode(!1);w.style.overflow="auto",w.style.position="absolute",e.nextElementSibling?n.insertBefore(w,e.nextElementSibling):n.appendChild(w);const m=parseInt($r(w,t).height,10);n.removeChild(w),m===0&&(f=0)}f=Math.min(f,c),s.height=r==="auto"?"auto":`${f}px`,u=Math.min(u,a),s.width=`${u}px`,s.overflow="",this.hasTableHeight=s.height==="auto"?!0:f>0,this.hasTableWidth=u>0}this.isTableVisible=Kn(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,n="master",i=e.getSetting("columnHeaders").length;if(i&&!t.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,c=this.getRenderedColumnsCount();for(let u=0;u<i;u++)for(let f=-1*a;f<c;f++)this.markIfOversizedColumnHeader(f);t.hasOversizedColumnHeadersMarked[n]=!0}}}le(cs,Ci);le(cs,ns);const Ph=cs;class Ah{constructor(e,t,n,r,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=n,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return t===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=De(t)>0&&t.clientHeight>0?t.clientHeight:1/0,n}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:n}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=t.documentElement.offsetWidth,s=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),c=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),f=c?u.right-i:u.left,g=i-f;let w,m;if(a)return we(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?w=Math.min(g,i):w=Math.min(this.getContainerFillWidth(),g,i),r===n&&s>0&&this.sumColumnWidths(0,s-1)>w)return t.documentElement.clientWidth;if(r!==n&&(m=Pn(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),m==="scroll"||m==="hidden"||m==="auto"))return Math.max(w,r.clientWidth);const v=e.getSetting("stretchH");return v==="none"||!v?Math.max(w,we(this.wtTable.TABLE)):w}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let n=0,r=e;for(;r<t;)n+=this.wtTable.getColumnWidth(r),r+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const n=t.offsetWidth;return this.containerWidth=n,e.removeChild(t),n}getWorkspaceOffset(){return xe(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=De(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,i=t.length;r<i;r++)n?(this.rowHeaderWidth+=we(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Bt;const{wtSettings:t,wtTable:n}=this;let r,i,s;this.rowHeaderWidth=NaN,t.getSetting("renderAllRows")&&e===Bt?r=1/0:r=this.getViewportHeight();let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const c=t.getSetting("fixedRowsTop"),u=t.getSetting("fixedRowsBottom"),f=t.getSetting("totalRows");return c&&a>=0&&(s=this.dataAccessObject.topOverlay.sumCellSizes(0,c),a+=s,r-=s),u&&this.dataAccessObject.bottomOverlay.clone&&(s=this.dataAccessObject.bottomOverlay.sumCellSizes(f-u,f),r-=s),n.holder.clientHeight===n.holder.offsetHeight?i=0:i=Re(this.domBindings.rootDocument),new Il({viewportHeight:r,scrollOffset:a,totalRows:t.getSetting("totalRows"),rowHeightFn:g=>n.getRowHeight(g),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),calculationType:e,horizontalScrollbarHeight:i})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Bt;const{wtSettings:t,wtTable:n}=this;let r=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const s=t.getSetting("fixedColumnsStart");if(s&&i>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);i+=a,r-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(r-=Re(this.domBindings.rootDocument)),new zr({viewportWidth:r,scrollOffset:i,totalColumns:t.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),calculationType:e,stretchMode:t.getSetting("stretchH"),stretchingColumnWidthFn:(a,c)=>t.getSetting("onBeforeStretchingColumnWidth",a,c),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createRenderCalculators(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(t){const n=this.createRowsCalculator(co),r=this.createColumnsCalculator(co);this.areAllProposedVisibleRowsAlreadyRendered(n)&&this.areAllProposedVisibleColumnsAlreadyRendered(r)||(t=!1)}return t||(this.rowsRenderCalculator=this.createRowsCalculator(Bt),this.columnsRenderCalculator=this.createColumnsCalculator(Bt)),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,t}createVisibleCalculators(){this.rowsVisibleCalculator=this.createRowsCalculator(co),this.columnsVisibleCalculator=this.createColumnsCalculator(co)}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;const{startRow:t,endRow:n,isVisibleInTrimmingContainer:r}=e;if(t===null&&n===null)return!r;const{startRow:i,endRow:s}=this.rowsRenderCalculator;return t<i||t===i&&t>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;const{startColumn:t,endColumn:n,isVisibleInTrimmingContainer:r}=e;if(t===null&&n===null)return!r;const{startColumn:i,endColumn:s}=this.columnsRenderCalculator;return t<i||t===i&&t>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){pe(this.hasOversizedColumnHeadersMarked,(e,t,n)=>{n[t]=void 0})}}const Nh=Ah;class _h extends os{constructor(e,t){super(e,new xh(t));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Ph(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new Nh(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new uh(this.wtSettings.getSetting("selections")),this.wtEvent=new di(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Oh(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},t=[],n=[];pe(e,(r,i)=>{this.wtSettings.getSetting(i).length&&n.push(r),t.push(r)}),me(this.wtTable.wtRootElement.parentNode,t),Y(this.wtTable.wtRootElement.parentNode,n)}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class ds{constructor(e){e instanceof os?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=t=>{const n=new ds(t);return()=>n},this._wot=new _h(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,n){return this._wot.createCellRange(e,t,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,t)}scrollViewport(e,t,n,r,i){return this._wot.scrollViewport(e,t,n,r,i)}scrollViewportHorizontally(e,t,n){return this._wot.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return this._wot.scrollViewportVertically(e,t,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,n,r,i){return this._wot.wtSettings.getSetting(e,t,n,r,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function nr(o){let{isShiftKey:e,isLeftClick:t,isRightClick:n,coords:r,selection:i,controller:s,cellCoordsFactory:a}=o;const c=i.isSelected()?i.getSelectedRange().current():null,u=i.isSelectedByCorner(),f=i.isSelectedByRowHeader();if(e&&c)r.row>=0&&r.col>=0&&!s.cell?i.setRangeEnd(r):(u||f)&&r.row>=0&&r.col>=0&&!s.cell?i.setRangeEnd(a(r.row,r.col)):u&&r.row<0&&!s.column?i.setRangeEnd(a(c.to.row,r.col)):f&&r.col<0&&!s.row?i.setRangeEnd(a(r.row,c.to.col)):(!u&&!f&&r.col<0||u&&r.col<0)&&!s.row?i.selectRows(Math.max(c.from.row,0),r.row,r.col):(!u&&!f&&r.row<0||f&&r.row<0)&&!s.column&&i.selectColumns(Math.max(c.from.col,0),r.col,r.row);else{const g=!i.inInSelection(r),w=t||n&&g;r.row<0&&r.col>=0&&!s.column?w&&i.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!s.row?w&&i.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!s.cell?w&&i.setRangeStart(r):r.col<0&&r.row<0&&i.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}}function Lh(o){let{isLeftClick:e,coords:t,selection:n,controller:r,cellCoordsFactory:i}=o;if(!e)return;const s=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),c=n.tableProps.countCols(),u=n.tableProps.countRows();a&&!r.column?n.setRangeEnd(i(u-1,t.col)):s&&!r.row?n.setRangeEnd(i(t.row,c-1)):r.cell||n.setRangeEnd(t)}const Dh=new Map([["mousedown",nr],["mouseover",Lh],["touchstart",nr]]);function sr(o,e){let{coords:t,selection:n,controller:r,cellCoordsFactory:i}=e;Dh.get(o.type)({coords:t,selection:n,controller:r,cellCoordsFactory:i,isShiftKey:o.shiftKey,isLeftClick:jr(o)||o.type==="touchstart",isRightClick:An(o)})}const Hi=new WeakMap,us=Symbol("rootInstance");function Vh(o){Hi.set(o,!0)}function Fh(o){return o===us}function Ao(o){return Hi.has(o)}function rr(o,e){Ei(o,e),e.add(o)}function dt(o,e,t){Ei(o,e),e.set(o,t)}function Ei(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function et(o,e,t){return e=Bh(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Bh(o){var e=Wh(o,"string");return typeof e=="symbol"?e:String(e)}function Wh(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function Dn(o,e,t){if(!e.has(o))throw new TypeError("attempted to get private field on non-instance");return t}function re(o,e){var t=Oi(o,e,"get");return kh(o,t)}function kh(o,e){return e.get?e.get.call(o):e.value}function Oe(o,e,t){var n=Oi(o,e,"set");return $h(o,n,t),t}function Oi(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function $h(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var mn=new WeakMap,So=new WeakMap,bo=new WeakMap,qe=new WeakMap,_e=new WeakMap,wn=new WeakMap,pn=new WeakMap,Vn=new WeakSet,ir=new WeakSet;class zh{constructor(e){rr(this,ir),rr(this,Vn),et(this,"hot",void 0),et(this,"eventManager",void 0),et(this,"settings",void 0),et(this,"THEAD",void 0),et(this,"TBODY",void 0),et(this,"_wt",void 0),et(this,"activeWt",void 0),dt(this,mn,{writable:!0,value:0}),dt(this,So,{writable:!0,value:0}),et(this,"postponedAdjustElementsSize",!1),dt(this,bo,{writable:!0,value:!1}),dt(this,qe,{writable:!0,value:void 0}),dt(this,_e,{writable:!0,value:void 0}),dt(this,wn,{writable:!0,value:0}),dt(this,pn,{writable:!0,value:0}),this.hot=e,this.eventManager=new Gn(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize(e)}getCellAtCoords(e,t){const n=this._wt.getCell(e,t);return n<0?null:n}scrollViewport(e,t,n,r,i){return this._wt.scrollViewport(e,t,n,r,i)}scrollViewportHorizontally(e,t,n){return this._wt.scrollViewportHorizontally(e,t,n)}scrollViewportVertically(e,t,n){return this._wt.scrollViewportVertically(e,t,n)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),Y(e,"handsontable"),Oe(this,_e,t.createElement("TABLE")),Y(re(this,_e),"htCore"),this.hot.getSettings().tableClassName&&Y(re(this,_e),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Z(re(this,_e),[Ze()]),Z(e,[Ml(),Ur(-1),Go(this.hot.countCols()),xl()])),this.THEAD=t.createElement("THEAD"),re(this,_e).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),re(this,_e).appendChild(this.TBODY),this.hot.table=re(this,_e),this.hot.container.insertBefore(re(this,_e),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:n}=this.hot,r=t.documentElement;this.eventManager.addEventListener(e,"mousedown",i=>{if(Oe(this,bo,!0),!this.isTextSelectionAllowed(i.target)){const{rootWindow:s}=this.hot;Cs(s),i.preventDefault(),s.focus()}}),this.eventManager.addEventListener(e,"mouseup",()=>{Oe(this,bo,!1)}),this.eventManager.addEventListener(e,"mousemove",i=>{re(this,bo)&&!this.isTextSelectionAllowed(i.target)&&(this.settings.fragmentSelection&&Cs(this.hot.rootWindow),i.preventDefault())}),this.eventManager.addEventListener(r,"keyup",i=>{n.isInProgress()&&!i.shiftKey&&n.finish()}),this.eventManager.addEventListener(r,"mouseup",i=>{n.isInProgress()&&jr(i)&&n.finish(),Oe(this,qe,!1);const s=Lr(t.activeElement);s&&(s||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(i.target)&&!An(i))&&this.hot.unlisten()}),this.eventManager.addEventListener(r,"contextmenu",i=>{n.isInProgress()&&An(i)&&(n.finish(),Oe(this,qe,!1))}),this.eventManager.addEventListener(r,"touchend",()=>{n.isInProgress()&&n.finish(),Oe(this,qe,!1)}),this.eventManager.addEventListener(r,"mousedown",i=>{const s=i.target,a=i.x||i.clientX,c=i.y||i.clientY;let u=i.target;if(re(this,qe)||!e||!this.hot.view)return;const{holder:f}=this.hot.view._wt.wtTable;if(u===f){const w=Re(t);if(t.elementFromPoint(a+w,c)!==f||t.elementFromPoint(a,c+w)!==f)return}else for(;u!==r;){if(u===null){if(i.isTargetWebComponent)break;return}if(u===e)return;u=u.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(s):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}),this.eventManager.addEventListener(re(this,_e),"selectstart",i=>{this.settings.fragmentSelection||Ss(i.target)||i.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,n))}translateFromRenderableToVisualIndex(e,t){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return n===null&&(n=e),r===null&&(r=t),[n,r]}countRenderableIndexes(e,t){const n=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(n-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,n,r){if(isNaN(e)||e<0)return 0;const i=n.getNearestNotHiddenIndex(e,t),s=n.getRenderableFromVisualIndex(i);if(!Number.isInteger(s))return 0;let a=0;return t<0?a=s+1:t>0&&(a=r-s),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let n=0;for(let r=e;r<=t;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(n+=1);return n}countRenderableRowsInRange(e,t){let n=0;for(let r=e;r<=t;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(n+=1);return n}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:re(this,_e),isDataViewInstance:()=>Ao(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(i,s)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(i,s)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,rowHeaders:()=>{const i=[];return this.hot.hasRowHeaders()&&i.push((s,a)=>{const c=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s;this.appendRowHeader(c,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",i),Oe(this,So,i.length),this.hot.getSettings().ariaTags&&Dn(this,Vn,Ii).call(this)===this.hot.countCols()&&Dn(this,ir,jh).call(this,re(this,So)),i},columnHeaders:()=>{const i=[];return this.hot.hasColHeaders()&&i.push((s,a)=>{const c=s>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(s):s;this.appendColHeader(c,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",i),Oe(this,mn,i.length),i},columnWidth:i=>{const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(i);return this.hot.getColWidth(s===null?i:s)},rowHeight:i=>{const s=this.hot.rowIndexMapper.getVisualFromRenderableIndex(i);return this.hot.getRowHeight(s===null?i:s)},cellRenderer:(i,s,a)=>{const[c,u]=this.translateFromRenderableToVisualIndex(i,s),f=this.hot.runHooks("modifyGetCellCoords",c,u);let g=c,w=u;Array.isArray(f)&&([g,w]=f);const m=this.hot.getCellMeta(g,w),v=this.hot.colToProp(w);let y=this.hot.getDataAtRowProp(g,v);this.hot.hasHook("beforeValueRender")&&(y=this.hot.runHooks("beforeValueRender",y,m)),this.hot.runHooks("beforeRenderer",a,c,u,v,y,m),this.hot.getCellRenderer(m)(this.hot,a,c,u,v,y,m),this.hot.runHooks("afterRenderer",a,c,u,v,y,m)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Kn(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(i,s,a,c)=>{const u=this.translateFromRenderableToVisualCoords(s),f={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=c,Oe(this,qe,!0),this.hot.runHooks("beforeOnCellMouseDown",i,u,a,f),!Tt(i)&&(sr(i,{coords:u,selection:this.hot.selection,controller:f,cellCoordsFactory:(g,w)=>this.hot._createCellCoords(g,w)}),this.hot.runHooks("afterOnCellMouseDown",i,u,a),this.activeWt=this._wt)},onCellContextMenu:(i,s,a,c)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=c,Oe(this,qe,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",i,u,a),!Tt(i)&&(this.hot.runHooks("afterOnCellContextMenu",i,u,a),this.activeWt=this._wt)},onCellMouseOut:(i,s,a,c)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=c,this.hot.runHooks("beforeOnCellMouseOut",i,u,a),!Tt(i)&&(this.hot.runHooks("afterOnCellMouseOut",i,u,a),this.activeWt=this._wt)},onCellMouseOver:(i,s,a,c)=>{const u=this.translateFromRenderableToVisualCoords(s),f={row:!1,column:!1,cell:!1};this.activeWt=c,this.hot.runHooks("beforeOnCellMouseOver",i,u,a,f),!Tt(i)&&(re(this,qe)&&sr(i,{coords:u,selection:this.hot.selection,controller:f,cellCoordsFactory:(g,w)=>this.hot._createCellCoords(g,w)}),this.hot.runHooks("afterOnCellMouseOver",i,u,a),this.activeWt=this._wt)},onCellMouseUp:(i,s,a,c)=>{const u=this.translateFromRenderableToVisualCoords(s);this.activeWt=c,this.hot.runHooks("beforeOnCellMouseUp",i,u,a),!(Tt(i)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",i,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:i=>{i.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",i)},onCellCornerDblClick:i=>{i.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",i)},beforeDraw:(i,s)=>this.beforeRender(i,s),onDraw:i=>this.afterRender(i),onBeforeViewportScrollVertically:i=>{const s=this.hot.rowIndexMapper,a=i<0;let c=i;return!a&&(c=s.getVisualFromRenderableIndex(i),c===null)?i:(c=this.hot.runHooks("beforeViewportScrollVertically",c),this.hot.runHooks("beforeViewportScroll"),a?c:s.getRenderableFromVisualIndex(c))},onBeforeViewportScrollHorizontally:i=>{const s=this.hot.columnIndexMapper,a=i<0;let c=i;return!a&&(c=s.getVisualFromRenderableIndex(i),c===null)?i:(c=this.hot.runHooks("beforeViewportScrollHorizontally",c),this.hot.runHooks("beforeViewportScroll"),a?c:s.getRenderableFromVisualIndex(c))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(i,s,a)=>{const c=this.hot.rowIndexMapper,u=i<0;let f=i;u||(f=c.getVisualFromRenderableIndex(i));const g=this.hot.runHooks("beforeHighlightingRowHeader",f,s,a);return u?g:c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(g,1))},onBeforeHighlightingColumnHeader:(i,s,a)=>{const c=this.hot.columnIndexMapper,u=i<0;let f=i;u||(f=c.getVisualFromRenderableIndex(i));const g=this.hot.runHooks("beforeHighlightingColumnHeader",f,s,a);return u?g:c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(g,1))},onAfterDrawSelection:(i,s,a)=>{let c;const[u,f]=this.translateFromRenderableToVisualIndex(i,s),g=this.hot.selection.getSelectedRange();if(g.size()>0){const m=g.peekByIndex(a??0);c=[m.from.row,m.from.col,m.to.row,m.to.col]}return this.hot.runHooks("afterDrawSelection",u,f,c,a)},onBeforeDrawBorders:(i,s)=>{const[a,c,u,f]=i,g=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(f)];return this.hot.runHooks("beforeDrawBorders",g,s)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(i,s)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.runHooks("beforeStretchingColumnWidth",i,a)},onModifyRowHeaderWidth:i=>this.hot.runHooks("modifyRowHeaderWidth",i),onModifyGetCellCoords:(i,s,a)=>{const c=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,f=s>=0?u.getVisualFromRenderableIndex(s):s,g=i>=0?c.getVisualFromRenderableIndex(i):i,w=this.hot.runHooks("modifyGetCellCoords",g,f,a);if(Array.isArray(w)){const[m,v,y,M]=w;return[m>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(m,1)):m,v>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(v,1)):v,y>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(y,-1)):y,M>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(M,-1)):M]}},viewportRowCalculatorOverride:i=>{let s=this.settings.viewportRowRenderingOffset;if(s==="auto"&&this.settings.fixedRowsTop&&(s=10),s>0||s==="auto"){const a=this.countRenderableRows(),c=i.startRow,u=i.endRow;if(typeof s=="number")i.startRow=Math.max(c-s,0),i.endRow=Math.min(u+s,a-1);else if(s==="auto"){const f=Math.ceil(u/a*12);i.startRow=Math.max(c-f,0),i.endRow=Math.min(u+f,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",i)},viewportColumnCalculatorOverride:i=>{let s=this.settings.viewportColumnRenderingOffset;if(s==="auto"&&this.settings.fixedColumnsStart&&(s=10),s>0||s==="auto"){const a=this.countRenderableColumns(),c=i.startColumn,u=i.endColumn;if(typeof s=="number"&&(i.startColumn=Math.max(c-s,0),i.endColumn=Math.min(u+s,a-1)),s==="auto"){const f=Math.ceil(u/a*6);i.startColumn=Math.max(c-f,0),i.endColumn=Math.min(u+f,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",i)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const i=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||i}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new ds(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:n,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,r),this.eventManager.addEventListener(t,"mousedown",i=>{i.target===t&&i.which===3&&i.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",i=>{i.target===t&&i.which===3&&i.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(Ss(e))return!0;const t=In(e,this.hot.view._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&t||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return re(this,qe)}isSelectedOnlyCell(){var e,t;return(e=(t=this.hot.getSelectedRangeLast())===null||t===void 0?void 0:t.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const n=t.firstChild;if(!ie(n,"relative")){Lo(t),this.appendRowHeader(e,t);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:r}=this.hot,i=n.createElement("div"),s=n.createElement("span");i.className="relative",s.className="rowHeader",this.updateCellHeader(s,e,r),i.appendChild(s),t.appendChild(i)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(t.firstChild){const i=t.firstChild;ie(i,"relative")?this.updateCellHeader(i.querySelector(".colHeader"),e,n,r):(Lo(t),this.appendColHeader(e,t,n,r))}else{const{rootDocument:i}=this.hot,s=i.createElement("div"),a=i.createElement("span");s.className="relative",a.className="colHeader",this.settings.ariaTags&&(Z(s,...Ze()),Z(a,...Ze())),this.updateCellHeader(a,e,n,r),s.appendChild(a),t.appendChild(s)}this.hot.runHooks("afterGetColHeader",e,t,r)}updateCellHeader(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,i=t;const s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(ie(e,"colHeader")?i=s.wtTable.columnFilter.sourceToRendered(t):ie(e,"rowHeader")&&(i=s.wtTable.rowFilter.sourceToRendered(t))),i>-1?Pl(e,n(t,r)):(Yn(e,String.fromCharCode(160)),Y(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,t){Oe(this,wn,e),Oe(this,pn,t)}getLastSize(){return{width:re(this,wn),height:re(this,pn)}}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this.hot.view._wt.wtScroll.getLastVisibleColumn())}getColumnHeadersCount(){return re(this,mn)}getRowHeadersCount(){return re(this,So)}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function Ii(){return parseInt(this.hot.rootElement.getAttribute(Go()[0]),10)}function jh(o){const e=Dn(this,Vn,Ii).call(this)+o;Z(this.hot.rootElement,...Go(e))}const Uh=zh;function jt(o,e,t){return e=Kh(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Kh(o){var e=Gh(o,"string");return typeof e=="symbol"?e:String(e)}function Gh(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Yh{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];jt(this,"hot",void 0),jt(this,"data",void 0),jt(this,"dataType","array"),jt(this,"colToProp",()=>{}),jt(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),t!==void 0&&!Number.isInteger(t)?t:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const t=[];return $(this.data,(n,r)=>{const i=this.getAtCell(r,e);t.push(i)}),t}getAtRow(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=t===void 0&&n===void 0;let s=null,a=null;if(s=this.modifyRowData(e),Array.isArray(s))a=[],i?s.forEach((c,u)=>{a[u]=this.getAtPhysicalCell(e,u,s)}):Qe(t,n,c=>{a[c-t]=this.getAtPhysicalCell(e,c,s)});else if(Pt(s)||ae(s))if(r?a=[]:a={},!i||r){const u=this.countFirstRowKeys()-1;Qe(0,u,f=>{const g=this.colToProp(f);if(f>=(t||0)&&f<=(n||u)&&!Number.isInteger(g)){const w=this.getAtPhysicalCell(e,g,s);r?a.push(w):qo(a,g,w)}})}else pe(s,(c,u)=>{qo(a,u,this.getAtPhysicalCell(e,u,s))});return a}setAtCell(e,t,n){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=ze(n);this.hot.runHooks("modifySourceData",e,t,r,"set"),r.isTouched()&&(n=r.value)}Number.isInteger(t)?this.data[e][t]=n:qo(this.data[e],t,n)}}getAtPhysicalCell(e,t,n){let r=null;if(n&&(typeof t=="string"?r=Al(n,t):typeof t=="function"?r=t(n):r=n[t]),this.hot.hasHook("modifySourceData")){const i=ze(r);this.hot.runHooks("modifySourceData",e,t,i,"get"),i.isTouched()&&(r=i.value)}return r}getAtCell(e,t){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,i=null,s=null,a=null,c=null;e===null||t===null?(r=!0,i=0,a=this.countRows()-1):(i=Math.min(e.row,t.row),s=Math.min(e.col,t.col),a=Math.max(e.row,t.row),c=Math.max(e.col,t.col));const u=[];return Qe(i,a,f=>{u.push(r?this.getAtRow(f,void 0,void 0,n):this.getAtRow(f,s,c,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Kr(this.data)}destroy(){this.data=null,this.hot=null}}const Xh=Yh,lr=new Map([["hiding",Gr],["index",Nl],["linkedPhysicalIndexToValue",_l],["physicalIndexToValue",Ll],["trimming",Yr]]);function qh(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!lr.has(o))throw new Error(`The provided map type ("${o}") does not exist.`);return new(lr.get(o))(e)}function Qh(o,e,t){return e=Zh(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Zh(o){var e=Jh(o,"string");return typeof e=="symbol"?e:String(e)}function Jh(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}let Fn=0;class hs{constructor(){Qh(this,"collection",new Map)}register(e,t){this.collection.has(e)===!1&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),Fn+=1)}unregister(e){const t=this.collection.get(e);W(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),Fn-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return Le(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(n=>{n.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}le(hs,At);function Mm(){return Fn}function Cn(o,e,t){return e=ef(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function ef(o){var e=tf(o,"string");return typeof e=="symbol"?e:String(e)}function tf(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class ar extends hs{constructor(e,t){super(),Cn(this,"mergedValuesCache",[]),Cn(this,"aggregationFunction",void 0),Cn(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const t=Zt(this.get(),i=>i.getValues()),n=[],r=W(t[0])&&t[0].length||0;for(let i=0;i<r;i+=1){const s=[];for(let a=0;a<this.getLength();a+=1)s.push(t[a][i]);n.push(s)}return Zt(n,this.aggregationFunction)}getMergedValueAtIndex(e,t){const n=this.getMergedValues(t)[e];return W(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function of(o,e,t){nf(o,e),e.set(o,t)}function nf(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sf(o,e,t){var n=Mi(o,e,"set");return rf(o,n,t),t}function rf(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function lf(o,e){var t=Mi(o,e,"get");return af(o,t)}function Mi(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function af(o,e){return e.get?e.get.call(o):e.value}var Sn=new WeakMap;class xi{constructor(){of(this,Sn,{writable:!0,value:[]})}subscribe(e){return this.addLocalHook("change",e),this._write(lf(this,Sn)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){sf(this,Sn,e)}}le(xi,At);function cr(o,e){const t=[];let n=0,r=0;for(;n<o.length&&r<e.length;n++,r++)o[n]!==e[r]&&t.push({op:"replace",index:r,oldValue:o[n],newValue:e[r]});for(;n<e.length;n++)t.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;r<o.length;r++)t.push({op:"remove",index:r,oldValue:o[r],newValue:void 0});return t}function Ut(o,e,t){cf(o,e),e.set(o,t)}function cf(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(o,e){var t=Pi(o,e,"get");return df(o,t)}function df(o,e){return e.get?e.get.call(o):e.value}function vo(o,e,t){var n=Pi(o,e,"set");return uf(o,n,t),t}function Pi(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function uf(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var yo=new WeakMap,Kt=new WeakMap,Ro=new WeakMap,To=new WeakMap,Ho=new WeakMap;class hf{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ut(this,yo,{writable:!0,value:new Set}),Ut(this,Kt,{writable:!0,value:[]}),Ut(this,Ro,{writable:!0,value:[]}),Ut(this,To,{writable:!0,value:!1}),Ut(this,Ho,{writable:!0,value:!1}),vo(this,Ho,e??!1)}createObserver(){const e=new xi;return Ie(this,yo).add(e),e.addLocalHook("unsubscribe",()=>{Ie(this,yo).delete(e)}),e._writeInitialChanges(cr(Ie(this,Kt),Ie(this,Ro))),e}emit(e){let t=Ie(this,Ro);(!Ie(this,To)||Ie(this,Kt).length!==e.length)&&(e.length===0?e=new Array(t.length).fill(Ie(this,Ho)):vo(this,Kt,new Array(e.length).fill(Ie(this,Ho))),Ie(this,To)||(vo(this,To,!0),t=Ie(this,Kt)));const n=cr(t,e);Ie(this,yo).forEach(r=>r._write(n)),vo(this,Ro,e)}}function ge(o,e,t){return e=ff(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function ff(o){var e=gf(o,"string");return typeof e=="symbol"?e:String(e)}function gf(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Bn{constructor(){ge(this,"indexesSequence",new Dl),ge(this,"trimmingMapsCollection",new ar(e=>e.some(t=>t===!0),!1)),ge(this,"hidingMapsCollection",new ar(e=>e.some(t=>t===!0),!1)),ge(this,"variousMapsCollection",new hs),ge(this,"hidingChangesObservable",new hf({initialIndexValue:!1})),ge(this,"notTrimmedIndexesCache",[]),ge(this,"notHiddenIndexesCache",[]),ge(this,"isBatched",!1),ge(this,"indexesSequenceChanged",!1),ge(this,"indexesChangeSource",void 0),ge(this,"trimmedIndexesChanged",!1),ge(this,"hiddenIndexesChanged",!1),ge(this,"renderablePhysicalIndexesCache",[]),ge(this,"fromPhysicalToVisualIndexesCache",new Map),ge(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,n){return this.registerMap(e,qh(t,n))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Yr?this.trimmingMapsCollection.register(e,t):t instanceof Gr?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const n=this.getNumberOfIndexes();return n>0&&t.init(n),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return W(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return W(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return W(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return W(t)?t:null}getNearestNotHiddenIndex(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const i=Array.from(this.fromVisualToRenderableIndexesCache.keys());let s=-1;return t>0?s=i.findIndex(a=>a>e):s=i.reverse().findIndex(a=>a<e),s===-1?n?this.getNearestNotHiddenIndex(e,-t,!1):null:i[s]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(n)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){typeof e=="number"&&(e=[e]);const n=Zt(e,u=>this.getPhysicalFromVisualIndex(u)),r=this.getNotTrimmedIndexesLength(),i=e.length,s=Vl(this.getIndexesSequence(),n),a=s.filter(u=>this.isTrimmed(u)===!1);let c=s.indexOf(a[a.length-1])+1;if(t+i<r){const u=a[t];c=s.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(Fl(s,c,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const n=this.getNotTrimmedIndexes()[e],r=W(n)?n:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),s=Zt(new Array(t).fill(r),(a,c)=>a+c);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,s),this.hidingMapsCollection.insertToEvery(i,s),this.variousMapsCollection.insertToEvery(i,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&t===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const n=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(n,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const n=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(r,t)}}}le(Bn,At);function mf(o,e){return pe(e,(t,n)=>{Le(o[n])&&(o[n]=t)}),o}function Ai(o){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(o);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:o}function Ni(o){W(o)&&Bl(oo`Language with code "${o}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function wf(o,e){return Array.isArray(o)&&Number.isInteger(e)?o[e]:o}const{register:pf,getValues:Cf}=Xr("phraseFormatters");function Sf(o,e){pf(o,e)}function bf(){return Cf()}Sf("pluralize",wf);/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const vf={languageCode:"en-US",[Wl]:"No available options",[kl]:"Insert row above",[$l]:"Insert row below",[zl]:"Insert column left",[jl]:"Insert column right",[Ul]:["Remove row","Remove rows"],[Kl]:["Remove column","Remove columns"],[Gl]:"Undo",[Yl]:"Redo",[Xl]:"Read only",[ql]:"Clear column",[Ql]:"Alignment",[Zl]:"Left",[Jl]:"Center",[ea]:"Right",[ta]:"Justify",[oa]:"Top",[na]:"Middle",[sa]:"Bottom",[ra]:"Freeze column",[ia]:"Unfreeze column",[la]:"Borders",[aa]:"Top",[ca]:"Right",[da]:"Bottom",[ua]:"Left",[ha]:"Remove border(s)",[fa]:"Add comment",[ga]:"Edit comment",[ma]:"Delete comment",[wa]:"Read-only comment",[pa]:"Merge cells",[Ca]:"Unmerge cells",[Sa]:"Copy",[ba]:["Copy with header","Copy with headers"],[va]:["Copy with group header","Copy with group headers"],[ya]:["Copy header only","Copy headers only"],[Ra]:"Cut",[Ta]:"Insert child row",[Ha]:"Detach from parent",[Ea]:["Hide column","Hide columns"],[Oa]:["Show column","Show columns"],[Ia]:["Hide row","Hide rows"],[Ma]:["Show row","Show rows"],[xa]:"None",[Pa]:"Is empty",[Aa]:"Is not empty",[Na]:"Is equal to",[_a]:"Is not equal to",[La]:"Begins with",[Da]:"Ends with",[Va]:"Contains",[Fa]:"Does not contain",[Ba]:"Greater than",[Wa]:"Greater than or equal to",[ka]:"Less than",[$a]:"Less than or equal to",[za]:"Is between",[ja]:"Is not between",[Ua]:"After",[Ka]:"Before",[Ga]:"Today",[Ya]:"Tomorrow",[Xa]:"Yesterday",[qa]:"Blank cells",[Qa]:"Filter by condition",[Za]:"Filter by value",[Ja]:"And",[ec]:"Or",[tc]:"Select all",[oc]:"Clear",[nc]:"OK",[sc]:"Cancel",[rc]:"Search",[ic]:"Value",[lc]:"Second value",[ac]:"Checked",[cc]:"Unchecked"},_i=vf,yf=dc,Wn=_i.languageCode,{register:Rf,getItem:Li,hasItem:Tf,getValues:Hf}=Xr("languagesDictionaries");Di(_i);function Di(o,e){let t=o,n=e;return Pt(o)&&(n=o,t=n.languageCode),Ef(t,n),Rf(t,ft(n)),ft(n)}function Ef(o,e){o!==Wn&&mf(e,Li(Wn))}function Vi(o){return fs(o)?ft(Li(o)):null}function fs(o){return Tf(o)}function Of(){return Hf()}function Fi(o,e,t){const n=Vi(o);if(n===null)return null;const r=n[e];if(Le(r))return null;const i=If(r,t);return Array.isArray(i)?i[0]:i}function If(o,e){let t=o;return $(bf(),n=>{t=n(o,e)}),t}function Mf(o){let e=Ai(o);return fs(e)||(e=Wn,Ni(o)),e}let Bi;function dr(o,e,t){return e=xf(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function xf(o){var e=Pf(o,"string");return typeof e=="symbol"?e:String(e)}function Pf(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}Bi=Symbol.iterator;class Af{constructor(e){dr(this,"ranges",[]),dr(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Bi](){return this.ranges[Symbol.iterator]()}}const Nf=Af;function Gt(o,e){Wi(o,e),e.add(o)}function bn(o,e,t){Wi(o,e),e.set(o,t)}function Wi(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _(o,e){var t=ki(o,e,"get");return _f(o,t)}function _f(o,e){return e.get?e.get.call(o):e.value}function ve(o,e,t){if(!e.has(o))throw new TypeError("attempted to get private field on non-instance");return t}function kn(o,e,t){var n=ki(o,e,"set");return Lf(o,n,t),t}function ki(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function Lf(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}var Eo=new WeakMap,F=new WeakMap,rt=new WeakMap,vn=new WeakSet,yn=new WeakSet,$n=new WeakSet,Rn=new WeakSet,ut=new WeakSet;class $i{constructor(e,t){Gt(this,ut),Gt(this,Rn),Gt(this,$n),Gt(this,yn),Gt(this,vn),bn(this,Eo,{writable:!0,value:void 0}),bn(this,F,{writable:!0,value:void 0}),bn(this,rt,{writable:!0,value:{x:0,y:0}}),kn(this,Eo,e),kn(this,F,t)}transformStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;ve(this,vn,ur).call(this,{x:_(this,F).navigableHeaders()?_(this,F).countRowHeaders():0,y:_(this,F).navigableHeaders()?_(this,F).countColHeaders():0});const r=_(this,F).createCellCoords(e,t);let i=_(this,Eo).current().highlight;const s=_(this,F).visualToRenderableCoords(i);let a=0,c=0;if(this.runLocalHooks("beforeTransformStart",r),s.row!==null&&s.col!==null){const{width:u,height:f}=ve(this,$n,zi).call(this),{row:g,col:w}=ve(this,Rn,fr).call(this,i),m=_(this,F).fixedRowsBottom(),v=_(this,F).minSpareRows(),y=_(this,F).minSpareCols(),M=_(this,F).autoWrapRow(),b=_(this,F).autoWrapCol(),E=_(this,F).createCellCoords(g+r.row,w+r.col);if(E.row>=f){const z=ze(n&&v>0&&m===0),O=E.col+1,L=_(this,F).createCellCoords(E.row-f,O>=u?O-u:O);this.runLocalHooks("beforeColumnWrap",z,ve(this,ut,Rt).call(this,L),O>=u),z.value?this.runLocalHooks("insertRowRequire",_(this,F).countRenderableRows()):b&&E.assign(L)}else if(E.row<0){const z=ze(b),O=E.col-1,L=_(this,F).createCellCoords(f+E.row,O<0?u+O:O);this.runLocalHooks("beforeColumnWrap",z,ve(this,ut,Rt).call(this,L),O<0),b&&E.assign(L)}if(E.col>=u){const z=ze(n&&y>0),O=E.row+1,L=_(this,F).createCellCoords(O>=f?O-f:O,E.col-u);this.runLocalHooks("beforeRowWrap",z,ve(this,ut,Rt).call(this,L),O>=f),z.value?this.runLocalHooks("insertColRequire",_(this,F).countRenderableColumns()):M&&E.assign(L)}else if(E.col<0){const z=ze(M),O=E.row-1,L=_(this,F).createCellCoords(O<0?f+O:O,u+E.col);this.runLocalHooks("beforeRowWrap",z,ve(this,ut,Rt).call(this,L),O<0),M&&E.assign(L)}const{rowDir:j,colDir:X}=ve(this,yn,hr).call(this,E);a=j,c=X,i=ve(this,ut,Rt).call(this,E)}return this.runLocalHooks("afterTransformStart",i,a,c),i}transformEnd(e,t){ve(this,vn,ur).call(this,{x:_(this,F).navigableHeaders()?_(this,F).countRowHeaders():0,y:_(this,F).navigableHeaders()?_(this,F).countColHeaders():0});const n=_(this,F).createCellCoords(e,t),r=_(this,Eo).current(),i=_(this,F).visualToRenderableCoords(r.highlight),s=r.to.clone();let a=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),i.row!==null&&i.col!==null){const{row:u,col:f}=ve(this,Rn,fr).call(this,r.to),g=_(this,F).createCellCoords(u+n.row,f+n.col),{rowDir:w,colDir:m}=ve(this,yn,hr).call(this,g);a=w,c=m;const v=ve(this,ut,Rt).call(this,g);n.row===0&&n.col!==0?s.col=v.col:n.row!==0&&n.col===0?s.row=v.row:(s.row=v.row,s.col=v.col)}return this.runLocalHooks("afterTransformEnd",s,a,c),s}}function ur(o){let{x:e,y:t}=o;kn(this,rt,{x:e,y:t})}function hr(o){const{width:e,height:t}=ve(this,$n,zi).call(this);let n=0,r=0;return o.row<0?(n=-1,o.row=0):o.row>0&&o.row>=t&&(n=1,o.row=t-1),o.col<0?(r=-1,o.col=0):o.col>0&&o.col>=e&&(r=1,o.col=e-1),{rowDir:n,colDir:r}}function zi(){return{width:_(this,rt).x+_(this,F).countRenderableColumns(),height:_(this,rt).y+_(this,F).countRenderableRows()}}function fr(o){const{row:e,col:t}=_(this,F).visualToRenderableCoords(o);return _(this,F).createCellCoords(_(this,rt).y+e,_(this,rt).x+t)}function Rt(o){const e=o.clone();return e.col=o.col-_(this,rt).x,e.row=o.row-_(this,rt).y,_(this,F).renderableToVisualCoords(e)}le($i,At);const Df=$i;function Vf(o,e,t){Ff(o,e),e.set(o,t)}function Ff(o,e){if(e.has(o))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tt(o,e,t){return e=Bf(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Bf(o){var e=Wf(o,"string");return typeof e=="symbol"?e:String(e)}function Wf(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function gr(o,e,t){var n=ji(o,e,"set");return kf(o,n,t),t}function kf(o,e,t){if(e.set)e.set.call(o,t);else{if(!e.writable)throw new TypeError("attempted to set read only private field");e.value=t}}function mr(o,e){var t=ji(o,e,"get");return $f(o,t)}function ji(o,e,t){if(!e.has(o))throw new TypeError("attempted to "+t+" private field on non-instance");return e.get(o)}function $f(o,e){return e.get?e.get.call(o):e.value}var Yt=new WeakMap;class Ui{constructor(e,t){var n=this;tt(this,"settings",void 0),tt(this,"tableProps",void 0),tt(this,"inProgress",!1),tt(this,"selectedRange",new Nf((r,i,s)=>this.tableProps.createCellRange(r,i,s))),tt(this,"highlight",void 0),tt(this,"transformation",void 0),tt(this,"selectedByRowHeader",new Set),tt(this,"selectedByColumnHeader",new Set),Vf(this,Yt,{writable:!0,value:!1}),this.settings=e,this.tableProps=t,this.highlight=new uc({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[hc()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,i)=>this.tableProps.isDisabledCellSelection(r,i),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,i)=>this.tableProps.createCellCoords(r,i),createCellRange:(r,i,s)=>this.tableProps.createCellRange(r,i,s)}),this.transformation=new Df(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),countRowHeaders:()=>this.tableProps.countRowHeaders(),countColHeaders:()=>this.tableProps.countColHeaders(),visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,i)=>this.tableProps.createCellCoords(r,i),navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol}),this.transformation.addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformStart",...i)}),this.transformation.addLocalHook("afterTransformStart",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n.runLocalHooks("afterModifyTransformStart",...i)}),this.transformation.addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n.runLocalHooks("beforeModifyTransformEnd",...i)}),this.transformation.addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n.runLocalHooks("afterModifyTransformEnd",...i)}),this.transformation.addLocalHook("insertRowRequire",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n.runLocalHooks("insertRowRequire",...i)}),this.transformation.addLocalHook("insertColRequire",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n.runLocalHooks("insertColRequire",...i)}),this.transformation.addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n.runLocalHooks("beforeRowWrap",...i)}),this.transformation.addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n.runLocalHooks("beforeColumnWrap",...i)})}getSelectedRange(){return this.selectedRange}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1}isInProgress(){return this.inProgress}setRangeStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const i=this.settings.selectionMode==="multiple",s=Le(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!i||i&&!s&&Le(t))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,t,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),n=this.tableProps.countRows(),r=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||r>0)&&(n===0&&t.col<0&&!i||r===0&&t.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const s=this.selectedRange.current();this.settings.navigableHeaders||s.highlight.normalize(),this.settings.selectionMode==="single"?(s.setFrom(s.highlight),s.setTo(s.highlight)):s.setTo(t),n>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!s.isSingleHeader())&&s.to.normalize(),this.runLocalHooks("beforeHighlightSet");const a=this.highlight.getFocus();a.clear(),this.highlight.isEnabledFor(fc,s.highlight)&&a.add(this.selectedRange.current().highlight).commit().syncWith(s);const c=this.getLayerLevel();c<this.highlight.layerLevel&&($(this.highlight.getAreas(),E=>void E.clear()),$(this.highlight.getLayeredAreas(),E=>void E.clear()),$(this.highlight.getRowHeaders(),E=>void E.clear()),$(this.highlight.getColumnHeaders(),E=>void E.clear()),$(this.highlight.getActiveRowHeaders(),E=>void E.clear()),$(this.highlight.getActiveColumnHeaders(),E=>void E.clear()),$(this.highlight.getActiveCornerHeaders(),E=>void E.clear()),$(this.highlight.getRowHighlights(),E=>void E.clear()),$(this.highlight.getColumnHighlights(),E=>void E.clear())),this.highlight.useLayerLevel(c);const u=this.highlight.createArea(),f=this.highlight.createLayeredArea(),g=this.highlight.createRowHeader(),w=this.highlight.createColumnHeader(),m=this.highlight.createActiveRowHeader(),v=this.highlight.createActiveColumnHeader(),y=this.highlight.createActiveCornerHeader(),M=this.highlight.createRowHighlight(),b=this.highlight.createColumnHighlight();if(u.clear(),f.clear(),g.clear(),w.clear(),m.clear(),v.clear(),y.clear(),M.clear(),b.clear(),this.highlight.isEnabledFor(gc,s.highlight)&&(this.isMultiple()||c>=1)&&(u.add(s.from).add(s.to).commit(),f.add(s.from).add(s.to).commit(),c===1)){const E=this.selectedRange.previous();this.highlight.useLayerLevel(c-1),this.highlight.createArea().add(E.from).commit().syncWith(E),this.highlight.createLayeredArea().add(E.from).commit().syncWith(E),this.highlight.useLayerLevel(c)}if(this.highlight.isEnabledFor(mc,s.highlight)){if(!s.isSingleHeader()){const X=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),z=this.tableProps.createCellCoords(s.to.row,-1),O=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),L=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(g.add(X).commit(),w.add(O).commit(),M.add(X).commit(),b.add(O).commit()):(g.add(X).add(z).commit(),w.add(O).add(L).commit(),M.add(X).add(z).commit(),b.add(O).add(L).commit())}const E=!mr(this,Yt)&&this.isEntireRowSelected()&&(r>0&&r===s.getWidth()||r===0&&this.isSelectedByRowHeader()),j=!mr(this,Yt)&&this.isEntireColumnSelected()&&(n>0&&n===s.getHeight()||n===0&&this.isSelectedByColumnHeader());E&&m.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),j&&v.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),E&&j&&y.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}this.runLocalHooks("afterSetRangeEnd",e)}isMultiple(){const e=ze(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}transformStart(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.setRangeStart(this.transformation.transformStart(e,t,n))}transformEnd(e,t){this.setRangeEnd(this.transformation.transformEnd(e,t))}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=r=>{const{col:i}=r.getOuterTopStartCorner(),s=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(s>0&&i<0||s===0)&&r.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>t(r));const n=this.selectedRange.peekByIndex(e);return n?t(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const t=r=>{const{row:i}=r.getOuterTopStartCorner(),s=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(s>0&&i<0||s===0)&&r.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>t(r));const n=this.selectedRange.peekByIndex(e);return n?t(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return t.row!==null&&t.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),s=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),c=this.tableProps.countColHeaders(),u=n?-c:0,f=t?-a:0;if(u===0&&f===0&&(i===0||s===0))return;let g=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:w,disableHeadersHighlight:m}=r;gr(this,Yt,m),w&&Number.isInteger(w==null?void 0:w.row)&&Number.isInteger(w==null?void 0:w.col)&&(g=this.tableProps.createCellCoords(St(w.row,u,i-1),St(w.col,f,s-1)));const v=this.tableProps.createCellCoords(u,f),y=this.tableProps.createCellCoords(i-1,s-1);this.clear(),this.setRangeStartOnly(v,void 0,g),f<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.finish(),gr(this,Yt,!1)}selectCells(e){var t=this;const n=wc(e);if(n===pc)return!1;if(n===Cc)throw new Error(oo`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=Sc(n,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:c=>this.tableProps.propToCol(c),keepDirection:!0}),i=this.settings.navigableHeaders,s={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},a=!e.some(c=>{const u=r(c),f=u.isValid(s);return!(f&&!u.containsHeaders()||f&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),$(e,c=>{const{from:u,to:f}=r(c);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(f.clone()),this.finish()})),a}selectColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,i=typeof t=="string"?this.tableProps.propToCol(t):t,s=this.tableProps.countRows(),a=this.tableProps.countCols(),c=this.tableProps.countColHeaders(),u=c===0?0:-c,f=this.tableProps.createCellCoords(u,r),g=this.tableProps.createCellCoords(s-1,i),w=this.tableProps.createCellRange(f,f,g).isValid({countRows:s,countCols:a,countRowHeaders:0,countColHeaders:c});if(w){const m=c===0?0:St(n,u,-1),v=s-1,y=this.tableProps.createCellCoords(m,r),M=this.tableProps.createCellCoords(v,i),b=this.tableProps.createCellCoords(St(n,u,s-1),r);this.runLocalHooks("beforeSelectColumns",y,M,b),y.row=m,M.row=v,this.setRangeStartOnly(y,void 0,b),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",y,M,b),this.finish()}return w}selectRows(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),a=s===0?0:-s,c=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(t,i-1),f=this.tableProps.createCellRange(c,c,u).isValid({countRows:r,countCols:i,countRowHeaders:s,countColHeaders:0});if(f){const g=s===0?0:St(n,a,-1),w=i-1,m=this.tableProps.createCellCoords(e,g),v=this.tableProps.createCellCoords(t,w),y=this.tableProps.createCellCoords(e,St(n,a,i-1));this.runLocalHooks("beforeSelectRows",m,v,y),m.col=g,v.col=w,this.setRangeStartOnly(m,void 0,y),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectRows",m,v,y),this.finish()}return f}refresh(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const t=this.highlight.getFocus(),n=this.getLayerLevel();t.commit().syncWith(this.selectedRange.current());for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const i=this.highlight.createArea(),s=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),c=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),f=this.highlight.createActiveColumnHeader(),g=this.highlight.createActiveCornerHeader(),w=this.highlight.createRowHighlight(),m=this.highlight.createColumnHighlight();i.commit(),s.commit(),a.commit(),c.commit(),u.commit(),f.commit(),g.commit(),w.commit(),m.commit()}this.highlight.useLayerLevel(n)}}le(Ui,At);const zf=Ui;function ht(o,e,t){return e=jf(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function jf(o){var e=Uf(o,"string");return typeof e=="symbol"?e:String(e)}function Uf(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class Ot{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,n){ht(this,"hot",void 0),ht(this,"metaManager",void 0),ht(this,"tableMeta",void 0),ht(this,"dataSource",void 0),ht(this,"duckSchema",void 0),ht(this,"colToPropCache",void 0),ht(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,t){let r=0,i=0,s=!1;if(typeof t=="function"){const a=qr(e);r=a>0?a:this.countFirstRowKeys(),s=!0}else{const a=this.tableMeta.maxCols;r=Math.min(a,t.length)}for(n=0;n<r;n++){const a=s?t(n):t[n];if(Pt(a)){if(typeof a.data<"u"){const c=s?i:n;this.colToPropCache[c]=a.data,this.propToColCache.set(a.data,c)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Kr(this.dataSource)}recursiveDuckColumns(e,t,n){let r=t,i=n,s;return typeof r>"u"&&(r=0,i=""),typeof e=="object"&&!Array.isArray(e)&&pe(e,(a,c)=>{a===null?(s=i+c,this.colToPropCache.push(s),this.propToColCache.set(s,r),r+=1):r=this.recursiveDuckColumns(a,r,`${c}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const t=this.hot.toPhysicalColumn(e);return t===null?e:this.colToPropCache&&W(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(W(t))return this.hot.toVisualColumn(t);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Nn(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=this.hot.countSourceRows();let s=i,a=0,c=e;if((typeof c!="number"||c>=i)&&(c=i),c<this.hot.countRows()&&(s=this.hot.toPhysicalRow(c)),this.hot.runHooks("beforeCreateRow",c,t,n)===!1||s===null)return{delta:0};const f=this.tableMeta.maxRows,g=this.getSchema().length,w=[];for(;a<t&&i+a<f;){let v=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?v=ft(this.getSchema()):(v=[],Qe(g-1,()=>v.push(null))):this.hot.dataType==="function"?v=this.tableMeta.dataSchema(c+a):(v={},bc(v,this.getSchema())),w.push(v),a+=1}this.hot.rowIndexMapper.insertIndexes(c,a),r==="below"&&(s=Math.min(s+1,i)),this.spliceData(s,0,w);const m=this.hot.toVisualRow(s);return this.hot.countSourceRows()===w.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(s,t)),this.hot.runHooks("afterCreateRow",m,a,n),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:s}}createCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,s=this.tableMeta.maxCols,a=this.hot.countSourceCols();let c=e;if((typeof c!="number"||c>=a)&&(c=a),this.hot.runHooks("beforeCreateCol",c,t,n)===!1)return{delta:0};let f=a;c<this.hot.countCols()&&(f=this.hot.toPhysicalColumn(c));const g=this.hot.countSourceRows();let w=this.hot.countCols(),m=0,v=f;r==="end"&&(v=Math.min(v+1,a));const y=v;for(;m<t&&w<s;){if(typeof c!="number"||c>=w)if(g>0)for(let b=0;b<g;b+=1)typeof i[b]>"u"&&(i[b]=[]),i[b].push(null);else i.push([null]);else for(let b=0;b<g;b++)i[b].splice(v,0,null);m+=1,v+=1,w+=1}this.hot.columnIndexMapper.insertIndexes(c,m),m>0&&(e==null?this.metaManager.createColumn(null,m):n!=="auto"&&this.metaManager.createColumn(y,t));const M=this.hot.toVisualColumn(y);return this.hot.runHooks("afterCreateCol",M,m,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:m,startPhysicalIndex:y}}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-t;const i=this.visualRowsToPhysical(r,t),s=this.hot.countSourceRows();if(r=(s+r)%s,this.hot.runHooks("beforeRemoveRow",r,i.length,i,n)===!1)return!1;const c=i.length;if(this.filterData(r,c,i),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const f=W(this.tableMeta.columns)||W(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&f===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return i.slice(0).sort((f,g)=>g-f).forEach(f=>{this.metaManager.removeRow(f,1)}),this.hot.runHooks("afterRemoveRow",r,c,i,n),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-t:e;r=(this.hot.countCols()+r)%this.hot.countCols();const i=this.visualColumnsToPhysical(r,t),s=i.slice(0).sort((g,w)=>w-g);if(this.hot.runHooks("beforeRemoveCol",r,t,i,n)===!1)return!1;let c=!0;const u=s.length,f=this.dataSource;for(let g=0;g<u;g++)c&&i[0]!==i[g]-g&&(c=!1);if(c)for(let g=0,w=this.hot.countSourceRows();g<w;g++)f[g].splice(i[0],t),g===0&&this.metaManager.removeColumn(i[0],t);else for(let g=0,w=this.hot.countSourceRows();g<w;g++)for(let m=0;m<u;m++)f[g].splice(s[m],1),g===0&&this.metaManager.removeColumn(s[m],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,t,i,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,n){const r=this.hot.getDataAtCol(e),i=r.slice(t,t+n),s=r.slice(t+n);for(var a=arguments.length,c=new Array(a>3?a-3:0),u=3;u<a;u++)c[u-3]=arguments[u];bs(c,s);let f=0;for(;f<n;)c.push(null),f+=1;return vc(c),this.hot.populateFromArray(t,e,c,null,null,"spliceCol"),i}spliceRow(e,t,n){const r=this.hot.getSourceDataAtRow(e),i=r.slice(t,t+n),s=r.slice(t+n);for(var a=arguments.length,c=new Array(a>3?a-3:0),u=3;u<a;u++)c[u-3]=arguments[u];bs(c,s);let f=0;for(;f<n;)c.push(null),f+=1;return this.hot.populateFromArray(e,t,[c],null,null,"spliceRow"),i}spliceData(e,t,n){if(this.hot.runHooks("beforeDataSplice",e,t,n)!==!1){const i=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,i.forEach(s=>this.dataSource.push(s))}}filterData(e,t,n){let r=this.hot.runHooks("filterData",e,t,n);Array.isArray(r)===!1&&(r=this.dataSource.filter((i,s)=>n.indexOf(s)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,t){const n=this.hot.toPhysicalRow(e);let r=this.dataSource[n];const i=this.hot.runHooks("modifyRowData",n);r=isNaN(i)?i:r;let s=null;if(r&&r.hasOwnProperty&&Jt(r,t))s=r[t];else if(typeof t=="string"&&t.indexOf(".")>-1){const a=t.split(".");let c=r;if(!c)return null;for(let u=0,f=a.length;u<f;u++)if(c=c[a[u]],typeof c>"u")return null;s=c}else typeof t=="function"&&(s=t(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const a=ze(s);this.hot.runHooks("modifyData",n,this.propToCol(t),a,"get"),a.isTouched()&&(s=a.value)}return s}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,n){const r=this.hot.toPhysicalRow(e);let i=n,s=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);if(s=isNaN(a)?a:s,this.hot.hasHook("modifyData")){const c=ze(i);this.hot.runHooks("modifyData",r,this.propToCol(t),c,"set"),c.isTouched()&&(i=c.value)}if(s&&s.hasOwnProperty&&Jt(s,t))s[t]=i;else if(typeof t=="string"&&t.indexOf(".")>-1){const c=t.split(".");let u=s,f=0,g;for(f=0,g=c.length-1;f<g;f++)typeof u[c[f]]>"u"&&(u[c[f]]={}),u=u[c[f]];u[c[f]]=i}else typeof t=="function"?t(this.dataSource.slice(r,r+1)[0],i):s[t]=i}visualRowsToPhysical(e,t){const n=this.hot.countSourceRows(),r=[];let i=(n+e)%n,s=t,a;for(;i<n&&s;)a=this.hot.toPhysicalRow(i),r.push(a),s-=1,i+=1;return r}visualColumnsToPhysical(e,t){const n=this.hot.countCols(),r=[];let i=(n+e)%n,s=t;for(;i<n&&s;){const a=this.hot.toPhysicalColumn(i);r.push(a),s-=1,i+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;e<0||e===0?t=0:t=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,t,Ot.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,n){const r=[];let i,s,a;const c=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(c===0||u===0)return[];const f=n===Ot.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,g=Math.min(Math.max(c-1,0),Math.max(e.row,t.row)),w=Math.min(Math.max(u-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=g;i++){a=[];const m=i>=0?this.hot.toPhysicalRow(i):i;for(s=Math.min(e.col,t.col);s<=w&&m!==null;s++)a.push(f.call(this,i,this.colToProp(s)));m!==null&&r.push(a)}return r}getText(e,t){return vs(this.getRange(e,t,Ot.DESTINATION_RENDERER))}getCopyableText(e,t){return vs(this.getRange(e,t,Ot.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const Kf=Ot;function Gf(o,e){var t;return o==="CELL_TYPE"?!1:((t=e._automaticallyAssignedMetaProps)===null||t===void 0?void 0:t.has(o))||!Jt(e,o)}function Yo(o,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:o;const n=typeof e.type=="string"?yc(e.type):e.type;if(o._automaticallyAssignedMetaProps&&pe(e,(i,s)=>void o._automaticallyAssignedMetaProps.delete(s)),!Pt(n))return;t===o&&!o._automaticallyAssignedMetaProps&&(o._automaticallyAssignedMetaProps=new Set);const r={};pe(n,(i,s)=>{if(Gf(s,t)){var a;r[s]=i,(a=o._automaticallyAssignedMetaProps)===null||a===void 0||a.add(s)}}),Mt(o,r)}function Yf(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function t(){}Rc(t,o);for(let n=0;n<e.length;n++)t.prototype[e[n]]=void 0;return t}function No(o){return Number.isInteger(o)&&o>=0}function _o(o,e){if(!o())throw new Error(`Assertion failed: ${e}`)}function Oo(o){return o==null}const Ki=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(o){let e,t,n;for(e=0,t=this.countRows();e<t;e++)if(n=this.getDataAtCell(e,o),Bo(n)===!1)return!1;return!0},isEmptyRow(o){let e,t,n,r;for(e=0,t=this.countCols();e<t;e++)if(n=this.getDataAtCell(o,e),Bo(n)===!1)return typeof n=="object"?(r=this.getCellMeta(o,e),Qr(this.getSchema()[r.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:void 0,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function wr(o,e,t){return e=Xf(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Xf(o){var e=qf(o,"string");return typeof e=="symbol"?e:String(e)}function qf(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function Qf(){return class{}}class Zf{constructor(e){wr(this,"metaCtor",Qf()),wr(this,"meta",void 0),this.meta=this.metaCtor.prototype,Mt(this.meta,Ki()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;Mt(this.meta,e),Yo(this.meta,{...e,type:(t=e.type)!==null&&t!==void 0?t:this.meta.type},e)}}function Jf(o,e,t){return e=eg(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function eg(o){var e=tg(o,"string");return typeof e=="symbol"?e:String(e)}function tg(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class og{constructor(e){Jf(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){Mt(this.meta,e),Yo(this.meta,e,e)}}let Gi;function Io(o,e,t){return e=ng(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function ng(o){var e=sg(o,"string");return typeof e=="symbol"?e:String(e)}function sg(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}Gi=Symbol.iterator;class zo{constructor(e){Io(this,"valueFactory",void 0),Io(this,"data",[]),Io(this,"index",[]),Io(this,"holes",new Set),this.valueFactory=e}obtain(e){_o(()=>No(e),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let n;if(t>=0)n=this.data[t],n===void 0&&(n=this.valueFactory(e),this.data[t]=n);else if(n=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=n,this.index[e]=r}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;_o(()=>No(e)||Oo(e),"Expecting an unsigned number or null/undefined argument.");const n=[],r=this.data.length;for(let s=0;s<t;s++)n.push(r+s),this.data.push(void 0);const i=Oo(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...n,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;_o(()=>No(e)||Oo(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Oo(e)?this.index.length-t:e,t);for(let r=0;r<n.length;r++){const i=n[r];typeof i=="number"&&this.holes.add(i)}}size(){return this.data.length-this.holes.size}values(){return Tc(this.data,(e,t)=>!this.holes.has(t))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const r=this._getKeyByStorageIndex(n);r!==-1&&e.push([r,this.data[n]])}let t=0;return{next:()=>{if(t<e.length){const n=e[t];return t+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Gi](){return this.entries()}}function pr(o,e,t){return e=rg(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function rg(o){var e=ig(o,"string");return typeof e=="symbol"?e:String(e)}function ig(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}const lg=["data","width"];class ag{constructor(e){pr(this,"globalMeta",void 0),pr(this,"metas",new zo(()=>this._createMeta())),this.globalMeta=e,this.metas=new zo(()=>this._createMeta())}updateMeta(e,t){const n=this.getMeta(e);Mt(n,t),Yo(n,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Yf(this.globalMeta.getMetaConstructor(),lg).prototype}}function Cr(o,e,t){return e=cg(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function cg(o){var e=dg(o,"string");return typeof e=="symbol"?e:String(e)}function dg(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class ug{constructor(e){Cr(this,"columnMeta",void 0),Cr(this,"metas",new zo(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,n){const r=this.getMeta(e,t);Mt(r,n),Yo(r,n)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,t)}getMeta(e,t,n){const r=this.metas.obtain(e).obtain(t);return n===void 0?r:r[n]}setMeta(e,t,n,r){var i;const s=this.metas.obtain(e).obtain(t);(i=s._automaticallyAssignedMetaProps)===null||i===void 0||i.delete(n),s[n]=r}removeMeta(e,t,n){const r=this.metas.obtain(e).obtain(t);delete r[n]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let n=0;n<t.length;n++)e.push(...t[n].values());return e}getMetasAtRow(e){_o(()=>No(e),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new zo(e=>this._createMeta(e))}_createMeta(e){const t=this.columnMeta.getMetaConstructor(e);return new t}}class Yi{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Zf(e),this.tableMeta=new og(this.globalMeta),this.columnMeta=new ag(this.globalMeta),this.cellMeta=new ug(this.columnMeta),n.forEach(r=>new r(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,n){let{visualRow:r,visualColumn:i}=n;const s=this.cellMeta.getMeta(e,t);return s.visualRow=r,s.visualCol=i,s.row=e,s.col=t,this.runLocalHooks("afterGetCellMeta",s),s}getCellMetaKeyValue(e,t,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,n)}setCellMeta(e,t,n,r){this.cellMeta.setMeta(e,t,n,r)}updateCellMeta(e,t,n){this.cellMeta.updateMeta(e,t,n)}removeCellMeta(e,t,n){this.cellMeta.removeMeta(e,t,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}le(Yi,At);function Sr(o,e,t,n){const{hotInstance:r,dataMap:i,dataSource:s,internalSource:a,source:c,metaManager:u,firstRun:f}=n,g=Zr(a),w=r.getSettings();Array.isArray(w.dataSchema)?r.dataType="array":ae(w.dataSchema)?r.dataType="function":r.dataType="object",i&&i.destroy(),o=r.runHooks(`before${g}`,o,f,c);const m=new Kf(r,o,u);if(e(m),typeof o=="object"&&o!==null)o.push&&o.splice||(o=[o]);else if(o===null){const v=m.getSchema();o=[];let y,M=0,b=0;for(M=0,b=w.startRows;M<b;M++)if((r.dataType==="object"||r.dataType==="function")&&w.dataSchema)y=ft(v),o.push(y);else if(r.dataType==="array")y=ft(v[0]),o.push(y);else{y=[];for(let E=0,j=w.startCols;E<j;E++)y.push(null);o.push(y)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof o} given)`);Array.isArray(o[0])&&(r.dataType="array"),w.data=o,m.dataSource=o,s.data=o,s.dataType=r.dataType,s.colToProp=m.colToProp.bind(m),s.propToCol=m.propToCol.bind(m),s.countCachedColumns=m.countCachedColumns.bind(m),t(m),r.runHooks(`after${g}`,o,f,c),f||(r.runHooks("afterChange",null,a),r.render()),r.getSettings().ariaTags&&Z(r.rootElement,[Ur(-1),Go(r.countCols()+(r.view?r.countRowHeaders():0))])}function br(o,e,t){return e=hg(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function hg(o){var e=fg(o,"string");return typeof e=="symbol"?e:String(e)}function fg(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class gg{constructor(e){br(this,"metaManager",void 0),br(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",t=>this.extendCellMeta(t)),Me.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t;const{row:n,col:r}=e;if((t=this.metaSyncMemo.get(n))!==null&&t!==void 0&&t.has(r))return;const{visualRow:i,visualCol:s}=e,a=this.metaManager.hot,c=a.colToProp(s);e.prop=c,a.runHooks("beforeGetCellMeta",i,s,e);const u=Jt(e,"type")?e.type:null;let f=ae(e.cells)?e.cells(n,r,c):null;if(u)if(f){var g;f.type=(g=f.type)!==null&&g!==void 0?g:u}else f={type:u};f&&this.metaManager.updateCellMeta(n,r,f),a.runHooks("afterGetCellMeta",i,s,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(r)}}function Tn(o,e,t){return e=mg(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function mg(o){var e=wg(o,"string");return typeof e=="symbol"?e:String(e)}function wg(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}class pg{constructor(e){Tn(this,"metaManager",void 0),Tn(this,"usageTracker",new Set),Tn(this,"propDescriptors",new Map([["ariaTags",{onChange(t,n,r){if(!r)throw new Error(`The \`${t}\` option can not be updated after the Handsontable instance was initialized.`)}}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&t==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{onChange(t,n,r){if(!r)throw new Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}}]])),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{const{target:n,onChange:r=()=>{}}=e,i=typeof n=="string",s=i?n:t,a=`_${s}`;this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[s],this.installPropWatcher(t,a,r),i&&this.installPropWatcher(n,a,r)})}installPropWatcher(e,t,n){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){const s=!r.usageTracker.has(e);r.usageTracker.add(e),n.call(r,e,i,s),this[t]=i},enumerable:!0,configurable:!0})}}const Cg={name:"editorCloseAndSave",callback(o,e,t){const n=o._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(t.includes("shift"))}},Sg={name:"editorCloseWithoutSaving",callback(o){const e=o._getEditorManager();e.closeEditorAndRestoreOriginalValue(o.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},bg={name:"editorFastOpen",callback(o,e){const{highlight:t}=o.getSelectedRangeLast();t.isHeader()||o._getEditorManager().openEditor(null,e,!0)}},vg={name:"editorOpen",callback(o,e,t){const n=o._getEditorManager(),{highlight:r}=o.getSelectedRangeLast();r.isHeader()||(o.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter():n.openEditor(null,e,!0):n.moveSelectionAfterEnter(t.includes("shift")),Xn(e))}};function yg(){return[Cg,Sg,bg,vg]}const Rg={name:"extendCellsSelectionDown",callback(o){const{highlight:e}=o.getSelectedRangeLast();(e.isCell()||e.isHeader()&&o.selection.isSelectedByRowHeader())&&o.selection.transformEnd(1,0)}},Tg={name:"extendCellsSelectionDownByViewportHeight",callback(o){const{to:e}=o.getSelectedRangeLast(),t=Math.min(e.row+o.countVisibleRows(),o.countRows()-1),n=o.rowIndexMapper.getNearestNotHiddenIndex(t,-1);if(n!==null){const r=o._createCellCoords(n,e.col),i=e.row-o.view.getFirstFullyVisibleRow(),s=Math.min(r.row-i,o.countRows()-1);o.selection.setRangeEnd(r),o.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},Hg={name:"extendCellsSelectionLeft",callback(o){const{highlight:e}=o.getSelectedRangeLast();(e.isCell()||e.isHeader()&&o.selection.isSelectedByColumnHeader())&&o.selection.transformEnd(0,-1*o.getDirectionFactor())}},Eg={name:"extendCellsSelectionRight",callback(o){const{highlight:e}=o.getSelectedRangeLast();(e.isCell()||e.isHeader()&&o.selection.isSelectedByColumnHeader())&&o.selection.transformEnd(0,o.getDirectionFactor())}},Og={name:"extendCellsSelectionToColumns",callback(o){const{highlight:e,from:t,to:n}=o.getSelectedRangeLast();o.selection.isSelectedByRowHeader()?o.selection.selectAll(!0,!0):o.selectColumns(t.col,n.col,e.row)}},Ig={name:"extendCellsSelectionToMostBottom",callback(o){const{selection:e,rowIndexMapper:t}=o,{highlight:n,from:r,to:i}=o.getSelectedRangeLast(),s=n.isHeader()&&o.selection.isSelectedByRowHeader();if(n.isCell()||s){const a=t.getNearestNotHiddenIndex(o.countRows()-1,-1);e.setRangeStart(r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(o._createCellCoords(a,i.col))}}},Mg={name:"extendCellsSelectionToMostInlineEnd",callback(o){const{selection:e,columnIndexMapper:t}=o,{highlight:n}=o.getSelectedRangeLast();n.isCell()&&e.setRangeEnd(o._createCellCoords(e.selectedRange.current().from.row,t.getNearestNotHiddenIndex(o.countCols()-1,-1)))}},xg={name:"extendCellsSelectionToMostInlineStart",callback(o){const{selection:e,columnIndexMapper:t}=o,{highlight:n}=o.getSelectedRangeLast();n.isCell()&&e.setRangeEnd(o._createCellCoords(e.selectedRange.current().from.row,t.getNearestNotHiddenIndex(0,1)))}},Pg={name:"extendCellsSelectionToMostLeft",callback(o){const{selection:e,columnIndexMapper:t}=o,{highlight:n,from:r,to:i}=o.getSelectedRangeLast(),s=n.isHeader()&&o.selection.isSelectedByColumnHeader();if(n.isCell()||s){const a=t.getNearestNotHiddenIndex(...o.isRtl()?[o.countCols()-1,-1]:[0,1]);e.setRangeStart(r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(o._createCellCoords(i.row,a))}}},Ag={name:"extendCellsSelectionToMostRight",callback(o){const{selection:e,columnIndexMapper:t}=o,{highlight:n,from:r,to:i}=o.getSelectedRangeLast(),s=n.isHeader()&&o.selection.isSelectedByColumnHeader();if(n.isCell()||s){const a=t.getNearestNotHiddenIndex(...o.isRtl()?[0,1]:[o.countCols()-1,-1]);e.setRangeStart(r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(o._createCellCoords(i.row,a))}}},Ng={name:"extendCellsSelectionToMostTop",callback(o){const{selection:e,rowIndexMapper:t}=o,{highlight:n,from:r,to:i}=o.getSelectedRangeLast(),s=n.isHeader()&&o.selection.isSelectedByRowHeader();if(n.isCell()||s){const a=t.getNearestNotHiddenIndex(0,1);e.setRangeStart(r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(o._createCellCoords(a,i.col))}}},_g={name:"extendCellsSelectionToRows",callback(o){const{highlight:e,from:t,to:n}=o.getSelectedRangeLast();o.selection.isSelectedByColumnHeader()?o.selection.selectAll(!0,!0):o.selectRows(t.row,n.row,e.col)}},Lg={name:"extendCellsSelectionUp",callback(o){const{highlight:e}=o.getSelectedRangeLast();(e.isCell()||e.isHeader()&&o.selection.isSelectedByRowHeader())&&o.selection.transformEnd(-1,0)}},Dg={name:"extendCellsSelectionUpByViewportHeight",callback(o){const{to:e}=o.getSelectedRangeLast(),t=Math.max(e.row-o.countVisibleRows(),0),n=o.rowIndexMapper.getNearestNotHiddenIndex(t,1);if(n!==null){const r=o._createCellCoords(n,e.col),i=e.row-o.view.getFirstFullyVisibleRow(),s=Math.max(r.row-i,0);o.selection.setRangeEnd(r),o.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}};function Vg(){return[Rg,Tg,Hg,Eg,Og,Ig,Mg,xg,Pg,Ag,Ng,_g,Lg,Dg]}const Fg={name:"moveCellSelectionDown",callback(o){let{selection:e}=o;e.transformStart(1,0)}},Bg={name:"moveCellSelectionDownByViewportHeight",callback(o){const{navigableHeaders:e}=o.getSettings(),t=e?o.countColHeaders():0,{row:n}=o.getSelectedRangeLast().highlight;let r=o.countVisibleRows()+t;n===o.countRows()-1?r=1:n+r>o.countRows()&&(r=o.countRows()-n-1),o.selection.transformStart(r,0),o.getSelectedRangeLast().highlight.row<0&&o.scrollViewportTo({row:0})}},Wg={name:"moveCellSelectionInlineEnd",callback(o,e){const t=o.getSettings(),n=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;o.selection.transformStart(-n.row,-n.col)}},kg={name:"moveCellSelectionInlineStart",callback(o,e){const t=o.getSettings(),n=typeof t.tabMoves=="function"?t.tabMoves(e):t.tabMoves;o.selection.transformStart(n.row,n.col)}},$g={name:"moveCellSelectionLeft",callback(o){o.selection.transformStart(0,-1*o.getDirectionFactor())}},zg={name:"moveCellSelectionRight",callback(o){o.selection.transformStart(0,o.getDirectionFactor())}},jg={name:"moveCellSelectionToMostBottom",callback(o){const{col:e}=o.getSelectedRangeLast().highlight;let t=o.rowIndexMapper.getNearestNotHiddenIndex(o.countRows()-1,-1);t===null&&(t=-1),o.selection.setRangeStart(o._createCellCoords(t,e))}},Ug={name:"moveCellSelectionToMostBottomInlineEnd",callback(o){const{selection:e,rowIndexMapper:t,columnIndexMapper:n}=o,r=parseInt(o.getSettings().fixedRowsBottom,10),i=t.getNearestNotHiddenIndex(o.countRows()-r-1,-1),s=n.getNearestNotHiddenIndex(o.countCols()-1,-1);e.setRangeStart(o._createCellCoords(i,s))}},Kg={name:"moveCellSelectionToMostInlineEnd",callback(o){const{selection:e,columnIndexMapper:t}=o;e.setRangeStart(o._createCellCoords(o.getSelectedRangeLast().highlight.row,t.getNearestNotHiddenIndex(o.countCols()-1,-1)))}},Gg={name:"moveCellSelectionToMostInlineStart",callback(o){const{selection:e,columnIndexMapper:t}=o,n=parseInt(o.getSettings().fixedColumnsStart,10),r=o.getSelectedRangeLast().highlight.row,i=t.getNearestNotHiddenIndex(n,1);e.setRangeStart(o._createCellCoords(r,i))}},Yg={name:"moveCellSelectionToMostLeft",callback(o){const{selection:e,columnIndexMapper:t}=o,n=o.getSelectedRangeLast().highlight.row;let r=t.getNearestNotHiddenIndex(...o.isRtl()?[o.countCols()-1,-1]:[0,1]);r===null&&(r=o.isRtl()?-1:-o.countRowHeaders()),e.setRangeStart(o._createCellCoords(n,r))}},Xg={name:"moveCellSelectionToMostRight",callback(o){const{selection:e,columnIndexMapper:t}=o,{row:n}=o.getSelectedRangeLast().highlight;let r=t.getNearestNotHiddenIndex(...o.isRtl()?[0,1]:[o.countCols()-1,-1]);r===null&&(r=o.isRtl()?-o.countRowHeaders():-1),e.setRangeStart(o._createCellCoords(n,r))}},qg={name:"moveCellSelectionToMostTop",callback(o){const{col:e}=o.getSelectedRangeLast().highlight;let t=o.rowIndexMapper.getNearestNotHiddenIndex(0,1);t===null&&(t=-o.countColHeaders()),o.selection.setRangeStart(o._createCellCoords(t,e))}},Qg={name:"moveCellSelectionToMostTopInlineStart",callback(o){const{selection:e,rowIndexMapper:t,columnIndexMapper:n}=o,r=parseInt(o.getSettings().fixedRowsTop,10),i=parseInt(o.getSettings().fixedColumnsStart,10),s=t.getNearestNotHiddenIndex(r,1),a=n.getNearestNotHiddenIndex(i,1);e.setRangeStart(o._createCellCoords(s,a))}},Zg={name:"moveCellSelectionUp",callback(o){let{selection:e}=o;e.transformStart(-1,0)}},Jg={name:"moveCellSelectionUpByViewportHight",callback(o){const{navigableHeaders:e}=o.getSettings(),t=e?o.countColHeaders():0,{row:n}=o.getSelectedRangeLast().highlight;let r=-(o.countVisibleRows()+t);n===-t?r=-1:n+r<t&&(r=-(n+t)),o.selection.transformStart(r,0),o.getSelectedRangeLast().highlight.row<0&&o.scrollViewportTo({row:0})}};function em(){return[Fg,Bg,Wg,kg,$g,zg,jg,Ug,Kg,Gg,Yg,Xg,qg,Qg,Zg,Jg]}const tm={name:"emptySelectedCells",callback(o){o.emptySelectedCells(),o._getEditorManager().prepareEditor()}},om={name:"scrollToFocusedCell",callback(o){const{highlight:e}=o.getSelectedRangeLast(),t=o.view.getFirstFullyVisibleRow()-1,n=o.view.getFirstFullyVisibleColumn()-1,r=o.view.getLastFullyVisibleRow()+1,i=o.view.getLastFullyVisibleColumn()+1,s=o._createCellCoords(t,n),a=o._createCellCoords(r,i);if(!o._createCellRange(s,s,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const f=Math.floor(o.countVisibleCols()/2);u.col=Math.max(e.col-f,0)}if(e.row>=0){const f=Math.floor(o.countVisibleRows()/2);u.row=Math.max(e.row-f,0)}o.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},nm={name:"selectAllCells",callback(o){o.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},sm={name:"selectAllCellsAndHeaders",callback(o){o.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},rm={name:"populateSelectedCellsData",callback(o){const e=o.getSelectedRange(),{row:t,col:n}=e[e.length-1].highlight.normalize(),r=o.getDataAtCell(t,n),i=new Map;for(let s=0;s<e.length;s++)e[s].forAll((a,c)=>{if(a>=0&&c>=0&&(a!==t||c!==n)){const{readOnly:u}=o.getCellMeta(a,c);u||i.set(`${a}x${c}`,[a,c,r])}});o.setDataAtCell(Array.from(i.values()))}},im=[...yg(),...Vg(),...em(),tm,om,nm,sm,rm];function Xi(o){const e={};return im.forEach(t=>{let{name:n,callback:r}=t;e[n]=function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return r(o,...s)}}),e}function lm(o){const e=o.getShortcutManager().addContext("editor"),t=Xi(o),n={group:Jr};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,i)=>t.editorCloseAndSave(r,i)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,i)=>t.editorCloseAndSave(r,i)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>t.editorCloseWithoutSaving()}],n)}function am(o){const e=o.getShortcutManager().addContext("grid"),t=Xi(o),n={runOnlyIf:()=>{const{navigableHeaders:r}=o.getSettings();return W(o.getSelected())&&(r||!r&&o.countRenderedRows()>0&&o.countRenderedCols()>0)},group:ei};e.addShortcuts([{keys:[["F2"]],callback:r=>t.editorFastOpen(r)},{keys:[["Enter"],["Enter","Shift"]],callback:(r,i)=>t.editorOpen(r,i)},{keys:[["Backspace"],["Delete"]],callback:()=>t.emptySelectedCells()}],{group:Jr,runOnlyIf:()=>W(o.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>t.selectAllCells()},{keys:[["Control/Meta","Shift","Space"]],callback:()=>t.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>t.populateSelectedCellsData(),runOnlyIf:()=>!o.getSelectedRangeLast().highlight.isHeader()&&o.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>t.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>t.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>t.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>t.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>t.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(o.selection.isSelectedByCorner()||o.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>t.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>t.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>t.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>t.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>t.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(o.selection.isSelectedByCorner()||o.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>o.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>o.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>o.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>t.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>t.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>o.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>t.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>t.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>t.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>t.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:()=>t.moveCellSelectionInlineStart()},{keys:[["Shift","Tab"]],preventDefault:!1,callback:()=>t.moveCellSelectionInlineEnd()},{keys:[["Control/Meta","Backspace"]],callback:()=>t.scrollToFocusedCell()}],n)}function cm(o){[lm,am].forEach(e=>e(o))}function dm(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t=o.rootElement,n=vr(o),r=vr(o);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),r.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),t.firstChild.before(n),t.lastChild.after(r),{activate(){o._registerTimeout(()=>{n.tabIndex=0,r.tabIndex=0},10)},deactivate(){o._registerTimeout(()=>{n.tabIndex=-1,r.tabIndex=-1},10)}}}function vr(o){const t=o.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),o.getSettings().ariaTags&&Z(t,[Ze(),Hc()]),t}function um(o){let e;const{activate:t,deactivate:n}=dm(o,{onFocusFromTop(){var u;const f=(u=e)!==null&&u!==void 0?u:yr(o);f&&(o.runHooks("modifyFocusOnTabNavigation","from_above",f),o.selectCell(f.row,f.col)),o.listen()},onFocusFromBottom(){var u;const f=(u=e)!==null&&u!==void 0?u:Rr(o);f&&(o.runHooks("modifyFocusOnTabNavigation","from_below",f),o.selectCell(f.row,f.col)),o.listen()}}),r={wrapped:!1,flipped:!1};let i=!0,s=!1;o.addHook("afterListen",()=>n()),o.addHook("afterUnlisten",()=>t()),o.addHook("afterSelection",(u,f,g,w,m)=>{if(s&&r.wrapped&&r.flipped&&(m.value=!0),i){var v;e=(v=o.getSelectedRangeLast())===null||v===void 0?void 0:v.highlight}}),o.addHook("beforeRowWrap",(u,f,g)=>{r.wrapped=!0,r.flipped=g});function a(){r.wrapped=!1,r.flipped=!1,o.deselectCell(),o.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:ei,group:"focusCatcher"};o.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{s=!0,o.getSelectedRangeLast()&&!o.getSettings().tabNavigation&&(i=!1)},position:"before"},{...c,callback:u=>{const{tabNavigation:f,autoWrapRow:g}=o.getSettings();if(s=!1,i=!0,!f||!o.selection.isSelected()||g&&r.wrapped&&r.flipped||!g&&r.wrapped)return g&&r.wrapped&&r.flipped&&(e=u.shiftKey?yr(o):Rr(o)),a(),!1;u.preventDefault()},position:"after"}])}function yr(o){const{rowIndexMapper:e,columnIndexMapper:t}=o,{navigableHeaders:n}=o.getSettings();let r=n&&o.countColHeaders()>0?-o.countColHeaders():0,i=n&&o.countRowHeaders()>0?-o.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),i===0&&(i=t.getVisualFromRenderableIndex(i)),r===null||i===null?null:o._createCellCoords(r,i)}function Rr(o){var e,t;const{rowIndexMapper:n,columnIndexMapper:r}=o,{navigableHeaders:i}=o.getSettings();let s=n.getRenderableIndexesLength()-1,a=r.getRenderableIndexesLength()-1;if(s<0){if(!i||o.countColHeaders()===0)return null;s=-1}if(a<0){if(!i||o.countColHeaders()===0)return null;a=-1}return o._createCellCoords((e=n.getVisualFromRenderableIndex(s))!==null&&e!==void 0?e:s,(t=r.getVisualFromRenderableIndex(a))!==null&&t!==void 0?t:a)}const Tr=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Mo=o=>o.map(e=>{const t=e.toLowerCase();return Tr.has(t)?Tr.get(t):t}).sort().join("+"),hm=o=>o.split("+"),Hr=new RegExp("^(?:Key|Digit)([A-Z0-9])$"),fm=new Set(["Backquote","Minus","Equal","BracketLeft","BracketRight","Backslash","Semicolon","Quote","Comma","Period","Slash"]),Hn=o=>{let{key:e,code:t}=o,n=e;return Hr.test(t)?n=t.replace(Hr,"$1"):fm.has(t)&&(n=t),n.toLowerCase()},qi=Symbol("shortcut-context");function Qi(o){return Pt(o)&&o.__kindOf===qi}const gm=o=>{const e=Qn({errorIdExists:c=>`The "${c}" shortcut is already registered in the "${o}" context.`}),t=function(){let{keys:c,callback:u,group:f,runOnlyIf:g=()=>!0,captureCtrl:w=!1,preventDefault:m=!0,stopPropagation:v=!1,relativeToGroup:y,position:M,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Le(f))throw new Error("You need to define the shortcut's group.");if(ae(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(oo`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const E={callback:u,group:f,runOnlyIf:g,captureCtrl:w,preventDefault:m,stopPropagation:v};W(y)&&([E.relativeToGroup,E.position]=[y,M]),Qi(b)&&(E.forwardToContext=b),c.forEach(j=>{const X=Mo(j);if(e.hasItem(X)){const O=e.getItem(X);let L=O.findIndex(te=>te.group===y);L!==-1?M==="before"?L-=1:L+=1:L=O.length,O.splice(L,0,E)}else e.addItem(X,[E])})},n=function(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(f=>{pe(u,(g,w)=>{Object.prototype.hasOwnProperty.call(f,w)===!1&&(f[w]=u[w])}),t(f)})},r=c=>{const u=Mo(c);e.removeItem(u)};return{__kindOf:qi,addShortcut:t,addShortcuts:n,getShortcuts:c=>{const u=Mo(c),f=e.getItem(u);return W(f)?f.slice():[]},hasShortcut:c=>{const u=Mo(c);return e.hasItem(u)},removeShortcutsByKeys:r,removeShortcutsByGroup:c=>{e.getItems().forEach(f=>{let[g,w]=f;const m=w.filter(v=>v.group!==c);m.length===0?r(hm(g)):(w.length=0,w.push(...m))})}}};function mm(){const o=new Set;return{press(e){o.add(e)},release(e){o.delete(e)},releaseAll(){o.clear()},isPressed(e){return o.has(e)}}}const wm=["meta","alt","shift","control"],Xt=mm();let xo=0;function pm(o,e,t,n,r){const i=m=>wm.includes(m),s=function(m){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const y=[];return m.altKey&&y.push("alt"),v&&(m.ctrlKey||m.metaKey)?y.push("control/meta"):(m.ctrlKey&&y.push("control"),m.metaKey&&y.push("meta")),m.shiftKey&&y.push("shift"),y},a=m=>{if(e(m)===!1)return;const v=t(m);if(m.keyCode===229||v===!1||Tt(m))return;const y=Hn(m);let M=[];i(y)||(M=s(m));const b=[y].concat(M);!r(m,b)&&(Rs()&&M.includes("meta")||!Rs()&&M.includes("control"))&&r(m,[y].concat(s(m,!0))),n(m)},c=m=>{const v=Hn(m);i(v)&&Xt.press(v)},u=m=>{const v=Hn(m);i(v)&&Xt.release(v)},f=()=>{Xt.releaseAll()};return{mount:()=>{let m=o;for(xo+=1;m;)xo===1&&(m.document.documentElement.addEventListener("keydown",c),m.document.documentElement.addEventListener("keyup",u)),m.document.documentElement.addEventListener("keydown",a),m.document.documentElement.addEventListener("blur",f),m=ys(m)},unmount:()=>{let m=o;for(xo-=1;m;)xo===0&&(m.document.documentElement.removeEventListener("keydown",c),m.document.documentElement.removeEventListener("keyup",u)),m.document.documentElement.removeEventListener("keydown",a),m.document.documentElement.removeEventListener("blur",f),m=ys(m)},isPressed:m=>Xt.isPressed(m),releasePressedKeys:()=>Xt.releaseAll()}}const Cm=o=>{let{ownerWindow:e,handleEvent:t,beforeKeyDown:n,afterKeyDown:r}=o;const i=Qn({errorIdExists:v=>`The "${v}" context name is already registered.`});let s="grid";const a=v=>{const y=gm(v);return i.addItem(v,y),y},c=()=>s,u=v=>i.getItem(v),f=v=>{if(!i.hasItem(v))throw new Error(oo`You've tried to activate the "${v}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);s=v};let g=!1;const w=function(v,y){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:c();const b=Qi(M)?M:u(M);let E=!1;if(!b.hasShortcut(y))return E;const j=b.getShortcuts(y);for(let X=0;X<j.length;X++){const{callback:z,runOnlyIf:O,preventDefault:L,stopPropagation:te,captureCtrl:Ce,forwardToContext:de}=j[X];if(O(v)===!0){if(g=Ce,E=z(v,y)===!1,g=!1,L&&v.preventDefault(),te&&(Xn(v),v.stopPropagation()),E)break;de&&w(v,y,de)}}return E},m=pm(e,t,n,r,w);return m.mount(),{addContext:a,getActiveContextName:c,getContext:u,setActiveContextName:f,isCtrlPressed:()=>!g&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}};let En=null;const On=new Map;function Zi(o,e){var t,n=this;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=this;const a=new Gn(s);let c,u,f,g,w,m=!0;Fh(r)&&Vh(this),this.rootElement=o,this.rootDocument=o.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const v=(t=e==null?void 0:e.layoutDirection)!==null&&t!==void 0?t:"inherit",y=["rtl","ltr"].includes(v)?v:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",y),this.isRtl=function(){return y==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=Mf(e.language);const M=new Yi(s,e,[gg,pg]),b=M.getTableMeta(),E=M.getGlobalMeta(),j=Qn();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,o.insertBefore(this.container,o.firstChild),Ao(this)&&Ec(e.licenseKey,o),this.guid=`ht_${Fr()}`,On.set(this.guid,this),this.columnIndexMapper=new Bn,this.rowIndexMapper=new Bn,this.columnIndexMapper.addLocalHook("indexesSequenceChange",l=>{s.runHooks("afterColumnSequenceChange",l)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",l=>{s.runHooks("afterRowSequenceChange",l)}),u=new Xh(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const X=l=>{const{row:d,col:h}=l;return s._createCellCoords(d>=0?s.rowIndexMapper.getRenderableFromVisualIndex(d):d,h>=0?s.columnIndexMapper.getRenderableFromVisualIndex(h):h)},z=l=>{const{row:d,col:h}=l;return s._createCellCoords(d>=0?s.rowIndexMapper.getVisualFromRenderableIndex(d):d,h>=0?s.columnIndexMapper.getVisualFromRenderableIndex(h):h)};let O=new zf(b,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:l=>c.propToCol(l),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(l,d)=>s._createCellCoords(l,d),createCellRange:(l,d,h)=>s._createCellRange(l,d,h),visualToRenderableCoords:X,renderableToVisualCoords:z,isDisabledCellSelection:(l,d)=>l<0||d<0?s.getSettings().disableVisualSelection:s.getCellMeta(l,d).disableVisualSelection});this.selection=O;const L=l=>{let{hiddenIndexesChanged:d}=l;d&&this.selection.refresh()};this.columnIndexMapper.addLocalHook("cacheUpdated",L),this.rowIndexMapper.addLocalHook("cacheUpdated",L),this.selection.addLocalHook("afterSetRangeEnd",l=>{const d=ze(!1),h=this.selection.getSelectedRange(),{from:C,to:p}=h.current(),S=h.size()-1;this.runHooks("afterSelection",C.row,C.col,p.row,p.col,d,S),this.runHooks("afterSelectionByProp",C.row,s.colToProp(C.col),p.row,s.colToProp(p.col),d,S);let R=!0;i&&(R=!1),d.isTouched()&&(R=!d.value);const T=this.selection.selectedRange.current(),P=this.selection.isSelectedByAnyHeader(),I=this.selection.isSelectedByRowHeader(),H=this.selection.isSelectedByColumnHeader();if(R!==!1)if(P)I?this.scrollViewportTo({row:l.row}):H&&this.scrollViewportTo({col:l.col});else if(T&&!this.selection.isMultiple()){const{row:A,col:B}=T.from;A<0&&B>=0?this.scrollViewportTo({col:B}):B<0&&A>=0?this.scrollViewportTo({row:A}):this.scrollViewportTo({row:A,col:B})}else this.scrollViewportTo(l.toObject());I&&H?Y(this.rootElement,["ht__selection--rows","ht__selection--columns"]):I?(me(this.rootElement,"ht__selection--columns"),Y(this.rootElement,"ht__selection--rows")):H?(me(this.rootElement,"ht__selection--rows"),Y(this.rootElement,"ht__selection--columns")):me(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this._refreshBorders(null)}),this.selection.addLocalHook("afterSelectionFinished",l=>{const d=l.length-1,{from:h,to:C}=l[d];this.runHooks("afterSelectionEnd",h.row,h.col,C.row,C.col,d),this.runHooks("afterSelectionEndByProp",h.row,s.colToProp(h.col),C.row,s.colToProp(C.col),d)}),this.selection.addLocalHook("afterIsMultipleSelection",l=>{const d=this.runHooks("afterIsMultipleSelection",l.value);l.value&&(l.value=d)}),this.selection.addLocalHook("afterDeselect",()=>{g.destroyEditor(),this._refreshBorders(),me(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("beforeSetRangeStart",...d)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("beforeSetRangeStartOnly",...d)}).addLocalHook("beforeSetRangeEnd",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("beforeSetRangeEnd",...d)}).addLocalHook("beforeSelectColumns",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("beforeSelectColumns",...d)}).addLocalHook("afterSelectColumns",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("afterSelectColumns",...d)}).addLocalHook("beforeSelectRows",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("beforeSelectRows",...d)}).addLocalHook("afterSelectRows",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("afterSelectRows",...d)}).addLocalHook("beforeModifyTransformStart",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("modifyTransformStart",...d)}).addLocalHook("afterModifyTransformStart",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("afterModifyTransformStart",...d)}).addLocalHook("beforeModifyTransformEnd",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("modifyTransformEnd",...d)}).addLocalHook("afterModifyTransformEnd",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("afterModifyTransformEnd",...d)}).addLocalHook("beforeRowWrap",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("beforeRowWrap",...d)}).addLocalHook("beforeColumnWrap",function(){for(var l=arguments.length,d=new Array(l),h=0;h<l;h++)d[h]=arguments[h];return n.runHooks("beforeColumnWrap",...d)}).addLocalHook("insertRowRequire",l=>this.alter("insert_row_above",l,1,"auto")).addLocalHook("insertColRequire",l=>this.alter("insert_col_start",l,1,"auto")),f={alter(l,d){var h,C;let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,S=arguments.length>3?arguments[3]:void 0,R=arguments.length>4?arguments[4]:void 0;const T=P=>{if(P.length===0)return[];const I=[...P];return I.sort((A,B)=>{let[D]=A,[K]=B;return D===K?0:D>K?1:-1}),Dc(I,(A,B)=>{let[D,K]=B;const oe=A[A.length-1],[fe,G]=oe,k=fe+G;if(D<=k){const J=Math.max(K-(k-D),0);oe[1]+=J}else A.push([D,K]);return A},[I[0]])};switch(l){case"insert_row_below":case"insert_row_above":const P=s.countSourceRows();if(b.maxRows===P)return;const I=l==="insert_row_below"?"below":"above";d=(h=d)!==null&&h!==void 0?h:I==="below"?P:0;const{delta:H,startPhysicalIndex:A}=c.createRow(d,p,{source:S,mode:I});if(H){const G=O.selectedRange.current(),k=G==null?void 0:G.from,J=k==null?void 0:k.row,q=s.toVisualRow(A);if(O.isSelectedByCorner())O.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(W(J)&&J>=q){const{row:ee,col:Se}=G.to;let ue=k.col;O.isSelectedByRowHeader()&&(ue=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(s._createCellCoords(J+H,ue),!0),O.setRangeEnd(s._createCellCoords(ee+H,Se))}else s._refreshBorders()}break;case"insert_col_start":case"insert_col_end":const B=l==="insert_col_end"?"end":"start";d=(C=d)!==null&&C!==void 0?C:B==="end"?s.countSourceCols():0;const{delta:D,startPhysicalIndex:K}=c.createCol(d,p,{source:S,mode:B});if(D){if(Array.isArray(b.colHeaders)){const ee=[s.toVisualColumn(K),0];ee.length+=D,Array.prototype.splice.apply(b.colHeaders,ee)}const G=O.selectedRange.current(),k=G==null?void 0:G.from,J=k==null?void 0:k.col,q=s.toVisualColumn(K);if(O.isSelectedByCorner())O.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(W(J)&&J>=q){const{row:ee,col:Se}=G.to;let ue=k.row;O.isSelectedByColumnHeader()&&(ue=-1),O.getSelectedRange().pop(),O.setRangeStartOnly(s._createCellCoords(ue,J+D),!0),O.setRangeEnd(s._createCellCoords(ee,Se+D))}else s._refreshBorders()}break;case"remove_row":const oe=G=>{let k=0;$(G,J=>{let[q,ee]=J;const Se=Bo(q)?s.countRows()-1:Math.max(q-k,0);if(Number.isInteger(q)&&(q=Math.max(q-k,0)),!c.removeRow(q,ee,S))return;const Dt=s.countRows(),Ke=b.fixedRowsTop;Ke>=Se+1&&(b.fixedRowsTop-=Math.min(ee,Ke-Se));const Ge=b.fixedRowsBottom;Ge&&Se>=Dt-Ge&&(b.fixedRowsBottom-=Math.min(ee,Ge)),k+=ee})};Array.isArray(d)?oe(T(d)):oe([[d,p]]),f.adjustRowsAndCols(),s._refreshBorders();break;case"remove_col":const fe=G=>{let k=0;$(G,J=>{let[q,ee]=J;const Se=Bo(q)?s.countCols()-1:Math.max(q-k,0);let ue=s.toPhysicalColumn(Se);if(Number.isInteger(q)&&(q=Math.max(q-k,0)),!c.removeCol(q,ee,S))return;const Ke=b.fixedColumnsStart;Ke>=Se+1&&(b.fixedColumnsStart-=Math.min(ee,Ke-Se)),Array.isArray(b.colHeaders)&&(typeof ue>"u"&&(ue=-1),b.colHeaders.splice(ue,ee)),k+=ee})};Array.isArray(d)?fe(T(d)):fe([[d,p]]),f.adjustRowsAndCols(),s._refreshBorders();break;default:throw new Error(`There is no such action "${l}"`)}R||f.adjustRowsAndCols()},adjustRowsAndCols(){const l=b.minRows,d=b.minSpareRows,h=b.minCols,C=b.minSpareCols;if(s.countRows()===0&&s.countCols()===0&&O.deselect(),l){const p=s.countRows();p<l&&c.createRow(p,l-p,{source:"auto"})}if(d){const p=s.countEmptyRows(!0);if(p<d){const S=d-p,R=Math.min(S,b.maxRows-s.countSourceRows());c.createRow(s.countRows(),R,{source:"auto"})}}{let p;(h||C)&&(p=s.countEmptyCols(!0));let S=s.countCols();if(h&&!b.columns&&S<h){const R=h-S;p+=R,c.createCol(S,R,{source:"auto"})}if(C&&!b.columns&&s.dataType==="array"&&p<C){S=s.countCols();const R=C-p,T=Math.min(R,b.maxCols-S);c.createCol(S,T,{source:"auto"})}}if(O.isSelected()){const p=s.countRows(),S=s.countCols();$(O.selectedRange,R=>{let T=!1,P=R.from.row,I=R.from.col,H=R.to.row,A=R.to.col;P>p-1?(P=p-1,T=!0,H>P&&(H=P)):H>p-1&&(H=p-1,T=!0,P>H&&(P=H)),I>S-1?(I=S-1,T=!0,A>I&&(A=I)):A>S-1&&(A=S-1,T=!0,I>A&&(I=A)),T&&s.selectCell(P,I,H,A)})}s.view&&s.view.adjustElementsSize()},populateFromArray(l,d,h,C,p){let S,R,T,P;const I=[],H={},A=[],B=l.row,D=l.col;if(R=d.length,R===0)return!1;let K=0,oe=0;switch(Pt(h)&&(K=h.col-D+1,oe=h.row-B+1),p){case"shift_down":const fe=Qo(d),G=fe.length,k=Math.max(G,K),J=s.getData().slice(B),q=Qo(J).slice(D,D+k);for(T=0;T<k;T+=1)if(T<G){for(S=0,R=fe[T].length;S<oe-R;S+=1)fe[T].push(fe[T][S%R]);T<q.length?A.push(fe[T].concat(q[T])):A.push(fe[T].concat(new Array(J.length).fill(null)))}else A.push(fe[T%G].concat(q[T]));s.populateFromArray(B,D,Qo(A));break;case"shift_right":const ee=d.length,Se=Math.max(ee,oe),ue=s.getData().slice(B).map(Ye=>Ye.slice(D));for(S=0;S<Se;S+=1)if(S<ee){for(T=0,P=d[S].length;T<K-P;T+=1)d[S].push(d[S][T%P]);if(S<ue.length)for(let Ye=0;Ye<ue[S].length;Ye+=1)d[S].push(ue[S][Ye]);else d[S].push(...new Array(ue[0].length).fill(null))}else d.push(d[S%R].slice(0,Se).concat(ue[S]));s.populateFromArray(B,D,d);break;case"overwrite":default:H.row=l.row,H.col=l.col;let Dt=0,Ke=0,Ge=!0,Vt;const gs=function(lo){let Ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ft=d[lo%d.length];return Ct!==null?Ft[Ct%Ft.length]:Ft},ms=d.length,Xo=h?h.row-l.row+1:0;for(h?R=Xo:R=Math.max(ms,Xo),S=0;S<R&&!(h&&H.row>h.row&&Xo>ms||!b.allowInsertRow&&H.row>s.countRows()-1||H.row>=b.maxRows);S++){const Ye=S-Dt,lo=gs(Ye).length,Ct=h?h.col-l.col+1:0;if(h?P=Ct:P=Math.max(lo,Ct),H.col=l.col,Vt=s.getCellMeta(H.row,H.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Vt.skipRowOnPaste){Dt+=1,H.row+=1,R+=1;continue}for(Ke=0,T=0;T<P&&!(h&&H.col>h.col&&Ct>lo||!b.allowInsertColumn&&H.col>s.countCols()-1||H.col>=b.maxCols);T++){if(Vt=s.getCellMeta(H.row,H.col),(C==="CopyPaste.paste"||C==="Autofill.fill")&&Vt.skipColumnOnPaste){Ke+=1,H.col+=1,P+=1;continue}if(Vt.readOnly&&C!=="UndoRedo.undo"){H.col+=1;continue}const Ft=T-Ke;let Ve=gs(Ye,Ft),Fe=s.getDataAtCell(H.row,H.col);if(Ve!==null&&typeof Ve=="object")if(Array.isArray(Ve)&&Fe===null&&(Fe=[]),Fe===null||typeof Fe!="object")Ge=!1;else{const ws=Nn(Array.isArray(Fe)?Fe:Fe[0]||Fe),ps=Nn(Array.isArray(Ve)?Ve:Ve[0]||Ve);Qr(ws,ps)||Array.isArray(ws)&&Array.isArray(ps)?Ve=ft(Ve):Ge=!1}else Fe!==null&&typeof Fe=="object"&&(Ge=!1);Ge&&I.push([H.row,H.col,Ve]),Ge=!0,H.col+=1}H.row+=1}s.setDataAtCell(I,null,null,C||"populateFromArray");break}}};function te(l){const d=Ai(l);fs(d)?(s.runHooks("beforeLanguageChange",d),E.language=d,s.runHooks("afterLanguageChange",d)):Ni(l)}function Ce(l,d){const h=l==="className"?s.rootElement:s.table;if(m)Y(h,d);else{let C=[],p=[];E[l]&&(C=Array.isArray(E[l])?E[l]:Is(E[l])),d&&(p=Array.isArray(d)?d:Is(d));const S=Ms(C,p),R=Ms(p,C);S.length&&me(h,S),R.length&&Y(h,R)}E[l]=d}this.init=function(){u.setData(b.data),s.runHooks("beforeInit"),(Ht()||Oc())&&Y(s.rootElement,"mobile"),this.updateSettings(b,!0),this.view=new Uh(this),g=Ic.getInstance(s,b,O),w=new Md(s),Ao(this)&&um(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),m&&s.rootElement.offsetParent===null&&Mc(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof m=="object"&&(s.runHooks("afterChange",m[0],m[1]),m=!1),s.runHooks("afterInit")};function de(){let l=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,l=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&l===!1&&(l=!0,this.onQueueEmpty(this.valid))}}}function ro(l){const d=l.replace(",",".");return isNaN(parseFloat(d))===!1?parseFloat(d):l}function je(l,d,h){if(!l.length)return;const C=s.getActiveEditor(),p=new de;let S=!0;p.onQueueEmpty=R=>{C&&S&&C.cancelChanges(),h(R)};for(let R=l.length-1;R>=0;R--){const[T,P,,I]=l[R],H=c.propToCol(P),A=s.getCellMeta(T,H);A.type==="numeric"&&typeof I=="string"&&Lc(I)&&(l[R][3]=ro(I)),s.getCellValidator(A)&&(p.addValidatorToQueue(),s.validateCell(l[R][3],A,function(B,D){return function(K){if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");if(K===!1&&D.allowInvalid===!1){S=!1,l.splice(B,1),D.valid=!0;const oe=s.getCell(D.visualRow,D.visualCol);oe!==null&&me(oe,b.invalidCellClassName)}p.removeValidatorFormQueue()}}(R,A),d))}p.checkIfQueueIsEmpty()}function _t(l,d){let h=l.length-1;if(h<0)return;for(;h>=0;h--){let p=!1;if(l[h]===null){l.splice(h,1);continue}if(!((l[h][2]===null||l[h][2]===void 0)&&(l[h][3]===null||l[h][3]===void 0))){if(b.allowInsertRow)for(;l[h][0]>s.countRows()-1;){const{delta:S}=c.createRow(void 0,void 0,{source:d});if(S===0){p=!0;break}}if(s.dataType==="array"&&(!b.columns||b.columns.length===0)&&b.allowInsertColumn)for(;c.propToCol(l[h][1])>s.countCols()-1;){const{delta:S}=c.createCol(void 0,void 0,{source:d});if(S===0){p=!0;break}}p||c.set(l[h][0],l[h][1],l[h][3])}}s.forceFullRender=!0,f.adjustRowsAndCols(),s.runHooks("beforeChangeRender",l,d),g.lockEditor(),s._refreshBorders(null),g.unlockEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",l,d||"edit");const C=s.getActiveEditor();C&&W(C.refreshValue)&&C.refreshValue()}this._createCellCoords=function(l,d){return s.view._wt.createCellCoords(l,d)},this._createCellRange=function(l,d,h){return s.view._wt.createCellRange(l,d,h)},this.validateCell=function(l,d,h,C){let p=s.getCellValidator(d);function S(R){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||d.hidden===!0){h(R);return}const P=d.visualCol,I=d.visualRow,H=s.getCell(I,P,!0);if(H&&H.nodeName!=="TH"){const A=s.rowIndexMapper.getRenderableFromVisualIndex(I),B=s.columnIndexMapper.getRenderableFromVisualIndex(P);s.view._wt.getSetting("cellRenderer",A,B,H)}h(R)}xc(p)&&(p=function(R){return function(T,P){P(R.test(T))}}(p)),ae(p)?(l=s.runHooks("beforeValidate",l,d.visualRow,d.prop,C),s._registerImmediate(()=>{p.call(d,l,R=>{s&&(R=s.runHooks("afterValidate",R,l,d.visualRow,d.prop,C),d.valid=R,S(R),s.runHooks("postAfterValidate",R,l,d.visualRow,d.prop,C))})})):s._registerImmediate(()=>{d.valid=!0,S(d.valid,!1)})};function Ue(l,d,h){return Array.isArray(l)?l:[[l,d,h]]}function pt(l,d){const h=s.getActiveEditor(),C=s.runHooks("beforeChange",l,d||"edit"),p=l.filter(S=>S!==null);return C===!1||p.length===0?(h&&h.cancelChanges(),[]):p}this.setDataAtCell=function(l,d,h,C){const p=Ue(l,d,h),S=[];let R=C,T,P,I;for(T=0,P=p.length;T<P;T++){if(typeof p[T]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof p[T][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");p[T][1]>=this.countCols()?I=p[T][1]:I=c.colToProp(p[T][1]),S.push([p[T][0],I,u.getAtCell(this.toPhysicalRow(p[T][0]),p[T][1]),p[T][2]])}!R&&typeof l=="object"&&(R=d);const H=pt(S,C);s.runHooks("afterSetDataAtCell",H,R),je(H,R,()=>{_t(H,R)})},this.setDataAtRowProp=function(l,d,h,C){const p=Ue(l,d,h),S=[];let R=C,T,P;for(T=0,P=p.length;T<P;T++)S.push([p[T][0],p[T][1],u.getAtCell(this.toPhysicalRow(p[T][0]),p[T][1]),p[T][2]]);!R&&typeof l=="object"&&(R=d);const I=pt(S,C);s.runHooks("afterSetDataAtRowProp",I,R),je(I,R,()=>{_t(I,R)})},this.listen=function(){s&&!s.isListening()&&(On.forEach(l=>{s!==l&&l.unlisten()}),En=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(En=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return En===s.guid},this.destroyEditor=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s._refreshBorders(l,d)},this.populateFromArray=function(l,d,h,C,p,S,R){if(!(typeof h=="object"&&typeof h[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const T=typeof C=="number"?s._createCellCoords(C,p):null;return f.populateFromArray(s._createCellCoords(l,d),h,T,S,R)},this.spliceCol=function(l,d,h){for(var C=arguments.length,p=new Array(C>3?C-3:0),S=3;S<C;S++)p[S-3]=arguments[S];return c.spliceCol(l,d,h,...p)},this.spliceRow=function(l,d,h){for(var C=arguments.length,p=new Array(C>3?C-3:0),S=3;S<C;S++)p[S-3]=arguments[S];return c.spliceRow(l,d,h,...p)},this.getSelected=function(){if(O.isSelected())return Zt(O.getSelectedRange(),l=>{let{from:d,to:h}=l;return[d.row,d.col,h.row,h.col]})},this.getSelectedLast=function(){const l=this.getSelected();let d;return l&&l.length>0&&(d=l[l.length-1]),d},this.getSelectedRange=function(){if(O.isSelected())return Array.from(O.getSelectedRange())},this.getSelectedRangeLast=function(){const l=this.getSelectedRange();let d;return l&&l.length>0&&(d=l[l.length-1]),d},this.emptySelectedCells=function(l){if(!O.isSelected()||this.countRows()===0||this.countCols()===0)return;const d=[];$(O.getSelectedRange(),h=>{if(h.isSingleHeader())return;const C=h.getTopStartCorner(),p=h.getBottomEndCorner();Qe(C.row,p.row,S=>{Qe(C.col,p.col,R=>{this.getCellMeta(S,R).readOnly||d.push([S,R,null])})})}),d.length>0&&this.setDataAtCell(d,l)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const l=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(l,0),!this.isRenderSuspended()&&l===this.renderSuspendedCounter&&(this.renderCall?this.render():this._refreshBorders(null))},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||(g.lockEditor(),this._refreshBorders(null),g.unlockEditor()))},this.batchRender=function(l){this.suspendRender();const d=l();return this.resumeRender(),d},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const d=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(d,0),(!this.isExecutionSuspended()&&d===this.executionSuspendedCounter||l)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const h=l();return this.resumeExecution(d),h},this.batch=function(l){this.suspendRender(),this.suspendExecution();const d=l();return this.resumeExecution(),this.resumeRender(),d},this.refreshDimensions=function(){if(!s.view)return;const{width:l,height:d}=s.view.getLastSize(),{width:h,height:C}=s.rootElement.getBoundingClientRect(),p=h!==l||C!==d;s.runHooks("beforeRefreshDimensions",{width:l,height:d},{width:h,height:C},p)!==!1&&((p||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(h,C),s.render()),s.runHooks("afterRefreshDimensions",{width:l,height:d},{width:h,height:C},p))},this.updateData=function(l,d){Sr(l,h=>{c=h},h=>{c=h,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),f.adjustRowsAndCols()},{hotInstance:s,dataMap:c,dataSource:u,internalSource:"updateData",source:d,metaManager:M,firstRun:m})},this.loadData=function(l,d){Sr(l,h=>{c=h},()=>{M.clearCellsCache(),s.initIndexMappers(),f.adjustRowsAndCols(),m&&(m=[null,"loadData"])},{hotInstance:s,dataMap:c,dataSource:u,internalSource:"loadData",source:d,metaManager:M,firstRun:m})},this.getInitialColumnCount=function(){const l=b.columns;let d=0;if(Array.isArray(l))d=l.length;else if(ae(l))if(s.dataType==="array"){const h=this.countSourceCols();for(let C=0;C<h;C+=1)l(C)&&(d+=1)}else(s.dataType==="object"||s.dataType==="function")&&(d=c.colToPropCache.length);else if(W(b.dataSchema)){const h=c.getSchema();d=Array.isArray(h)?h.length:qr(h)}else d=this.countSourceCols();return d},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(l,d,h,C){return Le(l)?c.getAll():c.getRange(s._createCellCoords(l,d),s._createCellCoords(h,C),c.DESTINATION_RENDERER)},this.getCopyableText=function(l,d,h,C){return c.getCopyableText(s._createCellCoords(l,d),s._createCellCoords(h,C))},this.getCopyableData=function(l,d){return c.getCopyable(l,c.colToProp(d))},this.getSchema=function(){return c.getSchema()},this.updateSettings=function(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const h=(m?s.loadData:s.updateData).bind(this);let C=!1,p,S;if(W(l.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(W(l.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(W(l.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(p in l)p==="data"||(p==="language"?te(l.language):p==="className"?Ce("className",l.className):p==="tableClassName"&&s.table?(Ce("tableClassName",l.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):Me.getSingleton().isRegistered(p)||Me.getSingleton().isDeprecated(p)?(ae(l[p])||Array.isArray(l[p]))&&(l[p].initialHook=!0,s.addHook(p,l[p])):!d&&Jt(l,p)&&(E[p]=l[p]));l.data===void 0&&b.data===void 0?h(null,"updateSettings"):l.data!==void 0?h(l.data,"updateSettings"):l.columns!==void 0&&(c.createMap(),s.initIndexMappers());const R=s.countCols(),T=b.columns;if(T&&ae(T)&&(C=!0),(l.cell!==void 0||l.cells!==void 0||l.columns!==void 0)&&M.clearCache(),R>0)for(p=0,S=0;p<R;p++){if(T){const H=C?T(p):T[S];H&&M.updateColumnMeta(S,H)}S+=1}W(l.cell)&&pe(l.cell,H=>{s.setCellMetaObject(H.row,H.col,H)}),s.runHooks("afterCellMetaReset");let P=s.rootElement.style.height;P!==""&&(P=parseInt(s.rootElement.style.height,10));let I=l.height;if(ae(I)&&(I=I()),d&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),I===null){const H=s.rootElement.getAttribute("data-initialstyle");H&&(H.indexOf("height")>-1||H.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",H):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else I!==void 0&&(s.rootElement.style.height=isNaN(I)?`${I}`:`${I}px`,s.rootElement.style.overflow="hidden");if(typeof l.width<"u"){let H=l.width;ae(H)&&(H=H()),s.rootElement.style.width=isNaN(H)?`${H}`:`${H}px`}d||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",l)),f.adjustRowsAndCols(),s.view&&!m&&(s.forceFullRender=!0,g.lockEditor(),s._refreshBorders(null),s.view._wt.wtOverlays.adjustElementsSize(),g.unlockEditor()),!d&&s.view&&(P===""||I===""||I===void 0)&&P!==I&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const l=s.getSelectedLast();if(b.getValue){if(ae(b.getValue))return b.getValue.call(s);if(l)return s.getData()[l[0][0]][b.getValue]}else if(l)return s.getDataAtCell(l[0],l[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(l,d,h,C,p){f.alter(l,d,h,C,p)},this.getCell=function(l,d){let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,C=d,p=l;if(d>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(d)))return null;C=this.columnIndexMapper.getRenderableFromVisualIndex(d)}if(l>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(l)))return null;p=this.rowIndexMapper.getRenderableFromVisualIndex(l)}return p===null||C===null?null:s.view.getCellAtCoords(s._createCellCoords(p,C),h)},this.getCoords=function(l){const d=this.view._wt.wtTable.getCoords(l);if(d===null)return null;const{row:h,col:C}=d;let p=h,S=C;return h>=0&&(p=this.rowIndexMapper.getVisualFromRenderableIndex(h)),C>=0&&(S=this.columnIndexMapper.getVisualFromRenderableIndex(C)),s._createCellCoords(p,S)},this.colToProp=function(l){return c.colToProp(l)},this.propToCol=function(l){return c.propToCol(l)},this.toVisualRow=l=>this.rowIndexMapper.getVisualFromPhysicalIndex(l),this.toVisualColumn=l=>this.columnIndexMapper.getVisualFromPhysicalIndex(l),this.toPhysicalRow=l=>this.rowIndexMapper.getPhysicalFromVisualIndex(l),this.toPhysicalColumn=l=>this.columnIndexMapper.getPhysicalFromVisualIndex(l),this.getDataAtCell=function(l,d){return c.get(l,c.colToProp(d))},this.getDataAtRowProp=function(l,d){return c.get(l,d)},this.getDataAtCol=function(l){const d=[],h=c.getRange(s._createCellCoords(0,l),s._createCellCoords(b.data.length-1,l),c.DESTINATION_RENDERER);for(let C=0;C<h.length;C+=1)for(let p=0;p<h[C].length;p+=1)d.push(h[C][p]);return d},this.getDataAtProp=function(l){const d=[],h=c.getRange(s._createCellCoords(0,c.propToCol(l)),s._createCellCoords(b.data.length-1,c.propToCol(l)),c.DESTINATION_RENDERER);for(let C=0;C<h.length;C+=1)for(let p=0;p<h[C].length;p+=1)d.push(h[C][p]);return d},this.getSourceData=function(l,d,h,C){let p;return l===void 0?p=u.getData():p=u.getByRange(s._createCellCoords(l,d),s._createCellCoords(h,C)),p},this.getSourceDataArray=function(l,d,h,C){let p;return l===void 0?p=u.getData(!0):p=u.getByRange(s._createCellCoords(l,d),s._createCellCoords(h,C),!0),p},this.getSourceDataAtCol=function(l){return u.getAtColumn(l)},this.setSourceDataAtCell=function(l,d,h,C){const p=Ue(l,d,h),S=this.hasHook("afterSetSourceDataAtCell"),R=[];S&&$(p,P=>{let[I,H,A]=P;R.push([I,H,u.getAtCell(I,H),A])}),$(p,P=>{let[I,H,A]=P;u.setAtCell(I,H,A)}),S&&this.runHooks("afterSetSourceDataAtCell",R,C),this.render();const T=s.getActiveEditor();T&&W(T.refreshValue)&&T.refreshValue()},this.getSourceDataAtRow=function(l){return u.getAtRow(l)},this.getSourceDataAtCell=function(l,d){return u.getAtCell(l,d)},this.getDataAtRow=function(l){return c.getRange(s._createCellCoords(l,0),s._createCellCoords(l,this.countCols()-1),c.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(l,d,h,C){const p=l===void 0?[0,0,this.countRows(),this.countCols()]:[l,d,h,C],[S,R]=p;let[,,T,P]=p,I=null,H=null;T===void 0&&(T=S),P===void 0&&(P=R);let A="mixed";return Qe(Math.max(Math.min(S,T),0),Math.max(S,T),B=>{let D=!0;return Qe(Math.max(Math.min(R,P),0),Math.max(R,P),K=>(H=this.getCellMeta(B,K).type,I?D=I===H:I=H,D)),A=D?H:"mixed",D}),A},this.removeCellMeta=function(l,d,h){const[C,p]=[this.toPhysicalRow(l),this.toPhysicalColumn(d)];let S=M.getCellMetaKeyValue(C,p,h);s.runHooks("beforeRemoveCellMeta",l,d,h,S)!==!1&&(M.removeCellMeta(C,p,h),s.runHooks("afterRemoveCellMeta",l,d,h,S)),S=null},this.spliceCellsMeta=function(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var h=arguments.length,C=new Array(h>2?h-2:0),p=2;p<h;p++)C[p-2]=arguments[p];if(C.length>0&&!Array.isArray(C[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");d>0&&M.removeRow(this.toPhysicalRow(l),d),C.length>0&&$(C.reverse(),S=>{M.createRow(this.toPhysicalRow(l)),$(S,(R,T)=>this.setCellMetaObject(l,T,R))}),s.render()},this.setCellMetaObject=function(l,d,h){typeof h=="object"&&pe(h,(C,p)=>{this.setCellMeta(l,d,p,C)})},this.setCellMeta=function(l,d,h,C){if(s.runHooks("beforeSetCellMeta",l,d,h,C)===!1)return;let S=l,R=d;l<this.countRows()&&(S=this.toPhysicalRow(l)),d<this.countCols()&&(R=this.toPhysicalColumn(d)),M.setCellMeta(S,R,h,C),s.runHooks("afterSetCellMeta",l,d,h,C)},this.getCellsMeta=function(){return M.getCellsMeta()},this.getCellMeta=function(l,d){let h=this.toPhysicalRow(l),C=this.toPhysicalColumn(d);return h===null&&(h=l),C===null&&(C=d),M.getCellMeta(h,C,{visualRow:l,visualColumn:d})},this.getCellMetaAtRow=function(l){return M.getCellsMetaAtRow(l)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||b.columns)},this.getCellRenderer=function(l,d){const h=typeof l=="number"?s.getCellMeta(l,d).renderer:l.renderer;return typeof h=="string"?Ts(h):Le(h)?Ts("text"):h},this.getCellEditor=function(l,d){const h=typeof l=="number"?s.getCellMeta(l,d).editor:l.editor;return typeof h=="string"?Hs(h):Le(h)?Hs("text"):h},this.getCellValidator=function(l,d){const h=typeof l=="number"?s.getCellMeta(l,d).validator:l.validator;return typeof h=="string"?Pc(h):h},this.validateCells=function(l){this._validateCells(l)},this.validateRows=function(l,d){if(!Array.isArray(l))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(d,l)},this.validateColumns=function(l,d){if(!Array.isArray(l))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(d,void 0,l)},this._validateCells=function(l,d,h){const C=new de;l&&(C.onQueueEmpty=l);let p=s.countRows()-1;for(;p>=0;){if(d!==void 0&&d.indexOf(p)===-1){p-=1;continue}let S=s.countCols()-1;for(;S>=0;){if(h!==void 0&&h.indexOf(S)===-1){S-=1;continue}C.addValidatorToQueue(),s.validateCell(s.getDataAtCell(p,S),s.getCellMeta(p,S),R=>{if(typeof R!="boolean")throw new Error("Validation error: result is not boolean");R===!1&&(C.valid=!1),C.removeValidatorFormQueue()},"validateCells"),S-=1}p-=1}C.checkIfQueueIsEmpty()},this.getRowHeader=function(l){let d=b.rowHeaders,h=l;return h!==void 0&&(h=s.runHooks("modifyRowHeader",h)),h===void 0?(d=[],Qe(s.countRows()-1,C=>{d.push(s.getRowHeader(C))})):Array.isArray(d)&&d[h]!==void 0?d=d[h]:ae(d)?d=d(h):d&&typeof d!="string"&&typeof d!="number"&&(d=h+1),d},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(b.colHeaders!==void 0&&b.colHeaders!==null)return!!b.colHeaders;for(let l=0,d=s.countCols();l<d;l++)if(s.getColHeader(l))return!0;return!1},this.getColHeader=function(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const h=s.runHooks("modifyColHeader",l);if(h===void 0){const T=[],P=s.countCols();for(let I=0;I<P;I++)T.push(s.getColHeader(I));return T}let C=b.colHeaders;const p=function(T){const P=[],I=s.countCols();let H=0;for(;H<I;H++)ae(b.columns)&&b.columns(H)&&P.push(H);return P[T]},S=s.toPhysicalColumn(h),R=p(S);return b.colHeaders===!1?C=null:b.columns&&ae(b.columns)&&b.columns(R)&&b.columns(R).title?C=b.columns(R).title:b.columns&&b.columns[S]&&b.columns[S].title?C=b.columns[S].title:Array.isArray(b.colHeaders)&&b.colHeaders[S]!==void 0?C=b.colHeaders[S]:ae(b.colHeaders)?C=b.colHeaders(S):b.colHeaders&&typeof b.colHeaders!="string"&&typeof b.colHeaders!="number"&&(C=Ac(h)),C=s.runHooks("modifyColumnHeaderValue",C,l,d),C},this._getColWidthFromSettings=function(l){let d;if(l>=0&&(d=s.getCellMeta(0,l).width),(d===void 0||d===b.width)&&(d=b.colWidths),d!=null){switch(typeof d){case"object":d=d[l];break;case"function":d=d(l);break}typeof d=="string"&&(d=parseInt(d,10))}return d},this.getColWidth=function(l){let d=s._getColWidthFromSettings(l);return d=s.runHooks("modifyColWidth",d,l),d===void 0&&(d=zr.DEFAULT_WIDTH),d},this._getRowHeightFromSettings=function(l){let d=b.rowHeights;if(d!=null){switch(typeof d){case"object":d=d[l];break;case"function":d=d(l);break}typeof d=="string"&&(d=parseInt(d,10))}return d},this.getRowHeight=function(l){let d=s._getRowHeightFromSettings(l);return d=s.runHooks("modifyRowHeight",d,l),d},this.countSourceRows=function(){return u.countRows()},this.countSourceCols=function(){return u.countFirstRowKeys()},this.countRows=function(){return c.getLength()},this.countCols=function(){const l=b.maxCols,d=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(l,d)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,d=0;return Es(s.countRows()-1,h=>{if(s.isEmptyRow(h))d+=1;else if(l===!0)return!1}),d},this.countEmptyCols=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,d=0;return Es(s.countCols()-1,h=>{if(s.isEmptyCol(h))d+=1;else if(l===!0)return!1}),d},this.isEmptyRow=function(l){return b.isEmptyRow.call(s,l)},this.isEmptyCol=function(l){return b.isEmptyCol.call(s,l)},this.selectCell=function(l,d,h,C){let p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,S=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Le(l)||Le(d)?!1:this.selectCells([[l,d,h,C]],p,S)},this.selectCells=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;d===!1&&(i=!0);const C=O.selectCells(l);return C&&h&&s.listen(),i=!1,C},this.selectColumns=function(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:l,h=arguments.length>2?arguments[2]:void 0;return O.selectColumns(l,d,h)},this.selectRows=function(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:l,h=arguments.length>2?arguments[2]:void 0;return O.selectRows(l,d,h)},this.deselectCell=function(){O.deselect()},this.selectAll=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:l,h=arguments.length>2?arguments[2]:void 0;i=!0,O.selectAll(l,d,h),i=!1};const Lt=(l,d)=>l.getNearestNotHiddenIndex(d,1,!0);this.scrollViewportTo=function(l){var d;if(typeof l=="number"){var h;l={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(h=arguments[4])!==null&&h!==void 0?h:!0}}const{row:C,col:p,verticalSnap:S,horizontalSnap:R,considerHiddenIndexes:T}=(d=l)!==null&&d!==void 0?d:{};let P,I,H,A;S!==void 0&&(P=S==="top",I=!P),R!==void 0&&(H=R==="start",A=!H);let B=C,D=p;if(T===void 0||T){const fe=Number.isInteger(C)&&C>=0,G=Number.isInteger(p)&&p>=0,k=fe?Lt(this.rowIndexMapper,C):void 0,J=G?Lt(this.columnIndexMapper,p):void 0;if(k===null||J===null)return!1;B=fe?s.rowIndexMapper.getRenderableFromVisualIndex(k):C,D=G?s.columnIndexMapper.getRenderableFromVisualIndex(J):p}const K=Number.isInteger(B),oe=Number.isInteger(D);return K&&B>=0&&oe&&D>=0?s.view.scrollViewport(s._createCellCoords(B,D),P,A,I,H):K&&B>=0&&(oe&&D<0||!oe)?s.view.scrollViewportVertically(B,P,I):oe&&D>=0&&(K&&B<0||!K)?s.view.scrollViewportHorizontally(D,A,H):!1},this.scrollToFocusedCell=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",l);const{highlight:d}=this.getSelectedRangeLast();this.scrollViewportTo(d.toObject())?this.view.render():(this.removeHook("afterScroll",l),this._registerImmediate(()=>l()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),u&&u.destroy(),u=null,this.getShortcutManager().destroy(),M.clearCache(),On.delete(this.guid),Ao(s)){const l=this.rootDocument.querySelector(".hot-display-license-info");l&&l.parentNode.removeChild(l)}Lo(s.rootElement),a.destroy(),g&&g.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),j.getItems().forEach(l=>{let[,d]=l;d.destroy()}),j.clear(),s.runHooks("afterDestroy")},!0),Me.getSingleton().destroy(s),pe(s,(l,d,h)=>{ae(l)?h[d]=io(d):d!=="guid"&&(h[d]=null)}),s.isDestroyed=!0,c&&c.destroy(),c=null,f=null,O=null,g=null,s=null};function io(l){return()=>{throw new Error(`The "${l}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return g.getActiveEditor()},this.getPlugin=function(l){const d=Zr(l);return d==="UndoRedo"?this.undoRedo:j.getItem(d)},this.getPluginName=function(l){return l===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:j.getId(l)},this.getInstance=function(){return s},this.addHook=function(l,d){Me.getSingleton().add(l,d,s)},this.hasHook=function(l){return Me.getSingleton().has(l,s)||Me.getSingleton().has(l)},this.addHookOnce=function(l,d){Me.getSingleton().once(l,d,s)},this.removeHook=function(l,d){Me.getSingleton().remove(l,d,s)},this.runHooks=function(l,d,h,C,p,S,R){return Me.getSingleton().run(s,l,d,h,C,p,S,R)},this.getTranslatedPhrase=function(l,d){return Fi(b.language,l,d)},this.toHTML=()=>Os(this),this.toTableElement=()=>{const l=this.rootDocument.createElement("div");return l.insertAdjacentHTML("afterbegin",Os(this)),l.firstElementChild},this.timeouts=[],this._registerTimeout=function(l){let d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,h=l;typeof h=="function"&&(h=setTimeout(h,d)),this.timeouts.push(h)},this._clearTimeouts=function(){$(this.timeouts,l=>{clearTimeout(l)})},this.immediates=[],this._registerImmediate=function(l){this.immediates.push(setImmediate(l))},this._clearImmediates=function(){$(this.immediates,l=>{clearImmediate(l)})},this._refreshBorders=function(){let l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;g.destroyEditor(l),s.view.render(),d&&O.isSelected()&&g.prepareEditor()},this._getEditorManager=function(){return g},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const V=Cm({handleEvent(){return s.isListening()},beforeKeyDown:l=>this.runHooks("beforeKeyDown",l),afterKeyDown:l=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",l)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",l=>{l.ctrlKey===!1&&l.metaKey===!1&&V.releasePressedKeys()}),this.getShortcutManager=function(){return V},this.getFocusManager=function(){return w},Nc().forEach(l=>{const d=_c(l);j.addItem(l,new d(this))}),cm(s),V.setActiveContextName("grid"),Me.getSingleton().run(s,"construct")}Vc(Bc);He.editors={BaseEditor:Fc};function He(o,e){const t=new Zi(o,e||{},us);return t.init(),t}He.Core=function(o){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Zi(o,e,us)};He.DefaultSettings=Ki();He.hooks=Me.getSingleton();He.CellCoords=Br;He.CellRange=Wr;He.packageName="handsontable";He.buildDate="30/11/2023 10:10:40";He.version="14.0.0";He.languages={dictionaryKeys:yf,getLanguageDictionary:Vi,getLanguagesDictionaries:Of,registerLanguageDictionary:Di,getTranslatedPhrase:Fi};var It=Symbol("unassigned"),Sm="The Handsontable instance bound to this component was destroyed and cannot be used properly.";function jo(o,e){return Object.prototype.hasOwnProperty.call(o,e)}function Ji(o){var e=He.hooks.getRegistered(),t={};Object.assign(t,He.DefaultSettings);for(var n in t)t[n]={default:It};for(var r=0;r<e.length;r++)t[e[r]]={default:It};return t.settings={default:It},o==="HotTable"&&(t.id={type:String,default:"hot-".concat(Math.random().toString(36).substring(5))}),t}function el(o){var e={},t=o.settings;if(t!==It)for(var n in t)jo(t,n)&&t[n]!==It&&(e[n]=t[n]);for(var r in o)jo(o,r)&&r!=="settings"&&o[r]!==It&&(e[r]=o[r]);return e}function Er(o,e){var t=el(o),n=o.settings?o.settings:t,r=o.settings?t:null,i={};for(var s in n)jo(n,s)&&n[s]!==void 0&&(!(e&&s!=="data")||!Or(e[s],n[s]))&&(i[s]=n[s]);for(var a in r)jo(r,a)&&a!=="id"&&a!=="settings"&&r[a]!==void 0&&(!(e&&a!=="data")||!Or(e[a],r[a]))&&(i[a]=r[a]);return i}function Or(o,e){return JSON.stringify(o)===JSON.stringify(e)}var bm="14.0.0",tl=ti({name:"HotTable",props:Ji("HotTable"),provide:function(){return{columnsCache:this.columnsCache}},watch:{$props:{handler:function(e){var t=Er(e,this.hotInstance?this.hotInstance.getSettings():void 0);!this.hotInstance||t===void 0||(t.data&&(this.hotInstance.isColumnModificationAllowed()||!this.hotInstance.isColumnModificationAllowed()&&this.hotInstance.countSourceCols()===this.miscCache.currentSourceColumns)&&(this.matchHotMappersSize(),delete t.data),Object.keys(t).length?this.hotInstance.updateSettings(t):this.hotInstance.render(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols())},deep:!0,immediate:!0}},data:function(){return{__hotInstance:null,miscCache:{currentSourceColumns:null},columnSettings:null,columnsCache:new Map,get hotInstance(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(Sm),null)},set hotInstance(e){this.__hotInstance=e}}},methods:{hotInit:function(){var e=Er(this.$props);e.columns=this.columnSettings?this.columnSettings:e.columns,this.hotInstance=Wc(new He.Core(this.$el,e)),this.hotInstance.init(),this.miscCache.currentSourceColumns=this.hotInstance.countSourceCols()},matchHotMappersSize:function(){var e=this;if(this.hotInstance){var t=this.hotInstance.getSourceData(),n=[],r=[],i=this.hotInstance.rowIndexMapper.getNumberOfIndexes(),s=this.hotInstance.isColumnModificationAllowed(),a=0;if(t&&t.length!==i&&t.length<i)for(var c=t.length;c<i;c++)n.push(c);if(s){var u;if(a=this.hotInstance.columnIndexMapper.getNumberOfIndexes(),t&&t[0]&&((u=t[0])===null||u===void 0?void 0:u.length)!==a&&t[0].length<a)for(var f=t[0].length;f<a;f++)r.push(f)}this.hotInstance.batch(function(){n.length>0?e.hotInstance.rowIndexMapper.removeIndexes(n):e.hotInstance.rowIndexMapper.insertIndexes(i-1,t.length-i),s&&t.length!==0&&(r.length>0?e.hotInstance.columnIndexMapper.removeIndexes(r):e.hotInstance.columnIndexMapper.insertIndexes(a-1,t[0].length-a))})}},getColumnSettings:function(){var e=Array.from(this.columnsCache.values());return e.length?e:void 0}},mounted:function(){this.columnSettings=this.getColumnSettings(),this.hotInit()},beforeUnmount:function(){this.hotInstance&&this.hotInstance.destroy()},version:bm}),vm=["id"];function ym(o,e,t,n,r,i){return kc(),$c("div",{id:o.id},[zc(o.$slots,"default")],8,vm)}tl.render=ym;tl.__file="src/HotTable.vue";function Ir(o,e){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(o);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(o,r).enumerable})),t.push.apply(t,n)}return t}function Rm(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ir(Object(t),!0).forEach(function(n){Tm(o,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):Ir(Object(t)).forEach(function(n){Object.defineProperty(o,n,Object.getOwnPropertyDescriptor(t,n))})}return o}function Tm(o,e,t){return e=Em(e),e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function Hm(o,e){if(typeof o!="object"||o===null)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function Em(o){var e=Hm(o,"string");return typeof e=="symbol"?e:String(e)}var Om=ti({name:"HotColumn",props:Ji("HotColumn"),inject:["columnsCache"],methods:{createColumnSettings:function(){var e=el(this.$props),t=Rm({},e);e.renderer&&(t.renderer=e.renderer),e.editor&&(t.editor=e.editor),this.columnsCache.set(this,t)}},mounted:function(){this.createColumnSettings()},unmounted:function(){this.columnsCache.delete(this)},render:function(){return null}});Om.__file="src/HotColumn.vue";export{He as H,tl as a,Mm as g};
