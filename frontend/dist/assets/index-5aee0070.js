import{c as commonjsGlobal,g as getDefaultExportFromCjs}from"./_commonjsHelpers-725317a4.js";var jsuites$1={exports:{}};(function(n,s){(function(p,A){n.exports=A()})(commonjsGlobal,function(){return function(){var d={195:function(q){(function(c,r){q.exports=r()})(this,function(){return function(Le){function r(Me,Ne){this.highOrder=Me,this.lowOrder=Ne}var b=[new r(1779033703,4089235720),new r(3144134277,2227873595),new r(1013904242,4271175723),new r(2773480762,1595750129),new r(1359893119,2917565137),new r(2600822924,725511199),new r(528734635,4215389547),new r(1541459225,327033209)],H=[new r(1116352408,3609767458),new r(1899447441,602891725),new r(3049323471,3964484399),new r(3921009573,2173295548),new r(961987163,4081628472),new r(1508970993,3053834265),new r(2453635748,2937671579),new r(2870763221,3664609560),new r(3624381080,2734883394),new r(310598401,1164996542),new r(607225278,1323610764),new r(1426881987,3590304994),new r(1925078388,4068182383),new r(2162078206,991336113),new r(2614888103,633803317),new r(3248222580,3479774868),new r(3835390401,2666613458),new r(4022224774,944711139),new r(264347078,2341262773),new r(604807628,2007800933),new r(770255983,1495990901),new r(1249150122,1856431235),new r(1555081692,3175218132),new r(1996064986,2198950837),new r(2554220882,3999719339),new r(2821834349,766784016),new r(2952996808,2566594879),new r(3210313671,3203337956),new r(3336571891,1034457026),new r(3584528711,2466948901),new r(113926993,3758326383),new r(338241895,168717936),new r(666307205,1188179964),new r(773529912,1546045734),new r(1294757372,1522805485),new r(1396182291,2643833823),new r(1695183700,2343527390),new r(1986661051,1014477480),new r(2177026350,1206759142),new r(2456956037,344077627),new r(2730485921,1290863460),new r(2820302411,3158454273),new r(3259730800,3505952657),new r(3345764771,106217008),new r(3516065817,3606008344),new r(3600352804,1432725776),new r(4094571909,1467031594),new r(275423344,851169720),new r(430227734,3100823752),new r(506948616,1363258195),new r(659060556,3750685593),new r(883997877,3785050280),new r(958139571,3318307427),new r(1322822218,3812723403),new r(1537002063,2003034995),new r(1747873779,3602036899),new r(1955562222,1575990012),new r(2024104815,1125592928),new r(2227730452,2716904306),new r(2361852424,442776044),new r(2428436474,593698344),new r(2756734187,3733110249),new r(3204031479,2999351573),new r(3329325298,3815920427),new r(3391569614,3928383900),new r(3515267271,566280711),new r(3940187606,3454069534),new r(4118630271,4000239992),new r(116418474,1914138554),new r(174292421,2731055270),new r(289380356,3203993006),new r(460393269,320620315),new r(685471733,587496836),new r(852142971,1086792851),new r(1017036298,365543100),new r(1126000580,2618297676),new r(1288033470,3409855158),new r(1501505948,4234509866),new r(1607167915,987167468),new r(1816402316,1246189591)],_=new Array(64),g,u,m,j,h,C,T,I,B,S,N,F,G=8;function U(Me){return unescape(encodeURIComponent(Me))}function se(Me){for(var Ne=[],Oe=(1<<G)-1,ze=Me.length*G,Ge=0;Ge<ze;Ge+=G)Ne[Ge>>5]|=(Me.charCodeAt(Ge/G)&Oe)<<32-G-Ge%32;return Ne}function ge(Me){for(var Ne="0123456789abcdef",Oe="",ze=Me.length*4,Ge,Qe=0;Qe<ze;Qe+=1)Ge=Me[Qe>>2]>>(3-Qe%4)*8,Oe+=Ne.charAt(Ge>>4&15)+Ne.charAt(Ge&15);return Oe}function ie(Me,Ne){var Oe,ze,Ge,Qe;return Oe=(Me.lowOrder&65535)+(Ne.lowOrder&65535),ze=(Me.lowOrder>>>16)+(Ne.lowOrder>>>16)+(Oe>>>16),Ge=(ze&65535)<<16|Oe&65535,Oe=(Me.highOrder&65535)+(Ne.highOrder&65535)+(ze>>>16),ze=(Me.highOrder>>>16)+(Ne.highOrder>>>16)+(Oe>>>16),Qe=(ze&65535)<<16|Oe&65535,new r(Qe,Ge)}function xe(Me,Ne,Oe,ze){var Ge,Qe,ct,at;return Ge=(Me.lowOrder&65535)+(Ne.lowOrder&65535)+(Oe.lowOrder&65535)+(ze.lowOrder&65535),Qe=(Me.lowOrder>>>16)+(Ne.lowOrder>>>16)+(Oe.lowOrder>>>16)+(ze.lowOrder>>>16)+(Ge>>>16),ct=(Qe&65535)<<16|Ge&65535,Ge=(Me.highOrder&65535)+(Ne.highOrder&65535)+(Oe.highOrder&65535)+(ze.highOrder&65535)+(Qe>>>16),Qe=(Me.highOrder>>>16)+(Ne.highOrder>>>16)+(Oe.highOrder>>>16)+(ze.highOrder>>>16)+(Ge>>>16),at=(Qe&65535)<<16|Ge&65535,new r(at,ct)}function Te(Me,Ne,Oe,ze,Ge){var Qe,ct,at,dt;return Qe=(Me.lowOrder&65535)+(Ne.lowOrder&65535)+(Oe.lowOrder&65535)+(ze.lowOrder&65535)+(Ge.lowOrder&65535),ct=(Me.lowOrder>>>16)+(Ne.lowOrder>>>16)+(Oe.lowOrder>>>16)+(ze.lowOrder>>>16)+(Ge.lowOrder>>>16)+(Qe>>>16),at=(ct&65535)<<16|Qe&65535,Qe=(Me.highOrder&65535)+(Ne.highOrder&65535)+(Oe.highOrder&65535)+(ze.highOrder&65535)+(Ge.highOrder&65535)+(ct>>>16),ct=(Me.highOrder>>>16)+(Ne.highOrder>>>16)+(Oe.highOrder>>>16)+(ze.highOrder>>>16)+(Ge.highOrder>>>16)+(Qe>>>16),dt=(ct&65535)<<16|Qe&65535,new r(dt,at)}function ve(Me,Ne,Oe){return new r(Me.highOrder&Ne.highOrder^Me.highOrder&Oe.highOrder^Ne.highOrder&Oe.highOrder,Me.lowOrder&Ne.lowOrder^Me.lowOrder&Oe.lowOrder^Ne.lowOrder&Oe.lowOrder)}function ae(Me,Ne,Oe){return new r(Me.highOrder&Ne.highOrder^~Me.highOrder&Oe.highOrder,Me.lowOrder&Ne.lowOrder^~Me.lowOrder&Oe.lowOrder)}function ke(Me,Ne){return Ne<=32?new r(Me.highOrder>>>Ne|Me.lowOrder<<32-Ne,Me.lowOrder>>>Ne|Me.highOrder<<32-Ne):new r(Me.lowOrder>>>Ne|Me.highOrder<<32-Ne,Me.highOrder>>>Ne|Me.lowOrder<<32-Ne)}function Ke(Me){var Ne=ke(Me,28),Oe=ke(Me,34),ze=ke(Me,39);return new r(Ne.highOrder^Oe.highOrder^ze.highOrder,Ne.lowOrder^Oe.lowOrder^ze.lowOrder)}function Ue(Me){var Ne=ke(Me,14),Oe=ke(Me,18),ze=ke(Me,41);return new r(Ne.highOrder^Oe.highOrder^ze.highOrder,Ne.lowOrder^Oe.lowOrder^ze.lowOrder)}function Be(Me){var Ne=ke(Me,1),Oe=ke(Me,8),ze=Y(Me,7);return new r(Ne.highOrder^Oe.highOrder^ze.highOrder,Ne.lowOrder^Oe.lowOrder^ze.lowOrder)}function lt(Me){var Ne=ke(Me,19),Oe=ke(Me,61),ze=Y(Me,6);return new r(Ne.highOrder^Oe.highOrder^ze.highOrder,Ne.lowOrder^Oe.lowOrder^ze.lowOrder)}function Y(Me,Ne){return Ne<=32?new r(Me.highOrder>>>Ne,Me.lowOrder>>>Ne|Me.highOrder<<32-Ne):new r(0,Me.highOrder<<32-Ne)}var Le=U(Le),qe=Le.length*G;Le=se(Le),Le[qe>>5]|=128<<24-qe%32,Le[(qe+128>>10<<5)+31]=qe;for(var B=0;B<Le.length;B+=32){g=b[0],u=b[1],m=b[2],j=b[3],h=b[4],C=b[5],T=b[6],I=b[7];for(var S=0;S<80;S++)S<16?_[S]=new r(Le[S*2+B],Le[S*2+B+1]):_[S]=xe(lt(_[S-2]),_[S-7],Be(_[S-15]),_[S-16]),N=Te(I,Ue(h),ae(h,C,T),H[S],_[S]),F=ie(Ke(g),ve(g,u,m)),I=T,T=C,C=h,h=ie(j,N),j=m,m=u,u=g,g=ie(N,F);b[0]=ie(g,b[0]),b[1]=ie(u,b[1]),b[2]=ie(m,b[2]),b[3]=ie(j,b[3]),b[4]=ie(h,b[4]),b[5]=ie(C,b[5]),b[6]=ie(T,b[6]),b[7]=ie(I,b[7])}for(var mt=[],B=0;B<b.length;B++)mt.push(b[B].highOrder),mt.push(b[B].lowOrder);return ge(mt)}})}},p={};function A(q){var c=p[q];if(c!==void 0)return c.exports;var r=p[q]={exports:{}};return d[q].call(r.exports,r,r.exports,A),r.exports}(function(){A.n=function(q){var c=q&&q.__esModule?function(){return q.default}:function(){return q};return A.d(c,{a:c}),c}})(),function(){A.d=function(q,c){for(var r in c)A.o(c,r)&&!A.o(q,r)&&Object.defineProperty(q,r,{enumerable:!0,get:c[r]})}}(),function(){A.o=function(q,c){return Object.prototype.hasOwnProperty.call(q,c)}}();var k={};return function(){A.d(k,{default:function(){return Tt}});var q={};q.two=function(w){return w=""+w,w.length==1&&(w="0"+w),w},q.focus=function(w){if(w.innerText.length){var E=document.createRange(),l=window.getSelection(),o=w.childNodes[w.childNodes.length-1];E.setStart(o,o.length),E.collapse(!0),l.removeAllRanges(),l.addRange(E),w.scrollLeft=w.scrollWidth}},q.isNumeric=function(w){return typeof w=="string"&&(w=w.trim()),!isNaN(w)&&w!==null&&w!==""},q.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(w){var E=Math.random()*16|0,l=w=="x"?E:E&3|8;return l.toString(16)})},q.getNode=function(){var w=document.getSelection().anchorNode;return w?w.nodeType==3?w.parentNode:w:null},q.hash=function(w){var E=0,l,o;if(w.length===0)return E;for(l=0;l<w.length;l++)o=w.charCodeAt(l),o>32&&(E=(E<<5)-E+o,E|=0);return E},q.randomColor=function(w){var E=-.25,l=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");l.length<6&&(l=l[0]+l[0]+l[1]+l[1]+l[2]+l[2]);var o=[],O,Q;for(Q=0;Q<3;Q++)O=parseInt(l.substr(Q*2,2),16),O=Math.round(Math.min(Math.max(0,O+O*E),255)).toString(16),o.push(("00"+O).substr(O.length));return w==!0?"#"+q.two(o[0].toString(16))+q.two(o[1].toString(16))+q.two(o[2].toString(16)):o},q.getWindowWidth=function(){var w=window,E=document,l=E.documentElement,o=E.getElementsByTagName("body")[0],O=w.innerWidth||l.clientWidth||o.clientWidth;return O},q.getWindowHeight=function(){var w=window,E=document,l=E.documentElement,o=E.getElementsByTagName("body")[0],O=w.innerHeight||l.clientHeight||o.clientHeight;return O},q.getPosition=function(w){if(w.changedTouches&&w.changedTouches[0])var E=w.changedTouches[0].pageX,l=w.changedTouches[0].pageY;else var E=window.Event?w.pageX:w.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),l=window.Event?w.pageY:w.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[E,l]},q.click=function(w){if(w.click)w.click();else{var E=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});w.dispatchEvent(E)}},q.findElement=function(w,E){var l=!1;function o(O){O&&!l&&(typeof E=="function"?l=E(O):typeof E=="string"&&O.classList&&O.classList.contains(E)&&(l=O)),O.parentNode&&!l&&o(O.parentNode)}return o(w),l};var c=q;function r(){var w={};w.now=function(O,Q){var ee=null,D=null,M=null,V=null,K=null,oe=null;return Array.isArray(O)?(ee=O[0],D=O[1],M=O[2],V=O[3],K=O[4],oe=O[5]):(O||(O=new Date),ee=O.getFullYear(),D=O.getMonth()+1,M=O.getDate(),V=O.getHours(),K=O.getMinutes(),oe=O.getSeconds()),Q==!0?c.two(ee)+"-"+c.two(D)+"-"+c.two(M):c.two(ee)+"-"+c.two(D)+"-"+c.two(M)+" "+c.two(V)+":"+c.two(K)+":"+c.two(oe)},w.toArray=function(O){var ee=O.split(O.indexOf("T")!==-1?"T":" "),Q=ee[1],ee=ee[0].split("-"),D=parseInt(ee[0]),M=parseInt(ee[1]),V=parseInt(ee[2]),K=0,oe=0;return Q&&(Q=Q.split(":"),K=parseInt(Q[0]),oe=parseInt(Q[1])),[D,M,V,K,oe,0]};var E=Date.UTC(1900,0,0),l=Date.UTC(1900,1,29),o=864e5;return w.dateToNum=function(O){typeof O=="string"&&(O=new Date(O+"  GMT+0"));var Q=O.getTime();return Q>=l&&(Q+=o),Q-=E,Q/o},w.numToDate=function(O){var Q=E+O*o;Q>=l&&(Q-=o);const ee=new Date(Q);var D=[ee.getUTCFullYear(),ee.getUTCMonth()+1,ee.getUTCDate(),ee.getUTCHours(),ee.getUTCMinutes(),ee.getUTCSeconds()];return w.now(D)},w.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],w.months=["January","February","March","April","May","June","July","August","September","October","November","December"],w.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],w.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],w}var b=r(),H=function(w){document.dictionary||(document.dictionary={});var E=null,l=null,o=Object.keys(w);for(l=0;l<o.length;l++)document.dictionary[o[l]]=w[o[l]];for(l=0;l<b.weekdays.length;l++)E=_(b.weekdays[l]),b.weekdays[l]&&(b.weekdays[l]=E,b.weekdaysShort[l]=E.substr(0,3));for(l=0;l<b.months.length;l++)E=_(b.months[l]),E&&(b.months[l]=E,b.monthsShort[l]=E.substr(0,3))},_=function(w){return typeof document<"u"&&document.dictionary&&document.dictionary[w]||w},g={setDictionary:H,translate:_};function u(w,E){if(E==!0)document.jsuitesComponents=document.jsuitesComponents.filter(function(o){return o!==null}),setTimeout(function(){document.jsuitesComponents.push(w)},0);else{var l=document.jsuitesComponents.indexOf(w);l>=0&&document.jsuitesComponents.splice(l,1)}}function m(w,E,l){if(w=w.split("."),w.length){let o=this,O=null;for(;w.length>1;)if(O=w.shift(),o.hasOwnProperty(O))o=o[O];else{if(typeof E>"u")return;o[O]={},o=o[O]}if(O=w.shift(),typeof E<"u")return l===!0?delete o[O]:o[O]=E,!0;if(o)return o[O]}return!1}function j(w,E){var l={};l.options={};var o={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},O=null;for(var Q in o)E&&E.hasOwnProperty(Q)?l.options[Q]=E[Q]:l.options[Q]=o[Q];w.classList.add("jsorting"),w.addEventListener("dragstart",function(M){var V=Array.prototype.indexOf.call(M.target.parentNode.children,M.target);O={element:M.target,o:V,d:V},M.target.style.opacity="0.25",typeof l.options.ondragstart=="function"&&l.options.ondragstart(w,M.target,M)}),w.addEventListener("dragover",function(M){if(M.preventDefault(),ee(M.target)&&O&&M.target.getAttribute("draggable")=="true"&&O.element!=M.target){if(l.options.direction)var V=M.target.clientWidth/2>M.offsetX;else var V=M.target.clientHeight/2>M.offsetY;V?M.target.parentNode.insertBefore(O.element,M.target):M.target.parentNode.insertBefore(O.element,M.target.nextSibling),O.d=Array.prototype.indexOf.call(M.target.parentNode.children,O.element)}}),w.addEventListener("dragleave",function(M){M.preventDefault()}),w.addEventListener("dragend",function(M){M.preventDefault(),O&&(typeof l.options.ondragend=="function"&&l.options.ondragend(w,O.element,M),O.o<O.d?M.target.parentNode.insertBefore(O.element,M.target.parentNode.children[O.o]):M.target.parentNode.insertBefore(O.element,M.target.parentNode.children[O.o].nextSibling),O.element.style.opacity="",O=null)}),w.addEventListener("drop",function(M){M.preventDefault(),O&&O.o!=O.d&&typeof l.options.ondrop=="function"&&l.options.ondrop(w,O.o,O.d,O.element,M.target,M),O.element.style.opacity="",O=null});for(var ee=function(M){var V=!1;function K(oe){oe.className&&oe.classList.contains("jsorting")&&(V=!0),V||K(oe.parentNode)}return K(M),V},D=0;D<w.children.length;D++)w.children[D].hasAttribute("draggable")||w.children[D].setAttribute("draggable","true");return w.val=function(){for(var M=null,V=[],K=0;K<w.children.length;K++)(M=w.children[K].getAttribute("data-id"))&&V.push(M);return V},w}function h(w,E){var l={};(!E.loadUp||typeof E.loadUp!="function")&&(E.loadUp=function(){return!1}),(!E.loadDown||typeof E.loadDown!="function")&&(E.loadDown=function(){return!1}),E.timer||(E.timer=100);var o=null,O=function(Q){if(o==null){var ee=!1,D=w.scrollTop;w.scrollTop+w.clientHeight*2>=w.scrollHeight?E.loadDown()&&(D==w.scrollTop&&(w.scrollTop=w.scrollTop-w.clientHeight),ee=!0):w.scrollTop<=w.clientHeight&&E.loadUp()&&(D==w.scrollTop&&(w.scrollTop=w.scrollTop+w.clientHeight),ee=!0),o=setTimeout(function(){o=null},E.timer),ee&&typeof E.onupdate=="function"&&E.onupdate()}};return w.onscroll=function(Q){O()},w.onwheel=function(Q){O()},l}function C(){var w=function(E,l){if(Array.isArray(E)){var o={instance:[],complete:l};if(E.length>0)for(var O=0;O<E.length;O++)E[O].multiple=o,o.instance.push(w(E[O]));return o}if(E.data||(E.data={}),E.type&&(E.method=E.type),E.method||(E.method="GET"),E.dataType||(E.dataType="json"),E.data){var Q=function(oe,be){var de=[];if(oe){var fe=Object.keys(oe);if(fe.length)for(var le=0;le<fe.length;le++){if(be)var me=be+"["+fe[le]+"]";else var me=fe[le];if(oe[me]instanceof FileList)de[me]=oe[fe[le]];else if(oe[fe[le]]===null||oe[fe[le]]===void 0)de[me]="";else if(typeof oe[fe[le]]=="object")for(var Ie=Q(oe[fe[le]],me),We=Object.keys(Ie),Je=0;Je<We.length;Je++)de[We[Je]]=Ie[We[Je]];else de[me]=oe[fe[le]]}}return de},ee=Q(E.data),D=Object.keys(ee);if(E.method=="GET"){if(D.length){for(var M=[],O=0;O<D.length;O++)M.push(D[O]+"="+encodeURIComponent(ee[D[O]]));E.url.indexOf("?")<0&&(E.url+="?"),E.url+=M.join("&")}}else for(var M=new FormData,O=0;O<D.length;O++)if(ee[D[O]]instanceof FileList){if(ee[D[O]].length)for(var V=0;V<ee[D[O]].length;V++)M.append(D[O],ee[D[O]][V],ee[D[O]][V].name)}else M.append(D[O],ee[D[O]])}var K=new XMLHttpRequest;return K.open(E.method,E.url,!0),K.setRequestHeader("X-Requested-With","XMLHttpRequest"),E.contentType&&K.setRequestHeader("Content-Type",E.contentType),E.method==="POST"?K.setRequestHeader("Accept","application/json"):E.dataType==="blob"?K.responseType="blob":E.contentType||(E.dataType==="json"?K.setRequestHeader("Content-Type","text/json"):E.dataType==="html"&&K.setRequestHeader("Content-Type","text/html")),E.cache!==!0&&(K.setRequestHeader("pragma","no-cache"),K.setRequestHeader("cache-control","no-cache")),E.withCredentials===!0&&(K.withCredentials=!0),typeof E.beforeSend=="function"&&E.beforeSend(K),typeof w.beforeSend=="function"&&w.beforeSend(K),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(K),K.onload=function(){if(K.status>=200&&K.status<300)if(E.dataType==="json")try{var oe=JSON.parse(K.responseText);E.success&&typeof E.success=="function"&&E.success(oe)}catch(de){E.error&&typeof E.error=="function"&&E.error(de,oe)}else{if(E.dataType==="blob")var oe=K.response;else var oe=K.responseText;E.success&&typeof E.success=="function"&&E.success(oe)}else E.error&&typeof E.error=="function"&&E.error(K.responseText,K.status);if(w.queue&&w.queue.length>0&&w.send(w.queue.shift()),w.requests&&w.requests.length){var be=w.requests.indexOf(K);if(w.requests.splice(be,1),w.requests.length||E.complete&&typeof E.complete=="function"&&E.complete(oe),E.group&&w.oncomplete&&typeof w.oncomplete[E.group]=="function"&&(w.pending(E.group)||(w.oncomplete[E.group](),w.oncomplete[E.group]=null)),E.multiple&&E.multiple.instance){var be=E.multiple.instance.indexOf(K);E.multiple.instance.splice(be,1),E.multiple.instance.length||E.multiple.complete&&typeof E.multiple.complete=="function"&&E.multiple.complete(oe)}}},K.options=E,K.data=M,E.queue===!0&&w.requests.length>0?w.queue.push(K):w.send(K),K};return w.send=function(E){E.data?Array.isArray(E.data)?E.send(E.data.join("&")):E.send(E.data):E.send(),w.requests.push(E)},w.exists=function(E,l){var o=new XMLHttpRequest;o.open("HEAD",E,!1),o.send(),o.status&&l(o.status)},w.pending=function(E){var l=0,o=w.requests;if(o&&o.length)for(var O=0;O<o.length;O++)(!E||E==o[O].options.group)&&l++;return l},w.oncomplete={},w.requests=[],w.queue=[],w}var T=C();function I(){const w={loading:{}};return w.loading.show=function(E){w.loading.element||(w.loading.element=document.createElement("div"),w.loading.element.className="jloading"),document.body.appendChild(w.loading.element),E>0&&setTimeout(function(){w.loading.hide()},E*1e3)},w.loading.hide=function(){w.loading.element&&w.loading.element.parentNode&&document.body.removeChild(w.loading.element)},w.slideLeft=function(E,l,o){l==!0?(E.classList.add("slide-left-in"),setTimeout(function(){E.classList.remove("slide-left-in"),typeof o=="function"&&o()},400)):(E.classList.add("slide-left-out"),setTimeout(function(){E.classList.remove("slide-left-out"),typeof o=="function"&&o()},400))},w.slideRight=function(E,l,o){l===!0?(E.classList.add("slide-right-in"),setTimeout(function(){E.classList.remove("slide-right-in"),typeof o=="function"&&o()},400)):(E.classList.add("slide-right-out"),setTimeout(function(){E.classList.remove("slide-right-out"),typeof o=="function"&&o()},400))},w.slideTop=function(E,l,o){l===!0?(E.classList.add("slide-top-in"),setTimeout(function(){E.classList.remove("slide-top-in"),typeof o=="function"&&o()},400)):(E.classList.add("slide-top-out"),setTimeout(function(){E.classList.remove("slide-top-out"),typeof o=="function"&&o()},400))},w.slideBottom=function(E,l,o){l===!0?(E.classList.add("slide-bottom-in"),setTimeout(function(){E.classList.remove("slide-bottom-in"),typeof o=="function"&&o()},400)):(E.classList.add("slide-bottom-out"),setTimeout(function(){E.classList.remove("slide-bottom-out"),typeof o=="function"&&o()},100))},w.fadeIn=function(E,l){E.style.display="",E.classList.add("fade-in"),setTimeout(function(){E.classList.remove("fade-in"),typeof l=="function"&&l()},2e3)},w.fadeOut=function(E,l){E.classList.add("fade-out"),setTimeout(function(){E.style.display="none",E.classList.remove("fade-out"),typeof l=="function"&&l()},1e3)},w}var B=I();function S(){var w={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},E=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var v=0;this.date[4]&&(v=parseFloat(this.date[4]/60));var P=parseInt(this.date[3])+v;P/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?P=c.two(this.date[3])+":"+c.two(this.date[4])+":"+c.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),P=c.two(this.date[0])+"-"+c.two(this.date[1])+"-"+c.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(P+=" "+c.two(this.date[3])+":"+c.two(this.date[4])+":"+c.two(this.date[5])));return P},l=function(){var v="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)v=parseInt(this.date[3]);else{let J=parseInt(this.date[3]);J<13&&this.values.indexOf("PM")!==-1?v=(J+12)%24:v=J%24}this.date[4]&&(v+=parseFloat(this.date[4]/60)),this.date[5]&&(v+=parseFloat(this.date[5]/3600)),v/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var P=b.now(this.date);v=b.dateToNum(P),this.date[4]&&(v+=parseFloat(this.date[4]/60))}return isNaN(v)&&(v=""),v},o=function(v){return v===null||v===""||v===void 0},O=function(v){var P=(""+v)[0];return P=="="},Q=function(v){return v==="currency"||v==="percentage"||v==="numeric"},ee=function(v){if(v&&Number(v)==v)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var P=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=P[1]}else{v||(v=this.mask);var J=new RegExp("0{1}(.{1})0+","ig"),P=J.exec(v);if(P&&P[1]&&P[1].length==1)return this.options.decimal=P[1],P[1];var J=new RegExp("#{1}(.{1})#+","ig"),P=J.exec(v);P&&P[1]&&P[1].length==1?P[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},D=function(v,P){if(v=="")return"";P||(P=ee.call(this)),v=(""+v).split(P);var J=v[0].match(/[-]+/g);if(J&&J.length?J=!0:J=!1,v[0]=v[0].match(/[0-9]+/g),v[0]?(J&&v[0].unshift("-"),v[0]=v[0].join("")):J&&(v[0]="-"),v[0]||v[1])v[1]!==void 0&&(v[1]=v[1].match(/[0-9]+/g),v[1]?v[1]=v[1].join(""):v[1]="");else return"";return v},M=function(v,P){if(v==="")return"";var J=ee.call(this),he=this.options;if(v=D.call(this,v),v==="")return"";var Z=null;if(v[0]&&(he.style==="percent"?Z=parseFloat(v[0])/100:Z=parseFloat(v[0]+".1")),(v[0]==="-"||v[0]==="-00")&&!v[1]&&P&&P.inputType=="deleteContentBackward")return"";var ue=new Intl.NumberFormat(this.locale,he).format(Z);if(ue=ue.split(J),he.style==="percent"&&ue[0].indexOf("%")!==-1&&(ue[0]=ue[0].replace("%",""),ue[2]="%"),typeof ue[1]<"u"){var ye=ue[1].replace(/[0-9]*/g,"");ye&&(ue[2]=ye)}return v[1]!==void 0?ue[1]=J+v[1]:ue[1]="",ue.join("")},V=function(v,P){var J=be.call(v);if(J){var he=M.call(this,J,P),Z=he.length-J.length,ue=oe.call(v)+Z;be.call(v,he,ue,!0)}},K=function(v){var P=D.call(this,v);return P?(P[0]==="-"&&(P[0]="-0"),parseFloat(P.join("."))):null},oe=function(v,P){if(v===void 0)if(this.tagName=="DIV"){var J=0,he=window.getSelection();if(he&&he.rangeCount!==0){var Z=he.getRangeAt(0),ue=Z.cloneRange();ue.selectNodeContents(this),ue.setEnd(Z.endContainer,Z.endOffset),J=ue.toString().length}return J}else return this.selectionStart;else{var ye=be.call(this);if(P){for(var ue=null,De=0;De<ye.length;De++)(ye[De].match(/[\-0-9]/g)||ye[De]==="."||ye[De]===",")&&(ue=De);ue===null&&(ue=ye.indexOf(" ")),v>=ue&&(v=ue+1)}if(v>ye.length&&(v=ye.length),v)if(this.tagName=="DIV"){var he=window.getSelection(),Z=document.createRange();this.childNodes[0]&&(Z.setStart(this.childNodes[0],v),he.removeAllRanges(),he.addRange(Z))}else this.selectionStart=v,this.selectionEnd=v}},be=function(v,P,J){if(this.tagName=="DIV")if(v===void 0){var v=this.innerText;return this.value&&this.value.length>v.length&&(v=this.value),v}else this.innerText!==v&&(this.innerText=v,P&&oe.call(this,P,J));else{if(v===void 0)return this.value;this.value!==v&&(this.value=v,P&&oe.call(this,P,J))}},de=b.weekdays,fe=b.weekdaysShort,le=b.months,me=b.monthsShort,Ie={YEAR:function(v,P){var J=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<=10&&this.values[this.index].length<P&&(this.values[this.index]+=v),this.values[this.index].length==P){if(P==2)var J=J.substr(0,2)+this.values[this.index];else if(P==3)var J=J.substr(0,1)+this.values[this.index];else if(P==4)var J=this.values[this.index];this.date[0]=J,this.index++}},YYYY:function(v){Ie.YEAR.call(this,v,4)},YYY:function(v){Ie.YEAR.call(this,v,3)},YY:function(v){Ie.YEAR.call(this,v,2)},FIND:function(v,P){if(o(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=v;return}for(var J=0,he=0,Z=(this.values[this.index]+v).toLowerCase(),ue=0;ue<P.length;ue++)P[ue].toLowerCase().indexOf(Z)==0&&(J=ue,he++);if(he>1)this.values[this.index]+=v;else if(he==1){var ye=P[J].length-this.values[this.index].length-1;return this.position+=ye,this.values[this.index]=P[J],this.index++,J}},MMM:function(v){var P=Ie.FIND.call(this,v,me);P!==void 0&&(this.date[1]=P+1)},MON:function(v){Ie.MMM.call(this,v)},MMMM:function(v){var P=Ie.FIND.call(this,v,le);P!==void 0&&(this.date[1]=P+1)},MONTH:function(v){Ie.MMMM.call(this,v)},MMMMM:function(v){o(this.values[this.index])&&(this.values[this.index]="");for(var P=(this.values[this.index]+v).toLowerCase(),J=0;J<le.length;J++)if(le[J][0].toLowerCase().indexOf(P)==0){this.values[this.index]=le[J][0],this.date[1]=J+1,this.index++;break}},MM:function(v){o(this.values[this.index])?parseInt(v)>1&&parseInt(v)<10?(this.date[1]=this.values[this.index]="0"+v,this.index++):parseInt(v)<2&&(this.values[this.index]=v):this.values[this.index]==1&&parseInt(v)<3?(this.date[1]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[1]=this.values[this.index]+=v,this.index++)},M:function(v){var P=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(o(this.values[this.index]))this.values[this.index]=v,v>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(v)<3)this.date[1]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[1]=this.values[this.index]+=v,this.index++;else var P=!0;else var P=!0;if(P==!0){var J=parseInt(this.values[this.index]);J>0&&J<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(v){var P=!1;if(parseInt(v)>=0&&parseInt(v)<10)if(o(this.values[this.index]))this.values[this.index]=v,parseInt(v)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(v)<2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=v,this.index++;else if(this.values[this.index]==0&&parseInt(v)>0)this.date[2]=this.values[this.index]+=v,this.index++;else var P=!0;else var P=!0;if(P==!0){var J=parseInt(this.values[this.index]);J>0&&J<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(v){o(this.values[this.index])?parseInt(v)>3&&parseInt(v)<10?(this.date[2]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==3&&parseInt(v)<2?(this.date[2]=this.values[this.index]+=v,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(v)<10?(this.date[2]=this.values[this.index]+=v,this.index++):this.values[this.index]==0&&parseInt(v)>0&&parseInt(v)<10&&(this.date[2]=this.values[this.index]+=v,this.index++)},DDD:function(v){Ie.FIND.call(this,v,fe)},DY:function(v){Ie.DDD.call(this,v)},DDDD:function(v){Ie.FIND.call(this,v,de)},DAY:function(v){Ie.DDDD.call(this,v)},HH12:function(v,P){o(this.values[this.index])?parseInt(v)>1&&parseInt(v)<10?(P&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==1&&parseInt(v)<3?(this.date[3]=this.values[this.index]+=v,this.index++):this.values[this.index]<1&&parseInt(v)<10&&(this.date[3]=this.values[this.index]+=v,this.index++)},HH24:function(v,P){parseInt(v)>=0&&parseInt(v)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(v)>2&&parseInt(v)<10?(P&&(v=0+v),this.date[3]=this.values[this.index]=v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):this.values[this.index]==2&&parseInt(v)<4?(!P&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++):this.values[this.index]<2&&parseInt(v)<10&&(!P&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=v,this.index++))},HH:function(v){Ie.HH24.call(this,v,1)},H:function(v){Ie.HH24.call(this,v,0)},"\\[H\\]":function(v){this.values[this.index]==null&&(this.values[this.index]=""),v.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=v:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(v,P){this.values[this.index]==null||this.values[this.index]==""?parseInt(v)>5&&parseInt(v)<10?(this.date[P]=this.values[this.index]="0"+v,this.index++):parseInt(v)<10&&(this.values[this.index]=v):parseInt(v)<10&&(this.date[P]=this.values[this.index]+=v,this.index++)},MI:function(v){Ie.N60.call(this,v,4)},SS:function(v){Ie.N60.call(this,v,5)},"AM/PM":function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?v.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":v.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(v){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(v)>=0&&parseInt(v)<7&&(this.values[this.index]=v),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(v){var P=ee.call(this),J=!1;o(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(J=!0);var he=D.call(this,this.values[this.index],P);he&&(this.values[this.index]=he.join(P)),parseInt(v)>=0&&parseInt(v)<10?(this.values[this.index]=="0"&&v>0?this.values[this.index]="":this.values[this.index]=="-0"&&v>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||v==P)&&(this.values[this.index]+=v)):P&&v==P?this.values[this.index].indexOf(P)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=v):v=="-"&&(J=!0),J===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(v){Ie["0{1}(.{1}0+)?"].call(this,v),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(v){Ie["0{1}(.{1}0+)?"].call(this,v);var P=ee.call(this),J=this.tokens[this.index].substr(1,1),he=this.values[this.index][0]==="-",Z=D.call(this,this.values[this.index],P);if(Z!==""){var ue=Z[0].match(/[0-9]/g);if(ue){ue=ue.join("");for(var ye=[],De=0,we=ue.length-1;we>=0;we--)ye.push(ue[we]),De++,De%3||ye.push(J);ye=ye.reverse(),Z[0]=ye.join(""),Z[0].substr(0,1)==J&&(Z[0]=Z[0].substr(1))}else Z[0]="";this.values[this.index]=Z.join(P),he&&(this.values[this.index]="-"+this.values[this.index])}},0:function(v){v.match(/[0-9]/g)&&(this.values[this.index]=v,this.index++)},"[0-9a-zA-Z$]+":function(v){o(this.values[this.index])&&(this.values[this.index]="");var P=this.tokens[this.index],J=this.values[this.index],he=J.length;P[he]==v?(this.values[this.index]+=v,this.values[this.index]==P&&this.index++):(this.values[this.index]=P,this.index++,v.match(/[\-0-9]/g)&&this.position--)},A:function(v){v.match(/[a-zA-Z]/gi)&&(this.values[this.index]=v,this.index++)},".":function(v){Ie["[0-9a-zA-Z$]+"].call(this,v)},"@":function(v){o(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=v}},We=function(v){if(this.type=="general")var P=[].concat(w.general);else var P=[].concat(w.currency,w.datetime,w.percentage,w.numeric,w.text,w.general);var J=new RegExp(P.join("|"),"gi");return v.match(J)},Je=function(v){if(this.type)if(this.type=="text")var P=["text"];else if(this.type=="general")var P=["general"];else if(this.type=="datetime")var P=["numeric","datetime","general"];else var P=["currency","percentage","numeric","general"];else var P=Object.keys(w);for(var J=0;J<P.length;J++)for(var he=P[J],Z=0;Z<w[he].length;Z++){var ue=new RegExp(w[he][Z],"gi"),ye=v.match(ue);if(ye)return{type:he,method:w[he][Z]}}},ce=function(v){for(var P=[],J=0;J<v.length;J++){var he=Je.call(this,v[J]);he?P.push(he.method):P.push(null)}for(var J=0;J<P.length;J++)P[J]=="MM"&&(P[J-1]&&P[J-1].indexOf("H")>=0||P[J-2]&&P[J-2].indexOf("H")>=0||P[J+1]&&P[J+1].indexOf("S")>=0||P[J+2]&&P[J+2].indexOf("S")>=0)&&(P[J]="MI");return P},Ae=function(v){var P=Je.call(this,v);if(P)var J=P.type;if(J){for(var he=0,Z=We.call(this,v),ue=0;ue<Z.length;ue++)P=Je.call(this,Z[ue]),P&&Q(P.type)&&he++;he>1&&(J="general")}return J},X=function(){typeof Ie[this.methods[this.index]]=="function"?(Ie[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},W=function(v){return(""+ +v).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(P,J,he,Z,ue){return ue<0?J+"0."+Array(1-ue-he.length).join(0)+he+Z:J+he+Z+Array(ue-Z.length+1).join(0)})},ne=function(v,P,J){var he=null,Z={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof v=="object"){if(Z.input=v.target,Z.value=be.call(v.target),Z.caret=oe.call(v.target),(he=v.target.getAttribute("data-mask"))&&(Z.mask=he),(he=v.target.getAttribute("data-type"))&&(Z.type=he),v.target.mask?(v.target.mask.options&&(Z.options=v.target.mask.options),v.target.mask.locale&&(Z.locale=v.target.mask.locale)):(he=v.target.getAttribute("data-locale"))&&(Z.locale=he,Z.mask&&(Z.options.style=Z.mask)),v.target.attributes&&v.target.attributes.length)for(var ue=0;ue<v.target.attributes.length;ue++){var ye=v.target.attributes[ue].name,De=v.target.attributes[ue].value;ye.substr(0,4)=="data"&&(Z.options[ye.substr(5)]=De)}}else{if(typeof P=="string")Z.mask=P;else for(var ye=Object.keys(P),ue=0;ue<ye.length;ue++)Z[ye[ue]]=P[ye[ue]];typeof v=="number"&&(ee.call(Z,Z.mask),v=(""+v).replace(".",Z.options.decimal)),Z.value=v,Z.input&&(be.call(Z.input,v),c.focus(Z.input),Z.caret=oe.call(Z.input))}if(!O(Z.value)&&(Z.mask||Z.locale)){if(Z.mask){if(Z.mask=Z.mask.replace(new RegExp(/\[h]/),"|h|"),Z.mask=Z.mask.replace(new RegExp(/\[.*?\]/),""),Z.mask=Z.mask.replace(new RegExp(/\|h\|/),"[h]"),Z.mask.indexOf(";")!==-1){var he=Z.mask.split(";");Z.mask=he[0]}if(Z.mask.indexOf("##")!==-1){var we=Z.mask.split(";");we[0]&&(typeof v=="object"&&(we[0]=we[0].replace(new RegExp(/_\)/g),""),we[0]=we[0].replace(new RegExp(/_\(/g),"")),we[0]=we[0].replace("*","	"),we[0]=we[0].replace(new RegExp(/_-/g),""),we[0]=we[0].replace(new RegExp(/_/g),""),we[0]=we[0].replace("##0.###","##0.000"),we[0]=we[0].replace("##0.##","##0.00"),we[0]=we[0].replace("##0.#","##0.0"),we[0]=we[0].replace("##0,###","##0,000"),we[0]=we[0].replace("##0,##","##0,00"),we[0]=we[0].replace("##0,#","##0,0")),Z.mask=we[0]}if(Z.mask.indexOf("\\")!==-1){var we=Z.mask.split(";");we[0]=we[0].replace(new RegExp(/\\/g),""),Z.mask=we[0]}Z.type||(Z.type=Ae.call(Z,Z.mask)),Z.tokens=We.call(Z,Z.mask)}if(typeof v!="object"||!v.inputType||!v.inputType.indexOf("insert")||!v.inputType.indexOf("delete"))if(Z.locale)if(Z.input)V.call(Z,Z.input,v);else var Fe=M.call(Z,Z.value);else{for(Z.methods=ce.call(Z,Z.tokens),Z.event=v;Z.position<Z.value.length&&typeof Z.tokens[Z.index]<"u";)X.call(Z);var Fe=Z.values.join("");if(Q(Z.type)&&Fe!==""){for(;typeof Z.tokens[Z.index]<"u";){var he=Je.call(Z,Z.tokens[Z.index]);he&&he.type=="general"&&(Z.values[Z.index]=Z.tokens[Z.index]),Z.index++}var Ve=!0}else var Ve=!1;if(Fe=Z.values.join(""),Z.input){if(he=Fe.length-Z.value.length,he>0)var Ze=Z.caret+he;else var Ze=Z.caret;be.call(Z.input,Fe,Ze,Ve)}}if(Z.input){var te=null;if(Q(Z.type)){let je=be.call(Z.input);Z.number=K.call(Z,je),Z.type=="percentage"&&je.indexOf("%")!==-1?te=ne.adjustPrecision(Z.number/100):te=Z.number}else Z.type=="datetime"&&(te=E.call(Z),Z.date[0]&&Z.date[1]&&Z.date[2]&&Z.input.setAttribute("data-completed",!0));te&&Z.input.setAttribute("data-value",te)}if(Fe!==void 0)return J?Z:Fe}};return ne.adjustPrecision=function(v){if(typeof v=="number"&&!Number.isInteger(v)){const P=v.toString().split(".");if(P[1]&&P[1].length>10){let J=0;const he=P[1][P[1].length-2];if(he==0||he==9){for(let Z=P[1].length-2;Z>0;Z--)if(J>=0&&P[1][Z]==he){if(J++,J>6)break}else{J=0;break}if(J)return parseFloat(parseFloat(v).toFixed(P[1].length-1))}}}return v},ne.getType=Ae,ne.prepare=function(v,P){return P||(P={}),We.call(P,v)},ne.apply=function(v){var P=be.call(v.target);v.key.length==1&&(P+=v.key),be.call(v.target,ne(P,v.target.getAttribute("data-mask")))},ne.run=function(v,P,J){return ne(v,{mask:P,decimal:J})},ne.extract=function(v,P,J){if(o(v)||typeof P!="object")return v;if(P=Object.assign({},P),P.options||(P.options={}),!P.mask&&P.format&&(P.mask=P.format),P.mask){if(P.mask.indexOf(";")!==-1){var he=P.mask.split(";");P.mask=he[0]}P.mask=P.mask.replace(new RegExp(/\[h]/),"|h|"),P.mask=P.mask.replace(new RegExp(/\[.*?\]/),""),P.mask=P.mask.replace(new RegExp(/\|h\|/),"[h]")}ee.call(P,P.mask);var Z=null,ue=null;if(P.type=="percent"||P.options.style=="percent"?Z="percentage":P.mask&&(Z=Ae.call(P,P.mask)),Z==="general"){var ye=ne(v,P,!0);ue=v}else if(Z==="datetime"){v instanceof Date&&(v=ne.getDateString(v,P.mask));var ye=ne(v,P,!0);c.isNumeric(v)?ue=v:ue=l.call(ye)}else{ue=K.call(P,v),Z==="percentage"&&v.indexOf("%")!==-1&&(ue/=100);var ye=P}return ye.value=ue,!ye.type&&Z&&(ye.type=Z),J?ye:ue},ne.render=function(v,P,J){if(o(v)||typeof P!="object")return v;if(P=Object.assign({},P),P.options||(P.options={}),!P.mask&&P.format&&(P.mask=P.format),P.mask){if(P.mask.indexOf(";")!==-1){var he=P.mask.split(";");J||(he[0]=he[0].replace(new RegExp(/_\)/g),""),he[0]=he[0].replace(new RegExp(/_\(/g),"")),P.mask=he[0]}P.mask=P.mask.replace(new RegExp(/\[h]/),"|h|"),P.mask=P.mask.replace(new RegExp(/\[.*?\]/),""),P.mask=P.mask.replace(new RegExp(/\|h\|/),"[h]")}var Z=null;P.type=="percent"||P.options.style=="percent"?Z="percentage":P.mask?Z=Ae.call(P,P.mask):v instanceof Date&&(Z="datetime");var ue=!1;if(Z=="datetime"||P.type=="calendar"){var he=ne.getDateString(v,P.mask);he&&(v=he),P.mask&&J&&(ue=!0)}else if(Z==="percentage"&&(v=ne.adjustPrecision(v*100)),typeof v=="number"){var he=null;if(P.mask&&J&&(""+v).indexOf("e")===-1){var ye=ee.call(P,P.mask);P.mask.indexOf(ye)!==-1?(ye=P.mask.split(ye),ye=""+ye[1].match(/[0-9]+/g),ye=ye.length,he=v.toFixed(ye)):he=v.toFixed(0)}else if(P.locale&&J){var ye=(""+v).split(".");if(P.options){typeof ye[1]>"u"&&(ye[1]="");var we=ye[1].length;if(P.options.minimumFractionDigits>we)for(var De=0;De<P.options.minimumFractionDigits-we;De++)ye[1]+="0"}ye[1].length?he=ye.join("."):he=ye[0];var we=ye[1].length;P.options&&P.options.maximumFractionDigits<we&&(he=parseFloat(he).toFixed(P.options.maximumFractionDigits))}else he=W(v);he!==null&&(v=he,ee.call(P,P.mask),P.options.decimal&&(v=v.replace(".",P.options.decimal)))}else P.mask&&J&&(ue=!0);if(ue){var Fe=P.mask.length-v.length;if(Fe>0)for(var De=0;De<Fe;De++)v+=" "}if(v=ne(v,P),J&&Z==="numeric"){var Ve=P.mask.match(new RegExp(/^[0]+$/gm));if(Ve&&Ve.length===1){var Ze=Ve[0].length;if(Ze>3)for(v=""+v;v.length<Ze;)v="0"+v}}return v},ne.set=function(v,P){if(P){v.setAttribute("data-mask",P);var J=new Event("input",{bubbles:!0,cancelable:!0});v.dispatchEvent(J)}},ne.extractDateFromString=function(v,P){var J=ne(v,{mask:P},!0);if(v>0&&Number(v)==v&&(J.values.join("")!==J.value||J.type=="numeric")){var he=new Date(Math.round((v-25569)*86400*1e3));return he.getFullYear()+"-"+c.two(he.getMonth())+"-"+c.two(he.getDate())+" 00:00:00"}var Z=!1;return J.values.length===J.tokens.length&&J.values[J.values.length-1].length>=J.tokens[J.tokens.length-1].length&&(Z=!0),J.date[0]&&J.date[1]&&(J.date[2]||Z)?(J.date[2]||(J.date[2]=1),J.date[0]+"-"+c.two(J.date[1])+"-"+c.two(J.date[2])+" "+c.two(J.date[3])+":"+c.two(J.date[4])+":"+c.two(J.date[5])):""},ne.getDateString=function(v,P){if(!P)var P={};if(P&&typeof P=="object")var J=P.format;else var J=P;if(J||(J="YYYY-MM-DD"),J.indexOf("[h]")>=0){var he=0;if(v&&c.isNumeric(v)&&(he=parseFloat(24*Number(v)),J.indexOf("mm")>=0)){var Z=(""+he).split(".");if(Z[1]){var ue=60*parseFloat("0."+Z[1]);ue=parseFloat(ue.toFixed(2))}else var ue=0;he=parseInt(Z[0])+":"+c.two(ue)}return he}v instanceof Date?v=b.now(v):v&&c.isNumeric(v)&&(v=b.numToDate(v));for(var ye=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],De=new RegExp(ye.join("|"),"gi"),we=J.match(De),Fe=0;Fe<we.length;Fe++)we[Fe].toUpperCase()=="MM"&&(we[Fe-1]&&we[Fe-1].toUpperCase().indexOf("H")>=0||we[Fe-2]&&we[Fe-2].toUpperCase().indexOf("H")>=0||we[Fe+1]&&we[Fe+1].toUpperCase().indexOf("S")>=0||we[Fe+2]&&we[Fe+2].toUpperCase().indexOf("S")>=0)&&(we[Fe]="mi");var Ve={tokens:we};if(v){var ue=""+v,Ze=ue.indexOf("T")!==-1?"T":" ";ue=ue.split(Ze);var Z=0,te=0,je=0;if(ue[1]&&(Z=ue[1].split(":"),te=Z[1]?Z[1]:0,je=Z[2]?Z[2]:0,Z=Z[0]?Z[0]:0),ue=ue[0].split("-"),ue[0]&&ue[1]&&ue[2]&&ue[0]>0&&ue[1]>0&&ue[1]<13&&ue[2]>0&&ue[2]<32){Ve.data=[ue[0],ue[1],ue[2],Z,te,je],Ve.value=[];for(var Ce=new Date(Ve.data[0],Ve.data[1]-1,Ve.data[2],Ve.data[3],Ve.data[4],Ve.data[5]),He=function(ot){var st=this.tokens[ot],Pe=st.toUpperCase(),Ye=null;Pe==="YYYY"?Ye=this.data[0]:Pe==="YYY"?Ye=this.data[0].substring(1,4):Pe==="YY"?Ye=this.data[0].substring(2,4):Pe==="Y"?Ye=this.data[0].substring(3,4):st==="MON"?Ye=b.months[Ce.getMonth()].substr(0,3).toUpperCase():st==="mon"?Ye=b.months[Ce.getMonth()].substr(0,3).toLowerCase():st==="MONTH"?Ye=b.months[Ce.getMonth()].toUpperCase():st==="month"?Ye=b.months[Ce.getMonth()].toLowerCase():Pe==="MMMMM"?Ye=b.months[Ce.getMonth()].substr(0,1):Pe==="MMMM"||st==="Month"?Ye=b.months[Ce.getMonth()]:Pe==="MMM"||st=="Mon"?Ye=b.months[Ce.getMonth()].substr(0,3):Pe==="MM"?Ye=c.two(this.data[1]):Pe==="M"?Ye=Ce.getMonth()+1:st==="DAY"?Ye=b.weekdays[Ce.getDay()].toUpperCase():st==="day"?Ye=b.weekdays[Ce.getDay()].toLowerCase():Pe==="DDDD"||st=="Day"?Ye=b.weekdays[Ce.getDay()]:Pe==="DDD"?Ye=b.weekdays[Ce.getDay()].substr(0,3):Pe==="DD"?Ye=c.two(this.data[2]):Pe==="D"?Ye=parseInt(this.data[2]):Pe==="Q"?Ye=Math.floor((Ce.getMonth()+3)/3):Pe==="HH24"||Pe==="HH"?(Ye=this.data[3],Ye>12&&this.tokens.indexOf("am/pm")!==-1&&(Ye-=12),Ye=c.two(Ye)):Pe==="HH12"?this.data[3]>12?Ye=c.two(this.data[3]-12):Ye=c.two(this.data[3]):Pe==="H"?(Ye=this.data[3],Ye>12&&this.tokens.indexOf("am/pm")!==-1&&(Ye-=12,Ye=c.two(Ye))):Pe==="MI"?Ye=c.two(this.data[4]):Pe==="SS"?Ye=c.two(this.data[5]):Pe==="MS"?Ye=Ce.getMilliseconds():Pe==="AM/PM"?this.data[3]>=12?Ye="PM":Ye="AM":Pe==="WD"&&(Ye=b.weekdays[Ce.getDay()]),Ye===null?this.value[ot]=this.tokens[ot]:this.value[ot]=Ye},Fe=0;Fe<Ve.tokens.length;Fe++)He.call(Ve,Fe);v=Ve.value.join("")}else v=""}return v},ne}var N=S();function F(){var w=function(E,l){if(E.calendar)return E.calendar.setOptions(l,!0);var o={type:"calendar"};o.options={},o.date=null,o.setOptions=function(W,ne){var v={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:b.monthsShort,monthsFull:b.months,weekdays:b.weekdays,textDone:g.translate("Done"),textReset:g.translate("Reset"),textUpdate:g.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var P in v)W&&W.hasOwnProperty(P)?o.options[P]=W[P]:(typeof o.options[P]>"u"||ne===!0)&&(o.options[P]=v[P]);if(o.options.resetButton==!1?M.style.display="none":M.style.display="",o.options.readonly?E.setAttribute("readonly","readonly"):E.removeAttribute("readonly"),o.options.placeholder?E.setAttribute("placeholder",o.options.placeholder):E.removeAttribute("placeholder"),c.isNumeric(o.options.value)&&o.options.value>0&&(o.options.value=w.numToDate(o.options.value),o.options.dataType="numeric"),M.innerHTML=o.options.textReset,V.innerHTML=o.options.textDone,Je.innerHTML=o.options.textUpdate,E.setAttribute("data-mask",o.options.format.toLowerCase()),!o.options.value&&o.options.today)var J=w.now();else var J=o.options.value;return J&&(o.options.value=null,o.setValue(J)),o},o.open=function(W){if(!D.classList.contains("jcalendar-focus")&&!D.classList.contains("jcalendar-inline")){if(w.current=o,u(o,!0),o.getDays(),o.options.type=="year-month-picker"&&o.getMonths(),o.options.time&&(ce.value=o.date[3],Ae.value=o.date[4]),D.classList.add("jcalendar-focus"),c.getWindowWidth()<800||o.options.fullscreen)D.classList.add("jcalendar-fullsize"),B.slideBottom(oe,1);else{D.classList.remove("jcalendar-fullsize");var ne=E.getBoundingClientRect(),v=oe.getBoundingClientRect();if(o.options.position)K.style.position="fixed",window.innerHeight<ne.bottom+v.height?K.style.top=ne.top-(v.height+2)+"px":K.style.top=ne.top+ne.height+2+"px",K.style.left=ne.left+"px";else{if(window.innerHeight<ne.bottom+v.height){var P=-1*(ne.height+v.height+2);P+ne.top<0&&(P=-1*(ne.top+ne.height)),K.style.top=P+"px"}else K.style.top="2px";if(window.innerWidth<ne.left+v.width){var P=window.innerWidth-(ne.left+v.width+20);K.style.left=P+"px"}else K.style.left="0px"}}typeof o.options.onopen=="function"&&o.options.onopen(E)}},o.close=function(W,ne){if(o.options.autoSelect!==!0&&typeof ne>"u"&&(ne=!1),D.classList.contains("jcalendar-focus")){if(ne!==!1){var v=D.querySelector(".jcalendar-selected");if(typeof ne=="string")var P=ne;else if(!v||v.classList.contains("jcalendar-disabled"))var P=o.options.value;else var P=o.getValue();o.setValue(P)}else if(o.options.value){let J=o.options.value;o.options.value="",o.setValue(J)}!W&&typeof o.options.onclose=="function"&&o.options.onclose(E),D.classList.remove("jcalendar-focus"),u(o,!1),w.current=null}return o.options.value},o.prev=function(){o.options.mode=="years"?(o.date[0]=o.date[0]-12,o.getYears()):o.options.mode=="months"?(o.date[0]=parseInt(o.date[0])-1,o.getMonths()):(o.date[1]<2?(o.date[0]=o.date[0]-1,o.date[1]=12):o.date[1]=o.date[1]-1,o.getDays())},o.next=function(){o.options.mode=="years"?(o.date[0]=parseInt(o.date[0])+12,o.getYears()):o.options.mode=="months"?(o.date[0]=parseInt(o.date[0])+1,o.getMonths()):(o.date[1]>11?(o.date[0]=parseInt(o.date[0])+1,o.date[1]=1):o.date[1]=parseInt(o.date[1])+1,o.getDays())},o.setToday=function(){var W=new Date().toISOString().substr(0,10);return o.setValue(W),W},o.setValue=function(W){W||(W=""+W);var ne=W,v=o.options.value;if(v!=ne){if(ne){o.setLabel(ne,o.options);var J=ne.split(" ");J[1]||(J[1]="00:00:00");var P=J[1].split(":"),J=J[0].split("-"),he=parseInt(J[0]),Z=parseInt(J[1]),ue=parseInt(J[2]),ye=parseInt(P[0]),De=parseInt(P[1]);o.date=[he,Z,ue,ye,De,0];var W=o.setLabel(ne,o.options),we=w.now(new Date(he,Z-1,ue),!0);if(o.options.validRange){if(!o.options.validRange[0]||we>=o.options.validRange[0])var Fe=!0;else var Fe=!1;if(!o.options.validRange[1]||we<=o.options.validRange[1])var Ve=!0;else var Ve=!1;Fe&&Ve?(E.classList.remove("jcalendar_warning"),E.title=""):(E.classList.add("jcalendar_warning"),E.title=g.translate("Date outside the valid range"))}else E.classList.remove("jcalendar_warning"),E.title=""}else{o.date=null;var W="";E.classList.remove("jcalendar_warning"),E.title=""}o.options.value=ne,typeof o.options.onchange=="function"&&o.options.onchange(E,ne,v),E.value!=W&&(E.value=W,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))}o.getDays(),o.options.type=="year-month-picker"&&o.getMonths()},o.getValue=function(){return o.date?o.options.time?c.two(o.date[0])+"-"+c.two(o.date[1])+"-"+c.two(o.date[2])+" "+c.two(o.date[3])+":"+c.two(o.date[4])+":"+c.two(0):c.two(o.date[0])+"-"+c.two(o.date[1])+"-"+c.two(o.date[2])+" "+c.two(0)+":"+c.two(0)+":"+c.two(0):""},o.update=function(W,ne){if(!W.classList.contains("jcalendar-disabled")){var v=D.querySelector(".jcalendar-selected");v&&v.classList.remove("jcalendar-selected"),W.classList.add("jcalendar-selected"),W.classList.contains("jcalendar-set-month")?(o.date[1]=ne,o.date[2]=1):o.date[2]=W.innerText,o.options.time?(o.date[3]=ce.value,o.date[4]=Ae.value):o.close(null,!0)}ee()},o.reset=function(){o.setValue(""),o.date=null,o.close(!1,!1)},o.getDays=function(){o.options.mode="days";var ye=new Date,W=o.date&&c.isNumeric(o.date[0])?o.date[0]:parseInt(ye.getFullYear()),ne=o.date&&c.isNumeric(o.date[1])?o.date[1]:parseInt(ye.getMonth())+1,v=o.date&&c.isNumeric(o.date[2])?o.date[2]:parseInt(ye.getDate()),P=o.date&&c.isNumeric(o.date[3])?o.date[3]:parseInt(ye.getHours()),J=o.date&&c.isNumeric(o.date[4])?o.date[4]:parseInt(ye.getMinutes());o.date=[W,ne,v,P,J,0],be.innerHTML=W,de.innerHTML=o.options.months[ne-1];var he=ye.getMonth()==ne-1&&ye.getFullYear()==W,Z=ye.getDate(),ye=new Date(W,ne,0,0,0),ue=ye.getDate(),ye=new Date(W,ne-1,0,0,0),De=ye.getDay()+1,Ze=o.options.startingDay||0;De=De-Ze,le.innerHTML="";var we=document.createElement("tr");we.setAttribute("align","center"),le.appendChild(we);for(var Fe=0;Fe<7;Fe++){var Ve=document.createElement("td");Ve.classList.add("jcalendar-weekday"),Ve.innerHTML=o.options.weekdays[Ze].substr(0,1),we.appendChild(Ve),Ze++,Ze>6&&(Ze=0)}for(var Ze=0,te=0,je=0;je<6;je++){var we=document.createElement("tr");we.setAttribute("align","center"),we.style.height="34px";for(var Fe=0;Fe<7;Fe++){var Ve=document.createElement("td");if(Ve.classList.add("jcalendar-set-day"),Ze>=De&&Ze<De+ue){te++,Ve.innerHTML=te,te==v&&Ve.classList.add("jcalendar-selected"),he&&Z==te&&(Ve.style.fontWeight="bold");var Ce=w.now(new Date(W,ne-1,te),!0);if(o.options.validRange){if(!o.options.validRange[0]||Ce>=o.options.validRange[0])var He=!0;else var He=!1;if(!o.options.validRange[1]||Ce<=o.options.validRange[1])var tt=!0;else var tt=!1;He&&tt||Ve.classList.add("jcalendar-disabled")}}we.appendChild(Ve),Ze++}le.appendChild(we)}o.options.time?Ie.style.display="":Ie.style.display="none",ee()},o.getMonths=function(){o.options.mode="months";var W=o.options.months;o.options.value;var ne=new Date,v=parseInt(ne.getFullYear()),P=parseInt(ne.getMonth())+1,J=o.date&&c.isNumeric(o.date[0])?o.date[0]:v,he=o.date&&c.isNumeric(o.date[1])?o.date[1]:P;be.innerHTML=o.date[0],de.innerHTML=W[he-1];var Z=document.createElement("table");Z.setAttribute("width","100%");for(var ue=null,ye=0;ye<12;ye++){if(!(ye%4)){var ue=document.createElement("tr");ue.setAttribute("align","center"),Z.appendChild(ue)}var De=document.createElement("td");if(De.classList.add("jcalendar-set-month"),De.setAttribute("data-value",ye+1),De.innerText=W[ye],o.options.validRange){var we=J+"-"+c.two(ye+1);if(!o.options.validRange[0]||we>=o.options.validRange[0].substr(0,7))var Fe=!0;else var Fe=!1;if(!o.options.validRange[1]||we<=o.options.validRange[1].substr(0,7))var Ve=!0;else var Ve=!1;Fe&&Ve||De.classList.add("jcalendar-disabled")}ye+1==he&&De.classList.add("jcalendar-selected"),v==J&&ye+1==P&&(De.style.fontWeight="bold"),ue.appendChild(De)}le.innerHTML='<tr><td colspan="7"></td></tr>',le.children[0].children[0].appendChild(Z),ee()},o.getYears=function(){o.options.mode="years";for(var W=new Date,ne=W.getFullYear(),v=o.date&&c.isNumeric(o.date[0])?o.date[0]:parseInt(W.getFullYear()),P=[],J=0;J<25;J++)P[J]=parseInt(o.date[0])+(J-12);var he=document.createElement("table");he.setAttribute("width","100%");for(var J=0;J<25;J++){if(!(J%5)){var Z=document.createElement("tr");Z.setAttribute("align","center"),he.appendChild(Z)}var ue=document.createElement("td");ue.classList.add("jcalendar-set-year"),ue.innerText=P[J],v==P[J]&&ue.classList.add("jcalendar-selected"),ne==P[J]&&(ue.style.fontWeight="bold"),Z.appendChild(ue)}le.innerHTML='<tr><td colspan="7"></td></tr>',le.firstChild.firstChild.appendChild(he),ee()},o.setLabel=function(W,ne){return w.getDateString(W,ne)},o.fromFormatted=function(W,ne){return w.extractDateFromString(W,ne)};var O=function(W){var ne=c.findElement(W.target,"jcalendar-container");if(ne){var v=W.target.className;if(v=="jcalendar-prev")o.prev();else if(v=="jcalendar-next")o.next();else if(v=="jcalendar-month")o.getMonths();else if(v=="jcalendar-year")o.getYears();else if(v=="jcalendar-set-year")o.date[0]=W.target.innerText,o.options.type=="year-month-picker"?o.getMonths():o.getDays();else if(W.target.classList.contains("jcalendar-set-month")){var P=parseInt(W.target.getAttribute("data-value"));o.options.type=="year-month-picker"?o.update(W.target,P):(o.date[1]=P,o.getDays())}else v=="jcalendar-confirm"||v=="jcalendar-update"||v=="jcalendar-close"?o.close(null,!0):v=="jcalendar-backdrop"?o.close(!1,!1):v=="jcalendar-reset"?o.reset():W.target.classList.contains("jcalendar-set-day")&&W.target.innerText&&o.update(W.target)}else o.close(!1,!1)},Q=function(W){if(W.target.value&&W.target.value.length>3){var ne=w.extractDateFromString(W.target.value,o.options.format);ne&&o.setValue(ne)}},ee=function(){var W=D.querySelector(".jcalendar-selected");W&&W.classList.contains("jcalendar-disabled")?(Je.setAttribute("disabled","disabled"),ce.setAttribute("disabled","disabled"),Ae.setAttribute("disabled","disabled")):(Je.removeAttribute("disabled"),ce.removeAttribute("disabled"),Ae.removeAttribute("disabled")),typeof o.options.onupdate=="function"&&o.options.onupdate(E,o.getValue())},D=null,M=null,V=null,K=null,oe=null,be=null,de=null,fe=null,le=null,me=null,Ie=null,We=null,Je=null,ce=null,Ae=null,X=function(){E.tagName=="INPUT"&&E.value&&(l.value=E.value),M=document.createElement("div"),M.className="jcalendar-reset",V=document.createElement("div"),V.className="jcalendar-confirm",me=document.createElement("div"),me.className="jcalendar-controls",me.style.borderBottom="1px solid #ddd",me.appendChild(M),me.appendChild(V),K=document.createElement("div"),K.className="jcalendar-container",oe=document.createElement("div"),oe.className="jcalendar-content",K.appendChild(oe),E.tagName=="DIV"?(D=E,D.classList.add("jcalendar-inline")):(oe.appendChild(me),D=document.createElement("div"),D.className="jcalendar"),D.classList.add("jcalendar-container"),D.appendChild(K);var W=document.createElement("div");W.className="jcalendar-table",oe.appendChild(W);var ne=document.createElement("td");ne.setAttribute("colspan","2"),ne.className="jcalendar-prev",be=document.createElement("span"),be.className="jcalendar-year",de=document.createElement("span"),de.className="jcalendar-month";var v=document.createElement("td");v.className="jcalendar-header",v.setAttribute("colspan","3"),v.appendChild(de),v.appendChild(be);var P=document.createElement("td");P.setAttribute("colspan","2"),P.className="jcalendar-next";var J=document.createElement("thead"),he=document.createElement("tr");he.appendChild(ne),he.appendChild(v),he.appendChild(P),J.appendChild(he),fe=document.createElement("table"),le=document.createElement("tbody"),fe.setAttribute("cellpadding","0"),fe.setAttribute("cellspacing","0"),fe.appendChild(J),fe.appendChild(le),W.appendChild(fe),ce=document.createElement("select"),ce.className="jcalendar-select",ce.onchange=function(){o.date[3]=this.value,typeof o.options.onupdate=="function"&&o.options.onupdate(E,o.getValue())};for(var Z=0;Z<24;Z++){var ue=document.createElement("option");ue.value=Z,ue.innerHTML=c.two(Z),ce.appendChild(ue)}Ae=document.createElement("select"),Ae.className="jcalendar-select",Ae.onchange=function(){o.date[4]=this.value,typeof o.options.onupdate=="function"&&o.options.onupdate(E,o.getValue())};for(var Z=0;Z<60;Z++){var ue=document.createElement("option");ue.value=Z,ue.innerHTML=c.two(Z),Ae.appendChild(ue)}var ye=document.createElement("div");ye.className="jcalendar-controls",Ie=document.createElement("div"),Ie.className="jcalendar-time",Ie.style.maxWidth="140px",Ie.appendChild(ce),Ie.appendChild(Ae),Je=document.createElement("button"),Je.setAttribute("type","button"),Je.className="jcalendar-update",We=document.createElement("div"),We.style.flexGrow="10",We.appendChild(Je),ye.appendChild(Ie),E.tagName=="INPUT"&&ye.appendChild(We),oe.appendChild(ye);var De=document.createElement("div");De.className="jcalendar-backdrop",D.appendChild(De),E.addEventListener("keyup",Q),D.addEventListener("swipeleft",function(we){B.slideLeft(fe,0,function(){o.next(),B.slideRight(fe,1)}),we.preventDefault(),we.stopPropagation()}),D.addEventListener("swiperight",function(we){B.slideRight(fe,0,function(){o.prev(),B.slideLeft(fe,1)}),we.preventDefault(),we.stopPropagation()}),"ontouchend"in document.documentElement?(D.addEventListener("touchend",O),E.addEventListener("touchend",o.open)):(D.addEventListener("mouseup",O),E.addEventListener("mouseup",o.open)),w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),o.setOptions(l),E.tagName=="INPUT"?(E.parentNode.insertBefore(D,E.nextSibling),E.setAttribute("autocomplete","off"),E.classList.add("jcalendar-input"),E.value=o.setLabel(o.getValue(),o.options)):(o.getDays(),o.options.time&&(ce.value=o.date[3],Ae.value=o.date[4])),o.options.opened==!0&&o.open(),o.options.controls==!1&&K.classList.add("jcalendar-hide-controls"),E.change=o.setValue,E.val=function(we){if(we===void 0)return o.getValue();o.setValue(we)},E.calendar=D.calendar=o};return X(),o};return w.keydown=function(E){var l=null;(l=w.current)&&(E.which==13?l.close(!1,!0):E.which==27&&l.close(!1,!1))},w.prettify=function(E,l){if(!l)var l={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};E.indexOf("GMT")===-1&&E.indexOf("Z")===-1&&(E+=" GMT");var o=new Date,O=new Date(E),Q=parseInt((o-O)/1e3/60);if(String.prototype.format=function(D){return this.replace("{0}",D)},Q==0)var ee=l.justNow;else if(Q<90)var ee=l.xMinutesAgo.format(Q);else if(Q<1440)var ee=l.xHoursAgo.format(Math.round(Q/60));else if(Q<20160)var ee=l.xDaysAgo.format(Math.round(Q/1440));else if(Q<43200)var ee=l.xWeeksAgo.format(Math.round(Q/10080));else if(Q<1036800)var ee=l.xMonthsAgo.format(Math.round(Q/43200));else var ee=l.xYearsAgo.format(Math.round(Q/525600));return ee},w.prettifyAll=function(){for(var E=document.querySelectorAll(".prettydate"),l=0;l<E.length;l++)E[l].getAttribute("data-date")?E[l].innerHTML=w.prettify(E[l].getAttribute("data-date")):E[l].innerHTML&&(E[l].setAttribute("title",E[l].innerHTML),E[l].setAttribute("data-date",E[l].innerHTML),E[l].innerHTML=w.prettify(E[l].innerHTML))},w.now=b.now,w.toArray=b.toArray,w.dateToNum=b.dateToNum,w.numToDate=b.numToDate,w.weekdays=b.weekdays,w.months=b.months,w.weekdaysShort=b.weekdaysShort,w.monthsShort=b.monthsShort,w.extractDateFromString=N.extractDateFromString,w.getDateString=N.getDateString,w}var G=F();function U(){var w={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},E=function(l){return w[l]?w[l]:w.material};return E.get=function(l){return w[l]?w[l]:w},E.set=function(l,o){w[l]=o},E}var se=U();function ge(w,E){var l={};l.options={};var o={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var O in o)E&&E.hasOwnProperty(O)?l.options[O]=E[O]:l.options[O]=o[O];w.classList.add("jtabs");var Q=null,ee=null,D=null,M=function(de){if(l.options.animation){var fe=l.headers.children[de].getBoundingClientRect();l.options.palette==="modern"?(D.style.width=fe.width-4+"px",D.style.left=l.headers.children[de].offsetLeft+2+"px"):(D.style.width=fe.width+"px",D.style.left=l.headers.children[de].offsetLeft+"px"),l.options.position==="bottom"?D.style.top="0px":D.style.bottom="0px"}},V=function(de){typeof l.headers.scrollTo=="function"?l.headers.scrollTo({left:de,behavior:"smooth"}):l.headers.scrollLeft=de,de<=1?Q.classList.add("disabled"):Q.classList.remove("disabled"),de>=l.headers.scrollWidth-l.headers.offsetWidth?ee.classList.add("disabled"):ee.classList.remove("disabled"),l.headers.scrollWidth<=l.headers.offsetWidth?(Q.style.display="none",ee.style.display="none"):(Q.style.display="",ee.style.display="")};if(l.setBorder=M,l.open=function(de){for(var fe=null,le=0;le<l.headers.children.length;le++)l.headers.children[le].classList.contains("jtabs-selected")&&(fe=le),l.headers.children[le].classList.remove("jtabs-selected"),l.content.children[le]&&l.content.children[le].classList.remove("jtabs-selected");if(l.headers.children[de].classList.add("jtabs-selected"),l.content.children[de]&&l.content.children[de].classList.add("jtabs-selected"),fe!=de&&typeof l.options.onchange=="function"&&l.content.children[de]&&l.options.onchange(w,l,de,l.headers.children[de],l.content.children[de]),l.options.hideHeaders==!0&&l.headers.children.length<3&&l.options.allowCreate==!1)l.headers.parentNode.style.display="none";else{M(de),l.headers.parentNode.style.display="";var me=l.headers.children[de].offsetLeft,Ie=me+l.headers.children[de].offsetWidth,We=l.headers.scrollLeft,Je=We+l.headers.offsetWidth;We<=me&&Je>=Ie||V(me-1)}},l.selectIndex=function(de){var fe=Array.prototype.indexOf.call(l.headers.children,de);return fe>=0&&l.open(fe),fe},l.rename=function(de,fe){fe||(fe=prompt("New title",l.headers.children[de].innerText)),l.headers.children[de].innerText=fe,l.open(de)},l.create=function(de,fe){if(typeof l.options.onbeforecreate=="function"){var le=l.options.onbeforecreate(w);if(le===!1)return!1;de=le}var me=l.appendElement(de);return typeof l.options.oncreate=="function"&&l.options.oncreate(w,me),M(),me},l.remove=function(de){return l.deleteElement(de)},l.nextNumber=function(){for(var de=0,fe=0;fe<l.headers.children.length;fe++){var le=l.headers.children[fe].innerText.match(/[0-9].*/);le>de&&(de=parseInt(le))}return de?de++:de=1,de},l.deleteElement=function(de){if(l.headers.children[de])l.headers.removeChild(l.headers.children[de]),l.content.removeChild(l.content.children[de]);else return!1;l.open(0),typeof l.options.ondelete=="function"&&l.options.ondelete(w,de)},l.appendElement=function(de,fe,le){if(!de)var de=prompt("Title?","");if(de){var me=document.createElement("div");l.content.appendChild(me);var Ie=document.createElement("div");return Ie.innerHTML=de,Ie.content=me,l.headers.insertBefore(Ie,l.headers.lastChild),l.options.allowChangePosition&&Ie.setAttribute("draggable","true"),le!==!1&&l.selectIndex(Ie),typeof fe=="function"&&fe(me,Ie),me}},l.getActive=function(){for(var de=0;de<l.headers.children.length;de++)if(l.headers.children[de].classList.contains("jtabs-selected"))return de;return 0},l.updateContent=function(de,fe){if(typeof fe!="string")var le=fe;else{var le=document.createElement("div");le.innerHTML=fe}l.content.children[de].classList.contains("jtabs-selected")&&fe.classList.add("jtabs-selected"),l.content.replaceChild(fe,l.content.children[de]),M()},l.updatePosition=function(de,fe,le){de>fe?l.content.insertBefore(l.content.children[de],l.content.children[fe]):l.content.insertBefore(l.content.children[de],l.content.children[fe].nextSibling),l.open(fe),!le&&typeof l.options.onchangeposition=="function"&&l.options.onchangeposition(l.headers,de,fe)},l.move=function(de,fe,le){de>fe?l.headers.insertBefore(l.headers.children[de],l.headers.children[fe]):l.headers.insertBefore(l.headers.children[de],l.headers.children[fe].nextSibling),l.updatePosition(de,fe,le)},l.setBorder=M,l.init=function(){w.innerHTML="",l.headers=document.createElement("div"),l.content=document.createElement("div"),l.headers.classList.add("jtabs-headers"),l.content.classList.add("jtabs-content"),l.options.palette?w.classList.add("jtabs-modern"):w.classList.remove("jtabs-modern"),l.options.padding&&(l.content.style.padding=parseInt(l.options.padding)+"px");var de=document.createElement("div");de.className="jtabs-headers-container",de.appendChild(l.headers),l.options.maxWidth&&(de.style.maxWidth=parseInt(l.options.maxWidth)+"px");var fe=document.createElement("div");if(fe.className="jtabs-controls",fe.setAttribute("draggable","false"),de.appendChild(fe),l.options.position=="bottom"?(w.appendChild(l.content),w.appendChild(de)):(w.appendChild(de),w.appendChild(l.content)),l.options.allowCreate==!0){var le=document.createElement("div");le.className="jtabs-add",le.onclick=function(){l.create()},fe.appendChild(le)}Q=document.createElement("div"),Q.className="jtabs-prev",Q.onclick=function(){V(l.headers.scrollLeft-l.headers.offsetWidth)},fe.appendChild(Q),ee=document.createElement("div"),ee.className="jtabs-next",ee.onclick=function(){V(l.headers.scrollLeft+l.headers.offsetWidth)},fe.appendChild(ee);for(var me=0;me<l.options.data.length;me++){if(l.options.data[me].titleElement)var Ie=l.options.data[me].titleElement;else var Ie=document.createElement("div");if(l.options.data[me].icon){var We=document.createElement("div"),Je=document.createElement("i");Je.classList.add("material-icons"),Je.innerHTML=l.options.data[me].icon,We.appendChild(Je),Ie.appendChild(We)}if(l.options.data[me].title){var ce=document.createTextNode(l.options.data[me].title);Ie.appendChild(ce)}if(l.options.data[me].width&&(Ie.style.width=l.options.data[me].width),l.options.data[me].contentElement)var Ae=l.options.data[me].contentElement;else{var Ae=document.createElement("div");Ae.innerHTML=l.options.data[me].content}l.headers.appendChild(Ie),l.content.appendChild(Ae)}D=document.createElement("div"),D.className="jtabs-border",l.headers.appendChild(D),l.options.animation&&w.classList.add("jtabs-animation"),l.headers.addEventListener("click",function(X){if(X.target.parentNode.classList.contains("jtabs-headers"))var W=X.target;else if(X.target.tagName=="I")var W=X.target.parentNode.parentNode;else var W=X.target.parentNode;var ne=l.selectIndex(W);typeof l.options.onclick=="function"&&l.options.onclick(w,l,ne,l.headers.children[ne],l.content.children[ne])}),l.headers.addEventListener("contextmenu",function(X){l.selectIndex(X.target)}),l.headers.children.length&&l.open(0),V(0),l.options.allowChangePosition==!0&&j(l.headers,{direction:1,ondrop:function(X,W,ne){l.updatePosition(W,ne)}}),typeof l.options.onload=="function"&&l.options.onload(w,l)},w.children[0]&&w.children[0].children.length)for(var K=0;K<w.children[0].children.length;K++){var oe=l.options.data&&l.options.data[K]?l.options.data[K]:{};w.children[1]&&w.children[1].children[K]?(oe.titleElement=w.children[0].children[K],oe.contentElement=w.children[1].children[K]):oe.contentElement=w.children[0].children[K],l.options.data[K]=oe}var be=!1;if(l.options.data)for(var K=0;K<l.options.data.length;K++)l.options.data[K].url&&(T({url:l.options.data[K].url,type:"GET",dataType:"text/html",index:K,success:function(fe){l.options.data[this.index].content=fe},complete:function(){l.init()}}),be=!0);return be||l.init(),w.tabs=l,l}function ie(w,E){if(w.color)return w.color.setOptions(E,!0);var l={type:"color"};l.options={};var o=null,O=null,Q=null,ee=null,D=null,M=null,V=null;l.setOptions=function(v,P){var J={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};v||(v={}),v&&!v.palette&&(v.palette=se());for(var he in J)v&&v.hasOwnProperty(he)?l.options[he]=v[he]:(typeof l.options[he]>"u"||P===!0)&&(l.options[he]=J[he]);return ee&&(ee.innerHTML=l.options.resetLabel),D&&(D.innerHTML=l.options.doneLabel),l.options.palette&&V&&V.updateContent(0,fe()),typeof l.options.value=="string"&&(w.value=l.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value)),l.options.placeholder?w.setAttribute("placeholder",l.options.placeholder):w.getAttribute("placeholder")&&w.removeAttribute("placeholder"),l},l.select=function(v){var P=o.querySelector(".jcolor-selected");P&&P.classList.remove("jcolor-selected"),l.values[v]&&l.values[v].classList.add("jcolor-selected"),l.options.value=v},l.open=function(){if(!o.classList.contains("jcolor-focus")){u(l,!0),o.classList.add("jcolor-focus"),l.options.value&&l.select(l.options.value),Q.style.marginTop="",Q.style.marginLeft="";var v=Q.getBoundingClientRect(),P=c.getWindowWidth(),J=c.getWindowHeight();if(P<800||l.options.fullscreen==!0?(Q.classList.add("jcolor-fullscreen"),B.slideBottom(Q,1),O.style.display="block"):(Q.classList.contains("jcolor-fullscreen")&&(Q.classList.remove("jcolor-fullscreen"),O.style.display=""),l.options.position?Q.style.position="fixed":Q.style.position="",v.left+v.width>P&&(Q.style.marginLeft=-1*(v.left+v.width-(P-20))+"px"),v.top+v.height>J&&(Q.style.marginTop=-1*(v.top+v.height-(J-20))+"px")),typeof l.options.onopen=="function"&&l.options.onopen(w,l),V.setBorder(V.getActive()),l.options.value){var he=de(l.options.value);Ae.forEach(function(Z,ue){Z.value=he[ue],Z.dispatchEvent(new Event("input"))})}}},l.close=function(v){return o.classList.contains("jcolor-focus")&&(o.classList.remove("jcolor-focus"),O.style.display="",!v&&typeof l.options.onclose=="function"&&l.options.onclose(w,l),u(l,!1)),l.options.value},l.setValue=function(v){v||(v=""),v!=l.options.value&&(l.options.value=v,ce=v,l.select(v),typeof l.options.onchange=="function"&&l.options.onchange(w,v,l),w.value!=l.options.value&&(w.value=l.options.value,w.tagName==="INPUT"&&(w.style.color=w.value,w.style.backgroundColor=w.value),typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),l.options.closeOnChange==!0&&l.close())},l.getValue=function(){return l.options.value};var K=function(v){var P=v.toString(16);return P.length===1?"0"+P:P},oe=function(v,P,J){return"#"+K(v)+K(P)+K(J)},be=function(v){return parseInt("0x"+v)},de=function(v){return[be(v.substr(1,2)),be(v.substr(3,2)),be(v.substr(5,2))]},fe=function(){var v=document.createElement("div");v.className="jcolor-grid",l.values=[];var P=document.createElement("table");P.setAttribute("cellpadding","7"),P.setAttribute("cellspacing","0");for(var J=0;J<l.options.palette.length;J++){for(var he=document.createElement("tr"),Z=0;Z<l.options.palette[J].length;Z++){var ue=document.createElement("td"),ye=l.options.palette[J][Z];ye.length<7&&ye.substr(0,1)!=="#"&&(ye="#"+ye),ue.style.backgroundColor=ye,ue.setAttribute("data-value",ye),ue.innerHTML="",he.appendChild(ue),l.options.value==ye&&ue.classList.add("jcolor-selected"),l.values[ye]=ue}P.appendChild(he)}return v.appendChild(P),v},le=document.createElement("canvas");le.width=200,le.height=160;var me=le.getContext("2d"),Ie=function(){var v=M.firstChild.getBoundingClientRect();le.width=v.width-14,We()},We=function(){var v=me.createLinearGradient(0,0,le.width,0);v.addColorStop(0,"rgb(255,0,0)"),v.addColorStop(.15,"rgb(255,0,255)"),v.addColorStop(.33,"rgb(0,0,255)"),v.addColorStop(.49,"rgb(0,255,255)"),v.addColorStop(.67,"rgb(0,255,0)"),v.addColorStop(.84,"rgb(255,255,0)"),v.addColorStop(1,"rgb(255,0,0)"),me.fillStyle=v,me.fillRect(0,0,le.width,le.height),v=me.createLinearGradient(0,0,0,le.height),v.addColorStop(0,"rgba(255,255,255,1)"),v.addColorStop(.5,"rgba(255,255,255,0)"),v.addColorStop(.5,"rgba(0,0,0,0)"),v.addColorStop(1,"rgba(0,0,0,1)"),me.fillStyle=v,me.fillRect(0,0,le.width,le.height)},Je=function(){var v=document.createElement("div");v.className="jcolor-hsl";var P=document.createElement("div");P.className="jcolor-point";var J=document.createElement("div");J.appendChild(le),J.appendChild(P),v.appendChild(J);var he=function(Z,ue,ye){if(Z===1){var De=v.getBoundingClientRect(),we=ue-De.left,Fe=ye-De.top;we<0&&(we=0),Fe<0&&(Fe=0),we>De.width&&(we=De.width),Fe>De.height&&(Fe=De.height),P.style.left=we+"px",P.style.top=Fe+"px";var Ve=me.getImageData(we,Fe,1,1).data;ce=oe(Ve[0],Ve[1],Ve[2])}};return v.addEventListener("mousedown",function(Z){he(Z.buttons,Z.clientX,Z.clientY)}),v.addEventListener("mousemove",function(Z){he(Z.buttons,Z.clientX,Z.clientY)}),v.addEventListener("touchmove",function(Z){he(1,Z.changedTouches[0].clientX,Z.changedTouches[0].clientY)}),v},ce="",Ae=[],X=function(){if(ce!=="")for(var v=0;v<Ae.length;v++){var P=de(ce);P[v]=0;var J="linear-gradient(90deg, rgb(";J+=P.join(", "),J+="), rgb(",P[v]=255,J+=P.join(", "),J+="))",Ae[v].style.backgroundImage=J}},W=function(){var v=document.createElement("div");v.className="jcolor-sliders";var P=document.createElement("div"),J=function(ye){var De=document.createElement("div");De.className="jcolor-sliders-input-container";var we=document.createElement("label");we.innerText=ye;var Fe=document.createElement("div");Fe.className="jcolor-sliders-input-subcontainer";var Ve=document.createElement("input");Ve.type="range",Ve.min=0,Ve.max=255,Ve.value=0,De.appendChild(we),Fe.appendChild(Ve);var Ze=document.createElement("div");return Ze.innerText=Ve.value,Ve.addEventListener("input",function(){Ze.innerText=Ve.value}),Fe.appendChild(Ze),De.appendChild(Fe),P.appendChild(De),Ve};Ae=[J("Red"),J("Green"),J("Blue")],v.appendChild(P);var he=document.createElement("div");he.className="jcolor-sliders-final-color";var Z=document.createElement("div");Z.style.visibility="hidden",Z.innerText="a",he.appendChild(Z);var ue=function(){var ye=oe(parseInt(Ae[0].value),parseInt(Ae[1].value),parseInt(Ae[2].value));Z.innerText=ye,Z.style.color=ye,Z.style.removeProperty("visibility"),ce=ye};return Ae.forEach(function(ye){ye.addEventListener("input",function(){ue(),X()})}),v.appendChild(he),v},ne=function(){l.setOptions(E),w.tagName=="INPUT"&&(w.classList.add("jcolor-input"),w.readOnly=!0),o=document.createElement("div"),o.className="jcolor",O=document.createElement("div"),O.className="jcolor-backdrop",o.appendChild(O),Q=document.createElement("div"),Q.className="jcolor-content";var v=document.createElement("div");v.className="jcolor-controls",Q.appendChild(v),ee=document.createElement("div"),ee.className="jcolor-reset",ee.innerHTML=l.options.resetLabel,v.appendChild(ee),D=document.createElement("div"),D.className="jcolor-close",D.innerHTML=l.options.doneLabel,v.appendChild(D),M=document.createElement("div"),Q.appendChild(M),V=ge(M,{animation:!0,data:[{title:"Grid",contentElement:fe()},{title:"Spectrum",contentElement:Je()},{title:"Sliders",contentElement:W()}],onchange:function(P,J,he){if(he===1)Ie();else{var Z=ce!==""?ce:l.getValue();if(he===2&&Z){var ue=de(Z);Ae.forEach(function(ye,De){ye.value=ue[De],ye.dispatchEvent(new Event("input"))})}}},palette:"modern"}),o.appendChild(Q),w.tagName=="INPUT"?w.parentNode.insertBefore(o,w.nextSibling):w.appendChild(o),o.addEventListener("click",function(P){if(P.target.tagName=="TD"){var J=P.target.getAttribute("data-value");J&&l.setValue(J)}else P.target.classList.contains("jcolor-reset")?(l.setValue(""),l.close()):P.target.classList.contains("jcolor-close")?(V.getActive()>0&&l.setValue(ce),l.close()):P.target.classList.contains("jcolor-backdrop")?l.close():l.open()}),w.addEventListener("mouseup",function(P){l.open()}),window.addEventListener("resize",function(){o.classList.contains("jcolor-focus")&&V.getActive()==1&&Ie()}),l.options.opened==!0&&l.open(),w.change=l.setValue,w.val=function(P){if(P===void 0)return l.getValue();l.setValue(P)},w.color=l,o.color=l};return l.toHex=function(v){var P=function(J){return("0"+parseInt(J).toString(16)).slice(-2)};if(v)return/^#[0-9A-F]{6}$/i.test(v)?v:(v=v.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),v&&v.length?"#"+P(v[1])+P(v[2])+P(v[3]):"")},ne(),l}function xe(){var w=function(E,l){var o={type:"contextmenu"};o.options={};var O={items:null,onclick:null};for(var Q in O)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=O[Q];E.classList.add("jcontextmenu"),o.open=function(M,V){if(V&&(o.options.items=V,o.create(V)),w.current&&w.current.close(),u(o,!0),E.classList.add("jcontextmenu-focus"),w.current=o,o.options.items&&o.options.items.length>0||E.children.length){if(M.target)if(M.changedTouches&&M.changedTouches[0])K=M.changedTouches[0].clientX,oe=M.changedTouches[0].clientY;else var K=M.clientX,oe=M.clientY;else var K=M.x,oe=M.y;var be=E.getBoundingClientRect();if(window.innerHeight<oe+be.height){var de=oe-be.height;de<0&&(de=0),E.style.top=de+"px"}else E.style.top=oe+"px";window.innerWidth<K+be.width?K-be.width>0?E.style.left=K-be.width+"px":E.style.left="10px":E.style.left=K+"px"}},o.isOpened=function(){return!!E.classList.contains("jcontextmenu-focus")},o.close=function(){E.classList.contains("jcontextmenu-focus")&&E.classList.remove("jcontextmenu-focus"),u(o,!1)},o.create=function(M){E.innerHTML="";var V=ee();E.appendChild(V);for(var K=0;K<M.length;K++){var oe=D(M[K]);E.appendChild(oe)}};function ee(){var M=document.createElement("div");M.classList.add("header"),M.addEventListener("click",function(oe){oe.preventDefault(),oe.stopPropagation()});var V=document.createElement("a");V.classList.add("title"),V.innerHTML=g.translate("Menu"),M.appendChild(V);var K=document.createElement("a");return K.classList.add("close"),K.innerHTML=g.translate("close"),K.addEventListener("click",function(oe){o.close()}),M.appendChild(K),M}function D(M){if(M.type&&(M.type=="line"||M.type=="divisor"))var V=document.createElement("hr");else{var V=document.createElement("div"),K=document.createElement("a");if(K.innerHTML=M.title,M.tooltip&&V.setAttribute("title",M.tooltip),M.icon&&V.setAttribute("data-icon",M.icon),M.id&&(V.id=M.id),M.disabled?V.className="jcontextmenu-disabled":M.onclick&&(V.method=M.onclick,V.addEventListener("mousedown",function(We){We.preventDefault()}),V.addEventListener("mouseup",function(We){this.method(this,We)})),V.appendChild(K),M.submenu){var oe=document.createElement("span");oe.innerHTML="&#9658;",V.appendChild(oe),V.classList.add("jcontexthassubmenu");var be=document.createElement("div");be.classList.add("jcontextmenu"),be.setAttribute("tabindex","900");for(var de=M.submenu,fe=0;fe<de.length;fe++){var le=D(de[fe]);be.appendChild(le)}V.appendChild(be)}else if(M.shortcut){var me=document.createElement("span");me.innerHTML=M.shortcut,V.appendChild(me)}}return V}return typeof o.options.onclick=="function"&&E.addEventListener("click",function(M){o.options.onclick(o,M)}),o.options.items&&o.create(o.options.items),window.addEventListener("mousewheel",function(){o.close()}),E.contextmenu=o,o};return w}var Te=xe();function ve(){var w=function(E,l){if(E.dropdown)return E.dropdown.setOptions(l,!0);var o={type:"dropdown"};o.options={};var O=function(X,W){X&&X.length&&(o.options.sortResults!==!1&&(typeof o.options.sortResults=="function"?X.sort(o.options.sortResults):X.sort(Q)),o.setData(X)),typeof o.options.onload=="function"&&o.options.onload(E,o,X,W),W&&D(W),W==null&&(o.options.value=""),E.value=o.options.value,o.options.opened==!0&&o.open()},Q=function(X,W){var ne,v;return typeof X=="string"?ne=X:X.text?ne=X.text:X.name&&(ne=X.name),typeof W=="string"?v=W:W.text?v=W.text:W.name&&(v=W.name),typeof ne=="string"||typeof v=="string"?(typeof ne!="string"&&(ne=""+ne),typeof v!="string"&&(v=""+v),ne.localeCompare(v)):ne-v},ee=function(){o.value={};for(var X=0;X<o.items.length;X++)o.items[X].selected==!0&&(o.items[X].element&&o.items[X].element.classList.remove("jdropdown-selected"),o.items[X].selected=null);o.options.value="",E.value=""},D=function(X){if(ee(),X!==null)if(!X)typeof o.value[""]<"u"&&(o.value[""]="");else{Array.isArray(X)||(X=(""+X).split(";"));for(var W=0;W<X.length;W++)o.value[X[W]]=""}for(var W=0;W<o.items.length;W++)typeof o.value[M(W)]<"u"&&(o.items[W].element&&o.items[W].element.classList.add("jdropdown-selected"),o.items[W].selected=!0,o.value[M(W)]=V(W));o.options.value=Object.keys(o.value).join(";"),o.header.value=o.getText()},M=function(X,W){if(o.options.format)var ne="id";else var ne="value";return o.items[X]?W!==void 0?o.items[X].data[ne]=W:o.items[X].data[ne]:""},V=function(X,W){if(o.options.format)var ne="name";else var ne="text";return o.items[X]?W!==void 0?o.items[X].data[ne]=W:o.items[X].data[ne]:""},K=function(){return Object.keys(o.value)},oe=function(){for(var X=[],W=Object.keys(o.value),ne=0;ne<W.length;ne++)X.push(o.value[W[ne]]);return X};o.setOptions=function(X,W){X||(X={});var ne={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1};for(var v in ne)X&&X.hasOwnProperty(v)?o.options[v]=X[v]:(typeof o.options[v]>"u"||W===!0)&&(o.options[v]=ne[v]);return(o.options.remoteSearch==!0||o.options.type==="searchbar")&&(o.options.autocomplete=!0),o.options.newOptions==!0?o.header.classList.add("jdropdown-add"):o.header.classList.remove("jdropdown-add"),o.options.autocomplete==!0?o.header.removeAttribute("readonly"):o.header.setAttribute("readonly","readonly"),o.options.placeholder?o.header.setAttribute("placeholder",o.options.placeholder):o.header.removeAttribute("placeholder"),E.classList.remove("jdropdown-searchbar"),E.classList.remove("jdropdown-picker"),E.classList.remove("jdropdown-list"),o.options.type=="searchbar"?E.classList.add("jdropdown-searchbar"):o.options.type=="list"?E.classList.add("jdropdown-list"):o.options.type=="picker"?E.classList.add("jdropdown-picker"):c.getWindowWidth()<800?o.options.autocomplete?(E.classList.add("jdropdown-searchbar"),o.options.type="searchbar"):(E.classList.add("jdropdown-picker"),o.options.type="picker"):(o.options.width?(E.style.width=o.options.width,E.style.minWidth=o.options.width):(E.style.removeProperty("width"),E.style.removeProperty("min-width")),E.classList.add("jdropdown-default"),o.options.type="default"),o.options.type=="searchbar"?be.appendChild(le):de.insertBefore(le,de.firstChild),o.options.url&&!X.data?T({url:o.options.url,method:"GET",dataType:"json",success:function(P){P&&O(P,o.options.value)}}):O(o.options.data,o.options.value),o};var be=null,de=null,fe=null,le=null,me=null,Ie=null,We=null,Je=function(){if(l||(l={}),E.tagName=="SELECT"){var X=w.extractFromDom(E,l);E=X.el,l=X.options}!l.placeholder&&E.getAttribute("placeholder")&&(l.placeholder=E.getAttribute("placeholder")),o.value={},o.items=[],o.groups=[],o.search="",o.results=null,E.classList.add("jdropdown"),be=document.createElement("div"),be.className="jdropdown-container-header",o.header=document.createElement("input"),o.header.className="jdropdown-header jss_object",o.header.type="text",o.header.setAttribute("autocomplete","off"),o.header.onfocus=function(){typeof o.options.onfocus=="function"&&o.options.onfocus(E)},o.header.onblur=function(){typeof o.options.onblur=="function"&&o.options.onblur(E)},o.header.onkeyup=function(W){o.options.autocomplete==!0&&!We?(o.search!=o.header.value.trim()&&(We=setTimeout(function(){o.find(o.header.value.trim()),We=null},400)),E.classList.contains("jdropdown-focus")||o.open()):o.options.autocomplete||o.next(W.key)},w.hasEvents||(w.hasEvents=!0,document.addEventListener("keydown",w.keydown)),de=document.createElement("div"),de.className="jdropdown-container",fe=document.createElement("div"),fe.className="jdropdown-content",le=document.createElement("div"),le.className="jdropdown-close",le.textContent="Done",me=document.createElement("div"),me.className="jdropdown-reset",me.textContent="x",me.onclick=function(){o.reset(),o.close()},Ie=document.createElement("div"),Ie.className="jdropdown-backdrop",be.appendChild(o.header),de.appendChild(fe),E.appendChild(be),E.appendChild(de),E.appendChild(Ie),o.setOptions(l),"ontouchsend"in document.documentElement?E.addEventListener("touchsend",w.mouseup):E.addEventListener("mouseup",w.mouseup),o.options.lazyLoading==!0&&h(fe,{loadUp:o.loadUp,loadDown:o.loadDown}),fe.onwheel=function(W){W.stopPropagation()},E.change=o.setValue,E.val=function(W){if(W===void 0)return o.getValue(!!o.options.multiple);o.setValue(W)},E.dropdown=o};o.getUrl=function(){return o.options.url},o.setUrl=function(X,W){o.options.url=X,T({url:o.options.url,method:"GET",dataType:"json",success:function(ne){o.setData(ne),typeof W=="function"&&W(o)}})},o.setId=function(X,W){if(o.options.format)var ne="id";else var ne="value";typeof X=="object"?X[ne]=W:o.items[X].data[ne]=W},o.add=function(X,W){if(!X){var ne=o.options.autocomplete==!0?o.header.value:"",X=prompt(g.translate("Add A New Option"),ne);if(!X)return!1}if(W||(W=c.guid()),o.options.format)var v={id:W,name:X};else var v={value:W,text:X};if(typeof o.options.onbeforeinsert=="function"){var P=o.options.onbeforeinsert(o,v);if(P===!1)return!1;P&&(v=P)}o.options.data.push(v);var J=o.createItem(v);return fe.appendChild(J.element),typeof o.options.oninsert=="function"&&o.options.oninsert(o,v,J),fe.style.display=="none"&&(fe.style.display=""),o.results&&o.results.push(J),v},o.createItem=function(X,W,ne){o.options.format?(!X.id&&X.value!==void 0&&(X.id=X.value),!X.name&&X.text!==void 0&&(X.name=X.text)):(!X.value&&X.id!==void 0&&(X.value=X.id),!X.text&&X.name!==void 0&&(X.text=X.name));var v={};if(v.element=document.createElement("div"),v.element.className="jdropdown-item",v.element.indexValue=o.items.length,v.data=X,W&&(v.group=W),X.id&&v.element.setAttribute("id",X.id),X.disabled==!0&&v.element.setAttribute("data-disabled",!0),X.tooltip&&v.element.setAttribute("title",X.tooltip),X.image){var P=document.createElement("img");P.className="jdropdown-image",P.src=X.image,X.title||P.classList.add("jdropdown-image-small"),v.element.appendChild(P)}else if(X.icon){var J=document.createElement("span");J.className="jdropdown-icon material-icons",J.innerText=X.icon,X.title||J.classList.add("jdropdown-icon-small"),X.color&&(J.style.color=X.color),v.element.appendChild(J)}else if(X.color){var he=document.createElement("div");he.className="jdropdown-color",he.style.backgroundColor=X.color,v.element.appendChild(he)}if(o.options.format)var Z=X.name;else var Z=X.text;var ue=document.createElement("div");if(ue.className="jdropdown-description",ue.textContent=Z||"&nbsp;",X.title){var ye=document.createElement("div");ye.className="jdropdown-title",ye.innerText=X.title,ue.appendChild(ye)}if(o.options.format)var De=X.id;else var De=X.value;return o.value[De]&&(v.element.classList.add("jdropdown-selected"),v.selected=!0),o.items.push(v),v.element.appendChild(ue),v},o.appendData=function(X){if(X.length){for(var W=[],ne=[],v=0;v<X.length;v++)X[v].group?(ne[X[v].group]||(ne[X[v].group]=[]),ne[X[v].group].push(v)):W.push(v);var P=0,J=Object.keys(ne);if(J.length>0)for(var v=0;v<J.length;v++){var he=document.createElement("div");he.className="jdropdown-group";var Z=document.createElement("div");Z.className="jdropdown-group-name",Z.textContent=J[v];var ue=document.createElement("i");ue.className="jdropdown-group-arrow jdropdown-group-arrow-down",Z.appendChild(ue);var ye=document.createElement("div");ye.className="jdropdown-group-items";for(var De=0;De<ne[J[v]].length;De++){var we=o.createItem(X[ne[J[v]][De]],he,J[v]);(o.options.lazyLoading==!1||P<200)&&(ye.appendChild(we.element),P++)}he.appendChild(Z),he.appendChild(ye),o.groups.push(he),ye.children.length>0&&fe.appendChild(he)}if(W.length)for(var v=0;v<W.length;v++){var we=o.createItem(X[W[v]]);(o.options.lazyLoading==!1||P<200)&&(fe.appendChild(we.element),P++)}}},o.setData=function(X){if(ee(),fe.textContent="",o.header.value="",o.items=[],X&&X.length){for(var W=0;W<X.length;W++)typeof X[W]!="object"&&(o.options.format?X[W]={id:X[W],name:X[W]}:X[W]={value:X[W],text:X[W]});o.appendData(X),o.options.data=X}else o.options.data=[];o.close()},o.getData=function(){return o.options.data},o.getPosition=function(X){for(var W=0;W<o.items.length;W++)if(M(W)==X)return W;return!1},o.getText=function(X){var W=oe();return X?W:W.join("; ")},o.getValue=function(X){var W=K();return X?W:W.join(";")};var ce=function(X){E.value!=o.options.value&&(E.value=o.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value})),typeof o.options.onchange=="function"&&o.options.onchange(E,o,X,o.options.value)};o.setValue=function(X){var W=o.getValue();Array.isArray(X)&&(X=X.join(";")),W!==X&&(D(X),ce(W))},o.resetSelected=function(){o.setValue(null)},o.selectIndex=function(ne,W){var ne=parseInt(ne);if(o.items&&o.items[ne]&&(W===!0||o.items[ne].data.disabled!==!0))if(o.setCursor(ne,!1),!o.options.multiple)o.items[ne].selected?o.setValue(null):o.setValue(M(ne)),o.close();else{var v=o.options.value;o.items[ne].selected?(o.items[ne].element.classList.remove("jdropdown-selected"),o.items[ne].selected=!1,delete o.value[M(ne)]):(o.items[ne].element.classList.add("jdropdown-selected"),o.items[ne].selected=!0,o.value[M(ne)]=V(ne)),o.options.value=Object.keys(o.value).join(";"),o.options.autocomplete==!1&&(o.header.value=oe().join("; ")),ce(v)}},o.selectItem=function(X){o.selectIndex(X.indexValue)};var Ae=function(X,W){for(var ne=0;ne<W.length;ne++)if(o.options.format){if(W[ne].id==X)return!0}else if(W[ne].value==X)return!0;return!1};return o.find=function(X){if(o.search==X.trim())return!1;if(o.search=X,o.setCursor(),o.groups.length)for(var W=0;W<o.groups.length;W++)o.groups[W].lastChild.textContent="";if(fe.textContent="",o.options.remoteSearch==!0){o.results=null;var ne=o.options.url;let ye={url:ne,method:"GET",data:{q:X},dataType:"json",success:function(De){o.items=[];var we=Object.keys(o.value);if(we.length)for(var Fe=0;Fe<we.length;Fe++)Ae(we[Fe],De)||(o.options.format?De.unshift({id:we[Fe],name:o.value[we[Fe]]}):De.unshift({value:we[Fe],text:o.value[we[Fe]]}));o.appendData(De),De.length?fe.style.display="":fe.style.display="none",typeof o.options.onsearch=="function"&&o.options.onsearch(o,De)}};if(typeof o.options.onbeforesearch=="function"){let De=o.options.onbeforesearch(o,ye);if(De===!1)return;typeof De=="object"&&(ye=De)}T(ye)}else{X=new RegExp(X,"gi");for(var v=[],W=0;W<o.items.length;W++){var P=V(W),J=o.items[W].data.title||"",he=o.items[W].data.group||"",Z=o.items[W].data.synonym||"";Z&&(Z=Z.join(" ")),(X==null||o.items[W].selected==!0||P.match(X)||J.match(X)||he.match(X)||Z.match(X))&&v.push(o.items[W])}if(!v.length)fe.style.display="none",o.results=null;else{fe.style.display="",o.results=v;var ue=v.length||0;o.options.lazyLoading==!0&&ue>200&&(ue=200);for(var W=0;W<ue;W++)o.results[W].group?(o.results[W].group.parentNode||fe.appendChild(o.results[W].group),o.results[W].group.lastChild.appendChild(o.results[W].element)):fe.appendChild(o.results[W].element)}}o.options.autofocus==!0&&o.first()},o.open=function(){if(!E.classList.contains("jdropdown-focus")){w.current=o,u(o,!0),E.classList.add("jdropdown-focus"),c.getWindowWidth()<800&&(o.options.type==null||o.options.type=="picker")&&B.slideBottom(de,1),o.options.autocomplete==!0&&(o.header.value=o.search,o.header.focus());var X=K();if(X[0]){var W=o.getPosition(X[0]);W!==!1&&o.setCursor(W)}if(!o.options.type||o.options.type=="default"){var ne=E.getBoundingClientRect(),v=de.getBoundingClientRect();o.options.position?(de.style.position="fixed",window.innerHeight<ne.bottom+v.height?(de.style.top="",de.style.bottom=window.innerHeight-ne.top+1+"px"):(de.style.top=ne.bottom+"px",de.style.bottom=""),de.style.left=ne.left+"px"):window.innerHeight<ne.bottom+v.height?(de.style.top="",de.style.bottom=ne.height+1+"px"):(de.style.top="",de.style.bottom=""),de.style.minWidth=ne.width+"px",o.options.maxWidth&&(de.style.maxWidth=o.options.maxWidth),!o.items.length&&o.options.autocomplete==!0?fe.style.display="none":fe.style.display=""}}typeof o.options.onopen=="function"&&o.options.onopen(E)},o.close=function(X){return E.classList.contains("jdropdown-focus")&&(o.header.value=o.getText(),o.setCursor(),!X&&typeof o.options.onclose=="function"&&o.options.onclose(E),o.header.blur&&o.header.blur(),E.classList.remove("jdropdown-focus"),u(o,!1),w.current=null),o.getValue()},o.setCursor=function(X,W){if(o.currentIndex!=null&&o.items&&o.items[o.currentIndex]&&o.items[o.currentIndex].element.classList.remove("jdropdown-cursor"),X==null)o.currentIndex=null;else if(X=parseInt(X),o.items[X].element.parentNode&&(o.items[X].element.classList.add("jdropdown-cursor"),o.currentIndex=X,W!==!1&&o.items[o.currentIndex].element)){fe.scrollTop;var ne=o.items[o.currentIndex].element;fe.scrollTop=ne.offsetTop-ne.scrollTop+ne.clientTop-95}},o.resetCursor=o.setCursor,o.updateCursor=o.setCursor,o.reset=function(){o.setCursor(),o.setValue(null)},o.first=function(){o.options.lazyLoading===!0&&o.loadFirst();var X=fe.querySelectorAll(".jdropdown-item");if(X.length){var W=X[0].indexValue;o.setCursor(W)}},o.last=function(){o.options.lazyLoading===!0&&o.loadLast();var X=fe.querySelectorAll(".jdropdown-item");if(X.length){var W=X[X.length-1].indexValue;o.setCursor(W)}},o.next=function(X){var W=null;if(X){if(X.length==1){var ne=o.currentIndex||-1;X=X.toLowerCase();var v=null,P=null,J=fe.querySelectorAll(".jdropdown-item");if(J.length){for(var he=0;he<J.length;he++)if(J[he].indexValue>ne&&(v=o.items[J[he].indexValue])&&(P=v.element.innerText[0])&&(P=P.toLowerCase(),X==P)){W=J[he].indexValue;break}o.setCursor(W)}}}else if(o.currentIndex==null||o.currentIndex==null)o.first();else{var Z=o.items[o.currentIndex].element,ue=Z.nextElementSibling;ue?(ue.classList.contains("jdropdown-group")&&(ue=ue.lastChild.firstChild),W=ue.indexValue):Z.parentNode.classList.contains("jdropdown-group-items")&&((ue=Z.parentNode.parentNode.nextElementSibling)&&(ue.classList.contains("jdropdown-group")?ue=ue.lastChild.firstChild:ue.classList.contains("jdropdown-item")?W=ue.indexValue:ue=null),ue&&(W=ue.indexValue)),W!==null&&o.setCursor(W)}},o.prev=function(){var X=null;if(o.currentIndex===null)o.first();else{var W=o.items[o.currentIndex].element,ne=W.previousElementSibling;ne?(ne.classList.contains("jdropdown-group")&&(ne=ne.lastChild.lastChild),X=ne.indexValue):W.parentNode.classList.contains("jdropdown-group-items")&&((ne=W.parentNode.parentNode.previousElementSibling)&&(ne.classList.contains("jdropdown-group")?ne=ne.lastChild.lastChild:ne.classList.contains("jdropdown-item")?X=ne.indexValue:ne=null),ne&&(X=ne.indexValue))}X!==null&&o.setCursor(X)},o.loadFirst=function(){if(o.results)var X=o.results;else var X=o.items;var W=X.length||0;o.options.lazyLoading==!0&&W>200&&(W=200),fe.textContent="";for(var ne=0;ne<W;ne++)X[ne].group?(X[ne].group.parentNode||fe.appendChild(X[ne].group),X[ne].group.lastChild.appendChild(X[ne].element)):fe.appendChild(X[ne].element);fe.scrollTop=0},o.loadLast=function(){if(o.results)var X=o.results;else var X=o.items;var W=X.length;if(W>200){W=W-200,fe.textContent="";for(var ne=W;ne<X.length;ne++)X[ne].group?(X[ne].group.parentNode||fe.appendChild(X[ne].group),X[ne].group.lastChild.appendChild(X[ne].element)):fe.appendChild(X[ne].element);fe.scrollTop=fe.scrollHeight}},o.loadUp=function(){var X=!1;if(o.results)var W=o.results;else var W=o.items;var ne=fe.querySelectorAll(".jdropdown-item"),v=ne[0].indexValue;v=o.items[v];var P=W.indexOf(v)-1;if(P>0){for(var J=0;P>0&&W[P]&&J<200;)W[P].group?(W[P].group.parentNode||fe.insertBefore(W[P].group,fe.firstChild),W[P].group.lastChild.insertBefore(W[P].element,W[P].group.lastChild.firstChild)):fe.insertBefore(W[P].element,fe.firstChild),P--,J++;X=!0}return X},o.loadDown=function(){var X=!1;if(o.results)var W=o.results;else var W=o.items;var ne=fe.querySelectorAll(".jdropdown-item"),v=ne[ne.length-1].indexValue;v=o.items[v];var P=W.indexOf(v)+1;if(P<W.length){for(var J=0;P<W.length&&W[P]&&J<200;)W[P].group?(W[P].group.parentNode||fe.appendChild(W[P].group),W[P].group.lastChild.appendChild(W[P].element)):fe.appendChild(W[P].element),P++,J++;X=!0}return X},Je(),o};return w.keydown=function(E){var l=null;if(l=w.current){if(E.which==13||E.which==9)l.header.value&&l.currentIndex==null&&l.options.newOptions?l.add():(l.currentIndex==null&&l.options.autocomplete==!0&&l.header.value!=""&&l.find(l.header.value),l.selectIndex(l.currentIndex));else if(E.which==38)l.currentIndex==null?l.first():l.currentIndex>0&&l.prev(),E.preventDefault();else if(E.which==40)l.currentIndex==null?l.first():l.currentIndex+1<l.items.length&&l.next(),E.preventDefault();else if(E.which==36)l.first(),E.target.classList.contains("jdropdown-header")||E.preventDefault();else if(E.which==35)l.last(),E.target.classList.contains("jdropdown-header")||E.preventDefault();else if(E.which==27)l.close();else if(E.which==33){if(l.currentIndex==null)l.first();else if(l.currentIndex>0)for(var o=0;o<7;o++)l.prev();E.preventDefault()}else if(E.which==34){if(l.currentIndex==null)l.first();else if(l.currentIndex+1<l.items.length)for(var o=0;o<7;o++)l.next();E.preventDefault()}}},w.mouseup=function(E){var l=c.findElement(E.target,"jdropdown");if(l){var o=l.dropdown;if(E.target.classList.contains("jdropdown-header"))if(l.classList.contains("jdropdown-focus")&&l.classList.contains("jdropdown-default")){var O=l.getBoundingClientRect();if(E.changedTouches&&E.changedTouches[0]){var Q=E.changedTouches[0].clientX;E.changedTouches[0].clientY}else{var Q=E.clientX;E.clientY}O.width-(Q-O.left)<30?E.target.classList.contains("jdropdown-add")?o.add():o.close():o.options.autocomplete==!1&&o.close()}else o.open();else if(E.target.classList.contains("jdropdown-group-name")){var ee=E.target.nextSibling.children;if(E.target.nextSibling.style.display!="none")for(var D=0;D<ee.length;D++)ee[D].style.display!="none"&&o.selectItem(ee[D])}else E.target.classList.contains("jdropdown-group-arrow")?E.target.classList.contains("jdropdown-group-arrow-down")?(E.target.classList.remove("jdropdown-group-arrow-down"),E.target.classList.add("jdropdown-group-arrow-up"),E.target.parentNode.nextSibling.style.display="none"):(E.target.classList.remove("jdropdown-group-arrow-up"),E.target.classList.add("jdropdown-group-arrow-down"),E.target.parentNode.nextSibling.style.display=""):E.target.classList.contains("jdropdown-item")?o.selectItem(E.target):E.target.classList.contains("jdropdown-image")||E.target.classList.contains("jdropdown-description")?o.selectItem(E.target.parentNode):E.target.classList.contains("jdropdown-title")?o.selectItem(E.target.parentNode.parentNode):(E.target.classList.contains("jdropdown-close")||E.target.classList.contains("jdropdown-backdrop"))&&o.close()}},w.extractFromDom=function(E,l){var o=E;if(l||(l={}),E.getAttribute("multiple")&&(!l||l.multiple==null)&&(l.multiple=!0),E.getAttribute("placeholder")&&(!l||l.placeholder==null)&&(l.placeholder=E.getAttribute("placeholder")),E.getAttribute("data-autocomplete")&&(!l||l.autocomplete==null)&&(l.autocomplete=!0),(!l||l.width==null)&&(l.width=E.offsetWidth),E.value&&(!l||l.value==null)&&(l.value=E.value),!l||l.data==null){l.data=[];for(var O=0;O<E.children.length;O++)if(E.children[O].tagName=="OPTGROUP")for(var Q=0;Q<E.children[O].children.length;Q++)l.data.push({value:E.children[O].children[Q].value,text:E.children[O].children[Q].textContent,group:E.children[O].getAttribute("label")});else l.data.push({value:E.children[O].value,text:E.children[O].textContent})}(!l||l.onchange==null)&&(l.onchange=function(D,M,V,K){l.multiple==!0?obj.items[M].classList.contains("jdropdown-selected")?o.options[M].setAttribute("selected","selected"):o.options[M].removeAttribute("selected"):o.value=K});var ee=document.createElement("div");return E.parentNode.insertBefore(ee,E),E.style.display="none",E=ee,{el:E,options:l}},w}var ae=ve();function ke(w,E){if(w.picker)return w.picker.setOptions(E,!0);var l={type:"picker"};l.options={};var o=null,O=null,Q=function(M){return M instanceof Element||M instanceof HTMLDocument},ee=function(){O.innerHTML="";for(var M=Object.keys(l.options.data),V=0;V<M.length;V++){var K=document.createElement("div");K.classList.add("jpicker-item"),K.k=M[V],K.v=l.options.data[M[V]];var oe=l.getLabel(M[V],K);Q(oe)?K.appendChild(oe):K.innerHTML=oe,O.appendChild(K)}};l.setOptions=function(M,V){var K={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};M&&M.options&&(M.data=M.options);for(var oe in K)M&&M.hasOwnProperty(oe)?l.options[oe]=M[oe]:(typeof l.options[oe]>"u"||V===!0)&&(l.options[oe]=K[oe]);return l.options.header===!1?o.style.display="none":o.style.display="",l.options.width?o.style.width=parseInt(l.options.width)+"px":o.style.width="",l.options.height?(O.style.maxHeight=l.options.height+"px",O.style.overflow="scroll"):O.style.overflow="",l.options.columns>0&&(l.options.grid?(O.classList.add("jpicker-grid"),O.style.gridTemplateColumns="repeat("+l.options.grid+", 1fr)"):(O.classList.add("jpicker-columns"),O.style.width=l.options.width?l.options.width:36*l.options.columns+"px")),isNaN(parseInt(l.options.value))&&(l.options.value=0),ee(),l.setValue(l.options.value),l},l.getValue=function(){return l.options.value},l.setValue=function(M,V){if(l.setLabel(M),l.options.value=String(M),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value})),O.children[M]&&O.children[M].getAttribute("type")!=="generic"&&l.close(),V&&typeof l.options.onchange=="function"){var K=l.options.data[M];l.options.onchange(w,l,K,K,M,V)}},l.getLabel=function(M,V){var K=l.options.data[M]||null;return typeof l.options.render=="function"&&(K=l.options.render(K,V)),K},l.setLabel=function(M){var V;l.options.content?V='<i class="material-icons">'+l.options.content+"</i>":V=l.getLabel(M,null),Q(V)?(o.innerHTML="",o.appendChild(V)):o.innerHTML=V},l.open=function(){if(!w.classList.contains("jpicker-focus")){u(l,!0),w.classList.add("jpicker-focus"),w.focus();var M=0,V=0;O.style.marginLeft="";var K=o.getBoundingClientRect(),oe=O.getBoundingClientRect();window.innerHeight<K.bottom+oe.height||l.options.bottom?M=-1*(oe.height+4):M=K.height+4,l.options.right===!0&&(V=-1*oe.width+K.width),oe.left+V<0&&(V=V+oe.left+10),oe.left+oe.width>window.innerWidth&&(V=-1*(10+oe.left+oe.width-window.innerWidth)),O.style.marginTop=parseInt(M)+"px",O.style.marginLeft=parseInt(V)+"px",typeof l.options.onopen=="function"&&l.options.onopen(w,l)}},l.close=function(){w.classList.contains("jpicker-focus")&&(w.classList.remove("jpicker-focus"),u(l,!1),typeof l.options.onclose=="function"&&l.options.onclose(w,l))};var D=function(){w.classList.add("jpicker"),w.setAttribute("tabindex","900"),w.onmousedown=function(M){w.classList.contains("jpicker-focus")||l.open()},o=document.createElement("div"),o.classList.add("jpicker-header"),O=document.createElement("div"),O.classList.add("jpicker-content"),O.onclick=function(M){var V=c.findElement(M.target,"jpicker-item");V&&V.parentNode===O&&l.setValue(V.k,M)},w.appendChild(o),w.appendChild(O),w.value=E.value||0,l.setOptions(E),typeof l.options.onload=="function"&&l.options.onload(w,l),w.change=l.setValue,w.val=function(M){if(M===void 0)return l.getValue();l.setValue(M)},w.picker=l};return D(),l}function Ke(w,E){var l={type:"toolbar"};l.options={};var o={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var O in o)E&&E.hasOwnProperty(O)?l.options[O]=E[O]:l.options[O]=o[O];!w&&E.app&&E.app.el&&(w=document.createElement("div"),E.app.el.appendChild(w));var Q=document.createElement("div");Q.classList.add("jtoolbar-item"),Q.classList.add("jtoolbar-arrow");var ee=document.createElement("div");ee.classList.add("jtoolbar-floating"),Q.appendChild(ee),l.selectItem=function(M){for(var V=D.children,K=0;K<V.length;K++)M!=V[K]&&V[K].classList.remove("jtoolbar-selected");M.classList.add("jtoolbar-selected")},l.hide=function(){B.slideBottom(w,0,function(){w.style.display="none"})},l.show=function(){w.style.display="",B.slideBottom(w,1)},l.get=function(){return w},l.setBadge=function(M,V){D.children[M].children[1].firstChild.innerHTML=V},l.destroy=function(){toolbar.remove(),w.innerHTML=""},l.update=function(M,V){for(var K=0;K<D.children.length;K++){var oe=D.children[K];typeof oe.updateState=="function"&&oe.updateState(w,l,oe,M,V)}for(var K=0;K<ee.children.length;K++){var oe=ee.children[K];typeof oe.updateState=="function"&&oe.updateState(w,l,oe,M,V)}},l.create=function(M){D.innerHTML="";for(var V=0;V<M.length;V++){var K=document.createElement("div");if(K.classList.add("jtoolbar-item"),M[V].width&&(K.style.width=parseInt(M[V].width)+"px"),M[V].k&&(K.k=M[V].k),M[V].tooltip&&K.setAttribute("title",M[V].tooltip),M[V].id&&K.setAttribute("id",M[V].id),M[V].updateState&&(K.updateState=M[V].updateState),M[V].active&&K.classList.add("jtoolbar-active"),M[V].disabled&&K.classList.add("jtoolbar-disabled"),M[V].type=="select"||M[V].type=="dropdown")ke(K,M[V]);else if(M[V].type=="divisor")K.classList.add("jtoolbar-divisor");else if(M[V].type=="label")K.classList.add("jtoolbar-label"),K.innerHTML=M[V].content;else{var oe=document.createElement("i");if(typeof M[V].class>"u")oe.classList.add("material-icons");else for(var be=M[V].class.split(" "),de=0;de<be.length;de++)oe.classList.add(be[de]);if(oe.innerHTML=M[V].content?M[V].content:"",K.appendChild(oe),l.options.badge==!0){var fe=document.createElement("div");fe.classList.add("jbadge");var le=document.createElement("div");le.innerHTML=M[V].badge?M[V].badge:"",fe.appendChild(le),K.appendChild(fe)}if(M[V].title)if(l.options.title==!0){var me=document.createElement("span");me.innerHTML=M[V].title,K.appendChild(me)}else K.setAttribute("title",M[V].title);l.options.app&&M[V].route&&(K.route=M[V].route,K.onclick=function(){l.options.app.pages(this.route)},l.options.app.pages(M[V].route,{toolbarItem:K,closed:!0})),typeof M[V].render=="function"&&M[V].render(K,M[V])}M[V].onclick&&(K.onclick=M[V].onclick.bind(M[V],w,l,K)),D.appendChild(K)}setTimeout(function(){l.refresh()},0)},l.open=function(){Q.classList.add("jtoolbar-arrow-selected"),w.getBoundingClientRect();var M=ee.getBoundingClientRect();M.bottom>window.innerHeight||l.options.bottom?ee.style.bottom="0":ee.style.removeProperty("bottom"),ee.style.right="0",Q.children[0].focus(),u(l,!0)},l.close=function(){Q.classList.remove("jtoolbar-arrow-selected"),u(l,!1)},l.refresh=function(){if(l.options.responsive==!0){var M=w.parentNode.getBoundingClientRect();l.options.maxWidth||(l.options.maxWidth=M.width);var V=parseInt(l.options.maxWidth);for(Q.parentNode&&Q.parentNode.removeChild(Q);ee.firstChild;)D.appendChild(ee.firstChild);if(V<D.offsetWidth)for(V-=50;D.lastChild&&V<D.offsetWidth;)ee.insertBefore(D.lastChild,ee.firstChild);ee.children.length>0&&D.appendChild(Q)}},l.setReadonly=function(M){M=M?"add":"remove",w.classList[M]("jtoolbar-disabled")},w.onclick=function(M){var V=c.findElement(M.target,"jtoolbar-item");V&&l.selectItem(V),M.target.classList.contains("jtoolbar-arrow")&&l.open()},window.addEventListener("resize",function(){l.refresh()}),w.classList.add("jtoolbar"),w.innerHTML="",l.options.container==!0&&w.classList.add("jtoolbar-container");var D=document.createElement("div");return w.appendChild(D),l.options.app&&w.classList.add("jtoolbar-mobile"),l.create(l.options.items),w.toolbar=l,l}function Ue(){var w=function(E,l){var o={type:"editor"};o.options={};var O={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var Q in O)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=O[Q];var ee=null,D=null,M=[];o.el=E,typeof o.options.onclick=="function"&&(E.onclick=function(te){o.options.onclick(E,o,te)}),E.classList.add("jeditor-container");var V=document.createElement("div");V.className="jsnippet",V.setAttribute("contenteditable",!1);var K=document.createElement("div");if(K.className="jeditor-toolbar",o.editor=document.createElement("div"),o.editor.setAttribute("contenteditable",!0),o.editor.setAttribute("spellcheck",!1),o.editor.classList.add("jeditor"),o.options.placeholder&&o.editor.setAttribute("data-placeholder",o.options.placeholder),(o.options.maxHeight||o.options.height)&&(o.editor.style.overflowY="auto",o.options.maxHeight&&(o.editor.style.maxHeight=o.options.maxHeight),o.options.height&&(o.editor.style.height=o.options.height)),o.options.url)T({url:o.options.url,dataType:"html",success:function(te){o.editor.innerHTML=te,w.setCursor(o.editor,o.options.focus=="initial")}});else if(o.options.value)o.editor.innerHTML=o.options.value;else for(var oe=0;oe<E.children.length;oe++)o.editor.appendChild(E.children[oe]);E.innerHTML="";var be=function(te){typeof o.options.onchange=="function"&&o.options.onchange(E,o,te),o.options.value=o.getData(),E.value!=o.options.value&&(E.value=o.options.value,typeof E.oninput=="function"&&E.oninput({type:"input",target:E,value:E.value}))},de=function(te){var je=document.createElement("div");je.innerHTML=te;var Ce=je.querySelectorAll("img");if(Ce.length)for(var He=0;He<Ce.length;He++)o.addImage(Ce[He].src)},fe=function(){var te=null;if(te=V.children[0]){te.classList.contains("jslider-grid")||te.classList.add("jslider-grid");var je=te.children.length;te.setAttribute("data-number",je>4?4:je),je>4?te.setAttribute("data-total",je-4):te.removeAttribute("data-total")}},le=function(te){V.innerHTML||o.appendSnippet({}),V.children[0].appendChild(te),fe()};o.appendSnippet=function(te){V.innerHTML="";for(var je=["image","title","description","host","url"],Ce=0;Ce<je.length;Ce++){var He=document.createElement("div");if(He.className="jsnippet-"+je[Ce],He.setAttribute("data-k",je[Ce]),V.appendChild(He),te[je[Ce]])if(je[Ce]=="image"){Array.isArray(te.image)||(te.image=[te.image]);for(var tt=0;tt<te.image.length;tt++){var $e=document.createElement("img");$e.src=te.image[tt],He.appendChild($e)}}else He.innerHTML=te[je[Ce]]}o.editor.appendChild(document.createElement("br")),o.editor.appendChild(V)},o.setData=function(te){typeof te=="object"?o.editor.innerHTML=te.content:o.editor.innerHTML=te,o.options.focus&&w.setCursor(o.editor,!0),M=[]},o.getFiles=function(){for(var te=o.editor.querySelectorAll(".jfile"),je=[],Ce=0;Ce<te.length;Ce++)M[te[Ce].src]&&je.push(M[te[Ce].src]);return je},o.getText=function(){return o.editor.innerText},o.getData=function(te){if(te){var je={content:""};if(V.innerHTML){je.snippet={};for(var Ce=0;Ce<V.children.length;Ce++){var He=V.children[Ce].getAttribute("data-k");if(He)if(He=="image"){je.snippet.image||(je.snippet.image=[]);for(var tt=0;tt<V.children[Ce].children.length;tt++)je.snippet.image.push(V.children[Ce].children[tt].getAttribute("src"))}else je.snippet[He]=V.children[Ce].innerHTML}}var $e=Object.keys(M);if($e.length){je.files=[];for(var Ce=0;Ce<$e.length;Ce++)je.files.push(M[$e[Ce]])}var ot=document.createElement("div");ot.innerHTML=o.editor.innerHTML;var st=ot.querySelector(".jsnippet");st&&st.remove();var Pe=ot.innerHTML;Pe=Pe.replace(/<br>/g,`
`),Pe=Pe.replace(/<\/div>/g,`</div>
`),Pe=Pe.replace(/<(?:.|\n)*?>/gm,""),je.content=Pe.trim(),Fe("getData",je)}else var je=o.editor.innerHTML;return je},o.reset=function(){o.editor.innerHTML="",V.innerHTML="",M=[]},o.addPdf=function(te){if(te.result.substr(0,4)!="data")console.error("Invalid source");else{var je=document.createElement("canvas");je.width=60,je.height=60;var Ce=new Image,He=je.getContext("2d");He.drawImage(Ce,0,0,je.width,je.height),je.toBlob(function(tt){var $e=document.createElement("img");$e.src=window.URL.createObjectURL(tt),$e.title=te.name,$e.className="jfile pdf",M[$e.src]={file:$e.src,extension:"pdf",content:te.result},document.execCommand("insertHtml",!1,$e.outerHTML)})}},o.addImage=function(te,je){if(te||(te=""),te.substr(0,4)!="data"&&!o.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(te.substr(0,4)=="data"){var Ce=te.split(";");Ce=Ce[0].split("/"),Ce=Ce[1]}else{var Ce=te.substr(te.lastIndexOf(".")+1);te=o.options.remoteParser+te}var He=new Image;He.onload=function(){var $e=document.createElement("canvas");$e.width=He.width,$e.height=He.height;var ot=$e.getContext("2d");ot.drawImage(He,0,0,$e.width,$e.height),$e.toBlob(function(st){var Pe=document.createElement("img");Pe.src=window.URL.createObjectURL(st),Pe.classList.add("jfile"),Pe.setAttribute("tabindex","900"),Pe.setAttribute("width",He.width),Pe.setAttribute("height",He.height),M[Pe.src]={file:Pe.src,extension:Ce,content:$e.toDataURL()},o.options.dropAsSnippet||je?(le(Pe),M[Pe.src].snippet=!0):document.execCommand("insertHtml",!1,Pe.outerHTML),be()})},He.src=te}},o.addFile=function(te){for(var je=[],Ce=0;Ce<te.length;Ce++)if(te[Ce].size>o.options.maxFileSize)alert("The file is too big");else{var He=te[Ce].type.split("/");He[0]=="image"?He=1:He[1]=="pdf"?He=2:He=0,He?(je[Ce]=new FileReader,je[Ce].index=Ce,je[Ce].type=He,je[Ce].name=te[Ce].name,je[Ce].date=te[Ce].lastModified,je[Ce].size=te[Ce].size,je[Ce].addEventListener("load",function(tt){tt.target.type==2?o.options.acceptFiles==!0&&o.addPdf(tt.target):o.addImage(tt.target.result)},!1),je[Ce].readAsDataURL(te[Ce])):alert("The extension is not allowed")}},o.destroy=function(){o.editor.removeEventListener("mouseup",ye),o.editor.removeEventListener("mousedown",De),o.editor.removeEventListener("mousemove",we),o.editor.removeEventListener("keyup",Z),o.editor.removeEventListener("keydown",ue),o.editor.removeEventListener("dragstart",W),o.editor.removeEventListener("dragenter",ne),o.editor.removeEventListener("dragover",v),o.editor.removeEventListener("drop",P),o.editor.removeEventListener("paste",X),o.editor.removeEventListener("blur",J),o.editor.removeEventListener("focus",he),E.editor=null,E.classList.remove("jeditor-container"),K.remove(),V.remove(),o.editor.remove()},o.upload=function(){c.click(o.file)};var me=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],Ie=["width","height","align","border","src","tabindex"],We=["color","font-weight","font-size","background","background-color","margin"],Je=function(te){if(te.attributes&&te.attributes.length){var je=null,Ce=te.getAttribute("style");if(Ce){je=[];for(var He=Ce.split(";"),tt=0;tt<He.length;tt++){var $e=He[tt].trim().split(":");if(We.indexOf($e[0].trim())>=0){var ot=$e.shift(),$e=$e.join(":");je.push(ot+":"+$e)}}}te.tagName.toUpperCase()=="IMG"&&(!o.options.acceptImages||!te.src?te.parentNode.removeChild(te):(te.setAttribute("tabindex","900"),o.addImage(te.src)));for(var st=[],Pe=0;Pe<te.attributes.length;Pe++)st.push(te.attributes[Pe].name);st.length&&st.forEach(function(Ye){Ie.indexOf(Ye)==-1?te.removeAttribute(Ye):te.attributes[Pe].value.indexOf("<")!==-1&&te.attributes[Pe].value.replace("<","&#60;")}),te.style="",je&&je.length&&te.setAttribute("style",je.join(";"))}if(te.children.length)for(var Pe=0;Pe<te.children.length;Pe++)Je(te.children[Pe]);me.indexOf(te.constructor)>=0&&te.remove()},ce=function(te){var je=window.getSelection(),Ce=document.createRange();Ce.selectNode(te),je.addRange(Ce)},Ae=function(te){te&&(te=te.replace(new RegExp("<!--(.*?)-->","gsi"),""));var je=new DOMParser,Ce=je.parseFromString(te,"text/html");Je(Ce);var He=document.createElement("span");return He.innerHTML=Ce.firstChild.innerHTML,He},X=function(te){if(o.options.filterPaste==!0){if(te.clipboardData||te.originalEvent.clipboardData)var je=(te.originalEvent||te).clipboardData.getData("text/html"),Ce=(te.originalEvent||te).clipboardData.getData("text/plain"),He=(te.originalEvent||te).clipboardData.files;else if(window.clipboardData)var je=window.clipboardData.getData("Html"),Ce=window.clipboardData.getData("Text"),He=window.clipboardData.files;if(He.length)o.addFile(He);else if(!je)je=Ce.split(`\r
`),te.target.innerText?(je=je.map(function($e){return"<div>"+$e+"</div>"}),document.execCommand("insertHtml",!1,je.join(""))):je.map(function($e){var ot=document.createElement("div");ot.innerText=$e,o.editor.appendChild(ot)});else{var tt=Ae(je);document.execCommand("insertHtml",!1,tt.innerHTML)}te.preventDefault()}},W=function(te){D&&D.e&&te.preventDefault()},ne=function(te){D||o.options.dropZone==!1||(E.classList.add("jeditor-dragging"),te.preventDefault())},v=function(te){D||o.options.dropZone==!1||(ee&&clearTimeout(ee),ee=setTimeout(function(){E.classList.remove("jeditor-dragging")},100),te.preventDefault())},P=function(te){if(!(D||o.options.dropZone==!1)){var je=null;document.caretRangeFromPoint?je=document.caretRangeFromPoint(te.clientX,te.clientY):te.rangeParent&&(je=document.createRange(),je.setStart(te.rangeParent,te.rangeOffset));var Ce=window.getSelection();Ce.removeAllRanges(),Ce.addRange(je),Ce.anchorNode.parentNode.focus();var He=(te.originalEvent||te).dataTransfer.getData("text/html"),tt=(te.originalEvent||te).dataTransfer.getData("text/plain"),$e=(te.originalEvent||te).dataTransfer.files;$e.length?o.addFile($e):tt&&de(He),E.classList.remove("jeditor-dragging"),te.preventDefault()}},J=function(te){Fe("onevent",te),be(te),typeof o.options.onblur=="function"&&o.options.onblur(E,o,te)},he=function(te){typeof o.options.onfocus=="function"&&o.options.onfocus(E,o,te)},Z=function(te){o.editor.innerHTML||(o.editor.innerHTML="<div><br></div>"),typeof o.options.onkeyup=="function"&&o.options.onkeyup(E,o,te)},ue=function(te){if(Fe("onevent",te),te.key=="Delete"&&te.target.tagName=="IMG"){var je=te.target.parentNode;ce(te.target),je.classList.contains("jsnippet-image")&&fe()}typeof o.options.onkeydown=="function"&&o.options.onkeydown(E,o,te)},ye=function(te){if(D&&D.e&&(D.e.classList.remove("resizing"),D.e.changed==!0)){var je=D.e.cloneNode();je.width=parseInt(D.e.style.width)||D.e.getAttribute("width"),je.height=parseInt(D.e.style.height)||D.e.getAttribute("height"),D.e.style.width="",D.e.style.height="",ce(D.e),document.execCommand("insertHtml",!1,je.outerHTML)}D=!1},De=function(te){var je=function($e){var ot=$e.getBoundingClientRect();ot.width-(te.clientX-ot.left)<40&&te.clientY-ot.top<40&&($e.innerHTML="",$e.remove())};if(te.target.tagName=="IMG")if(te.target.style.cursor){var Ce=te.target.getBoundingClientRect();D={e:te.target,x:te.clientX,y:te.clientY,w:Ce.width,h:Ce.height,d:te.target.style.cursor},te.target.getAttribute("width")||te.target.setAttribute("width",Ce.width),te.target.getAttribute("height")||te.target.setAttribute("height",Ce.height);var He=window.getSelection();if(He.rangeCount)for(var tt=0;tt<He.rangeCount;tt++)He.removeRange(He.getRangeAt(tt));te.target.classList.add("resizing")}else D=!0;else te.target.classList.contains("jsnippet")?je(te.target):te.target.parentNode.classList.contains("jsnippet")&&je(te.target.parentNode),D=!0},we=function(te){if(te.target.tagName=="IMG"&&!te.target.parentNode.classList.contains("jsnippet-image")&&o.options.allowImageResize==!0&&te.target.getAttribute("tabindex")){var je=te.target.getBoundingClientRect();te.clientY-je.top<5?je.width-(te.clientX-je.left)<5?te.target.style.cursor="ne-resize":te.clientX-je.left<5?te.target.style.cursor="nw-resize":te.target.style.cursor="n-resize":je.height-(te.clientY-je.top)<5?je.width-(te.clientX-je.left)<5?te.target.style.cursor="se-resize":te.clientX-je.left<5?te.target.style.cursor="sw-resize":te.target.style.cursor="s-resize":je.width-(te.clientX-je.left)<5?te.target.style.cursor="e-resize":te.clientX-je.left<5?te.target.style.cursor="w-resize":te.target.style.cursor=""}if(te.which==1&&D&&D.d){if(D.d=="e-resize"||D.d=="ne-resize"||D.d=="se-resize")if(D.e.style.width=D.w+(te.clientX-D.x),te.shiftKey){var Ce=(te.clientX-D.x)*(D.h/D.w);D.e.style.height=D.h+Ce}else var Ce=null;Ce||(D.d=="s-resize"||D.d=="se-resize"||D.d=="sw-resize")&&(te.shiftKey||(D.e.style.height=D.h+(te.clientY-D.y))),D.e.changed=!0}},Fe=function(te,je){if(o.options.extensions){var Ce=Object.keys(o.options.extensions);if(Ce.length)for(var He=0;He<Ce.length;He++)o.options.extensions[Ce[He]]&&typeof o.options.extensions[Ce[He]][te]=="function"&&o.options.extensions[Ce[He]][te].call(o,je)}},Ve=function(){if(o.options.extensions){var te=Object.keys(o.options.extensions);if(te.length)for(var je=0;je<te.length;je++)o.options.extensions[te[je]]&&typeof o.options.extensions[te[je]]=="function"&&(o.options.extensions[te[je]]=o.options.extensions[te[je]](E,o))}};if(document.addEventListener("mouseup",ye),document.addEventListener("mousemove",we),o.editor.addEventListener("mousedown",De),o.editor.addEventListener("keyup",Z),o.editor.addEventListener("keydown",ue),o.editor.addEventListener("dragstart",W),o.editor.addEventListener("dragenter",ne),o.editor.addEventListener("dragover",v),o.editor.addEventListener("drop",P),o.editor.addEventListener("paste",X),o.editor.addEventListener("focus",he),o.editor.addEventListener("blur",J),E.appendChild(o.editor),o.options.snippet&&o.appendSnippet(o.options.snippet),o.options.toolbar){if(Array.isArray(o.options.toolbar))var Ze={container:!0,responsive:!0,items:o.options.toolbar};else if(o.options.toolbar===!0)var Ze={container:!0,responsive:!0,items:[]};else var Ze=o.options.toolbar;Ze.items&&Ze.items.length||(Ze.items=w.getDefaultToolbar(o)),o.options.toolbarOnTop?(E.classList.add("toolbar-on-top"),E.insertBefore(K,E.firstChild)):(o.editor.style.padding="15px",E.appendChild(K)),Ke(K,Ze),K.addEventListener("click",function(){o.editor.focus()})}return o.file=document.createElement("input"),o.file.style.display="none",o.file.type="file",o.file.setAttribute("accept","image/*"),o.file.onchange=function(){o.addFile(this.files)},E.appendChild(o.file),o.options.focus&&w.setCursor(o.editor,o.options.focus=="initial"),E.change=o.setData,E.val=function(te){if(te===void 0){var je=E.getAttribute("data-html")!=="true";return o.getData(je)}else o.setData(te)},Ve(),E.editor=o,typeof o.options.onload=="function"&&o.options.onload(E,o,o.editor),o};return w.setCursor=function(E,l){E.focus(),document.execCommand("selectAll");var o=window.getSelection(),O=o.getRangeAt(0);if(l==!0)var Q=O.startContainer,ee=0;else var Q=O.endContainer,ee=Q.length;O.setStart(Q,ee),O.setEnd(Q,ee),o.removeAllRanges(),o.addRange(O)},w.getDefaultToolbar=function(E){var l=function(O,Q,ee){ee.color||(ie(ee,{onchange:function(D,M){ee.k==="color"?document.execCommand("foreColor",!1,M):document.execCommand("backColor",!1,M)}}),ee.color.open())},o=[];return o.push({content:"undo",onclick:function(){document.execCommand("undo")}}),o.push({content:"redo",onclick:function(){document.execCommand("redo")}}),o.push({type:"divisor"}),E.options.toolbarOnTop&&(o.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(O){return'<span style="font-family:'+O+'">'+O+"</span>"},onchange:function(O,Q,ee,D,M){document.execCommand("fontName",!1,D)}}),o.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(O){return'<span style="font-size:'+O+'">'+O+"</span>"},onchange:function(O,Q,ee,D,M){document.execCommand("fontSize",!1,parseInt(M)+1)}}),o.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(O){return'<i class="material-icons">'+O+"</i>"},onchange:function(O,Q,ee,D,M){var V=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(V[M])}}),o.push({type:"divisor"}),o.push({content:"format_color_text",k:"color",onclick:l}),o.push({content:"format_color_fill",k:"background-color",onclick:l})),o.push({content:"format_bold",onclick:function(O,Q,ee){document.execCommand("bold"),document.queryCommandState("bold")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({content:"format_italic",onclick:function(O,Q,ee){document.execCommand("italic"),document.queryCommandState("italic")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({content:"format_underline",onclick:function(O,Q,ee){document.execCommand("underline"),document.queryCommandState("underline")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({type:"divisor"}),o.push({content:"format_list_bulleted",onclick:function(O,Q,ee){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({content:"format_list_numbered",onclick:function(O,Q,ee){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({content:"format_indent_increase",onclick:function(O,Q,ee){document.execCommand("indent",!0,null),document.queryCommandState("indent")?ee.classList.add("selected"):ee.classList.remove("selected")}}),o.push({content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}),E.options.toolbarOnTop&&(o.push({type:"divisor"}),o.push({content:"photo",onclick:function(){E.upload()}}),o.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(O,Q){Q&&(Q.onmouseover=this.onmouseover,O=O.split("x"),Q.setAttribute("data-x",O[0]),Q.setAttribute("data-y",O[1]));var ee=document.createElement("div");return Q.style.margin="1px",Q.style.border="1px solid #ddd",ee},onmouseover:function(O){for(var Q=parseInt(O.target.getAttribute("data-x")),ee=parseInt(O.target.getAttribute("data-y")),D=0;D<O.target.parentNode.children.length;D++){var M=O.target.parentNode.children[D],V=parseInt(M.getAttribute("data-x")),K=parseInt(M.getAttribute("data-y"));V<=Q&&K<=ee?(M.style.backgroundColor="#cae1fc",M.style.borderColor="#2977ff"):(M.style.backgroundColor="",M.style.borderColor="#ddd")}},onchange:function(O,Q,ee){ee=ee.split("x");for(var D=document.createElement("table"),M=document.createElement("tbody"),V=0;V<=ee[1];V++){for(var K=document.createElement("tr"),oe=0;oe<=ee[0];oe++){var be=document.createElement("td");be.innerHTML="",K.appendChild(be)}M.appendChild(K)}D.appendChild(M),D.setAttribute("width","100%"),D.setAttribute("cellpadding","6"),D.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,D.outerHTML)}})),o},w}var Be=Ue();function lt(){var w=function(E,l){var o={};o.options={};var O={type:"big",title:"Untitled",width:510,height:472};for(var Q in O)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=O[Q];var ee=function(){for(var V=document.createElement("div");E.children[0];)V.appendChild(E.children[0]);for(o.content=document.createElement("div"),o.content.className="jfloating_content",o.content.innerHTML=E.innerHTML;V.children[0];)o.content.appendChild(V.children[0]);o.container=document.createElement("div"),o.container.className="jfloating",o.container.appendChild(o.content),o.options.title?o.container.setAttribute("title",o.options.title):o.container.classList.add("no-title"),o.options.width&&(o.container.style.width=parseInt(o.options.width)+"px"),o.options.height&&(o.container.style.height=parseInt(o.options.height)+"px"),E.innerHTML="",E.appendChild(o.container)},D=function(){o.container&&o.container.addEventListener("click",function(V){var K=V.target.getBoundingClientRect();if(V.target.classList.contains("jfloating")){if(V.changedTouches&&V.changedTouches[0])var oe=V.changedTouches[0].clientX,be=V.changedTouches[0].clientY;else var oe=V.clientX,be=V.clientY;K.width-(oe-K.left)<50&&be-K.top<50?setTimeout(function(){o.close()},100):o.setState()}})},M=function(){o.container.classList.add("jfloating-"+o.options.type)};return o.state={isMinized:!1},o.setState=function(){o.state.isMinized?o.container.classList.remove("jfloating-minimized"):o.container.classList.add("jfloating-minimized"),o.state.isMinized=!o.state.isMinized},o.close=function(){Components.elements.splice(w.elements.indexOf(o.container),1),o.updatePosition(),E.remove()},o.updatePosition=function(){for(var V=0;V<w.elements.length;V++){var K=w.elements[V],oe=w.elements[V-1];K.style.right=V*(oe?oe.offsetWidth:K.offsetWidth)*1.01+"px"}},o.init=function(){ee(),D(),M(),w.elements.push(o.container),o.updatePosition(),E.floating=o},o.init(),o};return w.elements=[],w}var Y=lt();function Le(){const w=function(D){return!isNaN(D)&&D!==null&&D!==""},E={between:function(D,M){return D>=M[0]&&D<=M[1]},"not between":function(D,M){return D<M[0]||D>M[1]},"<":function(D,M){return D<M[0]},"<=":function(D,M){return D<=M[0]},">":function(D,M){return D>M[0]},">=":function(D,M){return D>=M[0]},"=":function(D,M){return D==M[0]},"!=":function(D,M){return D!=M[0]}},l={"valid date":function(){return!0},"=":function(D,M){return D===M[0]},"!=":function(D,M){return D!==M[0]},"<":function(D,M){return D<M[0]},"<=":function(D,M){return D<=M[0]},">":function(D,M){return D>M[0]},">=":function(D,M){return D>=M[0]},between:function(D,M){return D>=M[0]&&D<=M[1]},"not between":function(D,M){return D<M[0]||D>M[1]}},o={contains:function(D,M){return D.includes(M[0])},"not contains":function(D,M){return!D.includes(M[0])},"begins with":function(D,M){return D.startsWith(M[0])},"ends with":function(D,M){return D.endsWith(M[0])},"=":function(D,M){return D===M[0]},"!=":function(D,M){return D!==M[0]},"valid email":function(D){var M=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return M.test(D)},"valid url":function(D){var M=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return M.test(D)}},O=function(D,M){return typeof O[M.type]=="function"?M.allowBlank&&D===""?!0:O[M.type](D,M):null};O.url=function(D){var M=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!M.test(D)},O.email=function(D){var M=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(D&&M.test(D))},O.required=function(D){return!!(D&&D.trim())},O.exist=function(D,M){return!!D.toString().trim()},O["not exist"]=function(D,M){return!D.toString().trim()},O.empty=function(D){return!D.toString().trim()},O.notEmpty=function(D){return!!D.toString().trim()},O.number=function(D,M){if(!w(D))return!1;if(!M||!M.criteria)return!0;if(!E[M.criteria])return!1;let V=M.value.map(function(K){return parseFloat(K)});return E[M.criteria](D,V)},O.login=function(D){let M=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(D&&M.test(D))},O.list=function(D,M){let V=typeof D;if(V!=="string"&&V!=="number")return!1;let K;return typeof M.value[0]=="string"?K=M.value[0].split(","):K=M.value[0],Array.isArray(K)?K.findIndex(function(be){return be==D})>-1:!1};const Q=function(){let D=new Date;return D.setHours(0,0,0,0),D},ee={"one year ago":function(){let D=Q();return D.setFullYear(D.getFullYear()-1),D},"one month ago":function(){let D=Q();return D.setMonth(D.getMonth()-1),D},"one week ago":function(){let D=Q();return D.setDate(D.getDate()-7),D},yesterday:function(){let D=Q();return D.setDate(D.getDate()-1),D},today:Q,tomorrow:function(){let D=Q();return D.setDate(D.getDate()+1),D}};return O.date=function(D,M){if(w(D)&&D>0&&D<1e6&&(D=b.numToDate(D)),new Date(D)=="Invalid Date")return!1;if(!M||!M.criteria)return!0;if(!l[M.criteria])return!1;let V=M.value.map(function(K){return typeof K=="string"&&ee[K]?ee[K]().getTime():new Date(K).getTime()});return l[M.criteria](new Date(D).getTime(),V)},O.text=function(D,M){return typeof D!="string"?!1:!M||!M.criteria?!0:o[M.criteria]?o[M.criteria](D,M.value):!1},O.textLength=function(D,M){return D=D.toString(),O.number(D.length,M)},O}var qe=Le();function mt(){var w=function(E,l){var o={};o.options={};var O={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(M,V){alert(V)}};for(var Q in O)l&&l.hasOwnProperty(Q)?o.options[Q]=l[Q]:o.options[Q]=O[Q];o.options.validations||(o.options.validations={}),o.options.submitButton||(o.options.submitButton=E.querySelector("input[type=submit]")),o.options.submitButton&&o.options.url&&(o.options.submitButton.onclick=function(){o.save()}),o.options.validations.email||(o.options.validations.email=qe.email),o.options.validations.length||(o.options.validations.length=qe.length),o.options.validations.required||(o.options.validations.required=qe.required),o.setUrl=function(M){o.options.url=M},o.load=function(){T({url:o.options.url,method:"GET",dataType:"json",queue:!0,success:function(M){if(typeof o.options.onbeforeload=="function"){var V=o.options.onbeforeload(E,M);V&&(M=V)}w.setElements(E,M),typeof o.options.onload=="function"&&o.options.onload(E,M)}})},o.save=function(){var M=o.validate();if(M)o.options.onerror(E,M);else{var V=w.getElements(E,!0);if(typeof o.options.onbeforesave=="function"){var V=o.options.onbeforesave(E,V);if(V===!1)return}T({url:o.options.url,method:"POST",dataType:"json",data:V,success:function(K){typeof o.options.onsave=="function"&&o.options.onsave(E,V,K)}})}},o.remove=function(){if(typeof o.options.onbeforeremove=="function"){var M=o.options.onbeforeremove(E,o);if(M===!1)return!1}T({url:o.options.url,method:"DELETE",dataType:"json",success:function(V){typeof o.options.onremove=="function"&&o.options.onremove(E,o,V),o.reset()}})};var ee=function(M){M.classList.add("error"),o.options.submitButton&&o.options.submitButton.setAttribute("disabled",!0);var V=M.getAttribute("data-error")||"There is an error in the form";return M.setAttribute("title",V),V},D=function(M){var V=!1;M.classList.remove("error"),M.removeAttribute("title");for(var K=E.querySelectorAll("input, select, textarea, div[name]"),oe=0;oe<K.length;oe++)K[oe].getAttribute("data-validation")&&K[oe].classList.contains("error")&&(V=!0);o.options.submitButton&&(V?o.options.submitButton.setAttribute("disabled",!0):o.options.submitButton.removeAttribute("disabled"))};return o.validateElement=function(M){var V=!1,K=w.getValue(M),oe=M.getAttribute("data-validation");return typeof o.options.validations[oe]=="function"&&!o.options.validations[oe](K,M)?V=ee(M):M.classList.contains("error")&&D(M),V},o.reset=function(){for(var M=E.querySelectorAll("input, select, textarea, div[name]"),V=0;V<M.length;V++)M[V].getAttribute("name")&&(M[V].type=="checkbox"||M[V].type=="radio"?M[V].checked=!1:typeof M[V].val=="function"?M[V].val(""):M[V].value="")},o.validate=function(){for(var M=[],V=E.querySelectorAll("input, select, textarea, div[name]"),K=0;K<V.length;K++)if(V[K].getAttribute("data-validation")){var oe=o.validateElement(V[K]);oe&&M.push(oe)}return M.length>0?M.join("<br>"):!1},o.getError=function(){return!!o.validation()},o.setHash=function(){return o.getHash(w.getElements(E))},o.getHash=function(M){var V=0,K,oe;if(M.length===0)return V;for(K=0;K<M.length;K++)oe=M.charCodeAt(K),V=(V<<5)-V+oe,V|=0;return V},o.isChanged=function(){var M=o.setHash();return o.options.currentHash!=M},o.resetTracker=function(){o.options.currentHash=o.setHash(),o.options.ignore=!1},o.setIgnore=function(M){o.options.ignore=!!M},setTimeout(function(){o.options.currentHash=o.setHash()},1e3),E.addEventListener("keyup",function(M){M.target.getAttribute("data-validation")&&o.validateElement(M.target)}),w.hasEvents||(window.addEventListener("beforeunload",function(M){if(o.isChanged()&&o.options.ignore==!1){var V=o.options.message?o.options.message:"o/";return V?(typeof M>"u"&&(M=window.event),M&&(M.returnValue=V),V):void 0}}),w.hasEvents=!0),E.form=o,o};return w.getValue=function(E){var l=null;if(E.type=="checkbox")E.checked==!0&&(l=E.value||!0);else if(E.type=="radio")E.checked==!0&&(l=E.value);else if(E.type=="file")l=E.files;else if(E.tagName=="select"&&E.multiple==!0){l=[];for(var o=E.querySelectorAll("options[selected]"),O=0;O<o.length;O++)l.push(o[O].value)}else typeof E.val=="function"?l=E.val():l=E.value||"";return l},w.getElements=function(E,l){for(var o={},O=null,Q=E.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<Q.length;ee++)(O=Q[ee].getAttribute("name"))&&(o[O]=w.getValue(Q[ee])||"");return l==!0?o:JSON.stringify(o)},w.setElements=function(E,l){for(var o=null,O=null,Q=E.querySelectorAll("input, select, textarea, div[name]"),ee=0;ee<Q.length;ee++){var D=Q[ee].getAttribute("type");if(o=Q[ee].getAttribute("name")){if(o=o.replace(new RegExp(/\[(.*?)\]/ig),".$1"),O=null,o.match(/\./)){var M=m.call(l,o)||"";typeof M<"u"&&(O=M)}else typeof l[o]<"u"&&(O=l[o]);O!==null&&(D=="checkbox"||D=="radio"?Q[ee].checked=!!O:D=="file"||(typeof Q[ee].val=="function"?Q[ee].val(O):Q[ee].value=O))}}},w}var Me=mt();function Ne(){var w=function(){var l=null,o=function(D){if(D.which==27)for(var M=document.querySelectorAll(".jmodal"),V=0;V<M.length;V++)M[V].parentNode.modal.close()},O=function(D){let M=D.composedPath();var V=c.findElement(M[0],"jmodal");if(V){var K=V.getBoundingClientRect();if(D.changedTouches&&D.changedTouches[0])var oe=D.changedTouches[0].clientX,be=D.changedTouches[0].clientY;else var oe=D.clientX,be=D.clientY;K.width-(oe-K.left)<50&&be-K.top<50&&V.parentNode.modal.close()}l&&(l.element.style.cursor="auto",l=null)},Q=function(D){let M=D.composedPath();var V=c.findElement(M[0],"jmodal");if(V){var K=V.getBoundingClientRect();if(D.changedTouches&&D.changedTouches[0])var oe=D.changedTouches[0].clientX,be=D.changedTouches[0].clientY;else var oe=D.clientX,be=D.clientY;K.width-(oe-K.left)<50&&be-K.top<50||be-K.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),l={left:K.left,top:K.top,x:D.clientX,y:D.clientY,width:K.width,height:K.height,element:V})}},ee=function(D){if(l){if(D=D||window.event,D.buttons)var M=D.buttons;else if(D.button)var M=D.button;else var M=D.which;M?(l.element.style.top=l.top+(D.clientY-l.y)+l.height/2+"px",l.element.style.left=l.left+(D.clientX-l.x)+l.width/2+"px",l.element.style.cursor="move"):l.element.style.cursor="auto"}};document.addEventListener("keydown",o),document.addEventListener("mouseup",O),document.addEventListener("mousedown",Q),document.addEventListener("mousemove",ee)},E=function(l,o){var O={};O.options={};var Q={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var ee in Q)o&&o.hasOwnProperty(ee)?O.options[ee]=o[ee]:O.options[ee]=Q[ee];!O.options.title&&l.getAttribute("title")&&(O.options.title=l.getAttribute("title"));for(var D=document.createElement("div");l.children[0];)D.appendChild(l.children[0]);for(O.title=document.createElement("div"),O.title.className="jmodal_title",O.options.icon&&O.title.setAttribute("data-icon",O.options.icon),O.content=document.createElement("div"),O.content.className="jmodal_content",O.content.innerHTML=l.innerHTML;D.children[0];)O.content.appendChild(D.children[0]);if(O.container=document.createElement("div"),O.container.className="jmodal",O.container.appendChild(O.title),O.container.appendChild(O.content),O.options.padding&&(O.content.style.padding=O.options.padding),O.options.width&&(O.container.style.width=O.options.width),O.options.height&&(O.container.style.height=O.options.height),O.options.title){var M=document.createElement("h4");M.innerText=O.options.title,O.title.appendChild(M)}if(l.innerHTML="",l.style.display="none",l.appendChild(O.container),O.options.backdrop){var V=document.createElement("div");V.className="jmodal_backdrop",V.onclick=function(){O.close()},l.appendChild(V)}return O.open=function(){l.style.display="block";var K=O.container.getBoundingClientRect();c.getWindowWidth()<K.width?(O.container.style.top="",O.container.style.left="",O.container.classList.add("jmodal_fullscreen"),B.slideBottom(O.container,1)):O.options.backdrop&&(V.style.display="block"),typeof O.options.onopen=="function"&&O.options.onopen(l,O)},O.resetPosition=function(){O.container.style.top="",O.container.style.left=""},O.isOpen=function(){return l.style.display!="none"},O.close=function(){O.isOpen()&&(l.style.display="none",O.options.backdrop&&(V.style.display=""),O.container.classList.remove("jmodal_fullscreen"),typeof O.options.onclose=="function"&&O.options.onclose(l,O))},O.options.url?T({url:O.options.url,method:"GET",dataType:"text/html",success:function(K){O.content.innerHTML=K,O.options.closed||O.open(),typeof O.options.onload=="function"&&O.options.onload(O)}}):(O.options.closed||O.open(),typeof O.options.onload=="function"&&O.options.onload(O)),l.modal=O,w(),w=function(){},O};return E}var Oe=Ne();function ze(){var w=function(E){var l={};l.options={};var o={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var O in o)E&&E.hasOwnProperty(O)?l.options[O]=E[O]:l.options[O]=o[O];var Q=document.createElement("div");Q.className="jnotification",l.options.error&&Q.classList.add("jnotification-error");var ee=document.createElement("div");ee.className="jnotification-container",Q.appendChild(ee);var D=document.createElement("div");D.className="jnotification-header",ee.appendChild(D);var M=document.createElement("div");if(M.className="jnotification-image",D.appendChild(M),l.options.icon){var V=document.createElement("img");V.src=l.options.icon,M.appendChild(V)}var K=document.createElement("div");if(K.className="jnotification-name",K.innerHTML=l.options.name,D.appendChild(K),l.options.closeable==!0){var oe=document.createElement("div");oe.className="jnotification-close",oe.onclick=function(){l.hide()},D.appendChild(oe)}var be=document.createElement("div");be.className="jnotification-date",D.appendChild(be);var de=document.createElement("div");if(de.className="jnotification-content",ee.appendChild(de),l.options.title){var fe=document.createElement("div");fe.className="jnotification-title",fe.innerHTML=l.options.title,de.appendChild(fe)}var le=document.createElement("div");if(le.className="jnotification-message",le.innerHTML=l.options.message,de.appendChild(le),l.show=function(){document.body.appendChild(Q),c.getWindowWidth()>800?B.fadeIn(Q):B.slideTop(Q,1)},l.hide=function(){c.getWindowWidth()>800?B.fadeOut(Q,function(){Q.parentNode&&(Q.parentNode.removeChild(Q),me&&clearTimeout(me))}):B.slideTop(Q,0,function(){Q.parentNode&&(Q.parentNode.removeChild(Q),me&&clearTimeout(me))})},l.show(),l.options.autoHide==!0)var me=setTimeout(function(){l.hide()},l.options.timeout);return c.getWindowWidth()<800&&Q.addEventListener("swipeup",function(Ie){l.hide(),Ie.preventDefault(),Ie.stopPropagation()}),l};return w.isVisible=function(){var E=document.querySelector(".jnotification");return!!(E&&E.parentNode)},w}var Ge=ze();function Qe(w,E){var l={};l.options={};var o={value:0,onchange:null,width:null};for(var O in o)E&&E.hasOwnProperty(O)?l.options[O]=E[O]:l.options[O]=o[O];w.classList.add("jprogressbar"),w.setAttribute("tabindex",1),w.setAttribute("data-value",l.options.value);var Q=document.createElement("div");Q.style.width=l.options.value+"%",Q.style.color="#fff",w.appendChild(Q),l.options.width&&(w.style.width=l.options.width),l.setValue=function(D){D=parseInt(D),l.options.value=D,Q.style.width=D+"%",w.setAttribute("data-value",D+"%"),D<6?w.style.color="#000":w.style.color="#fff",l.options.value=D,typeof l.options.onchange=="function"&&l.options.onchange(w,D),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},l.getValue=function(){return l.options.value};var ee=function(D){if(D.which){var M=w.getBoundingClientRect();if(D.changedTouches&&D.changedTouches[0]){var V=D.changedTouches[0].clientX;D.changedTouches[0].clientY}else{var V=D.clientX;D.clientY}l.setValue(Math.round((V-M.left)/M.width*100))}};return"touchstart"in document.documentElement?(w.addEventListener("touchstart",ee),w.addEventListener("touchend",ee)):(w.addEventListener("mousedown",ee),w.addEventListener("mousemove",ee)),w.change=l.setValue,w.val=function(D){if(D===void 0)return l.getValue();l.setValue(D)},w.progressbar=l,l}function ct(w,E){if(w.rating)return w.rating.setOptions(E,!0);var l={};l.options={},l.setOptions=function(O,Q){var ee={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var D in ee)O&&O.hasOwnProperty(D)?l.options[D]=O[D]:(typeof l.options[D]>"u"||Q===!0)&&(l.options[D]=ee[D]);w.innerHTML="";for(var M=0;M<l.options.number;M++){var V=document.createElement("div");V.setAttribute("data-index",M+1),V.setAttribute("title",l.options.tooltip[M]),w.appendChild(V)}if(l.options.value)for(var M=0;M<l.options.number;M++)M<l.options.value&&w.children[M].classList.add("jrating-selected");return l},l.setValue=function(O){for(var Q=0;Q<l.options.number;Q++)Q<O?w.children[Q].classList.add("jrating-selected"):(w.children[Q].classList.remove("jrating-over"),w.children[Q].classList.remove("jrating-selected"));l.options.value=O,typeof l.options.onchange=="function"&&l.options.onchange(w,O),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))},l.getValue=function(){return l.options.value};var o=function(){l.setOptions(E),w.classList.add("jrating"),w.addEventListener("click",function(O){var Q=O.target.getAttribute("data-index");Q!=null&&(Q==l.options.value?l.setValue(0):l.setValue(Q))}),w.addEventListener("mouseover",function(O){for(var Q=O.target.getAttribute("data-index"),ee=0;ee<l.options.number;ee++)ee<Q?w.children[ee].classList.add("jrating-over"):w.children[ee].classList.remove("jrating-over")}),w.addEventListener("mouseout",function(O){for(var Q=0;Q<l.options.number;Q++)w.children[Q].classList.remove("jrating-over")}),w.change=l.setValue,w.val=function(O){if(O===void 0)return l.getValue();l.setValue(O)},w.rating=l};return o(),l}function at(w,E){if(w.search)return w.search;var l=null,o=function(V){if(V.target.classList.contains("jsearch_item"))var K=V.target;else var K=V.target.parentNode;D.selectIndex(K),V.preventDefault()},O=function(V){if(typeof D.options.onsearch=="function"){var K=D.options.onsearch(D,V);K&&(V=K)}if(M.innerHTML="",!V.length)w.style.display="";else{w.style.display="block";for(var oe=V.length<11?V.length:10,be=0;be<oe;be++){if(typeof V[be]=="string")var de=V[be],fe=V[be];else{var de=V[be].text;!de&&V[be].name&&(de=V[be].name);var fe=V[be].value;!fe&&V[be].id&&(fe=V[be].id)}var le=document.createElement("div");le.setAttribute("data-value",fe),le.setAttribute("data-text",de),le.className="jsearch_item",V[be].id&&le.setAttribute("id",V[be].id),D.options.forceSelect&&be==0&&le.classList.add("selected");var me=document.createElement("img");V[be].image?me.src=V[be].image:me.style.display="none",le.appendChild(me);var Ie=document.createElement("div");Ie.innerHTML=de,le.appendChild(Ie),M.appendChild(le)}}},Q=function(V){if(V!=D.terms)if(D.terms=V,D.options.forceSelect?l=0:l=null,Array.isArray(D.options.data)){var K=function(be){if(typeof be=="string"){if((""+be).toLowerCase().search(V.toLowerCase())>=0)return!0}else for(var de in be){var fe=be[de];if((""+fe).toLowerCase().search(V.toLowerCase())>=0)return!0}return!1},oe=D.options.data.filter(function(be){return K(be)});O(oe)}else T({url:D.options.data+V,method:"GET",dataType:"json",success:function(be){O(be)}})},ee=null,D=function(V){ee&&clearTimeout(ee),ee=setTimeout(function(){Q(V)},500)};E.forceSelect===null&&(E.forceSelect=!0),D.options={data:E.data||null,input:E.input||null,searchByNode:E.searchByNode||null,onselect:E.onselect||null,forceSelect:E.forceSelect,onsearch:E.onsearch||null,onbeforesearch:E.onbeforesearch||null},D.selectIndex=function(V){var K=V.getAttribute("id"),oe=V.getAttribute("data-text"),be=V.getAttribute("data-value"),de=V.children[0].src||"";typeof D.options.onselect=="function"&&D.options.onselect(D,oe,be,K,de),D.close()},D.open=function(){w.style.display="block"},D.close=function(){ee&&clearTimeout(ee),D.terms="",M.innerHTML="",w.style.display=""},D.isOpened=function(){return!!w.style.display},D.keydown=function(V){D.isOpened()&&(V.key=="Enter"?l!==null&&M.children[l]?(D.selectIndex(M.children[l]),V.preventDefault()):D.close():V.key==="ArrowUp"?(l!==null&&M.children[0]&&(M.children[l].classList.remove("selected"),!D.options.forceSelect&&l===0?l=null:(l=Math.max(0,l-1),M.children[l].classList.add("selected"))),V.preventDefault()):V.key==="ArrowDown"&&(l==null?l=-1:M.children[l].classList.remove("selected"),l<9&&M.children[l+1]&&l++,M.children[l].classList.add("selected"),V.preventDefault()))},D.keyup=function(V){if(!D.options.searchByNode&&D.options.input)if(D.options.input.tagName==="DIV")var K=D.options.input.innerText;else var K=D.options.input.value;else{var oe=c.getNode();if(oe)var K=oe.innerText}if(typeof D.options.onbeforesearch=="function"){var be=D.options.onbeforesearch(D,K);if(be)K=be;else if(be===!1)return}D(K)},D.blur=function(V){D.close()},D.options.input&&(D.options.input.addEventListener("keyup",D.keyup),D.options.input.addEventListener("keydown",D.keydown),D.options.input.addEventListener("blur",D.blur));var M=document.createElement("div");return M.classList.add("jsearch_container"),M.onmousedown=o,w.appendChild(M),w.classList.add("jsearch"),w.search=D,D}function dt(w,E){var l={};if(l.options={},l.currentImage=null,E&&(l.options=E),w.setAttribute("tabindex","900"),l.options.items=[],!w.classList.contains("jslider")){if(w.classList.add("jslider"),w.classList.add("unselectable"),l.options.height&&(w.style.minHeight=parseInt(l.options.height)+"px"),l.options.width&&(w.style.width=parseInt(l.options.width)+"px"),l.options.grid){w.classList.add("jslider-grid");var o=w.children.length;o>4&&w.setAttribute("data-total",o-4),w.setAttribute("data-number",o>4?4:o)}var O=document.createElement("div");if(O.classList.add("jslider-counter"),w.children.length>0)for(var Q=0;Q<w.children.length;Q++){l.options.items.push(w.children[Q]);var ee=document.createElement("div");ee.onclick=function(){var oe=Array.prototype.slice.call(O.children).indexOf(this);l.show(l.currentImage=l.options.items[oe])},O.appendChild(ee)}var D=document.createElement("div");D.className="jslider-caption";var M=document.createElement("div"),V=document.createElement("div");V.className="jslider-close",V.innerHTML="",V.onclick=function(){l.close()},M.appendChild(D),M.appendChild(V)}l.updateCounter=function(oe){for(var be=0;be<O.children.length;be++)if(O.children[be].classList.contains("jslider-counter-focus")){O.children[be].classList.remove("jslider-counter-focus");break}O.children[oe].classList.add("jslider-counter-focus")},l.show=function(oe){if(!oe)var oe=w.children[0];w.classList.add("jslider-focus"),w.classList.remove("jslider-grid"),w.appendChild(M),w.appendChild(O);var be=l.options.items.indexOf(oe);l.updateCounter(be);for(var de=0;de<w.children.length;de++)w.children[de].style.display="";oe.style.display="block",oe.previousElementSibling?w.classList.add("jslider-left"):w.classList.remove("jslider-left"),oe.nextElementSibling&&oe.nextElementSibling.tagName=="IMG"?w.classList.add("jslider-right"):w.classList.remove("jslider-right"),l.currentImage=oe,l.currentImage.offsetHeight>l.currentImage.offsetWidth&&l.currentImage.classList.add("jslider-vertical"),M.children[0].innerText=l.currentImage.getAttribute("title")},l.open=function(){l.show(),typeof l.options.onopen=="function"&&l.options.onopen(w)},l.close=function(){w.classList.remove("jslider-focus"),w.classList.remove("jslider-left"),w.classList.remove("jslider-right"),l.options.grid&&w.classList.add("jslider-grid");for(var oe=0;oe<w.children.length;oe++)w.children[oe].style.display="";O.remove(),M.remove(),l.currentImage=null,typeof l.options.onclose=="function"&&l.options.onclose(w)},l.reset=function(){w.innerHTML=""},l.next=function(){var oe=l.currentImage.nextElementSibling;oe&&oe.tagName==="IMG"&&l.show(l.currentImage.nextElementSibling)},l.prev=function(){l.currentImage.previousElementSibling&&l.show(l.currentImage.previousElementSibling)};var K=function(oe){if(oe.target.tagName=="IMG")l.show(oe.target);else if(!oe.target.classList.contains("jslider-close")&&!(oe.target.parentNode.classList.contains("jslider-counter")||oe.target.classList.contains("jslider-counter"))){var be=oe.offsetX||oe.changedTouches[0].clientX;oe.target.clientWidth-be<40?l.next():be<40&&l.prev()}};return"ontouchend"in document.documentElement?w.addEventListener("touchend",K):w.addEventListener("mouseup",K),w.addEventListener("swipeleft",function(oe){l.next(),oe.preventDefault(),oe.stopPropagation()}),w.addEventListener("swiperight",function(oe){l.prev(),oe.preventDefault(),oe.stopPropagation()}),w.addEventListener("keydown",function(oe){oe.which==27&&l.close()}),w.slider=l,l}function vt(w,E){if(w.tags)return w.tags.setOptions(E,!0);var l={type:"tags"};l.options={};var o=function(){return!!(l.options.limit&&w.children.length>=l.options.limit)},O=null,Q=null;l.setOptions=function(ce,Ae){var X={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var W in X)ce&&ce.hasOwnProperty(W)?l.options[W]=ce[W]:(typeof l.options[W]>"u"||Ae===!0)&&(l.options[W]=X[W]);return l.options.placeholder?w.setAttribute("data-placeholder",l.options.placeholder):w.removeAttribute("data-placeholder"),w.placeholder=l.options.placeholder,l.setValue(l.options.value),V(),l.options.search?Q||(Q=document.createElement("div"),w.parentNode.insertBefore(Q,w.nextSibling),O=at(Q,{data:l.options.search,onselect:function(ne,v,P){l.selectIndex(v,P)}})):Q&&(O=null,Q.remove(),Q=null),l},l.add=function(ce,Ae){if(typeof l.options.onbeforechange=="function"){var X=l.options.onbeforechange(w,l,l.options.value,ce);if(X===!1)return!1;X!=null&&(ce=X)}if(O&&O.close(),o())typeof l.options.onlimit=="function"?l.options.onlimit(l,l.options.limit):alert(g.translate("You reach the limit number of entries")+" "+l.options.limit);else{var W=c.getNode();if(W&&W.parentNode&&W.parentNode.classList.contains("jtags")&&W.nextSibling&&!(W.nextSibling.innerText&&W.nextSibling.innerText.trim()))ne=W.nextSibling;else{if(w.lastChild&&(w.lastChild.innerText.trim()||w.removeChild(w.lastChild)),!ce||typeof ce=="string")var ne=D(ce,ce,W);else for(var v=0;v<=ce.length;v++)if(!o()){if(!ce[v]||typeof ce[v]=="string")var P=ce[v]||"",J=null;else var P=ce[v].text,J=ce[v].value;var ne=D(P,J)}M()}Ae&&ee(ne)}},l.setLimit=function(ce){for(l.options.limit=ce,w.children.length-ce;w.children.length>ce;)w.removeChild(w.lastChild)},l.remove=function(ce){ce.parentNode.removeChild(ce),w.children.length?M():l.add("",!0)},l.getData=function(){for(var ce=[],Ae=0;Ae<w.children.length;Ae++){var X=w.children[Ae].innerText.replace(`
`,""),W=w.children[Ae].getAttribute("data-value");W||(W=X),(X||W)&&ce.push({text:X,value:W})}return ce},l.getValue=function(ce){var Ae=null;if(ce!=null)Ae=w.children[ce].getAttribute("data-value"),Ae||(Ae=w.children[ce].innerText.replace(`
`,""));else{for(var X=[],W=0;W<w.children.length;W++)Ae=w.children[W].innerText.replace(`
`,""),Ae&&X.push(l.getValue(W));Ae=X.join(",")}return Ae},l.setValue=function(ce){if(!ce)l.reset();else if(w.value!=ce)if(Array.isArray(ce))l.add(ce);else{var Ae=(""+ce).trim(),X=oe(Ae);w.innerHTML="",l.add(X)}},l.reset=function(){w.classList.add("jtags-empty"),w.innerHTML="<div></div>",M()},l.isValid=function(){for(var ce=0,Ae=0;Ae<w.children.length;Ae++)w.children[Ae].classList.contains("jtags_error")&&ce++;return ce==0},l.selectIndex=function(ce,Ae){var X=c.getNode();X&&(X.innerText=ce,Ae&&X.setAttribute("data-value",Ae),X.classList.remove("jtags_error"),o()||l.add("",!0))},l.search=function(ce){ce.innerText},l.destroy=function(){w.removeEventListener("mouseup",me),w.removeEventListener("keydown",de),w.removeEventListener("keyup",fe),w.removeEventListener("paste",le),w.removeEventListener("focus",Ie),w.removeEventListener("blur",We),w.parentNode.removeChild(w)};var ee=function(ce){if(w.children.length){var Ae=document.createRange(),X=window.getSelection();if(!ce)var ce=w.childNodes[w.childNodes.length-1];Ae.setStart(ce,ce.length),Ae.collapse(!0),X.removeAllRanges(),X.addRange(Ae),w.scrollLeft=w.scrollWidth}},D=function(ce,Ae,X){var W=document.createElement("div");return W.innerHTML=ce||"",Ae&&W.setAttribute("data-value",Ae),X&&X.parentNode.classList.contains("jtags")?w.insertBefore(W,X.nextSibling):w.appendChild(W),W},M=function(){var ce=l.getValue();ce!=l.options.value&&(l.options.value=ce,typeof l.options.onchange=="function"&&l.options.onchange(w,l,l.options.value),w.value!=l.options.value&&(w.value=l.options.value,typeof w.oninput=="function"&&w.oninput({type:"input",target:w,value:w.value}))),V()},V=function(){for(var ce=0;ce<w.children.length;ce++)w.children[ce].tagName==="DIV"&&(l.getValue(ce)?(w.children[ce].classList.add("jtags_label"),typeof l.options.validation=="function"&&l.getValue(ce)?l.options.validation(w.children[ce],w.children[ce].innerText,w.children[ce].getAttribute("data-value"))?w.children[ce].classList.remove("jtags_error"):w.children[ce].classList.add("jtags_error"):w.children[ce].classList.remove("jtags_error")):w.children[ce].classList.remove("jtags_label"));K()},K=function(){w.innerText.trim()?w.classList.remove("jtags-empty"):(!w.children.length||w.children[0].tagName==="BR")&&(w.innerHTML="",ee(D()))},oe=function(ce){var Ae=[],X="";if(ce=ce.trim(),ce){for(var W=0;W<ce.length;W++)ce[W]==","||ce[W]==";"||ce[W]==`
`?X&&(Ae.push(X.trim()),X=""):X+=ce[W];X&&Ae.push(X)}return Ae},be=0,de=function(ce){if(be=window.getSelection().anchorOffset,K(),ce.key==="Tab"||ce.key===";"||ce.key===","){var Ae=window.getSelection().anchorOffset;Ae>1&&(o()?typeof l.options.onlimit=="function"&&l.options.onlimit(l,l.options.limit):l.add("",!0)),ce.preventDefault()}else if(ce.key=="Enter"){if(!O||!O.isOpened()){var Ae=window.getSelection().anchorOffset;Ae>1&&(o()||l.add("",!0)),ce.preventDefault()}}else ce.key=="Backspace"&&w.children.length==1&&window.getSelection().anchorOffset<1&&ce.preventDefault();O&&O.keydown(ce),K()},fe=function(ce){if(ce.which==39){var Ae=window.getSelection().anchorOffset;Ae>1&&Ae==be&&l.add("",!0)}else ce.which==13||ce.which==38||ce.which==40?ce.preventDefault():O&&O.keyup(ce);V()},le=function(ce){if(ce.clipboardData||ce.originalEvent.clipboardData)var Ae=(ce.originalEvent||ce).clipboardData.getData("text/plain");else if(window.clipboardData)var Ae=window.clipboardData.getData("Text");var X=oe(Ae);if(typeof l.options.onbeforepaste=="function"){var W=l.options.onbeforepaste(w,l,X);if(W===!1)return ce.preventDefault(),!1;W&&(X=W)}X.length>1?(l.add(X,!0),ce.preventDefault()):X[0]&&(document.execCommand("insertText",!1,X[0]),ce.preventDefault())},me=function(ce){if(ce.target.parentNode&&ce.target.parentNode.classList.contains("jtags")&&(ce.target.classList.contains("jtags_label")||ce.target.classList.contains("jtags_error"))){var Ae=ce.target.getBoundingClientRect();Ae.width-(ce.clientX-Ae.left)<16&&l.remove(ce.target)}ce.target==w&&ee()},Ie=function(){w.classList.contains("jtags-focus")||((!w.children.length||l.getValue(w.children.length-1))&&(o()||D("")),typeof l.options.onfocus=="function"&&l.options.onfocus(w,l,l.getValue()),w.classList.add("jtags-focus"))},We=function(){if(w.classList.contains("jtags-focus")){O&&O.close();for(var ce=0;ce<w.children.length-1;ce++)l.getValue(ce)||w.removeChild(w.children[ce]);M(),w.classList.remove("jtags-focus"),typeof l.options.onblur=="function"&&l.options.onblur(w,l,l.getValue())}},Je=function(){"touchend"in document.documentElement?w.addEventListener("touchend",me):w.addEventListener("mouseup",me),w.addEventListener("keydown",de),w.addEventListener("keyup",fe),w.addEventListener("paste",le),w.addEventListener("focus",Ie),w.addEventListener("blur",We),w.setAttribute("contenteditable",!0),w.classList.add("jtags"),l.setOptions(E),typeof l.options.onload=="function"&&l.options.onload(w,l),w.change=l.setValue,w.val=function(ce){if(ce===void 0)return l.getValue();l.setValue(ce)},w.tags=l};return Je(),l}function ht(w,E){var l={};l.options={};var o={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var O in o)E&&E.hasOwnProperty(O)?l.options[O]=E[O]:l.options[O]=o[O];l.options.multiple==!0&&w.setAttribute("data-multiple",!0),w.content=[],w.classList.add("jupload"),l.options.input==!0&&w.classList.add("input"),l.add=function(M){if(l.options.multiple==!1&&(w.content=[],w.innerText=""),l.options.type=="image"){var V=document.createElement("img");V.setAttribute("src",M.file),V.setAttribute("tabindex",-1),w.getAttribute("name")||(V.className="jfile",V.content=M),w.appendChild(V)}else{if(M.name)var K=M.name;else var K=M.file;var oe=document.createElement("div");oe.innerText=K||l.options.type,oe.classList.add("jupload-item"),oe.setAttribute("tabindex",-1),w.appendChild(oe)}M.content&&(M.file=c.guid()),w.content.push(M),typeof l.options.onchange=="function"&&l.options.onchange(w,M)},l.addFromFile=function(M){var V=M.type.split("/");if(V[0]==l.options.type){var K=new FileReader;K.addEventListener("load",function(oe){var be={file:oe.srcElement.result,extension:M.name.substr(M.name.lastIndexOf(".")+1),name:M.name,size:M.size,lastmodified:M.lastModified,content:oe.srcElement.result};l.add(be)}),K.readAsDataURL(M)}else alert(g.translate("This extension is not allowed"))},l.addFromUrl=function(M){if(M.substr(0,4)!="data"&&!l.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(M.substr(0,4)=="data"){var V=M.split(";");V=V[0].split("/");var K=V[0].replace("data:","");if(K==l.options.type){var oe={file:M,name:"",extension:V[1],content:M};l.add(oe)}else alert(l.options.text.extensionNotAllowed)}else{var V=M.substr(M.lastIndexOf(".")+1);M=l.options.remoteParser+M,T({url:M,type:"GET",dataType:"blob",success:function(de){}})}};var Q=l.options.type+"/"+l.options.extension,ee=document.createElement("input");ee.type="file",ee.setAttribute("accept",Q),ee.onchange=function(){for(var M=0;M<this.files.length;M++)l.addFromFile(this.files[M])},l.options.multiple==!0&&ee.setAttribute("multiple",!0);var D=null;return w.addEventListener("click",function(M){D=null,!w.children.length||M.target===w?c.click(ee):M.target.parentNode==w&&(D=M.target)}),w.addEventListener("dblclick",function(M){c.click(ee)}),w.addEventListener("dragenter",function(M){w.style.border="1px dashed #000"}),w.addEventListener("dragleave",function(M){w.style.border="1px solid #eee"}),w.addEventListener("dragstop",function(M){w.style.border="1px solid #eee"}),w.addEventListener("dragover",function(M){M.preventDefault()}),w.addEventListener("keydown",function(M){if(D&&M.which==46){var V=Array.prototype.indexOf.call(w.children,D);V>=0&&(w.content.splice(V,1),D.remove(),D=null)}}),w.addEventListener("drop",function(M){M.preventDefault(),M.stopPropagation();var V=(M.originalEvent||M).dataTransfer.getData("text/html"),K=(M.originalEvent||M).dataTransfer.files;if(K.length)for(var oe=0;oe<M.dataTransfer.files.length;oe++)l.addFromFile(M.dataTransfer.files[oe]);else if(V){l.options.multiple==!1&&(w.innerText="");var be=document.createElement("div");be.innerHTML=V;var de=be.querySelectorAll("img");if(de.length)for(var oe=0;oe<de.length;oe++)l.addFromUrl(de[oe].src)}return w.style.border="1px solid #eee",!1}),w.val=function(M){if(M===void 0)return w.content&&w.content.length?w.content:null;if(w.innerText="",w.content=[],M)if(Array.isArray(M))for(var V=0;V<M.length;V++)typeof M[V]=="string"?l.add({file:M[V]}):l.add(M[V]);else typeof M=="string"&&l.add({file:M})},w.upload=w.image=l,l}var Dt=A(195),St=A.n(Dt),ft={...g,...c,version:"5.0.27",setExtensions:function(w){if(typeof w=="object")for(var E=Object.keys(w),l=0;l<E.length;l++)ft[E[l]]=w[E[l]]},tracking:u,path:m,sorting:j,lazyLoading:h,ajax:T,animation:B,calendar:G,color:ie,contextmenu:Te,dropdown:ae,editor:Be,floating:Y,form:Me,mask:N,modal:Oe,notification:Ge,palette:se,picker:ke,progressbar:Qe,rating:ct,search:at,slider:dt,tabs:ge,tags:vt,toolbar:Ke,upload:ht,validations:qe};ft.image=ht,ft.image.create=function(w){var E=document.createElement("img");return E.setAttribute("src",w.file),E.className="jfile",E.setAttribute("tabindex",-1),E.content=w,E},ft.tracker=Me,ft.loading=B.loading,ft.sha512=St();const Ft=function(){document.jsuitesComponents=[];const w=function(le,me){return le[me.type]&&le[me.type]==me||le.component&&le.component==me?!0:le.parentNode?w(le.parentNode,me):!1},E=function(le){if(document.jsuitesComponents&&document.jsuitesComponents.length>0)for(var me=0;me<document.jsuitesComponents.length;me++)document.jsuitesComponents[me]&&!w(le,document.jsuitesComponents[me])&&document.jsuitesComponents[me].close()};let l=15,o=null,O=!1,Q={x:null,y:null},ee=document.createElement("div");ee.classList.add("jtooltip");const D=function(le){var me=ft.findElement(le.target,"jpanel");if(me&&!me.classList.contains("readonly")){me.focus();var Ie=le.target.getBoundingClientRect();O={e:me,x:le.clientX,y:le.clientY,w:Ie.width,h:Ie.height,d:me.style.cursor,resizing:!!me.style.cursor,actioned:!1},me.style.width||(me.style.width=Ie.width+"px"),me.style.height||(me.style.height=Ie.height+"px");var We=window.getSelection();if(We.rangeCount)for(var Je=0;Je<We.rangeCount;Je++)We.removeRange(We.getRangeAt(Je));le.preventDefault(),le.stopPropagation()}else O=!1;if(le.changedTouches&&le.changedTouches[0])var ce=le.changedTouches[0].clientX,Ae=le.changedTouches[0].clientY;else var ce=le.clientX,Ae=le.clientY;var X=le.path||le.composedPath&&le.composedPath();if(X)o=X[0];else{if(le.target&&le.target.shadowRoot)var W=le.target.shadowRoot;else var W=document;o=W.elementFromPoint(ce,Ae)}E(o)},M=function(le){O&&O.e&&(typeof O.e.refresh=="function"&&Q.actioned&&O.e.refresh(),O.e.style.cursor=""),Q={x:null,y:null},O=!1},V=function(le){if(O){var me=le.clientX||le.pageX,Ie=le.clientY||le.pageY;if(O.resizing){var X=null,W=null;if(O.d=="e-resize"||O.d=="ne-resize"||O.d=="se-resize")if(X=O.w+(me-O.x),O.e.style.width=X+"px",le.shiftKey){var ne=(me-O.x)*(O.h/O.w);W=O.h+ne,O.e.style.height=W+"px"}else var ne=!1;ne||(O.d=="s-resize"||O.d=="se-resize"||O.d=="sw-resize")&&(W=O.h+(Ie-O.y),O.e.style.height=W+"px"),typeof O.e.refresh=="function"&&(Q.actioned=!0,O.e.refresh("dimensions",X,W))}else{Q.x==null&&Q.y==null&&(Q.x=me,Q.y=Ie);var We=me-Q.x,Je=Ie-Q.y,ce=O.e.offsetTop+Je,Ae=O.e.offsetLeft+We;O.e.style.top=ce+"px",O.e.style.left=Ae+"px",O.e.style.cursor="move",Q.x=me,Q.y=Ie,typeof O.e.refresh=="function"&&(Q.actioned=!0,O.e.refresh("position",ce,Ae))}}else{var v=ft.findElement(le.target,"jpanel");if(v&&v.getAttribute("tabindex")){var P=v.getBoundingClientRect();le.clientY-P.top<l?P.width-(le.clientX-P.left)<l?v.style.cursor="ne-resize":le.clientX-P.left<l?v.style.cursor="nw-resize":v.style.cursor="n-resize":P.height-(le.clientY-P.top)<l?P.width-(le.clientX-P.left)<l?v.style.cursor="se-resize":le.clientX-P.left<l?v.style.cursor="sw-resize":v.style.cursor="s-resize":P.width-(le.clientX-P.left)<l?v.style.cursor="e-resize":le.clientX-P.left<l?v.style.cursor="w-resize":v.style.cursor=""}}},K=function(le){var me=le.target.getAttribute("data-tooltip");if(me){if(ee.innerText=me,le.changedTouches&&le.changedTouches[0])var Ie=le.changedTouches[0].clientX,We=le.changedTouches[0].clientY;else var Ie=le.clientX,We=le.clientY;ee.style.top=We+"px",ee.style.left=Ie+"px",document.body.appendChild(ee)}else ee.innerText&&(ee.innerText="",document.body.removeChild(ee))},oe=function(le){var me=ft.findElement(le.target,"jpanel");me&&typeof me.dblclick=="function"&&me.dblclick(le)},be=function(le){var me=document.activeElement;if(me&&typeof me.contextmenu=="function")me.contextmenu(le),le.preventDefault(),le.stopImmediatePropagation();else if(me=ft.findElement(le.target,function(We){return We.tagName&&We.getAttribute("aria-contextmenu-id")}),me){var Ie=document.querySelector("#"+me);Ie?(Ie.contextmenu.open(le),le.preventDefault(),le.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+me)}},de=function(le){let me=document.activeElement;me&&le.key==="Delete"&&typeof me.delete=="function"&&(me.delete(),le.preventDefault(),le.stopImmediatePropagation()),document.jsuitesComponents&&document.jsuitesComponents.length&&(me=document.jsuitesComponents[document.jsuitesComponents.length-1],me&&le.key==="Escape"&&typeof me.isOpened=="function"&&typeof me.close=="function"&&me.isOpened()&&(me.close(),le.preventDefault(),le.stopImmediatePropagation()))},fe=function(le){(le.target.getAttribute("data-mask")||le.target.mask)&&ft.mask(le)};document.addEventListener("mouseup",M),document.addEventListener("mousedown",D),document.addEventListener("mousemove",V),document.addEventListener("mouseover",K),document.addEventListener("dblclick",oe),document.addEventListener("keydown",de),document.addEventListener("contextmenu",be),document.addEventListener("input",fe)};typeof document<"u"&&!document.jsuitesComponents&&Ft();var Tt=ft}(),k=k.default,k}()})})(jsuites$1);var jsuitesExports=jsuites$1.exports;const jsuites="",jspreadsheet="";function commonjsRequire(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist={exports:{}};(function(module,exports){if(!jSuites&&typeof commonjsRequire=="function")var jSuites=jsuitesExports;(function(n,s){module.exports=s()})(self,function(){return function(){var __webpack_modules__={243:function(n){var s;n.exports=(function(){var d={765:function(q,c){var r;r=function(b){b.version="1.0.2";var H=Math;function _(ve,ae){for(var ke=0,Ke=0;ke<ve.length;++ke)Ke=ae*Ke+ve[ke];return Ke}function g(ve,ae,ke,Ke,Ue){if(ae===0)return ke;if(ae===1)return Ke;for(var Be=2/ve,lt=Ke,Y=1;Y<ae;++Y)lt=Ke*Y*Be+Ue*ke,ke=Ke,Ke=lt;return lt}function u(ve,ae,ke,Ke,Ue){return function(Be,lt){if(Ke){if(Be===0)return Ke==1?-1/0:1/0;if(Be<0)return NaN}return lt===0?ve(Be):lt===1?ae(Be):lt<0?NaN:g(Be,lt|=0,ve(Be),ae(Be),Ue)}}var m,j,h,C,T,I,B,S,N,F,G,U,se,ge=function(){var ve=.636619772,ae=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),ke=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),Ke=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Ue=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function Be(Me){var Ne=0,Oe=0,ze=0,Ge=Me*Me;if(Me<8)Ne=(Oe=_(ae,Ge))/(ze=_(ke,Ge));else{var Qe=Me-.785398164;Oe=_(Ke,Ge=64/Ge),ze=_(Ue,Ge),Ne=H.sqrt(ve/Me)*(H.cos(Qe)*Oe-H.sin(Qe)*ze*8/Me)}return Ne}var lt=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),Y=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Le=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),qe=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function mt(Me){var Ne=0,Oe=0,ze=0,Ge=Me*Me,Qe=H.abs(Me)-2.356194491;return Math.abs(Me)<8?Ne=(Oe=Me*_(lt,Ge))/(ze=_(Y,Ge)):(Oe=_(Le,Ge=64/Ge),ze=_(qe,Ge),Ne=H.sqrt(ve/H.abs(Me))*(H.cos(Qe)*Oe-H.sin(Qe)*ze*8/H.abs(Me)),Me<0&&(Ne=-Ne)),Ne}return function Me(Ne,Oe){if(Oe=Math.round(Oe),!isFinite(Ne))return isNaN(Ne)?Ne:0;if(Oe<0)return(Oe%2?-1:1)*Me(Ne,-Oe);if(Ne<0)return(Oe%2?-1:1)*Me(-Ne,Oe);if(Oe===0)return Be(Ne);if(Oe===1)return mt(Ne);if(Ne===0)return 0;var ze=0;if(Ne>Oe)ze=g(Ne,Oe,Be(Ne),mt(Ne),-1);else{for(var Ge=!1,Qe=0,ct=0,at=1,dt=0,vt=2/Ne,ht=2*H.floor((Oe+H.floor(H.sqrt(40*Oe)))/2);ht>0;ht--)dt=ht*vt*at-Qe,Qe=at,at=dt,H.abs(at)>1e10&&(at*=1e-10,Qe*=1e-10,ze*=1e-10,ct*=1e-10),Ge&&(ct+=at),Ge=!Ge,ht==Oe&&(ze=Qe);ze/=ct=2*ct-at}return ze}}(),ie=(m=.636619772,j=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),h=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),C=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),T=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),I=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),B=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),S=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),N=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),u(function(ve){var ae=0,ke=0,Ke=0,Ue=ve*ve,Be=ve-.785398164;return ve<8?ae=(ke=_(j,Ue))/(Ke=_(h,Ue))+m*ge(ve,0)*H.log(ve):(ke=_(C,Ue=64/Ue),Ke=_(T,Ue),ae=H.sqrt(m/ve)*(H.sin(Be)*ke+H.cos(Be)*Ke*8/ve)),ae},function(ve){var ae=0,ke=0,Ke=0,Ue=ve*ve,Be=ve-2.356194491;return ve<8?ae=(ke=ve*_(I,Ue))/(Ke=_(B,Ue))+m*(ge(ve,1)*H.log(ve)-1/ve):(ke=_(S,Ue=64/Ue),Ke=_(N,Ue),ae=H.sqrt(m/ve)*(H.sin(Be)*ke+H.cos(Be)*Ke*8/ve)),ae},0,1,-1)),xe=(F=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),G=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),U=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),se=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function ve(ae,ke){if((ke=Math.round(ke))===0)return function(qe){return qe<=3.75?_(F,qe*qe/14.0625):H.exp(H.abs(qe))/H.sqrt(H.abs(qe))*_(G,3.75/H.abs(qe))}(ae);if(ke===1)return function(qe){return qe<3.75?qe*_(U,qe*qe/14.0625):(qe<0?-1:1)*H.exp(H.abs(qe))/H.sqrt(H.abs(qe))*_(se,3.75/H.abs(qe))}(ae);if(ke<0)return NaN;if(H.abs(ae)===0)return 0;if(ae==1/0)return 1/0;var Ke,Ue=0,Be=2/H.abs(ae),lt=0,Y=1,Le=0;for(Ke=2*H.round((ke+H.round(H.sqrt(40*ke)))/2);Ke>0;Ke--)Le=Ke*Be*Y+lt,lt=Y,Y=Le,H.abs(Y)>1e10&&(Y*=1e-10,lt*=1e-10,Ue*=1e-10),Ke==ke&&(Ue=lt);return Ue*=ve(ae,0)/Y,ae<0&&ke%2?-Ue:Ue}),Te=function(){var ve=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),ae=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),ke=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),Ke=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return u(function(Ue){return Ue<=2?-H.log(Ue/2)*xe(Ue,0)+_(ve,Ue*Ue/4):H.exp(-Ue)/H.sqrt(Ue)*_(ae,2/Ue)},function(Ue){return Ue<=2?H.log(Ue/2)*xe(Ue,1)+1/Ue*_(ke,Ue*Ue/4):H.exp(-Ue)/H.sqrt(Ue)*_(Ke,2/Ue)},0,2,1)}();b.besselj=ge,b.bessely=ie,b.besseli=xe,b.besselk=Te},r(typeof DO_NOT_EXPORT_BESSEL>"u"?c:{})},162:function(q){var c;q.exports=(c=function(r,b){var H=Array.prototype.concat,_=Array.prototype.slice,g=Object.prototype.toString;function u(N,F){var G=N>F?N:F;return r.pow(10,17-~~(r.log(G>0?G:-G)*r.LOG10E))}var m=Array.isArray||function(N){return g.call(N)==="[object Array]"};function j(N){return g.call(N)==="[object Function]"}function h(N){return typeof N=="number"&&N-N==0}function C(){return new C._init(arguments)}function T(){return 0}function I(){return 1}function B(N,F){return N===F?1:0}C.fn=C.prototype,C._init=function(N){if(m(N[0]))if(m(N[0][0])){j(N[1])&&(N[0]=C.map(N[0],N[1]));for(var F=0;F<N[0].length;F++)this[F]=N[0][F];this.length=N[0].length}else this[0]=j(N[1])?C.map(N[0],N[1]):N[0],this.length=1;else if(h(N[0]))this[0]=C.seq.apply(null,N),this.length=1;else{if(N[0]instanceof C)return C(N[0].toArray());this[0]=[],this.length=1}return this},C._init.prototype=C.prototype,C._init.constructor=C,C.utils={calcRdx:u,isArray:m,isFunction:j,isNumber:h,toVector:function(N){return H.apply([],N)}},C._random_fn=r.random,C.setRandom=function(N){if(typeof N!="function")throw new TypeError("fn is not a function");C._random_fn=N},C.extend=function(N){var F,G;if(arguments.length===1){for(G in N)C[G]=N[G];return this}for(F=1;F<arguments.length;F++)for(G in arguments[F])N[G]=arguments[F][G];return N},C.rows=function(N){return N.length||1},C.cols=function(N){return N[0].length||1},C.dimensions=function(N){return{rows:C.rows(N),cols:C.cols(N)}},C.row=function(N,F){return m(F)?F.map(function(G){return C.row(N,G)}):N[F]},C.rowa=function(N,F){return C.row(N,F)},C.col=function(N,F){if(m(F)){var G=C.arange(N.length).map(function(){return new Array(F.length)});return F.forEach(function(ge,ie){C.arange(N.length).forEach(function(xe){G[xe][ie]=N[xe][ge]})}),G}for(var U=new Array(N.length),se=0;se<N.length;se++)U[se]=[N[se][F]];return U},C.cola=function(N,F){return C.col(N,F).map(function(G){return G[0]})},C.diag=function(N){for(var F=C.rows(N),G=new Array(F),U=0;U<F;U++)G[U]=[N[U][U]];return G},C.antidiag=function(N){for(var F=C.rows(N)-1,G=new Array(F),U=0;F>=0;F--,U++)G[U]=[N[U][F]];return G},C.transpose=function(N){var F,G,U,se,ge,ie=[];for(m(N[0])||(N=[N]),G=N.length,U=N[0].length,ge=0;ge<U;ge++){for(F=new Array(G),se=0;se<G;se++)F[se]=N[se][ge];ie.push(F)}return ie.length===1?ie[0]:ie},C.map=function(N,F,G){var U,se,ge,ie,xe;for(m(N[0])||(N=[N]),se=N.length,ge=N[0].length,ie=G?N:new Array(se),U=0;U<se;U++)for(ie[U]||(ie[U]=new Array(ge)),xe=0;xe<ge;xe++)ie[U][xe]=F(N[U][xe],U,xe);return ie.length===1?ie[0]:ie},C.cumreduce=function(N,F,G){var U,se,ge,ie,xe;for(m(N[0])||(N=[N]),se=N.length,ge=N[0].length,ie=G?N:new Array(se),U=0;U<se;U++)for(ie[U]||(ie[U]=new Array(ge)),ge>0&&(ie[U][0]=N[U][0]),xe=1;xe<ge;xe++)ie[U][xe]=F(ie[U][xe-1],N[U][xe]);return ie.length===1?ie[0]:ie},C.alter=function(N,F){return C.map(N,F,!0)},C.create=function(N,F,G){var U,se,ge=new Array(N);for(j(F)&&(G=F,F=N),U=0;U<N;U++)for(ge[U]=new Array(F),se=0;se<F;se++)ge[U][se]=G(U,se);return ge},C.zeros=function(N,F){return h(F)||(F=N),C.create(N,F,T)},C.ones=function(N,F){return h(F)||(F=N),C.create(N,F,I)},C.rand=function(N,F){return h(F)||(F=N),C.create(N,F,C._random_fn)},C.identity=function(N,F){return h(F)||(F=N),C.create(N,F,B)},C.symmetric=function(N){var F,G,U=N.length;if(N.length!==N[0].length)return!1;for(F=0;F<U;F++)for(G=0;G<U;G++)if(N[G][F]!==N[F][G])return!1;return!0},C.clear=function(N){return C.alter(N,T)},C.seq=function(N,F,G,U){j(U)||(U=!1);var se,ge=[],ie=u(N,F),xe=(F*ie-N*ie)/((G-1)*ie),Te=N;for(se=0;Te<=F&&se<G;Te=(N*ie+xe*ie*++se)/ie)ge.push(U?U(Te,se):Te);return ge},C.arange=function(N,F,G){var U,se=[];if(G=G||1,F===b&&(F=N,N=0),N===F||G===0)return[];if(N<F&&G<0)return[];if(N>F&&G>0)return[];if(G>0)for(U=N;U<F;U+=G)se.push(U);else for(U=N;U>F;U+=G)se.push(U);return se},C.slice=function(){function N(F,G,U,se){var ge,ie=[],xe=F.length;if(G===b&&U===b&&se===b)return C.copy(F);if(se=se||1,(G=(G=G||0)>=0?G:xe+G)===(U=(U=U||F.length)>=0?U:xe+U)||se===0)return[];if(G<U&&se<0)return[];if(G>U&&se>0)return[];if(se>0)for(ge=G;ge<U;ge+=se)ie.push(F[ge]);else for(ge=G;ge>U;ge+=se)ie.push(F[ge]);return ie}return function(F,G){var U,se;return h((G=G||{}).row)?h(G.col)?F[G.row][G.col]:N(C.rowa(F,G.row),(U=G.col||{}).start,U.end,U.step):h(G.col)?N(C.cola(F,G.col),(se=G.row||{}).start,se.end,se.step):(se=G.row||{},U=G.col||{},N(F,se.start,se.end,se.step).map(function(ge){return N(ge,U.start,U.end,U.step)}))}}(),C.sliceAssign=function(N,F,G){var U,se;if(h(F.row)){if(h(F.col))return N[F.row][F.col]=G;F.col=F.col||{},F.col.start=F.col.start||0,F.col.end=F.col.end||N[0].length,F.col.step=F.col.step||1,U=C.arange(F.col.start,r.min(N.length,F.col.end),F.col.step);var ge=F.row;return U.forEach(function(xe,Te){N[ge][xe]=G[Te]}),N}if(h(F.col)){F.row=F.row||{},F.row.start=F.row.start||0,F.row.end=F.row.end||N.length,F.row.step=F.row.step||1,se=C.arange(F.row.start,r.min(N[0].length,F.row.end),F.row.step);var ie=F.col;return se.forEach(function(xe,Te){N[xe][ie]=G[Te]}),N}return G[0].length===b&&(G=[G]),F.row.start=F.row.start||0,F.row.end=F.row.end||N.length,F.row.step=F.row.step||1,F.col.start=F.col.start||0,F.col.end=F.col.end||N[0].length,F.col.step=F.col.step||1,se=C.arange(F.row.start,r.min(N.length,F.row.end),F.row.step),U=C.arange(F.col.start,r.min(N[0].length,F.col.end),F.col.step),se.forEach(function(xe,Te){U.forEach(function(ve,ae){N[xe][ve]=G[Te][ae]})}),N},C.diagonal=function(N){var F=C.zeros(N.length,N.length);return N.forEach(function(G,U){F[U][U]=G}),F},C.copy=function(N){return N.map(function(F){return h(F)?F:F.map(function(G){return G})})};var S=C.prototype;return S.length=0,S.push=Array.prototype.push,S.sort=Array.prototype.sort,S.splice=Array.prototype.splice,S.slice=Array.prototype.slice,S.toArray=function(){return this.length>1?_.call(this):_.call(this)[0]},S.map=function(N,F){return C(C.map(this,N,F))},S.cumreduce=function(N,F){return C(C.cumreduce(this,N,F))},S.alter=function(N){return C.alter(this,N),this},function(N){for(var F=0;F<N.length;F++)(function(G){S[G]=function(U){var se,ge=this;return U?(setTimeout(function(){U.call(ge,S[G].call(ge))}),this):(se=C[G](this),m(se)?C(se):se)}})(N[F])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(N){for(var F=0;F<N.length;F++)(function(G){S[G]=function(U,se){var ge=this;return se?(setTimeout(function(){se.call(ge,S[G].call(ge,U))}),this):C(C[G](this,U))}})(N[F])}("row col".split(" ")),function(N){for(var F=0;F<N.length;F++)(function(G){S[G]=function(){return C(C[G].apply(null,arguments))}})(N[F])}("create zeros ones rand identity".split(" ")),C}(Math),function(r,b){var H=r.utils.isFunction;function _(m,j){return m-j}function g(m,j,h){return b.max(j,b.min(m,h))}r.sum=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h];return j},r.sumsqrd=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h]*m[h];return j},r.sumsqerr=function(m){for(var j,h=r.mean(m),C=0,T=m.length;--T>=0;)C+=(j=m[T]-h)*j;return C},r.sumrow=function(m){for(var j=0,h=m.length;--h>=0;)j+=m[h];return j},r.product=function(m){for(var j=1,h=m.length;--h>=0;)j*=m[h];return j},r.min=function(m){for(var j=m[0],h=0;++h<m.length;)m[h]<j&&(j=m[h]);return j},r.max=function(m){for(var j=m[0],h=0;++h<m.length;)m[h]>j&&(j=m[h]);return j},r.unique=function(m){for(var j={},h=[],C=0;C<m.length;C++)j[m[C]]||(j[m[C]]=!0,h.push(m[C]));return h},r.mean=function(m){return r.sum(m)/m.length},r.meansqerr=function(m){return r.sumsqerr(m)/m.length},r.geomean=function(m){var j=m.map(b.log),h=r.mean(j);return b.exp(h)},r.median=function(m){var j=m.length,h=m.slice().sort(_);return 1&j?h[j/2|0]:(h[j/2-1]+h[j/2])/2},r.cumsum=function(m){return r.cumreduce(m,function(j,h){return j+h})},r.cumprod=function(m){return r.cumreduce(m,function(j,h){return j*h})},r.diff=function(m){var j,h=[],C=m.length;for(j=1;j<C;j++)h.push(m[j]-m[j-1]);return h},r.rank=function(m){var j,h=[],C={};for(j=0;j<m.length;j++)C[S=m[j]]?C[S]++:(C[S]=1,h.push(S));var T=h.sort(_),I={},B=1;for(j=0;j<T.length;j++){var S,N=C[S=T[j]],F=(B+(B+N-1))/2;I[S]=F,B+=N}return m.map(function(G){return I[G]})},r.mode=function(m){var j,h=m.length,C=m.slice().sort(_),T=1,I=0,B=0,S=[];for(j=0;j<h;j++)C[j]===C[j+1]?T++:(T>I?(S=[C[j]],I=T,B=0):T===I&&(S.push(C[j]),B++),T=1);return B===0?S[0]:S},r.range=function(m){return r.max(m)-r.min(m)},r.variance=function(m,j){return r.sumsqerr(m)/(m.length-(j?1:0))},r.pooledvariance=function(m){return m.reduce(function(j,h){return j+r.sumsqerr(h)},0)/(m.reduce(function(j,h){return j+h.length},0)-m.length)},r.deviation=function(m){for(var j=r.mean(m),h=m.length,C=new Array(h),T=0;T<h;T++)C[T]=m[T]-j;return C},r.stdev=function(m,j){return b.sqrt(r.variance(m,j))},r.pooledstdev=function(m){return b.sqrt(r.pooledvariance(m))},r.meandev=function(m){for(var j=r.mean(m),h=[],C=m.length-1;C>=0;C--)h.push(b.abs(m[C]-j));return r.mean(h)},r.meddev=function(m){for(var j=r.median(m),h=[],C=m.length-1;C>=0;C--)h.push(b.abs(m[C]-j));return r.median(h)},r.coeffvar=function(m){return r.stdev(m)/r.mean(m)},r.quartiles=function(m){var j=m.length,h=m.slice().sort(_);return[h[b.round(j/4)-1],h[b.round(j/2)-1],h[b.round(3*j/4)-1]]},r.quantiles=function(m,j,h,C){var T,I,B,S,N,F=m.slice().sort(_),G=[j.length],U=m.length;for(h===void 0&&(h=.375),C===void 0&&(C=.375),T=0;T<j.length;T++)B=U*(I=j[T])+(h+I*(1-h-C)),S=b.floor(g(B,1,U-1)),N=g(B-S,0,1),G[T]=(1-N)*F[S-1]+N*F[S];return G},r.percentile=function(m,j,h){var C=m.slice().sort(_),T=j*(C.length+(h?1:-1))+(h?0:1),I=parseInt(T),B=T-I;return I+1<C.length?C[I-1]+B*(C[I]-C[I-1]):C[I-1]},r.percentileOfScore=function(m,j,h){var C,T,I=0,B=m.length,S=!1;for(h==="strict"&&(S=!0),T=0;T<B;T++)C=m[T],(S&&C<j||!S&&C<=j)&&I++;return I/B},r.histogram=function(m,j){j=j||4;var h,C=r.min(m),T=(r.max(m)-C)/j,I=m.length,B=[];for(h=0;h<j;h++)B[h]=0;for(h=0;h<I;h++)B[b.min(b.floor((m[h]-C)/T),j-1)]+=1;return B},r.covariance=function(m,j){var h,C=r.mean(m),T=r.mean(j),I=m.length,B=new Array(I);for(h=0;h<I;h++)B[h]=(m[h]-C)*(j[h]-T);return r.sum(B)/(I-1)},r.corrcoeff=function(m,j){return r.covariance(m,j)/r.stdev(m,1)/r.stdev(j,1)},r.spearmancoeff=function(m,j){return m=r.rank(m),j=r.rank(j),r.corrcoeff(m,j)},r.stanMoment=function(m,j){for(var h=r.mean(m),C=r.stdev(m),T=m.length,I=0,B=0;B<T;B++)I+=b.pow((m[B]-h)/C,j);return I/m.length},r.skewness=function(m){return r.stanMoment(m,3)},r.kurtosis=function(m){return r.stanMoment(m,4)-3};var u=r.prototype;(function(m){for(var j=0;j<m.length;j++)(function(h){u[h]=function(C,T){var I=[],B=0,S=this;if(H(C)&&(T=C,C=!1),T)return setTimeout(function(){T.call(S,u[h].call(S,C))}),this;if(this.length>1){for(S=C===!0?this:this.transpose();B<S.length;B++)I[B]=r[h](S[B]);return I}return r[h](this[0],C)}})(m[j])})("cumsum cumprod".split(" ")),function(m){for(var j=0;j<m.length;j++)(function(h){u[h]=function(C,T){var I=[],B=0,S=this;if(H(C)&&(T=C,C=!1),T)return setTimeout(function(){T.call(S,u[h].call(S,C))}),this;if(this.length>1){for(h!=="sumrow"&&(S=C===!0?this:this.transpose());B<S.length;B++)I[B]=r[h](S[B]);return C===!0?r[h](r.utils.toVector(I)):I}return r[h](this[0],C)}})(m[j])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(m){for(var j=0;j<m.length;j++)(function(h){u[h]=function(){var C,T=[],I=0,B=this,S=Array.prototype.slice.call(arguments);if(H(S[S.length-1])){C=S[S.length-1];var N=S.slice(0,S.length-1);return setTimeout(function(){C.call(B,u[h].apply(B,N))}),this}C=void 0;var F=function(G){return r[h].apply(B,[G].concat(S))};if(this.length>1){for(B=B.transpose();I<B.length;I++)T[I]=F(B[I]);return T}return F(this[0])}})(m[j])}("quantiles percentileOfScore".split(" "))}(c,Math),function(r,b){r.gammaln=function(H){var _,g,u,m=0,j=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],h=1.000000000190015;for(u=(g=_=H)+5.5,u-=(_+.5)*b.log(u);m<6;m++)h+=j[m]/++g;return b.log(2.5066282746310007*h/_)-u},r.loggam=function(H){var _,g,u,m,j,h,C,T=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(_=H,C=0,H==1||H==2)return 0;for(H<=7&&(_=H+(C=b.floor(7-H))),g=1/(_*_),u=2*b.PI,j=T[9],h=8;h>=0;h--)j*=g,j+=T[h];if(m=j/_+.5*b.log(u)+(_-.5)*b.log(_)-_,H<=7)for(h=1;h<=C;h++)m-=b.log(_-1),_-=1;return m},r.gammafn=function(H){var _,g,u,m,j=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],h=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],C=!1,T=0,I=0,B=0,S=H;if(H>171.6243769536076)return 1/0;if(S<=0){if(!(m=S%1+36e-17))return 1/0;C=(1&S?-1:1)*b.PI/b.sin(b.PI*m),S=1-S}for(u=S,g=S<1?S++:(S-=T=(0|S)-1)-1,_=0;_<8;++_)B=(B+j[_])*g,I=I*g+h[_];if(m=B/I+1,u<S)m/=u;else if(u>S)for(_=0;_<T;++_)m*=S,S++;return C&&(m=C/m),m},r.gammap=function(H,_){return r.lowRegGamma(H,_)*r.gammafn(H)},r.lowRegGamma=function(H,_){var g,u=r.gammaln(H),m=H,j=1/H,h=j,C=_+1-H,T=1/1e-30,I=1/C,B=I,S=1,N=-~(8.5*b.log(H>=1?H:1/H)+.4*H+17);if(_<0||H<=0)return NaN;if(_<H+1){for(;S<=N;S++)j+=h*=_/++m;return j*b.exp(-_+H*b.log(_)-u)}for(;S<=N;S++)B*=(I=1/(I=(g=-S*(S-H))*I+(C+=2)))*(T=C+g/T);return 1-B*b.exp(-_+H*b.log(_)-u)},r.factorialln=function(H){return H<0?NaN:r.gammaln(H+1)},r.factorial=function(H){return H<0?NaN:r.gammafn(H+1)},r.combination=function(H,_){return H>170||_>170?b.exp(r.combinationln(H,_)):r.factorial(H)/r.factorial(_)/r.factorial(H-_)},r.combinationln=function(H,_){return r.factorialln(H)-r.factorialln(_)-r.factorialln(H-_)},r.permutation=function(H,_){return r.factorial(H)/r.factorial(H-_)},r.betafn=function(H,_){if(!(H<=0||_<=0))return H+_>170?b.exp(r.betaln(H,_)):r.gammafn(H)*r.gammafn(_)/r.gammafn(H+_)},r.betaln=function(H,_){return r.gammaln(H)+r.gammaln(_)-r.gammaln(H+_)},r.betacf=function(H,_,g){var u,m,j,h,C=1e-30,T=1,I=_+g,B=_+1,S=_-1,N=1,F=1-I*H/B;for(b.abs(F)<C&&(F=C),h=F=1/F;T<=100&&(F=1+(m=T*(g-T)*H/((S+(u=2*T))*(_+u)))*F,b.abs(F)<C&&(F=C),N=1+m/N,b.abs(N)<C&&(N=C),h*=(F=1/F)*N,F=1+(m=-(_+T)*(I+T)*H/((_+u)*(B+u)))*F,b.abs(F)<C&&(F=C),N=1+m/N,b.abs(N)<C&&(N=C),h*=j=(F=1/F)*N,!(b.abs(j-1)<3e-7));T++);return h},r.gammapinv=function(H,_){var g,u,m,j,h,C,T=0,I=_-1,B=r.gammaln(_);if(H>=1)return b.max(100,_+100*b.sqrt(_));if(H<=0)return 0;for(_>1?(h=b.log(I),C=b.exp(I*(h-1)-B),j=H<.5?H:1-H,g=(2.30753+.27061*(u=b.sqrt(-2*b.log(j))))/(1+u*(.99229+.04481*u))-u,H<.5&&(g=-g),g=b.max(.001,_*b.pow(1-1/(9*_)-g/(3*b.sqrt(_)),3))):g=H<(u=1-_*(.253+.12*_))?b.pow(H/u,1/_):1-b.log(1-(H-u)/(1-u));T<12;T++){if(g<=0)return 0;if((g-=u=(m=(r.lowRegGamma(_,g)-H)/(u=_>1?C*b.exp(-(g-I)+I*(b.log(g)-h)):b.exp(-g+I*b.log(g)-B)))/(1-.5*b.min(1,m*((_-1)/g-1))))<=0&&(g=.5*(g+u)),b.abs(u)<1e-8*g)break}return g},r.erf=function(H){var _,g,u,m,j=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],h=j.length-1,C=!1,T=0,I=0;for(H<0&&(H=-H,C=!0),g=4*(_=2/(2+H))-2;h>0;h--)u=T,T=g*T-I+j[h],I=u;return m=_*b.exp(-H*H+.5*(j[0]+g*T)-I),C?m-1:1-m},r.erfc=function(H){return 1-r.erf(H)},r.erfcinv=function(H){var _,g,u,m,j=0;if(H>=2)return-100;if(H<=0)return 100;for(m=H<1?H:2-H,_=-.70711*((2.30753+.27061*(u=b.sqrt(-2*b.log(m/2))))/(1+u*(.99229+.04481*u))-u);j<2;j++)_+=(g=r.erfc(_)-m)/(1.1283791670955126*b.exp(-_*_)-_*g);return H<1?_:-_},r.ibetainv=function(H,_,g){var u,m,j,h,C,T,I,B,S,N,F=_-1,G=g-1,U=0;if(H<=0)return 0;if(H>=1)return 1;for(_>=1&&g>=1?(j=H<.5?H:1-H,T=(2.30753+.27061*(h=b.sqrt(-2*b.log(j))))/(1+h*(.99229+.04481*h))-h,H<.5&&(T=-T),I=(T*T-3)/6,B=2/(1/(2*_-1)+1/(2*g-1)),S=T*b.sqrt(I+B)/B-(1/(2*g-1)-1/(2*_-1))*(I+.8333333333333334-2/(3*B)),T=_/(_+g*b.exp(2*S))):(u=b.log(_/(_+g)),m=b.log(g/(_+g)),T=H<(h=b.exp(_*u)/_)/(S=h+(C=b.exp(g*m)/g))?b.pow(_*S*H,1/_):1-b.pow(g*S*(1-H),1/g)),N=-r.gammaln(_)-r.gammaln(g)+r.gammaln(_+g);U<10;U++){if(T===0||T===1)return T;if((T-=h=(C=(r.ibeta(T,_,g)-H)/(h=b.exp(F*b.log(T)+G*b.log(1-T)+N)))/(1-.5*b.min(1,C*(F/T-G/(1-T)))))<=0&&(T=.5*(T+h)),T>=1&&(T=.5*(T+h+1)),b.abs(h)<1e-8*T&&U>0)break}return T},r.ibeta=function(H,_,g){var u=H===0||H===1?0:b.exp(r.gammaln(_+g)-r.gammaln(_)-r.gammaln(g)+_*b.log(H)+g*b.log(1-H));return!(H<0||H>1)&&(H<(_+1)/(_+g+2)?u*r.betacf(H,_,g)/_:1-u*r.betacf(1-H,g,_)/g)},r.randn=function(H,_){var g,u,m,j,h;if(_||(_=H),H)return r.create(H,_,function(){return r.randn()});do g=r._random_fn(),u=1.7156*(r._random_fn()-.5),h=(m=g-.449871)*m+(j=b.abs(u)+.386595)*(.196*j-.25472*m);while(h>.27597&&(h>.27846||u*u>-4*b.log(g)*g*g));return u/g},r.randg=function(H,_,g){var u,m,j,h,C,T,I=H;if(g||(g=_),H||(H=1),_)return(T=r.zeros(_,g)).alter(function(){return r.randg(H)}),T;H<1&&(H+=1),u=H-.3333333333333333,m=1/b.sqrt(9*u);do{do h=1+m*(C=r.randn());while(h<=0);h*=h*h,j=r._random_fn()}while(j>1-.331*b.pow(C,4)&&b.log(j)>.5*C*C+u*(1-h+b.log(h)));if(H==I)return u*h;do j=r._random_fn();while(j===0);return b.pow(j,1/I)*u*h},function(H){for(var _=0;_<H.length;_++)(function(g){r.fn[g]=function(){return r(r.map(this,function(u){return r[g](u)}))}})(H[_])}("gammaln gammafn factorial factorialln".split(" ")),function(H){for(var _=0;_<H.length;_++)(function(g){r.fn[g]=function(){return r(r[g].apply(null,arguments))}})(H[_])}("randn".split(" "))}(c,Math),function(r,b){function H(g,u,m,j){for(var h,C=0,T=1,I=1,B=1,S=0,N=0;b.abs((I-N)/I)>j;)N=I,T=B+(h=-(u+S)*(u+m+S)*g/(u+2*S)/(u+2*S+1))*T,I=(C=I+h*C)+(h=(S+=1)*(m-S)*g/(u+2*S-1)/(u+2*S))*I,C/=B=T+h*B,T/=B,I/=B,B=1;return I/u}function _(g,u,m){var j=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],h=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],C=.5*g;if(C>=8)return 1;var T,I=2*r.normal.cdf(C,0,1,1,0)-1;I=I>=b.exp(-50/m)?b.pow(I,m):0;for(var B=C,S=(8-C)/(T=g>3?2:3),N=B+S,F=0,G=m-1,U=1;U<=T;U++){for(var se=0,ge=.5*(N+B),ie=.5*(N-B),xe=1;xe<=12;xe++){var Te,ve=ge+ie*(6<xe?j[(Te=12-xe+1)-1]:-j[(Te=xe)-1]),ae=ve*ve;if(ae>60)break;var ke=2*r.normal.cdf(ve,0,1,1,0)*.5-2*r.normal.cdf(ve,g,1,1,0)*.5;ke>=b.exp(-30/G)&&(se+=ke=h[Te-1]*b.exp(-.5*ae)*b.pow(ke,G))}F+=se*=2*ie*m/b.sqrt(2*b.PI),B=N,N+=S}return(I+=F)<=b.exp(-30/u)?0:(I=b.pow(I,u))>=1?1:I}(function(g){for(var u=0;u<g.length;u++)(function(m){r[m]=function j(h,C,T){return this instanceof j?(this._a=h,this._b=C,this._c=T,this):new j(h,C,T)},r.fn[m]=function(j,h,C){var T=r[m](j,h,C);return T.data=this,T},r[m].prototype.sample=function(j){var h=this._a,C=this._b,T=this._c;return j?r.alter(j,function(){return r[m].sample(h,C,T)}):r[m].sample(h,C,T)},function(j){for(var h=0;h<j.length;h++)(function(C){r[m].prototype[C]=function(T){var I=this._a,B=this._b,S=this._c;return T||T===0||(T=this.data),typeof T!="number"?r.fn.map.call(T,function(N){return r[m][C](N,I,B,S)}):r[m][C](T,I,B,S)}})(j[h])}("pdf cdf inv".split(" ")),function(j){for(var h=0;h<j.length;h++)(function(C){r[m].prototype[C]=function(){return r[m][C](this._a,this._b,this._c)}})(j[h])}("mean median mode variance".split(" "))})(g[u])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),r.extend(r.beta,{pdf:function(g,u,m){return g>1||g<0?0:u==1&&m==1?1:u<512&&m<512?b.pow(g,u-1)*b.pow(1-g,m-1)/r.betafn(u,m):b.exp((u-1)*b.log(g)+(m-1)*b.log(1-g)-r.betaln(u,m))},cdf:function(g,u,m){return g>1||g<0?1*(g>1):r.ibeta(g,u,m)},inv:function(g,u,m){return r.ibetainv(g,u,m)},mean:function(g,u){return g/(g+u)},median:function(g,u){return r.ibetainv(.5,g,u)},mode:function(g,u){return(g-1)/(g+u-2)},sample:function(g,u){var m=r.randg(g);return m/(m+r.randg(u))},variance:function(g,u){return g*u/(b.pow(g+u,2)*(g+u+1))}}),r.extend(r.centralF,{pdf:function(g,u,m){var j;return g<0?0:u<=2?g===0&&u<2?1/0:g===0&&u===2?1:1/r.betafn(u/2,m/2)*b.pow(u/m,u/2)*b.pow(g,u/2-1)*b.pow(1+u/m*g,-(u+m)/2):(j=u*g/(m+g*u),u*(m/(m+g*u))/2*r.binomial.pdf((u-2)/2,(u+m-2)/2,j))},cdf:function(g,u,m){return g<0?0:r.ibeta(u*g/(u*g+m),u/2,m/2)},inv:function(g,u,m){return m/(u*(1/r.ibetainv(g,u/2,m/2)-1))},mean:function(g,u){return u>2?u/(u-2):void 0},mode:function(g,u){return g>2?u*(g-2)/(g*(u+2)):void 0},sample:function(g,u){return 2*r.randg(g/2)/g/(2*r.randg(u/2)/u)},variance:function(g,u){if(!(u<=4))return 2*u*u*(g+u-2)/(g*(u-2)*(u-2)*(u-4))}}),r.extend(r.cauchy,{pdf:function(g,u,m){return m<0?0:m/(b.pow(g-u,2)+b.pow(m,2))/b.PI},cdf:function(g,u,m){return b.atan((g-u)/m)/b.PI+.5},inv:function(g,u,m){return u+m*b.tan(b.PI*(g-.5))},median:function(g){return g},mode:function(g){return g},sample:function(g,u){return r.randn()*b.sqrt(1/(2*r.randg(.5)))*u+g}}),r.extend(r.chisquare,{pdf:function(g,u){return g<0?0:g===0&&u===2?.5:b.exp((u/2-1)*b.log(g)-g/2-u/2*b.log(2)-r.gammaln(u/2))},cdf:function(g,u){return g<0?0:r.lowRegGamma(u/2,g/2)},inv:function(g,u){return 2*r.gammapinv(g,.5*u)},mean:function(g){return g},median:function(g){return g*b.pow(1-2/(9*g),3)},mode:function(g){return g-2>0?g-2:0},sample:function(g){return 2*r.randg(g/2)},variance:function(g){return 2*g}}),r.extend(r.exponential,{pdf:function(g,u){return g<0?0:u*b.exp(-u*g)},cdf:function(g,u){return g<0?0:1-b.exp(-u*g)},inv:function(g,u){return-b.log(1-g)/u},mean:function(g){return 1/g},median:function(g){return 1/g*b.log(2)},mode:function(){return 0},sample:function(g){return-1/g*b.log(r._random_fn())},variance:function(g){return b.pow(g,-2)}}),r.extend(r.gamma,{pdf:function(g,u,m){return g<0?0:g===0&&u===1?1/m:b.exp((u-1)*b.log(g)-g/m-r.gammaln(u)-u*b.log(m))},cdf:function(g,u,m){return g<0?0:r.lowRegGamma(u,g/m)},inv:function(g,u,m){return r.gammapinv(g,u)*m},mean:function(g,u){return g*u},mode:function(g,u){if(g>1)return(g-1)*u},sample:function(g,u){return r.randg(g)*u},variance:function(g,u){return g*u*u}}),r.extend(r.invgamma,{pdf:function(g,u,m){return g<=0?0:b.exp(-(u+1)*b.log(g)-m/g-r.gammaln(u)+u*b.log(m))},cdf:function(g,u,m){return g<=0?0:1-r.lowRegGamma(u,m/g)},inv:function(g,u,m){return m/r.gammapinv(1-g,u)},mean:function(g,u){return g>1?u/(g-1):void 0},mode:function(g,u){return u/(g+1)},sample:function(g,u){return u/r.randg(g)},variance:function(g,u){if(!(g<=2))return u*u/((g-1)*(g-1)*(g-2))}}),r.extend(r.kumaraswamy,{pdf:function(g,u,m){return g===0&&u===1?m:g===1&&m===1?u:b.exp(b.log(u)+b.log(m)+(u-1)*b.log(g)+(m-1)*b.log(1-b.pow(g,u)))},cdf:function(g,u,m){return g<0?0:g>1?1:1-b.pow(1-b.pow(g,u),m)},inv:function(g,u,m){return b.pow(1-b.pow(1-g,1/m),1/u)},mean:function(g,u){return u*r.gammafn(1+1/g)*r.gammafn(u)/r.gammafn(1+1/g+u)},median:function(g,u){return b.pow(1-b.pow(2,-1/u),1/g)},mode:function(g,u){if(g>=1&&u>=1&&g!==1&&u!==1)return b.pow((g-1)/(g*u-1),1/g)},variance:function(){throw new Error("variance not yet implemented")}}),r.extend(r.lognormal,{pdf:function(g,u,m){return g<=0?0:b.exp(-b.log(g)-.5*b.log(2*b.PI)-b.log(m)-b.pow(b.log(g)-u,2)/(2*m*m))},cdf:function(g,u,m){return g<0?0:.5+.5*r.erf((b.log(g)-u)/b.sqrt(2*m*m))},inv:function(g,u,m){return b.exp(-1.4142135623730951*m*r.erfcinv(2*g)+u)},mean:function(g,u){return b.exp(g+u*u/2)},median:function(g){return b.exp(g)},mode:function(g,u){return b.exp(g-u*u)},sample:function(g,u){return b.exp(r.randn()*u+g)},variance:function(g,u){return(b.exp(u*u)-1)*b.exp(2*g+u*u)}}),r.extend(r.noncentralt,{pdf:function(g,u,m){return b.abs(m)<1e-14?r.studentt.pdf(g,u):b.abs(g)<1e-14?b.exp(r.gammaln((u+1)/2)-m*m/2-.5*b.log(b.PI*u)-r.gammaln(u/2)):u/g*(r.noncentralt.cdf(g*b.sqrt(1+2/u),u+2,m)-r.noncentralt.cdf(g,u,m))},cdf:function(g,u,m){var j=1e-14;if(b.abs(m)<j)return r.studentt.cdf(g,u);var h=!1;g<0&&(h=!0,m=-m);for(var C=r.normal.cdf(-m,0,1),T=j+1,I=T,B=g*g/(g*g+u),S=0,N=b.exp(-m*m/2),F=b.exp(-m*m/2-.5*b.log(2)-r.gammaln(1.5))*m;S<200||I>j||T>j;)I=T,S>0&&(N*=m*m/(2*S),F*=m*m/(2*(S+.5))),C+=.5*(T=N*r.beta.cdf(B,S+.5,u/2)+F*r.beta.cdf(B,S+1,u/2)),S++;return h?1-C:C}}),r.extend(r.normal,{pdf:function(g,u,m){return b.exp(-.5*b.log(2*b.PI)-b.log(m)-b.pow(g-u,2)/(2*m*m))},cdf:function(g,u,m){return .5*(1+r.erf((g-u)/b.sqrt(2*m*m)))},inv:function(g,u,m){return-1.4142135623730951*m*r.erfcinv(2*g)+u},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},sample:function(g,u){return r.randn()*u+g},variance:function(g,u){return u*u}}),r.extend(r.pareto,{pdf:function(g,u,m){return g<u?0:m*b.pow(u,m)/b.pow(g,m+1)},cdf:function(g,u,m){return g<u?0:1-b.pow(u/g,m)},inv:function(g,u,m){return u/b.pow(1-g,1/m)},mean:function(g,u){if(!(u<=1))return u*b.pow(g,u)/(u-1)},median:function(g,u){return g*(u*b.SQRT2)},mode:function(g){return g},variance:function(g,u){if(!(u<=2))return g*g*u/(b.pow(u-1,2)*(u-2))}}),r.extend(r.studentt,{pdf:function(g,u){return u=u>1e100?1e100:u,1/(b.sqrt(u)*r.betafn(.5,u/2))*b.pow(1+g*g/u,-(u+1)/2)},cdf:function(g,u){var m=u/2;return r.ibeta((g+b.sqrt(g*g+u))/(2*b.sqrt(g*g+u)),m,m)},inv:function(g,u){var m=r.ibetainv(2*b.min(g,1-g),.5*u,.5);return m=b.sqrt(u*(1-m)/m),g>.5?m:-m},mean:function(g){return g>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(g){return r.randn()*b.sqrt(g/(2*r.randg(g/2)))},variance:function(g){return g>2?g/(g-2):g>1?1/0:void 0}}),r.extend(r.weibull,{pdf:function(g,u,m){return g<0||u<0||m<0?0:m/u*b.pow(g/u,m-1)*b.exp(-b.pow(g/u,m))},cdf:function(g,u,m){return g<0?0:1-b.exp(-b.pow(g/u,m))},inv:function(g,u,m){return u*b.pow(-b.log(1-g),1/m)},mean:function(g,u){return g*r.gammafn(1+1/u)},median:function(g,u){return g*b.pow(b.log(2),1/u)},mode:function(g,u){return u<=1?0:g*b.pow((u-1)/u,1/u)},sample:function(g,u){return g*b.pow(-b.log(r._random_fn()),1/u)},variance:function(g,u){return g*g*r.gammafn(1+2/u)-b.pow(r.weibull.mean(g,u),2)}}),r.extend(r.uniform,{pdf:function(g,u,m){return g<u||g>m?0:1/(m-u)},cdf:function(g,u,m){return g<u?0:g<m?(g-u)/(m-u):1},inv:function(g,u,m){return u+g*(m-u)},mean:function(g,u){return .5*(g+u)},median:function(g,u){return r.mean(g,u)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,u){return g/2+u/2+(u/2-g/2)*(2*r._random_fn()-1)},variance:function(g,u){return b.pow(u-g,2)/12}}),r.extend(r.binomial,{pdf:function(g,u,m){return m===0||m===1?u*m===g?1:0:r.combination(u,g)*b.pow(m,g)*b.pow(1-m,u-g)},cdf:function(g,u,m){var j,h=1e-10;if(g<0)return 0;if(g>=u)return 1;if(m<0||m>1||u<=0)return NaN;var C=m,T=(g=b.floor(g))+1,I=u-g,B=T+I,S=b.exp(r.gammaln(B)-r.gammaln(I)-r.gammaln(T)+T*b.log(C)+I*b.log(1-C));return j=C<(T+1)/(B+2)?S*H(C,T,I,h):1-S*H(1-C,I,T,h),b.round(1/h*(1-j))/(1/h)}}),r.extend(r.negbin,{pdf:function(g,u,m){return g===g>>>0&&(g<0?0:r.combination(g+u-1,u-1)*b.pow(1-m,g)*b.pow(m,u))},cdf:function(g,u,m){var j=0,h=0;if(g<0)return 0;for(;h<=g;h++)j+=r.negbin.pdf(h,u,m);return j}}),r.extend(r.hypgeom,{pdf:function(g,u,m,j){if(g!=g|0)return!1;if(g<0||g<m-(u-j)||g>j||g>m)return 0;if(2*m>u)return 2*j>u?r.hypgeom.pdf(u-m-j+g,u,u-m,u-j):r.hypgeom.pdf(j-g,u,u-m,j);if(2*j>u)return r.hypgeom.pdf(m-g,u,m,u-j);if(m<j)return r.hypgeom.pdf(g,u,j,m);for(var h=1,C=0,T=0;T<g;T++){for(;h>1&&C<j;)h*=1-m/(u-C),C++;h*=(j-T)*(m-T)/((T+1)*(u-m-j+T+1))}for(;C<j;C++)h*=1-m/(u-C);return b.min(1,b.max(0,h))},cdf:function(g,u,m,j){if(g<0||g<m-(u-j))return 0;if(g>=j||g>=m)return 1;if(2*m>u)return 2*j>u?r.hypgeom.cdf(u-m-j+g,u,u-m,u-j):1-r.hypgeom.cdf(j-g-1,u,u-m,j);if(2*j>u)return 1-r.hypgeom.cdf(m-g-1,u,m,u-j);if(m<j)return r.hypgeom.cdf(g,u,j,m);for(var h=1,C=1,T=0,I=0;I<g;I++){for(;h>1&&T<j;){var B=1-m/(u-T);C*=B,h*=B,T++}h+=C*=(j-I)*(m-I)/((I+1)*(u-m-j+I+1))}for(;T<j;T++)h*=1-m/(u-T);return b.min(1,b.max(0,h))}}),r.extend(r.poisson,{pdf:function(g,u){return u<0||g%1!=0||g<0?0:b.pow(u,g)*b.exp(-u)/r.factorial(g)},cdf:function(g,u){var m=[],j=0;if(g<0)return 0;for(;j<=g;j++)m.push(r.poisson.pdf(j,u));return r.sum(m)},mean:function(g){return g},variance:function(g){return g},sampleSmall:function(g){var u=1,m=0,j=b.exp(-g);do m++,u*=r._random_fn();while(u>j);return m-1},sampleLarge:function(g){var u,m,j,h,C,T,I,B,S,N,F=g;for(h=b.sqrt(F),C=b.log(F),T=.02483*(I=.931+2.53*h)-.059,B=1.1239+1.1328/(I-3.4),S=.9277-3.6224/(I-2);;)if(m=b.random()-.5,j=b.random(),N=.5-b.abs(m),u=b.floor((2*T/N+I)*m+F+.43),N>=.07&&j<=S||!(u<0||N<.013&&j>N)&&b.log(j)+b.log(B)-b.log(T/(N*N)+I)<=u*C-F-r.loggam(u+1))return u},sample:function(g){return g<10?this.sampleSmall(g):this.sampleLarge(g)}}),r.extend(r.triangular,{pdf:function(g,u,m,j){return m<=u||j<u||j>m?NaN:g<u||g>m?0:g<j?2*(g-u)/((m-u)*(j-u)):g===j?2/(m-u):2*(m-g)/((m-u)*(m-j))},cdf:function(g,u,m,j){return m<=u||j<u||j>m?NaN:g<=u?0:g>=m?1:g<=j?b.pow(g-u,2)/((m-u)*(j-u)):1-b.pow(m-g,2)/((m-u)*(m-j))},inv:function(g,u,m,j){return m<=u||j<u||j>m?NaN:g<=(j-u)/(m-u)?u+(m-u)*b.sqrt(g*((j-u)/(m-u))):u+(m-u)*(1-b.sqrt((1-g)*(1-(j-u)/(m-u))))},mean:function(g,u,m){return(g+u+m)/3},median:function(g,u,m){return m<=(g+u)/2?u-b.sqrt((u-g)*(u-m))/b.sqrt(2):m>(g+u)/2?g+b.sqrt((u-g)*(m-g))/b.sqrt(2):void 0},mode:function(g,u,m){return m},sample:function(g,u,m){var j=r._random_fn();return j<(m-g)/(u-g)?g+b.sqrt(j*(u-g)*(m-g)):u-b.sqrt((1-j)*(u-g)*(u-m))},variance:function(g,u,m){return(g*g+u*u+m*m-g*u-g*m-u*m)/18}}),r.extend(r.arcsine,{pdf:function(g,u,m){return m<=u?NaN:g<=u||g>=m?0:2/b.PI*b.pow(b.pow(m-u,2)-b.pow(2*g-u-m,2),-.5)},cdf:function(g,u,m){return g<u?0:g<m?2/b.PI*b.asin(b.sqrt((g-u)/(m-u))):1},inv:function(g,u,m){return u+(.5-.5*b.cos(b.PI*g))*(m-u)},mean:function(g,u){return u<=g?NaN:(g+u)/2},median:function(g,u){return u<=g?NaN:(g+u)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(g,u){return(g+u)/2+(u-g)/2*b.sin(2*b.PI*r.uniform.sample(0,1))},variance:function(g,u){return u<=g?NaN:b.pow(u-g,2)/8}}),r.extend(r.laplace,{pdf:function(g,u,m){return m<=0?0:b.exp(-b.abs(g-u)/m)/(2*m)},cdf:function(g,u,m){return m<=0?0:g<u?.5*b.exp((g-u)/m):1-.5*b.exp(-(g-u)/m)},mean:function(g){return g},median:function(g){return g},mode:function(g){return g},variance:function(g,u){return 2*u*u},sample:function(g,u){var m,j=r._random_fn()-.5;return g-u*((m=j)/b.abs(m))*b.log(1-2*b.abs(j))}}),r.extend(r.tukey,{cdf:function(g,u,m){var j=u,h=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],C=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(g<=0)return 0;if(m<2||j<2)return NaN;if(!Number.isFinite(g))return 1;if(m>25e3)return _(g,1,j);var T,I=.5*m,B=I*b.log(m)-m*b.log(2)-r.gammaln(I),S=I-1,N=.25*m;T=m<=100?1:m<=800?.5:m<=5e3?.25:.125,B+=b.log(T);for(var F=0,G=1;G<=50;G++){for(var U=0,se=(2*G-1)*T,ge=1;ge<=16;ge++){var ie,xe;8<ge?(ie=ge-8-1,xe=B+S*b.log(se+h[ie]*T)-(h[ie]*T+se)*N):(ie=ge-1,xe=B+S*b.log(se-h[ie]*T)+(h[ie]*T-se)*N),xe>=-30&&(U+=_(8<ge?g*b.sqrt(.5*(h[ie]*T+se)):g*b.sqrt(.5*(-h[ie]*T+se)),1,j)*C[ie]*b.exp(xe))}if(G*T>=1&&U<=1e-14)break;F+=U}if(U>1e-14)throw new Error("tukey.cdf failed to converge");return F>1&&(F=1),F},inv:function(g,u,m){if(m<2||u<2)return NaN;if(g<0||g>1)return NaN;if(g===0)return 0;if(g===1)return 1/0;var j,h=function(S,N,F){var G=.5-.5*S,U=b.sqrt(b.log(1/(G*G))),se=U+((((-453642210148e-16*U-.204231210125)*U-.342242088547)*U-1)*U+.322232421088)/((((.0038560700634*U+.10353775285)*U+.531103462366)*U+.588581570495)*U+.099348462606);F<120&&(se+=(se*se*se+se)/F/4);var ge=.8832-.2368*se;return F<120&&(ge+=-1.214/F+1.208*se/F),se*(ge*b.log(N-1)+1.4142)}(g,u,m),C=r.tukey.cdf(h,u,m)-g;j=C>0?b.max(0,h-1):h+1;for(var T,I=r.tukey.cdf(j,u,m)-g,B=1;B<50;B++)if(T=j-I*(j-h)/(I-C),C=I,h=j,T<0&&(T=0,I=-g),I=r.tukey.cdf(T,u,m)-g,j=T,b.abs(j-h)<1e-4)return T;throw new Error("tukey.inv failed to converge")}})}(c,Math),function(r,b){var H,_,g=Array.prototype.push,u=r.utils.isArray;function m(j){return u(j)||j instanceof r}r.extend({add:function(j,h){return m(h)?(m(h[0])||(h=[h]),r.map(j,function(C,T,I){return C+h[T][I]})):r.map(j,function(C){return C+h})},subtract:function(j,h){return m(h)?(m(h[0])||(h=[h]),r.map(j,function(C,T,I){return C-h[T][I]||0})):r.map(j,function(C){return C-h})},divide:function(j,h){return m(h)?(m(h[0])||(h=[h]),r.multiply(j,r.inv(h))):r.map(j,function(C){return C/h})},multiply:function(j,h){var C,T,I,B,S,N,F,G;if(j.length===void 0&&h.length===void 0)return j*h;if(S=j.length,N=j[0].length,F=r.zeros(S,I=m(h)?h[0].length:N),G=0,m(h)){for(;G<I;G++)for(C=0;C<S;C++){for(B=0,T=0;T<N;T++)B+=j[C][T]*h[T][G];F[C][G]=B}return S===1&&G===1?F[0][0]:F}return r.map(j,function(U){return U*h})},outer:function(j,h){return r.multiply(j.map(function(C){return[C]}),[h])},dot:function(j,h){m(j[0])||(j=[j]),m(h[0])||(h=[h]);for(var C,T,I=j[0].length===1&&j.length!==1?r.transpose(j):j,B=h[0].length===1&&h.length!==1?r.transpose(h):h,S=[],N=0,F=I.length,G=I[0].length;N<F;N++){for(S[N]=[],C=0,T=0;T<G;T++)C+=I[N][T]*B[N][T];S[N]=C}return S.length===1?S[0]:S},pow:function(j,h){return r.map(j,function(C){return b.pow(C,h)})},exp:function(j){return r.map(j,function(h){return b.exp(h)})},log:function(j){return r.map(j,function(h){return b.log(h)})},abs:function(j){return r.map(j,function(h){return b.abs(h)})},norm:function(j,h){var C=0,T=0;for(isNaN(h)&&(h=2),m(j[0])&&(j=j[0]);T<j.length;T++)C+=b.pow(b.abs(j[T]),h);return b.pow(C,1/h)},angle:function(j,h){return b.acos(r.dot(j,h)/(r.norm(j)*r.norm(h)))},aug:function(j,h){var C,T=[];for(C=0;C<j.length;C++)T.push(j[C].slice());for(C=0;C<T.length;C++)g.apply(T[C],h[C]);return T},inv:function(j){for(var h,C=j.length,T=j[0].length,I=r.identity(C,T),B=r.gauss_jordan(j,I),S=[],N=0;N<C;N++)for(S[N]=[],h=T;h<B[0].length;h++)S[N][h-T]=B[N][h];return S},det:function j(h){if(h.length===2)return h[0][0]*h[1][1]-h[0][1]*h[1][0];for(var C=0,T=0;T<h.length;T++){for(var I=[],B=1;B<h.length;B++){I[B-1]=[];for(var S=0;S<h.length;S++)S<T?I[B-1][S]=h[B][S]:S>T&&(I[B-1][S-1]=h[B][S])}var N=T%2?-1:1;C+=j(I)*h[0][T]*N}return C},gauss_elimination:function(j,h){var C,T,I,B,S=0,N=0,F=j.length,G=j[0].length,U=1,se=0,ge=[];for(C=(j=r.aug(j,h))[0].length,S=0;S<F;S++){for(T=j[S][S],N=S,B=S+1;B<G;B++)T<b.abs(j[B][S])&&(T=j[B][S],N=B);if(N!=S)for(B=0;B<C;B++)I=j[S][B],j[S][B]=j[N][B],j[N][B]=I;for(N=S+1;N<F;N++)for(U=j[N][S]/j[S][S],B=S;B<C;B++)j[N][B]=j[N][B]-U*j[S][B]}for(S=F-1;S>=0;S--){for(se=0,N=S+1;N<=F-1;N++)se+=ge[N]*j[S][N];ge[S]=(j[S][C-1]-se)/j[S][S]}return ge},gauss_jordan:function(j,h){var C,T,I,B=r.aug(j,h),S=B.length,N=B[0].length,F=0;for(T=0;T<S;T++){var G=T;for(I=T+1;I<S;I++)b.abs(B[I][T])>b.abs(B[G][T])&&(G=I);var U=B[T];for(B[T]=B[G],B[G]=U,I=T+1;I<S;I++)for(F=B[I][T]/B[T][T],C=T;C<N;C++)B[I][C]-=B[T][C]*F}for(T=S-1;T>=0;T--){for(F=B[T][T],I=0;I<T;I++)for(C=N-1;C>T-1;C--)B[I][C]-=B[T][C]*B[I][T]/F;for(B[T][T]/=F,C=S;C<N;C++)B[T][C]/=F}return B},triaUpSolve:function(j,h){var C,T=j[0].length,I=r.zeros(1,T)[0],B=!1;return h[0].length!=null&&(h=h.map(function(S){return S[0]}),B=!0),r.arange(T-1,-1,-1).forEach(function(S){C=r.arange(S+1,T).map(function(N){return I[N]*j[S][N]}),I[S]=(h[S]-r.sum(C))/j[S][S]}),B?I.map(function(S){return[S]}):I},triaLowSolve:function(j,h){var C,T=j[0].length,I=r.zeros(1,T)[0],B=!1;return h[0].length!=null&&(h=h.map(function(S){return S[0]}),B=!0),r.arange(T).forEach(function(S){C=r.arange(S).map(function(N){return j[S][N]*I[N]}),I[S]=(h[S]-r.sum(C))/j[S][S]}),B?I.map(function(S){return[S]}):I},lu:function(j){var h,C=j.length,T=r.identity(C),I=r.zeros(j.length,j[0].length);return r.arange(C).forEach(function(B){I[0][B]=j[0][B]}),r.arange(1,C).forEach(function(B){r.arange(B).forEach(function(S){h=r.arange(S).map(function(N){return T[B][N]*I[N][S]}),T[B][S]=(j[B][S]-r.sum(h))/I[S][S]}),r.arange(B,C).forEach(function(S){h=r.arange(B).map(function(N){return T[B][N]*I[N][S]}),I[B][S]=j[h.length][S]-r.sum(h)})}),[T,I]},cholesky:function(j){var h,C=j.length,T=r.zeros(j.length,j[0].length);return r.arange(C).forEach(function(I){h=r.arange(I).map(function(B){return b.pow(T[I][B],2)}),T[I][I]=b.sqrt(j[I][I]-r.sum(h)),r.arange(I+1,C).forEach(function(B){h=r.arange(I).map(function(S){return T[I][S]*T[B][S]}),T[B][I]=(j[I][B]-r.sum(h))/T[I][I]})}),T},gauss_jacobi:function(j,h,C,T){for(var I,B,S,N,F=0,G=0,U=j.length,se=[],ge=[],ie=[];F<U;F++)for(se[F]=[],ge[F]=[],ie[F]=[],G=0;G<U;G++)F>G?(se[F][G]=j[F][G],ge[F][G]=ie[F][G]=0):F<G?(ge[F][G]=j[F][G],se[F][G]=ie[F][G]=0):(ie[F][G]=j[F][G],se[F][G]=ge[F][G]=0);for(S=r.multiply(r.multiply(r.inv(ie),r.add(se,ge)),-1),B=r.multiply(r.inv(ie),h),I=C,N=r.add(r.multiply(S,C),B),F=2;b.abs(r.norm(r.subtract(N,I)))>T;)I=N,N=r.add(r.multiply(S,I),B),F++;return N},gauss_seidel:function(j,h,C,T){for(var I,B,S,N,F,G=0,U=j.length,se=[],ge=[],ie=[];G<U;G++)for(se[G]=[],ge[G]=[],ie[G]=[],I=0;I<U;I++)G>I?(se[G][I]=j[G][I],ge[G][I]=ie[G][I]=0):G<I?(ge[G][I]=j[G][I],se[G][I]=ie[G][I]=0):(ie[G][I]=j[G][I],se[G][I]=ge[G][I]=0);for(N=r.multiply(r.multiply(r.inv(r.add(ie,se)),ge),-1),S=r.multiply(r.inv(r.add(ie,se)),h),B=C,F=r.add(r.multiply(N,C),S),G=2;b.abs(r.norm(r.subtract(F,B)))>T;)B=F,F=r.add(r.multiply(N,B),S),G+=1;return F},SOR:function(j,h,C,T,I){for(var B,S,N,F,G,U=0,se=j.length,ge=[],ie=[],xe=[];U<se;U++)for(ge[U]=[],ie[U]=[],xe[U]=[],B=0;B<se;B++)U>B?(ge[U][B]=j[U][B],ie[U][B]=xe[U][B]=0):U<B?(ie[U][B]=j[U][B],ge[U][B]=xe[U][B]=0):(xe[U][B]=j[U][B],ge[U][B]=ie[U][B]=0);for(F=r.multiply(r.inv(r.add(xe,r.multiply(ge,I))),r.subtract(r.multiply(xe,1-I),r.multiply(ie,I))),N=r.multiply(r.multiply(r.inv(r.add(xe,r.multiply(ge,I))),h),I),S=C,G=r.add(r.multiply(F,C),N),U=2;b.abs(r.norm(r.subtract(G,S)))>T;)S=G,G=r.add(r.multiply(F,S),N),U++;return G},householder:function(j){for(var h,C,T,I,B=j.length,S=j[0].length,N=0,F=[],G=[];N<B-1;N++){for(h=0,I=N+1;I<S;I++)h+=j[I][N]*j[I][N];for(h=(j[N+1][N]>0?-1:1)*b.sqrt(h),C=b.sqrt((h*h-j[N+1][N]*h)/2),(F=r.zeros(B,1))[N+1][0]=(j[N+1][N]-h)/(2*C),T=N+2;T<B;T++)F[T][0]=j[T][N]/(2*C);G=r.subtract(r.identity(B,S),r.multiply(r.multiply(F,r.transpose(F)),2)),j=r.multiply(G,r.multiply(j,G))}return j},QR:(H=r.sum,_=r.arange,function(j){var h,C,T,I=j.length,B=j[0].length,S=r.zeros(B,B);for(j=r.copy(j),C=0;C<B;C++){for(S[C][C]=b.sqrt(H(_(I).map(function(N){return j[N][C]*j[N][C]}))),h=0;h<I;h++)j[h][C]=j[h][C]/S[C][C];for(T=C+1;T<B;T++)for(S[C][T]=H(_(I).map(function(N){return j[N][C]*j[N][T]})),h=0;h<I;h++)j[h][T]=j[h][T]-j[h][C]*S[C][T]}return[j,S]}),lstsq:function(j,h){var C=!1;h[0].length===void 0&&(h=h.map(function(se){return[se]}),C=!0);var T=r.QR(j),I=T[0],B=T[1],S=j[0].length,N=r.slice(I,{col:{end:S}}),F=function(se){var ge=(se=r.copy(se)).length,ie=r.identity(ge);return r.arange(ge-1,-1,-1).forEach(function(xe){r.sliceAssign(ie,{row:xe},r.divide(r.slice(ie,{row:xe}),se[xe][xe])),r.sliceAssign(se,{row:xe},r.divide(r.slice(se,{row:xe}),se[xe][xe])),r.arange(xe).forEach(function(Te){var ve=r.multiply(se[Te][xe],-1),ae=r.slice(se,{row:Te}),ke=r.multiply(r.slice(se,{row:xe}),ve);r.sliceAssign(se,{row:Te},r.add(ae,ke));var Ke=r.slice(ie,{row:Te}),Ue=r.multiply(r.slice(ie,{row:xe}),ve);r.sliceAssign(ie,{row:Te},r.add(Ke,Ue))})}),ie}(r.slice(B,{row:{end:S}})),G=r.transpose(N);G[0].length===void 0&&(G=[G]);var U=r.multiply(r.multiply(F,G),h);return U.length===void 0&&(U=[[U]]),C?U.map(function(se){return se[0]}):U},jacobi:function(j){for(var h,C,T,I,B,S,N,F=1,G=j.length,U=r.identity(G,G),se=[];F===1;){for(B=j[0][1],T=0,I=1,h=0;h<G;h++)for(C=0;C<G;C++)h!=C&&B<b.abs(j[h][C])&&(B=b.abs(j[h][C]),T=h,I=C);for(S=j[T][T]===j[I][I]?j[T][I]>0?b.PI/4:-b.PI/4:b.atan(2*j[T][I]/(j[T][T]-j[I][I]))/2,(N=r.identity(G,G))[T][T]=b.cos(S),N[T][I]=-b.sin(S),N[I][T]=b.sin(S),N[I][I]=b.cos(S),U=r.multiply(U,N),j=r.multiply(r.multiply(r.inv(N),j),N),F=0,h=1;h<G;h++)for(C=1;C<G;C++)h!=C&&b.abs(j[h][C])>.001&&(F=1)}for(h=0;h<G;h++)se.push(j[h][h]);return[U,se]},rungekutta:function(j,h,C,T,I,B){var S,N,F;if(B===2)for(;T<=C;)I+=((S=h*j(T,I))+(N=h*j(T+h,I+S)))/2,T+=h;if(B===4)for(;T<=C;)I+=((S=h*j(T,I))+2*(N=h*j(T+h/2,I+S/2))+2*(F=h*j(T+h/2,I+N/2))+h*j(T+h,I+F))/6,T+=h;return I},romberg:function(j,h,C,T){for(var I,B,S,N,F,G=0,U=(C-h)/2,se=[],ge=[],ie=[];G<T/2;){for(F=j(h),S=h,N=0;S<=C;S+=U,N++)se[N]=S;for(I=se.length,S=1;S<I-1;S++)F+=(S%2!=0?4:2)*j(se[S]);F=U/3*(F+j(C)),ie[G]=F,U/=2,G++}for(B=ie.length,I=1;B!==1;){for(S=0;S<B-1;S++)ge[S]=(b.pow(4,I)*ie[S+1]-ie[S])/(b.pow(4,I)-1);B=ge.length,ie=ge,ge=[],I++}return ie},richardson:function(j,h,C,T){function I(xe,Te){for(var ve,ae=0,ke=xe.length;ae<ke;ae++)xe[ae]===Te&&(ve=ae);return ve}for(var B,S,N,F,G,U=b.abs(C-j[I(j,C)+1]),se=0,ge=[],ie=[];T>=U;)B=I(j,C+T),S=I(j,C),ge[se]=(h[B]-2*h[S]+h[2*S-B])/(T*T),T/=2,se++;for(F=ge.length,N=1;F!=1;){for(G=0;G<F-1;G++)ie[G]=(b.pow(4,N)*ge[G+1]-ge[G])/(b.pow(4,N)-1);F=ie.length,ge=ie,ie=[],N++}return ge},simpson:function(j,h,C,T){for(var I,B=(C-h)/T,S=j(h),N=[],F=h,G=0,U=1;F<=C;F+=B,G++)N[G]=F;for(I=N.length;U<I-1;U++)S+=(U%2!=0?4:2)*j(N[U]);return B/3*(S+j(C))},hermite:function(j,h,C,T){for(var I,B=j.length,S=0,N=0,F=[],G=[],U=[],se=[];N<B;N++){for(F[N]=1,I=0;I<B;I++)N!=I&&(F[N]*=(T-j[I])/(j[N]-j[I]));for(G[N]=0,I=0;I<B;I++)N!=I&&(G[N]+=1/(j[N]-j[I]));U[N]=(1-2*(T-j[N])*G[N])*(F[N]*F[N]),se[N]=(T-j[N])*(F[N]*F[N]),S+=U[N]*h[N]+se[N]*C[N]}return S},lagrange:function(j,h,C){for(var T,I,B=0,S=0,N=j.length;S<N;S++){for(I=h[S],T=0;T<N;T++)S!=T&&(I*=(C-j[T])/(j[S]-j[T]));B+=I}return B},cubic_spline:function(j,h,C){for(var T,I,B=j.length,S=0,N=[],F=[],G=[],U=[],se=[],ge=[];S<B-1;S++)U[S]=j[S+1]-j[S];for(G[0]=0,S=1;S<B-1;S++)G[S]=3/U[S]*(h[S+1]-h[S])-3/U[S-1]*(h[S]-h[S-1]);for(S=1;S<B-1;S++)N[S]=[],F[S]=[],N[S][S-1]=U[S-1],N[S][S]=2*(U[S-1]+U[S]),N[S][S+1]=U[S],F[S][0]=G[S];for(I=r.multiply(r.inv(N),F),T=0;T<B-1;T++)se[T]=(h[T+1]-h[T])/U[T]-U[T]*(I[T+1][0]+2*I[T][0])/3,ge[T]=(I[T+1][0]-I[T][0])/(3*U[T]);for(T=0;T<B&&!(j[T]>C);T++);return h[T-=1]+(C-j[T])*se[T]+r.sq(C-j[T])*I[T]+(C-j[T])*r.sq(C-j[T])*ge[T]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(j){var h,C,T,I,B,S=j.length,N=j[0].length,F=0,G=[],U=[],se=[],ge=[],ie=[],xe=[],Te=[];for(F=0;F<S;F++)G[F]=r.sum(j[F])/N;for(F=0;F<N;F++)for(ie[F]=[],h=0;h<S;h++)ie[F][h]=j[h][F]-G[h];for(ie=r.transpose(ie),F=0;F<S;F++)for(xe[F]=[],h=0;h<S;h++)xe[F][h]=r.dot([ie[F]],[ie[h]])/(N-1);for(B=(T=r.jacobi(xe))[0],U=T[1],Te=r.transpose(B),F=0;F<U.length;F++)for(h=F;h<U.length;h++)U[F]<U[h]&&(C=U[F],U[F]=U[h],U[h]=C,se=Te[F],Te[F]=Te[h],Te[h]=se);for(I=r.transpose(ie),F=0;F<S;F++)for(ge[F]=[],h=0;h<I.length;h++)ge[F][h]=r.dot([Te[F]],[I[h]]);return[j,U,Te,ge]}}),function(j){for(var h=0;h<j.length;h++)(function(C){r.fn[C]=function(T,I){var B=this;return I?(setTimeout(function(){I.call(B,r.fn[C].call(B,T))},15),this):typeof r[C](this,T)=="number"?r[C](this,T):r(r[C](this,T))}})(j[h])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(c,Math),function(r,b){var H=[].slice,_=r.utils.isNumber,g=r.utils.isArray;function u(m,j,h,C){if(m>1||h>1||m<=0||h<=0)throw new Error("Proportions should be greater than 0 and less than 1");var T=(m*j+h*C)/(j+C);return(m-h)/b.sqrt(T*(1-T)*(1/j+1/C))}r.extend({zscore:function(){var m=H.call(arguments);return _(m[1])?(m[0]-m[1])/m[2]:(m[0]-r.mean(m[1]))/r.stdev(m[1],m[2])},ztest:function(){var m,j=H.call(arguments);return g(j[1])?(m=r.zscore(j[0],j[1],j[3]),j[2]===1?r.normal.cdf(-b.abs(m),0,1):2*r.normal.cdf(-b.abs(m),0,1)):j.length>2?(m=r.zscore(j[0],j[1],j[2]),j[3]===1?r.normal.cdf(-b.abs(m),0,1):2*r.normal.cdf(-b.abs(m),0,1)):(m=j[0],j[1]===1?r.normal.cdf(-b.abs(m),0,1):2*r.normal.cdf(-b.abs(m),0,1))}}),r.extend(r.fn,{zscore:function(m,j){return(m-this.mean())/this.stdev(j)},ztest:function(m,j,h){var C=b.abs(this.zscore(m,h));return j===1?r.normal.cdf(-C,0,1):2*r.normal.cdf(-C,0,1)}}),r.extend({tscore:function(){var m=H.call(arguments);return m.length===4?(m[0]-m[1])/(m[2]/b.sqrt(m[3])):(m[0]-r.mean(m[1]))/(r.stdev(m[1],!0)/b.sqrt(m[1].length))},ttest:function(){var m,j=H.call(arguments);return j.length===5?(m=b.abs(r.tscore(j[0],j[1],j[2],j[3])),j[4]===1?r.studentt.cdf(-m,j[3]-1):2*r.studentt.cdf(-m,j[3]-1)):_(j[1])?(m=b.abs(j[0]),j[2]==1?r.studentt.cdf(-m,j[1]-1):2*r.studentt.cdf(-m,j[1]-1)):(m=b.abs(r.tscore(j[0],j[1])),j[2]==1?r.studentt.cdf(-m,j[1].length-1):2*r.studentt.cdf(-m,j[1].length-1))}}),r.extend(r.fn,{tscore:function(m){return(m-this.mean())/(this.stdev(!0)/b.sqrt(this.cols()))},ttest:function(m,j){return j===1?1-r.studentt.cdf(b.abs(this.tscore(m)),this.cols()-1):2*r.studentt.cdf(-b.abs(this.tscore(m)),this.cols()-1)}}),r.extend({anovafscore:function(){var m,j,h,C,T,I,B,S,N=H.call(arguments);if(N.length===1){for(T=new Array(N[0].length),B=0;B<N[0].length;B++)T[B]=N[0][B];N=T}for(j=new Array,B=0;B<N.length;B++)j=j.concat(N[B]);for(h=r.mean(j),m=0,B=0;B<N.length;B++)m+=N[B].length*b.pow(r.mean(N[B])-h,2);for(m/=N.length-1,I=0,B=0;B<N.length;B++)for(C=r.mean(N[B]),S=0;S<N[B].length;S++)I+=b.pow(N[B][S]-C,2);return m/(I/(j.length-N.length))},anovaftest:function(){var m,j,h,C,T=H.call(arguments);if(_(T[0]))return 1-r.centralF.cdf(T[0],T[1],T[2]);var I=r.anovafscore(T);for(m=T.length-1,h=0,C=0;C<T.length;C++)h+=T[C].length;return j=h-m-1,1-r.centralF.cdf(I,m,j)},ftest:function(m,j,h){return 1-r.centralF.cdf(m,j,h)}}),r.extend(r.fn,{anovafscore:function(){return r.anovafscore(this.toArray())},anovaftes:function(){var m,j=0;for(m=0;m<this.length;m++)j+=this[m].length;return r.ftest(this.anovafscore(),this.length-1,j-this.length)}}),r.extend({qscore:function(){var m,j,h,C,T,I=H.call(arguments);return _(I[0])?(m=I[0],j=I[1],h=I[2],C=I[3],T=I[4]):(m=r.mean(I[0]),j=r.mean(I[1]),h=I[0].length,C=I[1].length,T=I[2]),b.abs(m-j)/(T*b.sqrt((1/h+1/C)/2))},qtest:function(){var m,j=H.call(arguments);j.length===3?(m=j[0],j=j.slice(1)):j.length===7?(m=r.qscore(j[0],j[1],j[2],j[3],j[4]),j=j.slice(5)):(m=r.qscore(j[0],j[1],j[2]),j=j.slice(3));var h=j[0],C=j[1];return 1-r.tukey.cdf(m,C,h-C)},tukeyhsd:function(m){for(var j=r.pooledstdev(m),h=m.map(function(N){return r.mean(N)}),C=m.reduce(function(N,F){return N+F.length},0),T=[],I=0;I<m.length;++I)for(var B=I+1;B<m.length;++B){var S=r.qtest(h[I],h[B],m[I].length,m[B].length,j,C,m.length);T.push([[I,B],S])}return T}}),r.extend({normalci:function(){var m,j=H.call(arguments),h=new Array(2);return m=j.length===4?b.abs(r.normal.inv(j[1]/2,0,1)*j[2]/b.sqrt(j[3])):b.abs(r.normal.inv(j[1]/2,0,1)*r.stdev(j[2])/b.sqrt(j[2].length)),h[0]=j[0]-m,h[1]=j[0]+m,h},tci:function(){var m,j=H.call(arguments),h=new Array(2);return m=j.length===4?b.abs(r.studentt.inv(j[1]/2,j[3]-1)*j[2]/b.sqrt(j[3])):b.abs(r.studentt.inv(j[1]/2,j[2].length-1)*r.stdev(j[2],!0)/b.sqrt(j[2].length)),h[0]=j[0]-m,h[1]=j[0]+m,h},significant:function(m,j){return m<j}}),r.extend(r.fn,{normalci:function(m,j){return r.normalci(m,j,this.toArray())},tci:function(m,j){return r.tci(m,j,this.toArray())}}),r.extend(r.fn,{oneSidedDifferenceOfProportions:function(m,j,h,C){var T=u(m,j,h,C);return r.ztest(T,1)},twoSidedDifferenceOfProportions:function(m,j,h,C){var T=u(m,j,h,C);return r.ztest(T,2)}})}(c,Math),c.models=function(){function r(b,H){var _=b.length,g=H[0].length-1,u=_-g-1,m=c.lstsq(H,b),j=c.multiply(H,m.map(function(S){return[S]})).map(function(S){return S[0]}),h=c.subtract(b,j),C=c.mean(b),T=c.sum(j.map(function(S){return Math.pow(S-C,2)})),I=c.sum(b.map(function(S,N){return Math.pow(S-j[N],2)})),B=T+I;return{exog:H,endog:b,nobs:_,df_model:g,df_resid:u,coef:m,predict:j,resid:h,ybar:C,SST:B,SSE:T,SSR:I,R2:T/B}}return{ols:function(b,H){var _=r(b,H),g=function(j){var h,C,T=(h=j.exog,C=h[0].length,c.arange(C).map(function(U){var se=c.arange(C).filter(function(ge){return ge!==U});return r(c.col(h,U).map(function(ge){return ge[0]}),c.col(h,se))})),I=Math.sqrt(j.SSR/j.df_resid),B=T.map(function(U){var se=U.SST,ge=U.R2;return I/Math.sqrt(se*(1-ge))}),S=j.coef.map(function(U,se){return(U-0)/B[se]}),N=S.map(function(U){var se=c.studentt.cdf(U,j.df_resid);return 2*(se>.5?1-se:se)}),F=c.studentt.inv(.975,j.df_resid),G=j.coef.map(function(U,se){var ge=F*B[se];return[U-ge,U+ge]});return{se:B,t:S,p:N,sigmaHat:I,interval95:G}}(_),u=function(j){var h,C,T,I=j.R2/j.df_model/((1-j.R2)/j.df_resid);return{F_statistic:I,pvalue:1-(h=I,C=j.df_model,T=j.df_resid,c.beta.cdf(h/(T/C+h),C/2,T/2))}}(_),m=1-(1-_.R2)*((_.nobs-1)/_.df_resid);return _.t=g,_.f=u,_.adjust_R2=m,_}}}(),c.extend({buildxmatrix:function(){for(var r=new Array(arguments.length),b=0;b<arguments.length;b++)r[b]=[1].concat(arguments[b]);return c(r)},builddxmatrix:function(){for(var r=new Array(arguments[0].length),b=0;b<arguments[0].length;b++)r[b]=[1].concat(arguments[0][b]);return c(r)},buildjxmatrix:function(r){for(var b=new Array(r.length),H=0;H<r.length;H++)b[H]=r[H];return c.builddxmatrix(b)},buildymatrix:function(r){return c(r).transpose()},buildjymatrix:function(r){return r.transpose()},matrixmult:function(r,b){var H,_,g,u,m;if(r.cols()==b.rows()){if(b.rows()>1){for(u=[],H=0;H<r.rows();H++)for(u[H]=[],_=0;_<b.cols();_++){for(m=0,g=0;g<r.cols();g++)m+=r.toArray()[H][g]*b.toArray()[g][_];u[H][_]=m}return c(u)}for(u=[],H=0;H<r.rows();H++)for(u[H]=[],_=0;_<b.cols();_++){for(m=0,g=0;g<r.cols();g++)m+=r.toArray()[H][g]*b.toArray()[_];u[H][_]=m}return c(u)}},regress:function(r,b){var H=c.xtranspxinv(r),_=r.transpose(),g=c.matrixmult(c(H),_);return c.matrixmult(g,b)},regresst:function(r,b,H){var _=c.regress(r,b),g={anova:{}},u=c.jMatYBar(r,_);g.yBar=u;var m=b.mean();g.anova.residuals=c.residuals(b,u),g.anova.ssr=c.ssr(u,m),g.anova.msr=g.anova.ssr/(r[0].length-1),g.anova.sse=c.sse(b,u),g.anova.mse=g.anova.sse/(b.length-(r[0].length-1)-1),g.anova.sst=c.sst(b,m),g.anova.mst=g.anova.sst/(b.length-1),g.anova.r2=1-g.anova.sse/g.anova.sst,g.anova.r2<0&&(g.anova.r2=0),g.anova.fratio=g.anova.msr/g.anova.mse,g.anova.pvalue=c.anovaftest(g.anova.fratio,r[0].length-1,b.length-(r[0].length-1)-1),g.anova.rmse=Math.sqrt(g.anova.mse),g.anova.r2adj=1-g.anova.mse/g.anova.mst,g.anova.r2adj<0&&(g.anova.r2adj=0),g.stats=new Array(r[0].length);for(var j,h,C,T=c.xtranspxinv(r),I=0;I<_.length;I++)j=Math.sqrt(g.anova.mse*Math.abs(T[I][I])),h=Math.abs(_[I]/j),C=c.ttest(h,b.length-r[0].length-1,H),g.stats[I]=[_[I],j,h,C];return g.regress=_,g},xtranspx:function(r){return c.matrixmult(r.transpose(),r)},xtranspxinv:function(r){var b=c.matrixmult(r.transpose(),r);return c.inv(b)},jMatYBar:function(r,b){var H=c.matrixmult(r,b);return new c(H)},residuals:function(r,b){return c.matrixsubtract(r,b)},ssr:function(r,b){for(var H=0,_=0;_<r.length;_++)H+=Math.pow(r[_]-b,2);return H},sse:function(r,b){for(var H=0,_=0;_<r.length;_++)H+=Math.pow(r[_]-b[_],2);return H},sst:function(r,b){for(var H=0,_=0;_<r.length;_++)H+=Math.pow(r[_]-b,2);return H},matrixsubtract:function(r,b){for(var H=new Array(r.length),_=0;_<r.length;_++){H[_]=new Array(r[_].length);for(var g=0;g<r[_].length;g++)H[_][g]=r[_][g]-b[_][g]}return c(H)}}),c.jStat=c,c)},960:function(q,c,r){const b=r(592);q.exports=function(H){function _(I,B){const S=B.split(".");let N=I;for(const F of S){if(N==null)return;N=N[F]}return N}for(let I=0;I<Object.keys(b).length;I++){let B,S=Object.keys(b)[I],N=[];if(typeof b[S]=="object"){N=Object.keys(b[S]),B=Object.values(b[S]);for(let F=0;F<B.length;F++)if(typeof B[F]=="object"){let G=N[F];b[S][G]&&(N=[...N,...Object.keys(b[S][G]).map(U=>G+"."+U)],N.splice(N.indexOf(G),1))}}if(N.length<1)H[S]=b[S];else for(let F=0;F<N.length;F++)typeof _(b[S],N[F])=="function"&&(H[S]=_(b[S],N[F]))}let g=function(I){return typeof I=="number"&&(I=parseInt(I)),I},u=null,m=null,j=null;H.TABLE=function(){return j},H.COLUMN=H.COL=function(){return j.tracking&&j.tracking.push(T.getColumnNameFromCoords(g(u),g(m))),g(u)+1},H.ROW=function(){return j.tracking&&j.tracking.push(T.getColumnNameFromCoords(g(u),g(m))),g(m)+1},H.CELL=function(){return T.getColumnNameFromCoords(u,m)},H.VALUE=function(I,B,S){return j.getValueFromCoords(g(I)-1,g(B)-1,S)},H.THISROWCELL=function(I){return j.getValueFromCoords(g(I)-1,g(m))};const h=function(I,B){for(let S=0;S<I.length;S++){let N=T.getTokensFromRange(I[S]);B=B.replace(I[S],"["+N.join(",")+"]")}return B},C=function(I){return typeof I=="string"&&(I=I.trim()),!isNaN(I)&&I!==null&&I!==""},T=function(I,B,S,N,F){j=F,u=S,m=N;let G="",U={};if(B)if(B.size){let ie,xe=null;B.forEach(function(Te,ve){ie=ve.replace(/!/g,"."),ie.indexOf(".")!==-1&&(ie=ie.split("."),U[ie[0]]=!0)}),ie=Object.keys(U);for(let Te=0;Te<ie.length;Te++)G+="var "+ie[Te]+" = {};";B.forEach(function(Te,ve){ie=ve.replace(/!/g,"."),Te===null||C(Te)||(xe=Te.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),xe&&xe.length&&(Te=updateRanges(xe,Te))),ie.indexOf(".")>0?G+=ie+" = "+B.get(ve)+`;
`:G+="var "+ie+" = "+Te+`;
`})}else{let ie=Object.keys(B);if(ie.length){let xe,Te={};for(let ve=0;ve<ie.length;ve++)if(xe=ie[ve].replace(/\!/g,"."),xe.indexOf(".")>0){let ae=ae.split(".");Te[ae[0]]={}}xe=Object.keys(Te);for(let ve=0;ve<xe.length;ve++)G+="var "+xe[ve]+" = {};";for(let ve=0;ve<ie.length;ve++){if(xe=ie[ve].replace(/!/g,"."),B[ie[ve]]!==null&&!C(B[ie[ve]])){let ae=B[ie[ve]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);ae&&ae.length&&(B[ie[ve]]=h(ae,B[ie[ve]]))}xe.indexOf(".")>0?G+=xe+" = "+B[ie[ve]]+`;
`:G+="var "+xe+" = "+B[ie[ve]]+`;
`}}}let se=(I=function(ie,xe){let Te="",ve=0,ae=["=","!",">","<"];for(let ke=0;ke<ie.length;ke++)ie[ke]==='"'&&(ve=ve===0?1:0),ve===1?Te+=ie[ke]:(Te+=ie[ke].toUpperCase(),ke>0&&ie[ke]==="="&&ae.indexOf(ie[ke-1])===-1&&ae.indexOf(ie[ke+1])===-1&&(Te+="="));return Te=Te.replace(/\^/g,"**"),Te=Te.replace(/<>/g,"!="),Te=Te.replace(/&/g,"+"),Te=Te.replace(/\$/g,""),Te}(I=(I=I.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);se&&se.length&&(I=h(se,I));let ge=new Function(G+"; return "+I)();return ge===null&&(ge=0),ge};return T.getColumnNameFromCoords=function(I,B){return N="",(S=parseInt(I))>701?(N+=String.fromCharCode(64+parseInt(S/676)),N+=String.fromCharCode(64+parseInt(S%676/26))):S>25&&(N+=String.fromCharCode(64+parseInt(S/26))),N+String.fromCharCode(65+S%26)+(parseInt(B)+1);var S,N},T.getCoordsFromColumnName=function(I){var B=/^[a-zA-Z]+/.exec(I);if(B){for(var S=0,N=0;N<B[0].length;N++)S+=parseInt(B[0].charCodeAt(N)-64)*Math.pow(26,B[0].length-1-N);--S<0&&(S=0);var F=parseInt(/[0-9]+$/.exec(I))||null;return F>0&&F--,[S,F]}},T.getRangeFromTokens=function(I){I=I.filter(function(F){return F!="#REF!"});for(var B="",S="",N=0;N<I.length;N++)I[N].indexOf(".")>=0?B=".":I[N].indexOf("!")>=0&&(B="!"),B&&(S=I[N].split(B),I[N]=S[1],S=S[0]+B);return I.sort(function(F,G){var U=Helpers.getCoordsFromColumnName(F),se=Helpers.getCoordsFromColumnName(G);return U[1]>se[1]?1:U[1]<se[1]?-1:U[0]>se[0]?1:U[0]<se[0]?-1:0}),I.length?S+(I[0]+":")+I[I.length-1]:"#REF!"},T.getTokensFromRange=function(I){if(I.indexOf(".")>0){var B=I.split(".");I=B[1],B=B[0]+"."}else I.indexOf("!")>0?(B=I.split("!"),I=B[1],B=B[0]+"!"):B="";I=I.split(":");var S=T.getCoordsFromColumnName(I[0]),N=T.getCoordsFromColumnName(I[1]);if(S[0]<=N[0])var F=S[0],G=N[0];else F=N[0],G=S[0];if(S[1]===null&&N[1]==null)for(var U=null,se=null,ge=Object.keys(vars),ie=0;ie<ge.length;ie++){var xe=T.getCoordsFromColumnName(ge[ie]);xe[0]===S[0]&&(U===null||xe[1]<U)&&(U=xe[1]),xe[0]===N[0]&&(se===null||xe[1]>se)&&(se=xe[1])}else S[1]<=N[1]?(U=S[1],se=N[1]):(U=N[1],se=S[1]);for(var Te=[],ve=U;ve<=se;ve++){var ae=[];for(ie=F;ie<=G;ie++)ae.push(B+T.getColumnNameFromCoords(ie,ve));Te.push(ae)}return Te},T.setFormula=function(I){let B=Object.keys(I);for(let S=0;S<B.length;S++)typeof I[B[S]]=="function"&&(H[B[S]]=I[B[S]])},T.basic=!0,T}(typeof window>"u"?r.g:window)},592:function(q,c,r){var b=r(162),H=r(765);const _=new Error("#NULL!"),g=new Error("#DIV/0!"),u=new Error("#VALUE!"),m=new Error("#REF!"),j=new Error("#NAME?"),h=new Error("#NUM!"),C=new Error("#N/A"),T=new Error("#ERROR!"),I=new Error("#GETTING_DATA");var B=Object.freeze({__proto__:null,data:I,div0:g,error:T,na:C,name:j,nil:_,num:h,ref:m,value:u});function S(e){const t=[];return N(e,a=>{t.push(a)}),t}function N(e,t){let a=-1;const f=e.length;for(;++a<f&&t(e[a],a,e)!==!1;);return e}function F(e){let t,a=e.length;for(;a--;)if(t=e[a],typeof t!="number")if(t!==!0)if(t!==!1){if(typeof t=="string"){const f=Y(t);e[a]=f instanceof Error?0:f}}else e[a]=0;else e[a]=1;return e}function G(e,t){if(!e)return u;e.every(L=>Array.isArray(L))&&e.length!==0||(e=[[...e]]),e.map((L,R)=>{L.map((z,re)=>{z||(e[R][re]=0)})});const a=e.reduce((L,R,z)=>R.length>e[L].length?z:L,0),f=e[a].length;return e.map(L=>[...L,...Array(f-L.length).fill(t||0)])}function U(){let e;if(arguments.length===1){const a=arguments[0];e=(t=a)!=null&&typeof t.length=="number"&&typeof t!="string"?S.apply(null,arguments):[a]}else e=Array.from(arguments);for(var t;!ge(e);)e=se(e);return e}function se(e){return e&&e.reduce?e.reduce((t,a)=>{const f=Array.isArray(t),L=Array.isArray(a);return f&&L?t.concat(a):f?(t.push(a),t):L?[t].concat(a):[t,a]}):[e]}function ge(e){if(!e)return!1;for(let t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0}function ie(e,t){return t=t||1,e&&typeof e.slice=="function"?e.slice(t):e}function xe(e){return e?e[0].map((t,a)=>e.map(f=>f[a])):u}function Te(e,t){let a=null;return N(e,(f,L)=>{if(f[0]===t)return a=L,!1}),a??u}function ve(){for(let e=0;e<arguments.length;e++)if(arguments[e]instanceof Error)return arguments[e]}function ae(){let e=arguments.length;for(;e--;)if(arguments[e]instanceof Error)return!0;return!1}function ke(e){return Math.round(e*1e14)/1e14}function Ke(){return U.apply(null,arguments).filter(e=>typeof e=="number")}function Ue(e){if(typeof e=="boolean"||e instanceof Error)return e;if(typeof e=="number")return e!==0;if(typeof e=="string"){const t=e.toUpperCase();if(t==="TRUE")return!0;if(t==="FALSE")return!1}return e instanceof Date&&!isNaN(e)||u}function Be(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);const t=parseFloat(e);return t<0||t>=2958466?h:function(a){a<60&&(a+=1);const f=Math.floor(a-25569),L=new Date(86400*f*1e3),R=a-Math.floor(a)+1e-7;let z=Math.floor(86400*R);const re=z%60;z-=re;const pe=Math.floor(z/3600),Ee=Math.floor(z/60)%60;let Se=L.getUTCDate(),_e=L.getUTCMonth();return a>=60&&a<61&&(Se=29,_e=1),new Date(L.getUTCFullYear(),_e,Se,pe,Ee,re)}(t)}return typeof e!="string"||(e=/(\d{4})-(\d\d?)-(\d\d?)$/.test(e)?new Date(e+"T00:00:00.000"):new Date(e),isNaN(e))?u:e}function lt(e){let t,a=e.length;for(;a--;){if(t=Be(e[a]),t===u)return t;e[a]=t}return e}function Y(e){return e instanceof Error?e:e==null?0:(typeof e=="boolean"&&(e=+e),isNaN(e)||e===""?u:parseFloat(e))}function Le(e){let t,a;if(!e||(t=e.length)===0)return u;for(;t--;){if(e[t]instanceof Error)return e[t];if(a=Y(e[t]),a instanceof Error)return a;e[t]=a}return e}function qe(e){return e instanceof Error?e:e==null?"":e.toString()}function mt(){let e=arguments.length;for(;e--;)if(typeof arguments[e]=="string")return!0;return!1}function Me(e){return e!=null}const Ne="=",Oe=[">",">=","<","<=","=","<>"],ze="operator",Ge="literal",Qe=[ze,Ge],ct=ze,at=Ge;function dt(e,t){if(Qe.indexOf(t)===-1)throw new Error("Unsupported token type: "+t);return{value:e,type:t}}function vt(e){return function(t){let a="";const f=[];for(let L=0;L<t.length;L++){const R=t[L];L===0&&Oe.indexOf(R)>=0?f.push(dt(R,ct)):a+=R}return a.length>0&&f.push(dt(function(L){return typeof L!="string"||/^\d+(\.\d+)?$/.test(L)&&(L=L.indexOf(".")===-1?parseInt(L,10):parseFloat(L)),L}(a),at)),f.length>0&&f[0].type!==ct&&f.unshift(dt(Ne,ct)),f}(function(t){const a=t.length,f=[];let L=0,R="",z="";for(;L<a;){const re=t.charAt(L);switch(re){case">":case"<":case"=":z+=re,R.length>0&&(f.push(R),R="");break;default:z.length>0&&(f.push(z),z=""),R+=re}L++}return R.length>0&&f.push(R),z.length>0&&f.push(z),f}(e))}const ht=function(e){const t=[];let a;for(let f=0;f<e.length;f++){const L=e[f];switch(L.type){case ct:a=L.value;break;case at:t.push(L.value)}}return function(f,L){let R=!1;switch(L){case">":R=f[0]>f[1];break;case">=":R=f[0]>=f[1];break;case"<":R=f[0]<f[1];break;case"<=":R=f[0]<=f[1];break;case"=":R=f[0]==f[1];break;case"<>":R=f[0]!=f[1]}return R}(t,a)},Dt={};function St(e){return[u,m,g,h,j,_].indexOf(e)>=0||typeof e=="number"&&(isNaN(e)||!isFinite(e))}function ft(e){return St(e)||e===C}function Ft(e){return e===!0||e===!1}function Tt(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function w(e){return typeof e=="string"}function E(){const e=[];for(let t=0;t<arguments.length;++t){let a=!1;const f=arguments[t];for(let L=0;L<e.length&&(a=e[L]===f,!a);++L);a||e.push(f)}return e}function l(e,t,a,f){if(!t||!a)return C;f=!(f===0||f===!1);let L=C;const R=typeof e=="number";let z=!1;for(let re=0;re<t.length;re++){const pe=t[re];if(pe[0]===e){L=a<pe.length+1?pe[a-1]:m;break}!z&&(R&&f&&pe[0]<=e||f&&typeof pe[0]=="string"&&pe[0].localeCompare(e)<0)&&(L=a<pe.length+1?pe[a-1]:m),R&&pe[0]>e&&(z=!0)}return L}function o(){const e=U(arguments).filter(Me);if(e.length===0)return g;const t=ve.apply(void 0,e);if(t)return t;const a=Ke(e),f=a.length;let L,R=0,z=0;for(let re=0;re<f;re++)R+=a[re],z+=1;return L=R/z,isNaN(L)&&(L=h),L}function O(){const e=U(arguments).filter(Me);if(e.length===0)return g;const t=ve.apply(void 0,e);if(t)return t;const a=e,f=a.length;let L,R=0,z=0;for(let re=0;re<f;re++){const pe=a[re];typeof pe=="number"&&(R+=pe),pe===!0&&R++,pe!==null&&z++}return L=R/z,isNaN(L)&&(L=h),L}Dt.TYPE=e=>{switch(e){case _:return 1;case g:return 2;case u:return 3;case m:return 4;case j:return 5;case h:return 6;case C:return 7;case I:return 8}return C};const Q={DIST:function(e,t,a,f,L,R){return arguments.length<4?u:(L=L===void 0?0:L,R=R===void 0?1:R,ae(e=Y(e),t=Y(t),a=Y(a),L=Y(L),R=Y(R))?u:(e=(e-L)/(R-L),f?b.beta.cdf(e,t,a):b.beta.pdf(e,t,a)))},INV:(e,t,a,f,L)=>(f=f===void 0?0:f,L=L===void 0?1:L,ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f),L=Y(L))?u:b.beta.inv(e,t,a)*(L-f)+f)},ee={DIST:(e,t,a,f)=>ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f))?u:f?b.binomial.cdf(e,t,a):b.binomial.pdf(e,t,a)};ee.DIST.RANGE=(e,t,a,f)=>{if(f=f===void 0?a:f,ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f)))return u;let L=0;for(let R=a;R<=f;R++)L+=st(e,R)*Math.pow(t,R)*Math.pow(1-t,e-R);return L},ee.INV=(e,t,a)=>{if(ae(e=Y(e),t=Y(t),a=Y(a)))return u;let f=0;for(;f<=e;){if(b.binomial.cdf(f,e,t)>=a)return f;f++}};const D={DIST:(e,t,a)=>ae(e=Y(e),t=Y(t))?u:a?b.chisquare.cdf(e,t):b.chisquare.pdf(e,t)};D.DIST.RT=(e,t)=>!e|!t?C:e<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?u:1-b.chisquare.cdf(e,t),D.INV=(e,t)=>ae(e=Y(e),t=Y(t))?u:b.chisquare.inv(e,t),D.INV.RT=(e,t)=>!e|!t?C:e<0||e>1||t<1||t>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"?u:b.chisquare.inv(1-e,t),D.TEST=function(e,t){if(arguments.length!==2)return C;if(!(e instanceof Array&&t instanceof Array)||e.length!==t.length||e[0]&&t[0]&&e[0].length!==t[0].length)return u;const a=e.length;let f,L,R;for(L=0;L<a;L++)e[L]instanceof Array||(f=e[L],e[L]=[],e[L].push(f)),t[L]instanceof Array||(f=t[L],t[L]=[],t[L].push(f));const z=e[0].length,re=z===1?a-1:(a-1)*(z-1);let pe=0;const Ee=Math.PI;for(L=0;L<a;L++)for(R=0;R<z;R++)pe+=Math.pow(e[L][R]-t[L][R],2)/t[L][R];return Math.round(1e6*function(Se,_e){let Re=Math.exp(-.5*Se);_e%2==1&&(Re*=Math.sqrt(2*Se/Ee));let Xe=_e;for(;Xe>=2;)Re=Re*Se/Xe,Xe-=2;let et=Re,nt=_e;for(;et>1e-10*Re;)nt+=2,et=et*Se/nt,Re+=et;return 1-Re}(pe,re))/1e6};const M={};function V(){return Ke(U(arguments)).length}function K(){const e=U(arguments);return e.length-oe(e)}function oe(){const e=U(arguments);let t,a=0;for(let f=0;f<e.length;f++)t=e[f],t!=null&&t!==""||a++;return a}M.NORM=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:b.normalci(1,e,t,a)[1]-1,M.T=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:b.tci(1,e,t,a)[1]-1;const be={P:(e,t)=>{if(ae(e=Le(U(e)),t=Le(U(t))))return u;const a=b.mean(e),f=b.mean(t);let L=0;const R=e.length;for(let z=0;z<R;z++)L+=(e[z]-a)*(t[z]-f);return L/R},S:(e,t)=>ae(e=Le(U(e)),t=Le(U(t)))?u:b.covariance(e,t)},de={DIST:(e,t,a)=>ae(e=Y(e),t=Y(t))?u:a?b.exponential.cdf(e,t):b.exponential.pdf(e,t)},fe={};function le(e,t,a){if(ae(e=Y(e),t=Le(U(t)),a=Le(U(a))))return u;const f=b.mean(a),L=b.mean(t),R=a.length;let z=0,re=0;for(let Ee=0;Ee<R;Ee++)z+=(a[Ee]-f)*(t[Ee]-L),re+=Math.pow(a[Ee]-f,2);const pe=z/re;return L-pe*f+pe*e}function me(e){return(e=Y(e))instanceof Error?e:e===0||parseInt(e,10)===e&&e<0?h:b.gammafn(e)}function Ie(e){return(e=Y(e))instanceof Error?e:b.gammaln(e)}fe.DIST=(e,t,a,f)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:f?b.centralF.cdf(e,t,a):b.centralF.pdf(e,t,a),fe.DIST.RT=function(e,t,a){return arguments.length!==3?C:e<0||t<1||a<1?h:typeof e!="number"||typeof t!="number"||typeof a!="number"?u:1-b.centralF.cdf(e,t,a)},fe.INV=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:e<=0||e>1?h:b.centralF.inv(e,t,a),fe.INV.RT=function(e,t,a){return arguments.length!==3?C:e<0||e>1||t<1||t>Math.pow(10,10)||a<1||a>Math.pow(10,10)?h:typeof e!="number"||typeof t!="number"||typeof a!="number"?u:b.centralF.inv(1-e,t,a)},fe.TEST=(e,t)=>{if(!e||!t||!(e instanceof Array&&t instanceof Array))return C;if(e.length<2||t.length<2)return g;const a=(R,z)=>{let re=0;for(let pe=0;pe<R.length;pe++)re+=Math.pow(R[pe]-z,2);return re},f=Et(e)/e.length,L=Et(t)/t.length;return a(e,f)/(e.length-1)/(a(t,L)/(t.length-1))},me.DIST=function(e,t,a,f){return arguments.length!==4?C:e<0||t<=0||a<=0||typeof e!="number"||typeof t!="number"||typeof a!="number"?u:f?b.gamma.cdf(e,t,a,!0):b.gamma.pdf(e,t,a,!1)},me.INV=function(e,t,a){return arguments.length!==3?C:e<0||e>1||t<=0||a<=0?h:typeof e!="number"||typeof t!="number"||typeof a!="number"?u:b.gamma.inv(e,t,a)},Ie.PRECISE=function(e){return arguments.length!==1?C:e<=0?h:typeof e!="number"?u:b.gammaln(e)};const We={};function Je(e,t){return ae(e=Le(U(e)),t=Y(t))?e:t<0||e.length<t?u:e.sort((a,f)=>f-a)[t-1]}function ce(e,t){if(ae(e=Le(U(e)),t=Le(U(t))))return u;const a=b.mean(e),f=b.mean(t),L=t.length;let R=0,z=0;for(let pe=0;pe<L;pe++)R+=(t[pe]-f)*(e[pe]-a),z+=Math.pow(t[pe]-f,2);const re=R/z;return[re,a-re*f]}We.DIST=(e,t,a,f,L)=>{if(ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f)))return u;function R(z,re,pe,Ee){return st(pe,z)*st(Ee-pe,re-z)/st(Ee,re)}return L?function(z,re,pe,Ee){let Se=0;for(let _e=0;_e<=z;_e++)Se+=R(_e,re,pe,Ee);return Se}(e,t,a,f):R(e,t,a,f)};const Ae={};function X(){const e=U(arguments),t=ve.apply(void 0,e);if(t)return t;const a=Ke(e);return a.length===0?0:Math.max.apply(Math,a)}function W(){const e=U(arguments),t=ve.apply(void 0,e);if(t)return t;const a=F(e);let f=b.median(a);return isNaN(f)&&(f=h),f}function ne(){const e=U(arguments),t=ve.apply(void 0,e);if(t)return t;const a=Ke(e);return a.length===0?0:Math.min.apply(Math,a)}Ae.DIST=(e,t,a,f)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:f?b.lognormal.cdf(e,t,a):b.lognormal.pdf(e,t,a),Ae.INV=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:b.lognormal.inv(e,t,a);const v={MULT:function(){const e=Le(U(arguments));if(e instanceof Error)return e;const t=e.length,a={};let f,L=[],R=0;for(let z=0;z<t;z++)f=e[z],a[f]=a[f]?a[f]+1:1,a[f]>R&&(R=a[f],L=[]),a[f]===R&&(L[L.length]=f);return L},SNGL:function(){const e=Le(U(arguments));return e instanceof Error?e:v.MULT(e).sort((t,a)=>t-a)[0]}},P={DIST:(e,t,a,f)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:f?b.negbin.cdf(e,t,a):b.negbin.pdf(e,t,a)},J={};function he(e,t){if(ae(t=Le(U(t)),e=Le(U(e))))return u;const a=b.mean(e),f=b.mean(t),L=e.length;let R=0,z=0,re=0;for(let pe=0;pe<L;pe++)R+=(e[pe]-a)*(t[pe]-f),z+=Math.pow(e[pe]-a,2),re+=Math.pow(t[pe]-f,2);return R/Math.sqrt(z*re)}J.DIST=(e,t,a,f)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:a<=0?h:f?b.normal.cdf(e,t,a):b.normal.pdf(e,t,a),J.INV=(e,t,a)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:b.normal.inv(e,t,a),J.S={},J.S.DIST=(e,t)=>(e=Y(e))instanceof Error?u:t?b.normal.cdf(e,0,1):b.normal.pdf(e,0,1),J.S.INV=e=>(e=Y(e))instanceof Error?u:b.normal.inv(e,0,1);const Z={EXC:(e,t)=>{if(ae(e=Le(U(e)),t=Y(t)))return u;const a=(e=e.sort((R,z)=>R-z)).length;if(t<1/(a+1)||t>1-1/(a+1))return h;const f=t*(a+1)-1,L=Math.floor(f);return ke(f===L?e[f]:e[L]+(f-L)*(e[L+1]-e[L]))},INC:(e,t)=>{if(ae(e=Le(U(e)),t=Y(t)))return u;const a=t*((e=e.sort((L,R)=>L-R)).length-1),f=Math.floor(a);return ke(a===f?e[a]:e[f]+(a-f)*(e[f+1]-e[f]))}},ue={EXC:(e,t,a)=>{if(a=a===void 0?3:a,ae(e=Le(U(e)),t=Y(t),a=Y(a)))return u;e=e.sort((Se,_e)=>Se-_e);const f=E.apply(null,e),L=e.length,R=f.length,z=Math.pow(10,a);let re=0,pe=!1,Ee=0;for(;!pe&&Ee<R;)t===f[Ee]?(re=(e.indexOf(f[Ee])+1)/(L+1),pe=!0):t>=f[Ee]&&(t<f[Ee+1]||Ee===R-1)&&(re=(e.indexOf(f[Ee])+1+(t-f[Ee])/(f[Ee+1]-f[Ee]))/(L+1),pe=!0),Ee++;return Math.floor(re*z)/z},INC:(e,t,a)=>{if(a=a===void 0?3:a,ae(e=Le(U(e)),t=Y(t),a=Y(a)))return u;e=e.sort((Se,_e)=>Se-_e);const f=E.apply(null,e),L=e.length,R=f.length,z=Math.pow(10,a);let re=0,pe=!1,Ee=0;for(;!pe&&Ee<R;)t===f[Ee]?(re=e.indexOf(f[Ee])/(L-1),pe=!0):t>=f[Ee]&&(t<f[Ee+1]||Ee===R-1)&&(re=(e.indexOf(f[Ee])+(t-f[Ee])/(f[Ee+1]-f[Ee]))/(L-1),pe=!0),Ee++;return Math.floor(re*z)/z}},ye={DIST:(e,t,a)=>ae(e=Y(e),t=Y(t))?u:a?b.poisson.cdf(e,t):b.poisson.pdf(e,t)},De={EXC:(e,t)=>{if(ae(e=Le(U(e)),t=Y(t)))return u;switch(t){case 1:return Z.EXC(e,.25);case 2:return Z.EXC(e,.5);case 3:return Z.EXC(e,.75);default:return h}},INC:(e,t)=>{if(ae(e=Le(U(e)),t=Y(t)))return u;switch(t){case 1:return Z.INC(e,.25);case 2:return Z.INC(e,.5);case 3:return Z.INC(e,.75);default:return h}}},we={};function Fe(){const e=Le(U(arguments));if(e instanceof Error)return e;const t=b.mean(e),a=e.length;let f=0;for(let L=0;L<a;L++)f+=Math.pow(e[L]-t,3);return a*f/((a-1)*(a-2)*Math.pow(b.stdev(e,!0),3))}function Ve(e,t){return ae(e=Le(U(e)),t=Y(t))?e:e.sort((a,f)=>a-f)[t-1]}we.AVG=(e,t,a)=>{if(ae(e=Y(e),t=Le(U(t))))return u;const f=(a=a||!1)?(z,re)=>z-re:(z,re)=>re-z,L=(t=(t=U(t)).sort(f)).length;let R=0;for(let z=0;z<L;z++)t[z]===e&&R++;return R>1?(2*t.indexOf(e)+R+1)/2:t.indexOf(e)+1},we.EQ=(e,t,a)=>{if(ae(e=Y(e),t=Le(U(t))))return u;const f=(a=a||!1)?(L,R)=>L-R:(L,R)=>R-L;return(t=t.sort(f)).indexOf(e)+1},Fe.P=function(){const e=Le(U(arguments));if(e instanceof Error)return e;const t=b.mean(e),a=e.length;let f=0,L=0;for(let R=0;R<a;R++)L+=Math.pow(e[R]-t,3),f+=Math.pow(e[R]-t,2);return L/=a,f/=a,L/Math.pow(f,1.5)};const Ze={P:function(){const e=je.P.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},S:function(){const e=je.S.apply(this,arguments);return Math.sqrt(e)}},te={DIST:(e,t,a)=>a!==1&&a!==2?h:a===1?te.DIST.RT(e,t):te.DIST["2T"](e,t)};te.DIST["2T"]=function(e,t){return arguments.length!==2?C:e<0||t<1?h:typeof e!="number"||typeof t!="number"?u:2*(1-b.studentt.cdf(e,t))},te.DIST.RT=function(e,t){return arguments.length!==2?C:e<0||t<1?h:typeof e!="number"||typeof t!="number"?u:1-b.studentt.cdf(e,t)},te.INV=(e,t)=>ae(e=Y(e),t=Y(t))?u:b.studentt.inv(e,t),te.INV["2T"]=(e,t)=>(e=Y(e),t=Y(t),e<=0||e>1||t<1?h:ae(e,t)?u:Math.abs(b.studentt.inv(e/2,t))),te.TEST=(e,t)=>{if(ae(e=Le(U(e)),t=Le(U(t))))return u;const a=b.mean(e),f=b.mean(t);let L,R=0,z=0;for(L=0;L<e.length;L++)R+=Math.pow(e[L]-a,2);for(L=0;L<t.length;L++)z+=Math.pow(t[L]-f,2);R/=e.length-1,z/=t.length-1;const re=Math.abs(a-f)/Math.sqrt(R/e.length+z/t.length);return te.DIST["2T"](re,e.length+t.length-2)};const je={};function Ce(){const e=U(arguments),t=e.length;let a=0,f=0;const L=O(e);for(let R=0;R<t;R++){const z=e[R];a+=Math.pow(typeof z=="number"?z-L:z===!0?1-L:0-L,2),z!==null&&f++}return a/(f-1)}function He(){const e=U(arguments),t=e.length;let a=0,f=0;const L=O(e);let R;for(let z=0;z<t;z++){const re=e[z];a+=Math.pow(typeof re=="number"?re-L:re===!0?1-L:0-L,2),re!==null&&f++}return R=a/f,isNaN(R)&&(R=h),R}je.P=function(){const e=Ke(U(arguments)),t=e.length;let a=0;const f=o(e);let L;for(let R=0;R<t;R++)a+=Math.pow(e[R]-f,2);return L=a/t,isNaN(L)&&(L=h),L},je.S=function(){const e=Ke(U(arguments)),t=e.length;let a=0;const f=o(e);for(let L=0;L<t;L++)a+=Math.pow(e[L]-f,2);return a/(t-1)};const tt={DIST:(e,t,a,f)=>ae(e=Y(e),t=Y(t),a=Y(a))?u:f?1-Math.exp(-Math.pow(e/a,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/a,t))*t/Math.pow(a,t)},$e={};function ot(e,t,a){const f=ve(e=Y(e),t=Y(t),a=Y(a));if(f)return f;if(t===0)return 0;t=Math.abs(t);const L=-Math.floor(Math.log(t)/Math.log(10));return e>=0?yt(Math.ceil(e/t)*t,L):a===0?-yt(Math.floor(Math.abs(e)/t)*t,L):-yt(Math.ceil(Math.abs(e)/t)*t,L)}function st(e,t){return ve(e=Y(e),t=Y(t))||(e<t?h:Ye(e)/(Ye(t)*Ye(e-t)))}$e.TEST=(e,t,a)=>{if(ae(e=Le(U(e)),t=Y(t)))return u;a=a||Ze.S(e);const f=e.length;return 1-J.S.DIST((o(e)-t)/(a/Math.sqrt(f)),!0)},ot.MATH=ot,ot.PRECISE=ot;const Pe=[];function Ye(e){if((e=Y(e))instanceof Error)return e;const t=Math.floor(e);return t===0||t===1?1:(Pe[t]>0||(Pe[t]=Ye(t-1)*t),Pe[t])}function Ct(e,t){const a=ve(e=Y(e),t=Y(t));if(a)return a;if(t===0)return 0;if(!(e>=0&&t>0||e<=0&&t<0))return h;t=Math.abs(t);const f=-Math.floor(Math.log(t)/Math.log(10));return e>=0?yt(Math.floor(e/t)*t,f):-yt(Math.ceil(Math.abs(e)/t),f)}Ct.MATH=(e,t,a)=>{if(t instanceof Error)return t;t=t===void 0?0:t;const f=ve(e=Y(e),t=Y(t),a=Y(a));if(f)return f;if(t===0)return 0;t=t?Math.abs(t):1;const L=-Math.floor(Math.log(t)/Math.log(10));return e>=0?yt(Math.floor(e/t)*t,L):a===0||a===void 0?-yt(Math.ceil(Math.abs(e)/t)*t,L):-yt(Math.floor(Math.abs(e)/t)*t,L)},Ct.PRECISE=Ct.MATH;const cn={CEILING:ot};function Qt(e,t){const a=ve(e=Y(e),t=Y(t));if(a)return a;if(e===0&&t===0)return h;const f=Math.pow(e,t);return isNaN(f)?h:f}function Vt(){const e=U(arguments).filter(f=>f!=null);if(e.length===0)return 0;const t=Le(e);if(t instanceof Error)return t;let a=1;for(let f=0;f<t.length;f++)a*=t[f];return a}function yt(e,t){return ve(e=Y(e),t=Y(t))||+(Math.round(+(e+"e"+t))+"e"+-1*t)}function Et(){let e=0;return N(S(arguments),t=>{if(e instanceof Error)return!1;if(t instanceof Error)e=t;else if(typeof t=="number")e+=t;else if(typeof t=="string"){const a=parseFloat(t);!isNaN(a)&&(e+=a)}else if(Array.isArray(t)){const a=Et.apply(null,t);a instanceof Error?e=a:e+=a}}),e}var dn=Object.freeze({__proto__:null,ADD:function(e,t){return arguments.length!==2?C:ve(e=Y(e),t=Y(t))||e+t},DIVIDE:function(e,t){return arguments.length!==2?C:ve(e=Y(e),t=Y(t))||(t===0?g:e/t)},EQ:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e===t)},GT:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(mt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),ve(e,t)||e>t)},GTE:function(e,t){return arguments.length!==2?C:(mt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),ve(e,t)||e>=t)},LT:function(e,t){return arguments.length!==2?C:(mt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),ve(e,t)||e<t)},LTE:function(e,t){return arguments.length!==2?C:(mt(e,t)?(e=qe(e),t=qe(t)):(e=Y(e),t=Y(t)),ve(e,t)||e<=t)},MINUS:function(e,t){return arguments.length!==2?C:ve(e=Y(e),t=Y(t))||e-t},MULTIPLY:function(e,t){return arguments.length!==2?C:ve(e=Y(e),t=Y(t))||e*t},NE:function(e,t){return arguments.length!==2?C:e instanceof Error?e:t instanceof Error?t:(e===null&&(e=void 0),t===null&&(t=void 0),e!==t)},POW:function(e,t){return arguments.length!==2?C:Qt(e,t)}});const fn=new Date(Date.UTC(1900,0,1)),pn=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],hn=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],Ot=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Nt(e,t,a){a=a.toUpperCase(),e=Be(e),t=Be(t);const f=e.getFullYear(),L=e.getMonth(),R=e.getDate(),z=t.getFullYear(),re=t.getMonth(),pe=t.getDate();let Ee;switch(a){case"Y":Ee=Math.floor(Ut(e,t));break;case"D":Ee=At(t,e);break;case"M":Ee=re-L+12*(z-f),pe<R&&Ee--;break;case"MD":R<=pe?Ee=pe-R:(re===0?(e.setFullYear(z-1),e.setMonth(12)):(e.setFullYear(z),e.setMonth(re-1)),Ee=At(t,e));break;case"YM":Ee=re-L+12*(z-f),pe<R&&Ee--,Ee%=12;break;case"YD":re>L||re===L&&pe<R?e.setFullYear(z):e.setFullYear(z-1),Ee=At(t,e)}return Ee}function kt(e){const t=new Date(e);return t.setHours(0,0,0,0),t}function At(e,t){return e=Be(e),t=Be(t),e instanceof Error?e:t instanceof Error?t:tn(kt(e))-tn(kt(t))}function xt(e,t,a){if(a=Ue(a||"false"),e=Be(e),t=Be(t),e instanceof Error)return e;if(t instanceof Error)return t;if(a instanceof Error)return a;const f=e.getMonth();let L,R,z=t.getMonth();if(a)L=e.getDate()===31?30:e.getDate(),R=t.getDate()===31?30:t.getDate();else{const re=new Date(e.getFullYear(),f+1,0).getDate(),pe=new Date(t.getFullYear(),z+1,0).getDate();L=e.getDate()===re?30:e.getDate(),t.getDate()===pe?L<30?(z++,R=1):R=30:R=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(z-f)+(R-L)}function en(e){if((e=Be(e))instanceof Error)return e;(e=kt(e)).setDate(e.getDate()+4-(e.getDay()||7));const t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)}function Rt(e,t,a){return Rt.INTL(e,t,1,a)}function Ht(e,t,a){return Ht.INTL(e,t,1,a)}function Yt(e){return new Date(e,1,29).getMonth()===1}function Bt(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function Ut(e,t,a){if((e=Be(e))instanceof Error)return e;if((t=Be(t))instanceof Error)return t;a=a||0;let f=e.getDate();const L=e.getMonth()+1,R=e.getFullYear();let z=t.getDate();const re=t.getMonth()+1,pe=t.getFullYear();switch(a){case 0:return f===31&&z===31?(f=30,z=30):f===31?f=30:f===30&&z===31&&(z=30),(z+30*re+360*pe-(f+30*L+360*R))/360;case 1:{const Ee=(Xe,et)=>{const nt=Xe.getFullYear(),gt=new Date(nt,2,1);if(Yt(nt)&&Xe<gt&&et>=gt)return!0;const ut=et.getFullYear(),wt=new Date(ut,2,1);return Yt(ut)&&et>=wt&&Xe<wt};let Se=365;if(R===pe||R+1===pe&&(L>re||L===re&&f>=z))return(R===pe&&Yt(R)||Ee(e,t)||re===1&&z===29)&&(Se=366),Bt(e,t)/Se;const _e=pe-R+1,Re=(new Date(pe+1,0,1)-new Date(R,0,1))/1e3/60/60/24/_e;return Bt(e,t)/Re}case 2:return Bt(e,t)/360;case 3:return Bt(e,t)/365;case 4:return(z+30*re+360*pe-(f+30*L+360*R))/360}}function tn(e){const t=e>-22038912e5?2:1;return Math.ceil((e-fn)/864e5)+t}function nn(e){return(e=Y(e))===0?u:e instanceof Error?e:String.fromCharCode(e)}function on(e){if(ae(e))return e;let t=(e=e||"").charCodeAt(0);return isNaN(t)&&(t=u),t}function rn(){const e=U(arguments),t=ve.apply(void 0,e);if(t)return t;let a=0;for(;(a=e.indexOf(!0))>-1;)e[a]="TRUE";let f=0;for(;(f=e.indexOf(!1))>-1;)e[f]="FALSE";return e.join("")}Rt.INTL=(e,t,a,f)=>{if((e=Be(e))instanceof Error)return e;if((t=Be(t))instanceof Error)return t;let L=!1;const R=[],z=[1,2,3,4,5,6,0],re=new RegExp("^[0|1]{7}$");if(a===void 0)a=Ot[1];else if(typeof a=="string"&&re.test(a)){L=!0,a=a.split("");for(let _e=0;_e<a.length;_e++)a[_e]==="1"&&R.push(z[_e])}else a=Ot[a];if(!(a instanceof Array))return u;f===void 0?f=[]:f instanceof Array||(f=[f]);for(let _e=0;_e<f.length;_e++){const Re=Be(f[_e]);if(Re instanceof Error)return Re;f[_e]=Re}const pe=Math.round((t-e)/864e5)+1;let Ee=pe;const Se=e;for(let _e=0;_e<pe;_e++){const Re=new Date().getTimezoneOffset()>0?Se.getUTCDay():Se.getDay();let Xe=L?R.includes(Re):Re===a[0]||Re===a[1];for(let et=0;et<f.length;et++){const nt=f[et];if(nt.getDate()===Se.getDate()&&nt.getMonth()===Se.getMonth()&&nt.getFullYear()===Se.getFullYear()){Xe=!0;break}}Xe&&Ee--,Se.setDate(Se.getDate()+1)}return Ee},Ht.INTL=(e,t,a,f)=>{if((e=Be(e))instanceof Error)return e;if((t=Y(t))instanceof Error)return t;if(t<0)return h;if(!((a=a===void 0?Ot[1]:Ot[a])instanceof Array))return u;f===void 0?f=[]:f instanceof Array||(f=[f]);for(let R=0;R<f.length;R++){const z=Be(f[R]);if(z instanceof Error)return z;f[R]=z}let L=0;for(;L<t;){e.setDate(e.getDate()+1);const R=e.getDay();if(R!==a[0]&&R!==a[1]){for(let z=0;z<f.length;z++){const re=f[z];if(re.getDate()===e.getDate()&&re.getMonth()===e.getMonth()&&re.getFullYear()===e.getFullYear()){L--;break}}L++}}return e};const gn=rn;function an(e,t=2,a=!1){if(e=Y(e),isNaN(e)||(t=Y(t),isNaN(t)))return u;if(t<0){const f=Math.pow(10,-t);e=Math.round(e/f)*f}else e=e.toFixed(t);if(a)e=e.toString().replace(/,/g,"");else{const f=e.toString().split(".");f[0]=f[0].replace(/\B(?=(\d{3})+$)/g,","),e=f.join(".")}return e}function bt(e,t){return ve(e,t)||(e=qe(e),(t=Y(t))instanceof Error?t:new Array(t+1).join(e))}const mn=nn,bn=on;function qt(e){return/^[01]{1,10}$/.test(e)}function pt(e,t,a){if(ae(e=Y(e),t=Y(t)))return e;if((a=a===void 0?"i":a)!=="i"&&a!=="j")return u;if(e===0&&t===0)return 0;if(e===0)return t===1?a:t.toString()+a;if(t===0)return e.toString();{const f=t>0?"+":"";return e.toString()+f+(t===1?a:t.toString()+a)}}function zt(e,t){return t=t===void 0?0:t,ae(e=Y(e),t=Y(t))?u:b.erf(e)}function Wt(e){return isNaN(e)?u:b.erfc(e)}function Xt(e){const t=it(e),a=rt(e);return ae(t,a)?u:Math.sqrt(Math.pow(t,2)+Math.pow(a,2))}function rt(e){if(e===void 0||e===!0||e===!1)return u;if(e===0||e==="0")return 0;if(["i","j"].indexOf(e)>=0)return 1;let t=(e=(e+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),a=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),a===0&&(a=e.indexOf("-",1));const f=e.substring(e.length-1,e.length),L=f==="i"||f==="j";return t>=0||a>=0?L?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,a))||isNaN(e.substring(a+1,e.length-1))?h:-Number(e.substring(a+1,e.length-1)):h:L?isNaN(e.substring(0,e.length-1))?h:e.substring(0,e.length-1):isNaN(e)?h:0}function Gt(e){const t=it(e),a=rt(e);return ae(t,a)?u:t===0&&a===0?g:t===0&&a>0?Math.PI/2:t===0&&a<0?-Math.PI/2:a===0&&t>0?0:a===0&&t<0?-Math.PI:t>0?Math.atan(a/t):t<0&&a>=0?Math.atan(a/t)+Math.PI:Math.atan(a/t)-Math.PI}function Pt(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let f=e.substring(e.length-1);return f=f==="i"||f==="j"?f:"i",pt(Math.cos(t)*(Math.exp(a)+Math.exp(-a))/2,-Math.sin(t)*(Math.exp(a)-Math.exp(-a))/2,f)}function sn(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let f=e.substring(e.length-1);return f=f==="i"||f==="j"?f:"i",pt(Math.cos(a)*(Math.exp(t)+Math.exp(-t))/2,Math.sin(a)*(Math.exp(t)-Math.exp(-t))/2,f)}function Lt(e,t){const a=it(e),f=rt(e),L=it(t),R=rt(t);if(ae(a,f,L,R))return u;const z=e.substring(e.length-1),re=t.substring(t.length-1);let pe="i";if((z==="j"||re==="j")&&(pe="j"),L===0&&R===0)return h;const Ee=L*L+R*R;return pt((a*L+f*R)/Ee,(f*L-a*R)/Ee,pe)}function it(e){if(e===void 0||e===!0||e===!1)return u;if(e===0||e==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;let t=(e+="").indexOf("+"),a=e.indexOf("-");t===0&&(t=e.indexOf("+",1)),a===0&&(a=e.indexOf("-",1));const f=e.substring(e.length-1,e.length),L=f==="i"||f==="j";return t>=0||a>=0?L?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?h:Number(e.substring(0,t)):isNaN(e.substring(0,a))||isNaN(e.substring(a+1,e.length-1))?h:Number(e.substring(0,a)):h:L?isNaN(e.substring(0,e.length-1))?h:0:isNaN(e)?h:e}function _t(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let f=e.substring(e.length-1);return f=f==="i"||f==="j"?f:"i",pt(Math.sin(t)*(Math.exp(a)+Math.exp(-a))/2,Math.cos(t)*(Math.exp(a)-Math.exp(-a))/2,f)}function ln(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let f=e.substring(e.length-1);return f=f==="i"||f==="j"?f:"i",pt(Math.cos(a)*(Math.exp(t)-Math.exp(-t))/2,Math.sin(a)*(Math.exp(t)+Math.exp(-t))/2,f)}zt.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},Wt.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const jn=Q.DIST,vn=Q.INV,yn=ee.DIST,xn=ot.MATH,wn=ot.PRECISE,Cn=D.DIST,En=D.DIST.RT,An=D.INV,Ln=D.INV.RT,Mn=D.TEST,Tn=be.P,Nn=be.P,In=be.S,Dn=ee.INV,Sn=Wt.PRECISE,Fn=zt.PRECISE,On=de.DIST,kn=fe.DIST,Rn=fe.DIST.RT,Hn=fe.INV,Bn=fe.INV.RT,Pn=Ct.MATH,_n=Ct.PRECISE,Vn=fe.TEST,Yn=me.DIST,Un=me.INV,qn=Ie.PRECISE,zn=We.DIST,Wn=Ae.INV,Xn=Ae.DIST,Gn=Ae.INV,Kn=v.MULT,$n=v.SNGL,Jn=P.DIST,Zn=Rt.INTL,Qn=J.DIST,eo=J.INV,to=J.S.DIST,no=J.S.INV,oo=Z.EXC,ro=Z.INC,io=ue.EXC,ao=ue.INC,so=ye.DIST,lo=De.EXC,uo=De.INC,co=we.AVG,fo=we.EQ,po=Fe.P,ho=Ze.P,go=Ze.S,mo=te.DIST,bo=te.DIST.RT,jo=te.INV,vo=te.TEST,yo=je.P,xo=je.S,wo=tt.DIST,Co=Ht.INTL,Eo=$e.TEST;function Kt(e){const t=[];return N(e,a=>{a&&t.push(a)}),t}function jt(e,t){const a={};for(let R=1;R<e[0].length;++R)a[R]=!0;let f=t[0].length;for(let R=1;R<t.length;++R)t[R].length>f&&(f=t[R].length);for(let R=1;R<e.length;++R)for(let z=1;z<e[R].length;++z){let re=!1,pe=!1;for(let Ee=0;Ee<t.length;++Ee){const Se=t[Ee];if(Se.length<f)continue;const _e=Se[0];if(e[R][0]===_e){pe=!0;for(let Re=1;Re<Se.length;++Re)if(!re)if(Se[Re]===void 0||Se[Re]==="*")re=!0;else{const Xe=vt(Se[Re]+""),et=[dt(e[R][z],at)].concat(Xe);re=ht(et)}}}pe&&(a[z]=a[z]&&re)}const L=[];for(let R=0;R<e[0].length;++R)a[R]&&L.push(R-1);return L}function $t(e){return e&&e.getTime&&!isNaN(e.getTime())}function Jt(e){return e instanceof Date?e:new Date(e)}function Mt(e,t,a,f,L){if(f=f||0,L=L||0,ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f),L=Y(L)))return u;let R;if(e===0)R=f+a*t;else{const z=Math.pow(1+e,t);R=L===1?f*z+a*(1+e)*(z-1)/e:f*z+a*(z-1)/e}return-R}function un(e,t,a,f,L,R){if(L=L||0,R=R||0,ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f),L=Y(L),R=Y(R)))return u;const z=It(e,a,f,L,R);return(t===1?R===1?0:-f:R===1?Mt(e,t-2,z,f,1)-z:Mt(e,t-1,z,f,0))*e}function Zt(){const e=Le(U(arguments));if(e instanceof Error)return e;const t=e[0];let a=0;for(let f=1;f<e.length;f++)a+=e[f]/Math.pow(1+t,f);return a}function It(e,t,a,f,L){if(f=f||0,L=L||0,ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f),L=Y(L)))return u;let R;if(e===0)R=(a+f)/t;else{const z=Math.pow(1+e,t);R=L===1?(f*e/(z-1)+a*e/(1-1/z))/(1+e):f*e/(z-1)+a*e/(1-1/z)}return-R}const Ao={errors:B,symbols:dn};c.ABS=function(e){return(e=Y(e))instanceof Error?e:Math.abs(e)},c.ACCRINT=function(e,t,a,f,L,R,z){return e=Jt(e),t=Jt(t),a=Jt(a),$t(e)&&$t(t)&&$t(a)?f<=0||L<=0||[1,2,4].indexOf(R)===-1||[0,1,2,3,4].indexOf(z)===-1||a<=e?h:(L=L||0)*f*Ut(e,a,z=z||0):u},c.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},c.ACOS=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.acos(e);return isNaN(t)&&(t=h),t},c.ACOSH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=h),t},c.ACOT=function(e){return(e=Y(e))instanceof Error?e:Math.atan(1/e)},c.ACOTH=function(e){if((e=Y(e))instanceof Error)return e;let t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=h),t},c.AGGREGATE=function(e,t,a,f){if(ae(e=Y(e),Y(e)))return u;switch(e){case 1:return o(a);case 2:return V(a);case 3:return K(a);case 4:return X(a);case 5:return ne(a);case 6:return Vt(a);case 7:return Ze.S(a);case 8:return Ze.P(a);case 9:return Et(a);case 10:return je.S(a);case 11:return je.P(a);case 12:return W(a);case 13:return v.SNGL(a);case 14:return Je(a,f);case 15:return Ve(a,f);case 16:return Z.INC(a,f);case 17:return De.INC(a,f);case 18:return Z.EXC(a,f);case 19:return De.EXC(a,f)}},c.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},c.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},c.AND=function(){const e=U(arguments);let t=u;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===u&&(t=!0),e[a]||(t=!1))}return t},c.ARABIC=function(e){if(e==null)return 0;if(e instanceof Error)return e;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return u;let t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,a=>{t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[a]}),t},c.ASC=function(){throw new Error("ASC is not implemented")},c.ASIN=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.asin(e);return isNaN(t)&&(t=h),t},c.ASINH=function(e){return(e=Y(e))instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},c.ATAN=function(e){return(e=Y(e))instanceof Error?e:Math.atan(e)},c.ATAN2=function(e,t){return ve(e=Y(e),t=Y(t))||Math.atan2(e,t)},c.ATANH=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=h),t},c.AVEDEV=function(){const e=U(arguments).filter(Me);if(e.length===0)return h;const t=Le(e);return t instanceof Error?t:b.sum(b(t).subtract(b.mean(t)).abs()[0])/t.length},c.AVERAGE=o,c.AVERAGEA=O,c.AVERAGEIF=function(e,t,a){if(arguments.length<=1)return C;if(a=Le(U(a=a||e).filter(Me)),e=U(e),a instanceof Error)return a;let f=0,L=0;const R=t===void 0||t==="*",z=R?null:vt(t+"");for(let re=0;re<e.length;re++){const pe=e[re];if(R)L+=a[re],f++;else{const Ee=[dt(pe,at)].concat(z);ht(Ee)&&(L+=a[re],f++)}}return L/f},c.AVERAGEIFS=function(){const e=S(arguments),t=(e.length-1)/2,a=U(e[0]);let f=0,L=0;for(let z=0;z<a.length;z++){let re=!1;for(let pe=0;pe<t;pe++){const Ee=e[2*pe+1][z],Se=e[2*pe+2];let _e=!1;if(Se===void 0||Se==="*")_e=!0;else{const Re=vt(Se+""),Xe=[dt(Ee,at)].concat(Re);_e=ht(Xe)}if(!_e){re=!1;break}re=!0}re&&(L+=a[z],f++)}const R=L/f;return isNaN(R)?0:R},c.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},c.BASE=function(e,t,a){const f=ve(e=Y(e),t=Y(t),a=Y(a));if(f)return f;if(t===0)return h;const L=e.toString(t);return new Array(Math.max(a+1-L.length,0)).join("0")+L},c.BESSELI=function(e,t){return ae(e=Y(e),t=Y(t))?u:H.besseli(e,t)},c.BESSELJ=function(e,t){return ae(e=Y(e),t=Y(t))?u:H.besselj(e,t)},c.BESSELK=function(e,t){return ae(e=Y(e),t=Y(t))?u:H.besselk(e,t)},c.BESSELY=function(e,t){return ae(e=Y(e),t=Y(t))?u:H.bessely(e,t)},c.BETA=Q,c.BETADIST=jn,c.BETAINV=vn,c.BIN2DEC=function(e){if(!qt(e))return h;const t=parseInt(e,2),a=e.toString();return a.length===10&&a.substring(0,1)==="1"?parseInt(a.substring(1),2)-512:t},c.BIN2HEX=function(e,t){if(!qt(e))return h;const a=e.toString();if(a.length===10&&a.substring(0,1)==="1")return(0xfffffffe00+parseInt(a.substring(1),2)).toString(16);const f=parseInt(e,2).toString(16);return t===void 0?f:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=f.length?bt("0",t-f.length)+f:h},c.BIN2OCT=function(e,t){if(!qt(e))return h;const a=e.toString();if(a.length===10&&a.substring(0,1)==="1")return(1073741312+parseInt(a.substring(1),2)).toString(8);const f=parseInt(e,2).toString(8);return t===void 0?f:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=f.length?bt("0",t-f.length)+f:h},c.BINOM=ee,c.BINOMDIST=yn,c.BITAND=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e&t},c.BITLSHIFT=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e<<t:e>>-t},c.BITOR=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e|t},c.BITRSHIFT=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<0||Math.floor(e)!==e||e>0xffffffffffff||Math.abs(t)>53?h:t>=0?e>>t:e<<-t},c.BITXOR=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<0||t<0||Math.floor(e)!==e||Math.floor(t)!==t||e>0xffffffffffff||t>0xffffffffffff?h:e^t},c.CEILING=ot,c.CEILINGMATH=xn,c.CEILINGPRECISE=wn,c.CELL=function(){throw new Error("CELL is not implemented")},c.CHAR=nn,c.CHIDIST=Cn,c.CHIDISTRT=En,c.CHIINV=An,c.CHIINVRT=Ln,c.CHISQ=D,c.CHITEST=Mn,c.CHOOSE=function(){if(arguments.length<2)return C;const e=arguments[0];return e<1||e>254||arguments.length<e+1?u:arguments[e]},c.CLEAN=function(e){return ae(e)?e:(e=e||"").replace(/[\0-\x1F]/g,"")},c.CODE=on,c.COLUMN=function(e,t){return arguments.length!==2?C:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?b.col(e,t):void 0:u},c.COLUMNS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:b.cols(e):u},c.COMBIN=st,c.COMBINA=function(e,t){return ve(e=Y(e),t=Y(t))||(e<t?h:e===0&&t===0?1:st(e+t-1,e-1))},c.COMPLEX=pt,c.CONCAT=gn,c.CONCATENATE=rn,c.CONFIDENCE=M,c.CONVERT=function(e,t,a){if((e=Y(e))instanceof Error)return e;const f=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ngstrm","",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ngstrm","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestrke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ngstrm","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],L={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},R={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let z,re=null,pe=null,Ee=t,Se=a,_e=1,Re=1;for(let Xe=0;Xe<f.length;Xe++)z=f[Xe][2]===null?[]:f[Xe][2],(f[Xe][1]===Ee||z.indexOf(Ee)>=0)&&(re=f[Xe]),(f[Xe][1]===Se||z.indexOf(Se)>=0)&&(pe=f[Xe]);if(re===null){const Xe=L[t.substring(0,2)];let et=R[t.substring(0,1)];t.substring(0,2)==="da"&&(et=["dekao",10,"da"]),Xe?(_e=Xe[2],Ee=t.substring(2)):et&&(_e=et[1],Ee=t.substring(et[2].length));for(let nt=0;nt<f.length;nt++)z=f[nt][2]===null?[]:f[nt][2],(f[nt][1]===Ee||z.indexOf(Ee)>=0)&&(re=f[nt])}if(pe===null){const Xe=L[a.substring(0,2)];let et=R[a.substring(0,1)];a.substring(0,2)==="da"&&(et=["dekao",10,"da"]),Xe?(Re=Xe[2],Se=a.substring(2)):et&&(Re=et[1],Se=a.substring(et[2].length));for(let nt=0;nt<f.length;nt++)z=f[nt][2]===null?[]:f[nt][2],(f[nt][1]===Se||z.indexOf(Se)>=0)&&(pe=f[nt])}return re===null||pe===null||re[3]!==pe[3]?C:e*re[6]*_e/(pe[6]*Re)},c.CORREL=function(e,t){return ae(e=Le(U(e)),t=Le(U(t)))?u:b.corrcoeff(e,t)},c.COS=function(e){return(e=Y(e))instanceof Error?e:Math.cos(e)},c.COSH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},c.COT=function(e){return(e=Y(e))instanceof Error?e:e===0?g:1/Math.tan(e)},c.COTH=function(e){if((e=Y(e))instanceof Error)return e;if(e===0)return g;const t=Math.exp(2*e);return(t+1)/(t-1)},c.COUNT=V,c.COUNTA=K,c.COUNTBLANK=oe,c.COUNTIF=function(e,t){if(e=U(e),t===void 0||t==="*")return e.length;let a=0;const f=vt(t+"");for(let L=0;L<e.length;L++){const R=[dt(e[L],at)].concat(f);ht(R)&&a++}return a},c.COUNTIFS=function(){const e=S(arguments),t=new Array(U(e[0]).length);for(let f=0;f<t.length;f++)t[f]=!0;for(let f=0;f<e.length;f+=2){const L=U(e[f]),R=e[f+1];if(R!==void 0&&R!=="*"){const z=vt(R+"");for(let re=0;re<L.length;re++){const pe=[dt(L[re],at)].concat(z);t[re]=t[re]&&ht(pe)}}}let a=0;for(let f=0;f<t.length;f++)t[f]&&a++;return a},c.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},c.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},c.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},c.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},c.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},c.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},c.COVAR=Tn,c.COVARIANCE=be,c.COVARIANCEP=Nn,c.COVARIANCES=In,c.CRITBINOM=Dn,c.CSC=function(e){return(e=Y(e))instanceof Error?e:e===0?g:1/Math.sin(e)},c.CSCH=function(e){return(e=Y(e))instanceof Error?e:e===0?g:2/(Math.exp(e)-Math.exp(-e))},c.CUMIPMT=function(e,t,a,f,L,R){if(ae(e=Y(e),t=Y(t),a=Y(a)))return u;if(e<=0||t<=0||a<=0||f<1||L<1||f>L||R!==0&&R!==1)return h;const z=It(e,t,a,0,R);let re=0;f===1&&(R===0&&(re=-a),f++);for(let pe=f;pe<=L;pe++)re+=R===1?Mt(e,pe-2,z,a,1)-z:Mt(e,pe-1,z,a,0);return re*=e,re},c.CUMPRINC=function(e,t,a,f,L,R){if(ae(e=Y(e),t=Y(t),a=Y(a)))return u;if(e<=0||t<=0||a<=0||f<1||L<1||f>L||R!==0&&R!==1)return h;const z=It(e,t,a,0,R);let re=0;f===1&&(re=R===0?z+a*e:z,f++);for(let pe=f;pe<=L;pe++)re+=R>0?z-(Mt(e,pe-2,z,a,1)-z)*e:z-Mt(e,pe-1,z,a,0)*e;return re},c.DATE=function(e,t,a){let f;return ae(e=Y(e),t=Y(t),a=Y(a))?f=u:(f=new Date(e,t-1,a),f.getFullYear()<0&&(f=h)),f},c.DATEDIF=Nt,c.DATEVALUE=function(e){if(typeof e!="string")return u;const t=Date.parse(e);return isNaN(t)?u:new Date(e)},c.DAVERAGE=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);let R=0;return N(f,z=>{R+=L[z]}),f.length===0?g:R/f.length},c.DAY=function(e){const t=Be(e);return t instanceof Error?t:t.getDate()},c.DAYS=At,c.DAYS360=xt,c.DB=function(e,t,a,f,L){if(L=L===void 0?12:L,ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f),L=Y(L)))return u;if(e<0||t<0||a<0||f<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(L)===-1||f>a)return h;if(t>=e)return 0;const R=(1-Math.pow(t/e,1/a)).toFixed(3),z=e*R*L/12;let re=z,pe=0;const Ee=f===a?a-1:f;for(let Se=2;Se<=Ee;Se++)pe=(e-re)*R,re+=pe;return f===1?z:f===a?(e-re)*R:pe},c.DBCS=function(){throw new Error("DBCS is not implemented")},c.DCOUNT=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);const R=[];return N(f,z=>{R.push(L[z])}),V(R)},c.DCOUNTA=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);const R=[];return N(f,z=>{R.push(L[z])}),K(R)},c.DDB=function(e,t,a,f,L){if(L=L===void 0?2:L,ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f),L=Y(L)))return u;if(e<0||t<0||a<0||f<0||L<=0||f>a)return h;if(t>=e)return 0;let R=0,z=0;for(let re=1;re<=f;re++)z=Math.min(L/a*(e-R),e-t-R),R+=z;return z},c.DEC2BIN=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return h;if(e<0)return"1"+bt("0",9-(512+e).toString(2).length)+(512+e).toString(2);const a=parseInt(e,10).toString(2);return t===void 0?a:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=a.length?bt("0",t-a.length)+a:h},c.DEC2HEX=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return h;if(e<0)return(1099511627776+e).toString(16);const a=parseInt(e,10).toString(16);return t===void 0?a:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=a.length?bt("0",t-a.length)+a:h},c.DEC2OCT=function(e,t){if((e=Y(e))instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return h;if(e<0)return(1073741824+e).toString(8);const a=parseInt(e,10).toString(8);return t===void 0?a:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=a.length?bt("0",t-a.length)+a:h},c.DECIMAL=function(e,t){return arguments.length<1?u:ve(e=Y(e),t=Y(t))||(t===0?h:parseInt(e,t))},c.DEGREES=function(e){return(e=Y(e))instanceof Error?e:180*e/Math.PI},c.DELTA=function(e,t){return t=t===void 0?0:t,ae(e=Y(e),t=Y(t))?u:e===t?1:0},c.DEVSQ=function(){const e=Le(U(arguments));if(e instanceof Error)return e;const t=b.mean(e);let a=0;for(let f=0;f<e.length;f++)a+=Math.pow(e[f]-t,2);return a},c.DGET=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];return L=ie(typeof t=="string"?e[Te(e,t)]:e[t]),f.length===0?u:f.length>1?h:L[f[0]]},c.DISC=function(e,t,a,f,L){if(ae(e=Be(e),t=Be(t),a=Y(a),f=Y(f),L=(L=Y(L))||0))return u;if(a<=0||f<=0)return h;if(e>=t)return u;let R,z;switch(L){case 0:R=360,z=xt(e,t,!1);break;case 1:case 3:R=365,z=Nt(e,t,"D");break;case 2:R=360,z=Nt(e,t,"D");break;case 4:R=360,z=xt(e,t,!0);break;default:return h}return(f-a)/f*R/z},c.DMAX=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);let R=L[f[0]];return N(f,z=>{R<L[z]&&(R=L[z])}),R},c.DMIN=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);let R=L[f[0]];return N(f,z=>{R>L[z]&&(R=L[z])}),R},c.DOLLAR=function(e,t=2){if(e=Y(e),isNaN(e))return u;const a={style:"currency",currency:"USD",minimumFractionDigits:t>=0?t:0,maximumFractionDigits:t>=0?t:0},f=(e=yt(e,t)).toLocaleString("en-US",a);return e<0?"$("+f.slice(2)+")":f},c.DOLLARDE=function(e,t){if(ae(e=Y(e),t=Y(t)))return u;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let a=parseInt(e,10);a+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;const f=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return a=Math.round(a*f)/f,a},c.DOLLARFR=function(e,t){if(ae(e=Y(e),t=Y(t)))return u;if(t<0)return h;if(t>=0&&t<1)return g;t=parseInt(t,10);let a=parseInt(e,10);return a+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t,a},c.DPRODUCT=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const re=Te(e,t);L=ie(e[re])}else L=ie(e[t]);let R=[];N(f,re=>{R.push(L[re])}),R=Kt(R);let z=1;return N(R,re=>{z*=re}),z},c.DSTDEV=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);let R=[];return N(f,z=>{R.push(L[z])}),R=Kt(R),Ze.S(R)},c.DSTDEVP=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);let R=[];return N(f,z=>{R.push(L[z])}),R=Kt(R),Ze.P(R)},c.DSUM=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);const R=[];return N(f,z=>{R.push(L[z])}),Et(R)},c.DURATION=function(){throw new Error("DURATION is not implemented")},c.DVAR=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);const R=[];return N(f,z=>{R.push(L[z])}),je.S(R)},c.DVARP=function(e,t,a){if(isNaN(t)&&typeof t!="string")return u;const f=jt(e,a);let L=[];if(typeof t=="string"){const z=Te(e,t);L=ie(e[z])}else L=ie(e[t]);const R=[];return N(f,z=>{R.push(L[z])}),je.P(R)},c.EDATE=function(e,t){return(e=Be(e))instanceof Error?e:isNaN(t)?u:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),e)},c.EFFECT=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<=0||t<1?h:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},c.EOMONTH=function(e,t){return(e=Be(e))instanceof Error?e:isNaN(t)?u:(t=parseInt(t,10),new Date(e.getFullYear(),e.getMonth()+t+1,0))},c.ERF=zt,c.ERFC=Wt,c.ERFCPRECISE=Sn,c.ERFPRECISE=Fn,c.ERROR=Dt,c.EVEN=function(e){return(e=Y(e))instanceof Error?e:ot(e,-2,-1)},c.EXACT=function(e,t){return arguments.length!==2?C:ve(e,t)||(e=qe(e))===qe(t)},c.EXP=function(e){return arguments.length<1?C:arguments.length>1?T:(e=Y(e))instanceof Error?e:e=Math.exp(e)},c.EXPON=de,c.EXPONDIST=On,c.F=fe,c.FACT=Ye,c.FACTDOUBLE=function e(t){if((t=Y(t))instanceof Error)return t;const a=Math.floor(t);return a<=0?1:a*e(a-2)},c.FALSE=function(){return!1},c.FDIST=kn,c.FDISTRT=Rn,c.FIND=function(e,t,a){if(arguments.length<2)return C;e=qe(e),a=a===void 0?0:a;const f=(t=qe(t)).indexOf(e,a-1);return f===-1?u:f+1},c.FINV=Hn,c.FINVRT=Bn,c.FISHER=function(e){return(e=Y(e))instanceof Error?e:Math.log((1+e)/(1-e))/2},c.FISHERINV=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},c.FIXED=an,c.FLOOR=Ct,c.FLOORMATH=Pn,c.FLOORPRECISE=_n,c.FORECAST=le,c.FREQUENCY=function(e,t){if(ae(e=Le(U(e)),t=Le(U(t))))return u;const a=e.length,f=t.length,L=[];for(let R=0;R<=f;R++){L[R]=0;for(let z=0;z<a;z++)R===0?e[z]<=t[0]&&(L[0]+=1):R<f?e[z]>t[R-1]&&e[z]<=t[R]&&(L[R]+=1):R===f&&e[z]>t[f-1]&&(L[f]+=1)}return L},c.FTEST=Vn,c.FV=Mt,c.FVSCHEDULE=function(e,t){if(ae(e=Y(e),t=Le(U(t))))return u;const a=t.length;let f=e;for(let L=0;L<a;L++)f*=1+t[L];return f},c.GAMMA=me,c.GAMMADIST=Yn,c.GAMMAINV=Un,c.GAMMALN=Ie,c.GAMMALNPRECISE=qn,c.GAUSS=function(e){return(e=Y(e))instanceof Error?e:b.normal.cdf(e,0,1)-.5},c.GCD=function(){const e=Le(U(arguments));if(e instanceof Error)return e;const t=e.length,a=e[0];let f=a<0?-a:a;for(let L=1;L<t;L++){const R=e[L];let z=R<0?-R:R;for(;f&&z;)f>z?f%=z:z%=f;f+=z}return f},c.GEOMEAN=function(){const e=Le(U(arguments));return e instanceof Error?e:b.geomean(e)},c.GESTEP=function(e,t){return ae(t=t||0,e=Y(e))?e:e>=t?1:0},c.GROWTH=function(e,t,a,f){if((e=Le(e))instanceof Error)return e;let L;if(t===void 0)for(t=[],L=1;L<=e.length;L++)t.push(L);if(a===void 0)for(a=[],L=1;L<=e.length;L++)a.push(L);if(ae(t=Le(t),a=Le(a)))return u;f===void 0&&(f=!0);const R=e.length;let z,re,pe=0,Ee=0,Se=0,_e=0;for(L=0;L<R;L++){const Xe=t[L],et=Math.log(e[L]);pe+=Xe,Ee+=et,Se+=Xe*et,_e+=Xe*Xe}pe/=R,Ee/=R,Se/=R,_e/=R,f?(z=(Se-pe*Ee)/(_e-pe*pe),re=Ee-z*pe):(z=Se/_e,re=0);const Re=[];for(L=0;L<a.length;L++)Re.push(Math.exp(re+z*a[L]));return Re},c.HARMEAN=function(){const e=Le(U(arguments));if(e instanceof Error)return e;const t=e.length;let a=0;for(let f=0;f<t;f++)a+=1/e[f];return t/a},c.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const a=!(e.length!==10||e.substring(0,1).toLowerCase()!=="f"),f=a?parseInt(e,16)-1099511627776:parseInt(e,16);if(f<-512||f>511)return h;if(a)return"1"+bt("0",9-(512+f).toString(2).length)+(512+f).toString(2);const L=f.toString(2);return t===void 0?L:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=L.length?bt("0",t-L.length)+L:h},c.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},c.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return h;const a=parseInt(e,16);if(a>536870911&&a<0xffe0000000)return h;if(a>=0xffe0000000)return(a-0xffc0000000).toString(8);const f=a.toString(8);return t===void 0?f:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=f.length?bt("0",t-f.length)+f:h},c.HLOOKUP=function(e,t,a,f){return l(e,xe(t),a,f)},c.HOUR=function(e){return(e=Be(e))instanceof Error?e:e.getHours()},c.HYPGEOM=We,c.HYPGEOMDIST=zn,c.IF=function(e,t,a){return e instanceof Error?e:((t=!(arguments.length>=2)||t)==null&&(t=0),(a=arguments.length===3&&a)==null&&(a=0),e?t:a)},c.IFERROR=function(e,t){return ft(e)?t:e},c.IFNA=function(e,t){return e===C?t:e},c.IFS=function(){for(let e=0;e<arguments.length/2;e++)if(arguments[2*e])return arguments[2*e+1];return C},c.IMABS=Xt,c.IMAGINARY=rt,c.IMARGUMENT=Gt,c.IMCONJUGATE=function(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let f=e.substring(e.length-1);return f=f==="i"||f==="j"?f:"i",a!==0?pt(t,-a,f):e},c.IMCOS=Pt,c.IMCOSH=sn,c.IMCOT=function(e){return ae(it(e),rt(e))?u:Lt(Pt(e),_t(e))},c.IMCSC=function(e){return e===!0||e===!1?u:ae(it(e),rt(e))?h:Lt("1",_t(e))},c.IMCSCH=function(e){return e===!0||e===!1?u:ae(it(e),rt(e))?h:Lt("1",ln(e))},c.IMDIV=Lt,c.IMEXP=function(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let f=e.substring(e.length-1);f=f==="i"||f==="j"?f:"i";const L=Math.exp(t);return pt(L*Math.cos(a),L*Math.sin(a),f)},c.IMLN=function(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let f=e.substring(e.length-1);return f=f==="i"||f==="j"?f:"i",pt(Math.log(Math.sqrt(t*t+a*a)),Math.atan(a/t),f)},c.IMLOG10=function(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let f=e.substring(e.length-1);return f=f==="i"||f==="j"?f:"i",pt(Math.log(Math.sqrt(t*t+a*a))/Math.log(10),Math.atan(a/t)/Math.log(10),f)},c.IMLOG2=function(e){const t=it(e),a=rt(e);if(ae(t,a))return u;let f=e.substring(e.length-1);return f=f==="i"||f==="j"?f:"i",pt(Math.log(Math.sqrt(t*t+a*a))/Math.log(2),Math.atan(a/t)/Math.log(2),f)},c.IMPOWER=function(e,t){if(ae(t=Y(t),it(e),rt(e)))return u;let a=e.substring(e.length-1);a=a==="i"||a==="j"?a:"i";const f=Math.pow(Xt(e),t),L=Gt(e);return pt(f*Math.cos(t*L),f*Math.sin(t*L),a)},c.IMPRODUCT=function(){let e=arguments[0];if(!arguments.length)return u;for(let t=1;t<arguments.length;t++){const a=it(e),f=rt(e),L=it(arguments[t]),R=rt(arguments[t]);if(ae(a,f,L,R))return u;e=pt(a*L-f*R,a*R+f*L)}return e},c.IMREAL=it,c.IMSEC=function(e){return e===!0||e===!1||ae(it(e),rt(e))?u:Lt("1",Pt(e))},c.IMSECH=function(e){return ae(it(e),rt(e))?u:Lt("1",sn(e))},c.IMSIN=_t,c.IMSINH=ln,c.IMSQRT=function(e){if(ae(it(e),rt(e)))return u;let t=e.substring(e.length-1);t=t==="i"||t==="j"?t:"i";const a=Math.sqrt(Xt(e)),f=Gt(e);return pt(a*Math.cos(f/2),a*Math.sin(f/2),t)},c.IMSUB=function(e,t){const a=it(e),f=rt(e),L=it(t),R=rt(t);if(ae(a,f,L,R))return u;const z=e.substring(e.length-1),re=t.substring(t.length-1);let pe="i";return(z==="j"||re==="j")&&(pe="j"),pt(a-L,f-R,pe)},c.IMSUM=function(){if(!arguments.length)return u;const e=U(arguments);let t=e[0];for(let a=1;a<e.length;a++){const f=it(t),L=rt(t),R=it(e[a]),z=rt(e[a]);if(ae(f,L,R,z))return u;t=pt(f+R,L+z)}return t},c.IMTAN=function(e){return e===!0||e===!1||ae(it(e),rt(e))?u:Lt(_t(e),Pt(e))},c.INDEX=function(e,t,a){const f=ve(e,t,a);if(f)return f;if(!Array.isArray(e))return u;const L=e.length>0&&!Array.isArray(e[0]);return L&&!a?(a=t,t=1):(a=a||1,t=t||1),a<0||t<0?u:L&&t===1&&a<=e.length?e[a-1]:t<=e.length&&a<=e[t-1].length?e[t-1][a-1]:m},c.INFO=function(){throw new Error("INFO is not implemented")},c.INT=function(e){return(e=Y(e))instanceof Error?e:Math.floor(e)},c.INTERCEPT=function(e,t){return ae(e=Le(e),t=Le(t))?u:e.length!==t.length?C:le(0,e,t)},c.INTRATE=function(){throw new Error("INTRATE is not implemented")},c.IPMT=un,c.IRR=function(e,t){if(t=t||0,ae(e=Le(U(e)),t=Y(t)))return u;const a=(Re,Xe,et)=>{const nt=et+1;let gt=Re[0];for(let ut=1;ut<Re.length;ut++)gt+=Re[ut]/Math.pow(nt,(Xe[ut]-Xe[0])/365);return gt},f=(Re,Xe,et)=>{const nt=et+1;let gt=0;for(let ut=1;ut<Re.length;ut++){const wt=(Xe[ut]-Xe[0])/365;gt-=wt*Re[ut]/Math.pow(nt,wt+1)}return gt},L=[];let R=!1,z=!1;for(let Re=0;Re<e.length;Re++)L[Re]=Re===0?0:L[Re-1]+365,e[Re]>0&&(R=!0),e[Re]<0&&(z=!0);if(!R||!z)return h;let re,pe,Ee,Se=t=t===void 0?.1:t,_e=!0;do Ee=a(e,L,Se),re=Se-Ee/f(e,L,Se),pe=Math.abs(re-Se),Se=re,_e=pe>1e-10&&Math.abs(Ee)>1e-10;while(_e);return Se},c.ISBLANK=function(e){return e===null},c.ISERR=St,c.ISERROR=ft,c.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},c.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},c.ISLOGICAL=Ft,c.ISNA=function(e){return e===C},c.ISNONTEXT=function(e){return typeof e!="string"},c.ISNUMBER=Tt,c.ISO=cn,c.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},c.ISOWEEKNUM=en,c.ISPMT=function(e,t,a,f){return ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f))?u:f*e*(t/a-1)},c.ISREF=function(){throw new Error("ISREF is not implemented")},c.ISTEXT=w,c.KURT=function(){const e=Le(U(arguments));if(e instanceof Error)return e;const t=b.mean(e),a=e.length;let f=0;for(let L=0;L<a;L++)f+=Math.pow(e[L]-t,4);return f/=Math.pow(b.stdev(e,!0),4),a*(a+1)/((a-1)*(a-2)*(a-3))*f-3*(a-1)*(a-1)/((a-2)*(a-3))},c.LARGE=Je,c.LCM=function(){const e=Le(U(arguments));if(e instanceof Error)return e;for(var t,a,f,L,R=1;(f=e.pop())!==void 0;){if(f===0)return 0;for(;f>1;){if(f%2){for(t=3,a=Math.floor(Math.sqrt(f));t<=a&&f%t;t+=2);L=t<=a?t:f}else L=2;for(f/=L,R*=L,t=e.length;t;e[--t]%L==0&&(e[t]/=L)==1&&e.splice(t,1));}}return R},c.LEFT=function(e,t){return ve(e,t)||(e=qe(e),(t=Y(t=t===void 0?1:t))instanceof Error||typeof e!="string"?u:e.substring(0,t))},c.LEN=function(e){return arguments.length===0?T:e instanceof Error?e:Array.isArray(e)?u:qe(e).length},c.LINEST=ce,c.LN=function(e){return(e=Y(e))instanceof Error?e:e===0?h:Math.log(e)},c.LOG=function(e,t){return ve(e=Y(e),t=Y(t))||(e===0||t===0?h:Math.log(e)/Math.log(t))},c.LOG10=function(e){return(e=Y(e))instanceof Error?e:e===0?h:Math.log(e)/Math.log(10)},c.LOGEST=function(e,t){if(ae(e=Le(U(e)),t=Le(U(t)))||e.length!==t.length)return u;for(let f=0;f<e.length;f++)e[f]=Math.log(e[f]);const a=ce(e,t);return a[0]=Math.round(1e6*Math.exp(a[0]))/1e6,a[1]=Math.round(1e6*Math.exp(a[1]))/1e6,a},c.LOGINV=Wn,c.LOGNORM=Ae,c.LOGNORMDIST=Xn,c.LOGNORMINV=Gn,c.LOOKUP=function(e,t,a){t=U(t),a=a?U(a):t;const f=typeof e=="number";let L=C;for(let R=0;R<t.length;R++){if(t[R]===e)return a[R];if(f&&t[R]<=e||typeof t[R]=="string"&&t[R].localeCompare(e)<0)L=a[R];else if(f&&t[R]>e)return L}return L},c.LOWER=function(e){return arguments.length!==1?u:ae(e=qe(e))?e:e.toLowerCase()},c.MATCH=function(e,t,a){if(!e||!t||(arguments.length===2&&(a=1),!((t=U(t))instanceof Array))||a!==-1&&a!==0&&a!==1)return C;let f,L;for(let R=0;R<t.length;R++)if(a===1){if(t[R]===e)return R+1;t[R]<e&&(L?t[R]>L&&(f=R+1,L=t[R]):(f=R+1,L=t[R]))}else if(a===0){if(typeof e=="string"&&typeof t[R]=="string"){const z=e.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+z+"$").test(t[R].toLowerCase()))return R+1}else if(t[R]===e)return R+1}else if(a===-1){if(t[R]===e)return R+1;t[R]>e&&(L?t[R]<L&&(f=R+1,L=t[R]):(f=R+1,L=t[R]))}return f||C},c.MAX=X,c.MAXA=function(){const e=U(arguments),t=ve.apply(void 0,e);if(t)return t;let a=F(e);return a=a.map(f=>f??0),a.length===0?0:Math.max.apply(Math,a)},c.MDURATION=function(){throw new Error("MDURATION is not implemented")},c.MEDIAN=W,c.MID=function(e,t,a){if(t==null)return u;if(ae(t=Y(t),a=Y(a))||typeof e!="string")return a;const f=t-1,L=f+a;return e.substring(f,L)},c.MIN=ne,c.MINA=function(){const e=U(arguments),t=ve.apply(void 0,e);if(t)return t;let a=F(e);return a=a.map(f=>f??0),a.length===0?0:Math.min.apply(Math,a)},c.MINUTE=function(e){return(e=Be(e))instanceof Error?e:e.getMinutes()},c.MIRR=function(e,t,a){if(ae(e=Le(U(e)),t=Y(t),a=Y(a)))return u;const f=e.length,L=[],R=[];for(let pe=0;pe<f;pe++)e[pe]<0?L.push(e[pe]):R.push(e[pe]);const z=-Zt(a,R)*Math.pow(1+a,f-1),re=Zt(t,L)*(1+t);return Math.pow(z/re,1/(f-1))-1},c.MMULT=function(e,t){return!Array.isArray(e)||!Array.isArray(t)||e.some(a=>!a.length)||t.some(a=>!a.length)||se(e).some(a=>typeof a!="number")||se(t).some(a=>typeof a!="number")||e[0].length!==t.length?u:Array(e.length).fill(0).map(()=>Array(t[0].length).fill(0)).map((a,f)=>a.map((L,R)=>e[f].reduce((z,re,pe)=>z+re*t[pe][R],0)))},c.MOD=function(e,t){const a=ve(e=Y(e),t=Y(t));if(a)return a;if(t===0)return g;let f=Math.abs(e%t);return f=e<0?t-f:f,t>0?f:-f},c.MODE=v,c.MODEMULT=Kn,c.MODESNGL=$n,c.MONTH=function(e){return(e=Be(e))instanceof Error?e:e.getMonth()+1},c.MROUND=function(e,t){return ve(e=Y(e),t=Y(t))||(e*t==0?0:e*t<0?h:Math.round(e/t)*t)},c.MULTINOMIAL=function(){const e=Le(U(arguments));if(e instanceof Error)return e;let t=0,a=1;for(let f=0;f<e.length;f++)t+=e[f],a*=Ye(e[f]);return Ye(t)/a},c.MUNIT=function(e){return arguments.length>1?C:!(e=parseInt(e))||e<=0?u:Array(e).fill(0).map(()=>Array(e).fill(0)).map((t,a)=>(t[a]=1,t))},c.N=function(e){return Tt(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:ft(e)?e:0},c.NA=function(){return C},c.NEGBINOM=P,c.NEGBINOMDIST=Jn,c.NETWORKDAYS=Rt,c.NETWORKDAYSINTL=Zn,c.NOMINAL=function(e,t){return ae(e=Y(e),t=Y(t))?u:e<=0||t<1?h:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},c.NORM=J,c.NORMDIST=Qn,c.NORMINV=eo,c.NORMSDIST=to,c.NORMSINV=no,c.NOT=function(e){return typeof e=="string"?u:e instanceof Error?e:!e},c.NOW=function(){return new Date},c.NPER=function(e,t,a,f,L){if(L=L===void 0?0:L,f=f===void 0?0:f,ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f),L=Y(L)))return u;if(e===0)return-(a+f)/t;{const R=t*(1+e*L)-f*e,z=a*e+t*(1+e*L);return Math.log(R/z)/Math.log(1+e)}},c.NPV=Zt,c.NUMBERVALUE=function(e,t,a){return typeof(e=Me(e)?e:"")=="number"?e:typeof e!="string"?C:(t=t===void 0?".":t,a=a===void 0?",":a,Number(e.replace(t,".").replace(a,"")))},c.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const a=!(e.length!==10||e.substring(0,1)!=="7"),f=a?parseInt(e,8)-1073741824:parseInt(e,8);if(f<-512||f>511)return h;if(a)return"1"+bt("0",9-(512+f).toString(2).length)+(512+f).toString(2);const L=f.toString(2);return t===void 0?L:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=L.length?bt("0",t-L.length)+L:h},c.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return h;const t=parseInt(e,8);return t>=536870912?t-1073741824:t},c.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return h;const a=parseInt(e,8);if(a>=536870912)return"ff"+(a+3221225472).toString(16);const f=a.toString(16);return t===void 0?f:isNaN(t)?u:t<0?h:(t=Math.floor(t))>=f.length?bt("0",t-f.length)+f:h},c.ODD=function(e){if((e=Y(e))instanceof Error)return e;let t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>=0?t:-t},c.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},c.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},c.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},c.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},c.OR=function(){const e=U(arguments);let t=u;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===u&&(t=!1),e[a]&&(t=!0))}return t},c.PDURATION=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?u:e<=0?h:(Math.log(a)-Math.log(t))/Math.log(1+e)},c.PEARSON=he,c.PERCENTILE=Z,c.PERCENTILEEXC=oo,c.PERCENTILEINC=ro,c.PERCENTRANK=ue,c.PERCENTRANKEXC=io,c.PERCENTRANKINC=ao,c.PERMUT=function(e,t){return ae(e=Y(e),t=Y(t))?u:Ye(e)/Ye(e-t)},c.PERMUTATIONA=function(e,t){return ae(e=Y(e),t=Y(t))?u:Math.pow(e,t)},c.PHI=function(e){return(e=Y(e))instanceof Error?u:Math.exp(-.5*e*e)/2.5066282746310002},c.PI=function(){return Math.PI},c.PMT=It,c.POISSON=ye,c.POISSONDIST=so,c.POWER=Qt,c.PPMT=function(e,t,a,f,L,R){return L=L||0,R=R||0,ae(e=Y(e),a=Y(a),f=Y(f),L=Y(L),R=Y(R))?u:It(e,a,f,L,R)-un(e,t,a,f,L,R)},c.PRICE=function(){throw new Error("PRICE is not implemented")},c.PRICEDISC=function(e,t,a,f,L){if(ae(e=Be(e),t=Be(t),a=Y(a),f=Y(f),L=(L=Y(L))||0))return u;if(a<=0||f<=0)return h;if(e>=t)return u;let R,z;switch(L){case 0:R=360,z=xt(e,t,!1);break;case 1:case 3:R=365,z=Nt(e,t,"D");break;case 2:R=360,z=Nt(e,t,"D");break;case 4:R=360,z=xt(e,t,!0);break;default:return h}return f-a*f*z/R},c.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},c.PROB=function(e,t,a,f){if(a===void 0)return 0;if(f=f===void 0?a:f,ae(e=Le(U(e)),t=Le(U(t)),a=Y(a),f=Y(f)))return u;if(a===f)return e.indexOf(a)>=0?t[e.indexOf(a)]:0;const L=e.sort((re,pe)=>re-pe),R=L.length;let z=0;for(let re=0;re<R;re++)L[re]>=a&&L[re]<=f&&(z+=t[e.indexOf(L[re])]);return z},c.PRODUCT=Vt,c.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},c.PROPER=function(e){return ae(e)?e:isNaN(e)&&typeof e=="number"?u:(e=qe(e)).replace(/\w\S*/g,t=>t.charAt(0).toUpperCase()+t.substr(1).toLowerCase())},c.PV=function(e,t,a,f,L){return f=f||0,L=L||0,ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f),L=Y(L))?u:e===0?-a*t-f:((1-Math.pow(1+e,t))/e*a*(1+e*L)-f)/Math.pow(1+e,t)},c.QUARTILE=De,c.QUARTILEEXC=lo,c.QUARTILEINC=uo,c.QUOTIENT=function(e,t){return ve(e=Y(e),t=Y(t))||parseInt(e/t,10)},c.RADIANS=function(e){return(e=Y(e))instanceof Error?e:e*Math.PI/180},c.RAND=function(){return Math.random()},c.RANDBETWEEN=function(e,t){return ve(e=Y(e),t=Y(t))||e+Math.ceil((t-e+1)*Math.random())-1},c.RANK=we,c.RANKAVG=co,c.RANKEQ=fo,c.RATE=function(e,t,a,f,L,R){if(R=R===void 0?.01:R,f=f===void 0?0:f,L=L===void 0?0:L,ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f),L=Y(L),R=Y(R)))return u;const z=1e-10;let re=R;L=L?1:0;for(let pe=0;pe<20;pe++){if(re<=-1)return h;let Ee,Se,_e;if(Math.abs(re)<z?Ee=a*(1+e*re)+t*(1+re*L)*e+f:(Se=Math.pow(1+re,e),Ee=a*Se+t*(1/re+L)*(Se-1)+f),Math.abs(Ee)<z)return re;if(Math.abs(re)<z)_e=a*e+t*L*e;else{Se=Math.pow(1+re,e);const Re=e*Math.pow(1+re,e-1);_e=a*Re+t*(1/re+L)*Re+t*(-1/(re*re))*(Se-1)}re-=Ee/_e}return re},c.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},c.REPLACE=function(e,t,a,f){return ae(t=Y(t),a=Y(a))||typeof e!="string"||typeof f!="string"?u:e.substr(0,t-1)+f+e.substr(t-1+a)},c.REPT=bt,c.RIGHT=function(e,t){return ve(e,t)||(e=qe(e),(t=Y(t=t===void 0?1:t))instanceof Error?t:e.substring(e.length-t))},c.ROMAN=function(e){if((e=Y(e))instanceof Error)return e;const t=String(e).split(""),a=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let f="",L=3;for(;L--;)f=(a[+t.pop()+10*L]||"")+f;return new Array(+t.join("")+1).join("M")+f},c.ROUND=yt,c.ROUNDDOWN=function(e,t){return ve(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},c.ROUNDUP=function(e,t){return ve(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},c.ROW=function(e,t){return arguments.length!==2?C:t<0?h:e instanceof Array&&typeof t=="number"?e.length!==0?b.row(e,t):void 0:u},c.ROWS=function(e){return arguments.length!==1?C:e instanceof Array?e.length===0?0:b.rows(e):u},c.RRI=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?u:e===0||t===0?h:Math.pow(a/t,1/e)-1},c.RSQ=function(e,t){return ae(e=Le(U(e)),t=Le(U(t)))?u:Math.pow(he(e,t),2)},c.SEARCH=function(e,t,a){let f;return typeof e!="string"||typeof t!="string"?u:(a=a===void 0?0:a,f=t.toLowerCase().indexOf(e.toLowerCase(),a-1)+1,f===0?u:f)},c.SEC=function(e){return(e=Y(e))instanceof Error?e:1/Math.cos(e)},c.SECH=function(e){return(e=Y(e))instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},c.SECOND=function(e){return(e=Be(e))instanceof Error?e:e.getSeconds()},c.SERIESSUM=function(e,t,a,f){if(ae(e=Y(e),t=Y(t),a=Y(a),f=Le(f)))return u;let L=f[0]*Math.pow(e,t);for(let R=1;R<f.length;R++)L+=f[R]*Math.pow(e,t+R*a);return L},c.SHEET=function(){throw new Error("SHEET is not implemented")},c.SHEETS=function(){throw new Error("SHEETS is not implemented")},c.SIGN=function(e){return(e=Y(e))instanceof Error?e:e<0?-1:e===0?0:1},c.SIN=function(e){return(e=Y(e))instanceof Error?e:Math.sin(e)},c.SINH=function(e){return(e=Y(e))instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},c.SKEW=Fe,c.SKEWP=po,c.SLN=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?u:a===0?h:(e-t)/a},c.SLOPE=function(e,t){if(ae(e=Le(U(e)),t=Le(U(t))))return u;const a=b.mean(t),f=b.mean(e),L=t.length;let R=0,z=0;for(let re=0;re<L;re++)R+=(t[re]-a)*(e[re]-f),z+=Math.pow(t[re]-a,2);return R/z},c.SMALL=Ve,c.SORT=function(e,t=1,a=1,f=!1){if(!e||!Array.isArray(e))return C;if(e.length===0)return 0;if(!(t=Y(t))||t<1||(a=Y(a))!==1&&a!==-1)return u;if(typeof(f=Ue(f))!="boolean")return j;const L=re=>re.sort((pe,Ee)=>(pe=qe(pe[t-1]),Ee=qe(Ee[t-1]),a===1?pe<Ee?-1*a:a:pe>Ee?a:-1*a)),R=G(e),z=f?xe(R):R;return t>=1&&t<=z[0].length?f?xe(L(z)):L(z):u},c.SQRT=function(e){return(e=Y(e))instanceof Error?e:e<0?h:Math.sqrt(e)},c.SQRTPI=function(e){return(e=Y(e))instanceof Error?e:Math.sqrt(e*Math.PI)},c.STANDARDIZE=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?u:(e-t)/a},c.STDEV=Ze,c.STDEVA=function(){const e=Ce.apply(this,arguments);return Math.sqrt(e)},c.STDEVP=ho,c.STDEVPA=function(){const e=He.apply(this,arguments);let t=Math.sqrt(e);return isNaN(t)&&(t=h),t},c.STDEVS=go,c.STEYX=function(e,t){if(ae(e=Le(U(e)),t=Le(U(t))))return u;const a=b.mean(t),f=b.mean(e),L=t.length;let R=0,z=0,re=0;for(let pe=0;pe<L;pe++)R+=Math.pow(e[pe]-f,2),z+=(t[pe]-a)*(e[pe]-f),re+=Math.pow(t[pe]-a,2);return Math.sqrt((R-z*z/re)/(L-2))},c.SUBSTITUTE=function(e,t,a,f){if(arguments.length<3)return C;if(e&&t){if(f===void 0)return e.split(t).join(a);{if(f=Math.floor(Number(f)),Number.isNaN(f)||f<=0)return u;let L=0,R=0;for(;L>-1&&e.indexOf(t,L)>-1;)if(L=e.indexOf(t,L+1),R++,L>-1&&R===f)return e.substring(0,L)+a+e.substring(L+t.length);return e}}return e},c.SUBTOTAL=function(e,t){if((e=Y(e))instanceof Error)return e;switch(e){case 1:case 101:return o(t);case 2:case 102:return V(t);case 3:case 103:return K(t);case 4:case 104:return X(t);case 5:case 105:return ne(t);case 6:case 106:return Vt(t);case 7:case 107:return Ze.S(t);case 8:case 108:return Ze.P(t);case 9:case 109:return Et(t);case 10:case 110:return je.S(t);case 11:case 111:return je.P(t)}},c.SUM=Et,c.SUMIF=function(e,t,a){if(e=U(e),a=a?U(a):e,e instanceof Error)return e;if(t==null||t instanceof Error)return 0;let f=0;const L=t==="*",R=L?null:vt(t+"");for(let z=0;z<e.length;z++){const re=e[z],pe=a[z];if(L)f+=re;else{const Ee=[dt(re,at)].concat(R);f+=ht(Ee)?pe:0}}return f},c.SUMIFS=function(){const e=S(arguments),t=Le(U(e.shift()));if(t instanceof Error)return t;const a=e,f=a.length/2;for(let R=0;R<f;R++)a[2*R]=U(a[2*R]);let L=0;for(let R=0;R<t.length;R++){let z=!1;for(let re=0;re<f;re++){const pe=a[2*re][R],Ee=a[2*re+1];let Se=!1;if(Ee===void 0||Ee==="*")Se=!0;else{const _e=vt(Ee+""),Re=[dt(pe,at)].concat(_e);Se=ht(Re)}if(!Se){z=!1;break}z=!0}z&&(L+=t[R])}return L},c.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return u;const e=arguments.length+1;let t,a,f,L,R=0;for(let z=0;z<arguments[0].length;z++)if(arguments[0][z]instanceof Array)for(let re=0;re<arguments[0][z].length;re++){for(t=1,a=1;a<e;a++){const pe=arguments[a-1][z][re];if(pe instanceof Error)return pe;if(L=Y(pe),L instanceof Error)return L;t*=L}R+=t}else{for(t=1,a=1;a<e;a++){const re=arguments[a-1][z];if(re instanceof Error)return re;if(f=Y(re),f instanceof Error)return f;t*=f}R+=t}return R},c.SUMSQ=function(){const e=Le(U(arguments));if(e instanceof Error)return e;let t=0;const a=e.length;for(let f=0;f<a;f++)t+=Tt(e[f])?e[f]*e[f]:0;return t},c.SUMX2MY2=function(e,t){if(ae(e=Le(U(e)),t=Le(U(t))))return u;let a=0;for(let f=0;f<e.length;f++)a+=e[f]*e[f]-t[f]*t[f];return a},c.SUMX2PY2=function(e,t){if(ae(e=Le(U(e)),t=Le(U(t))))return u;let a=0;e=Le(U(e)),t=Le(U(t));for(let f=0;f<e.length;f++)a+=e[f]*e[f]+t[f]*t[f];return a},c.SUMXMY2=function(e,t){if(ae(e=Le(U(e)),t=Le(U(t))))return u;let a=0;e=U(e),t=U(t);for(let f=0;f<e.length;f++)a+=Math.pow(e[f]-t[f],2);return a},c.SWITCH=function(){let e;if(arguments.length>0){const t=arguments[0],a=arguments.length-1,f=Math.floor(a/2);let L=!1;const R=a%2!=0,z=a%2==0?null:arguments[arguments.length-1];if(f){for(let re=0;re<f;re++)if(t===arguments[2*re+1]){e=arguments[2*re+2],L=!0;break}}L||(e=R?z:C)}else e=u;return e},c.SYD=function(e,t,a,f){return ae(e=Y(e),t=Y(t),a=Y(a),f=Y(f))?u:a===0||f<1||f>a?h:(e-t)*(a-(f=parseInt(f,10))+1)*2/(a*(a+1))},c.T=function(e){return e instanceof Error||typeof e=="string"?e:""},c.TAN=function(e){return(e=Y(e))instanceof Error?e:Math.tan(e)},c.TANH=function(e){if((e=Y(e))instanceof Error)return e;const t=Math.exp(2*e);return(t-1)/(t+1)},c.TBILLEQ=function(e,t,a){return ae(e=Be(e),t=Be(t),a=Y(a))?u:a<=0||e>t||t-e>31536e6?h:365*a/(360-a*xt(e,t,!1))},c.TBILLPRICE=function(e,t,a){return ae(e=Be(e),t=Be(t),a=Y(a))?u:a<=0||e>t||t-e>31536e6?h:100*(1-a*xt(e,t,!1)/360)},c.TBILLYIELD=function(e,t,a){return ae(e=Be(e),t=Be(t),a=Y(a))?u:a<=0||e>t||t-e>31536e6?h:360*(100-a)/(a*xt(e,t,!1))},c.TDIST=mo,c.TDISTRT=bo,c.TEXT=function(e,t){if(e===void 0||e instanceof Error||t instanceof Error)return C;if(t==null)return"";if(typeof t=="number")return String(t);if(typeof t!="string")return u;const a=t.startsWith("$")?"$":"",f=t.endsWith("%");return f&&(e*=100),e=(e=an(e,(t=t.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!t.includes(","))).startsWith("-")?"-"+a+(e=e.replace("-","")):a+e,f&&(e+="%"),e},c.TEXTJOIN=function(e,t,...a){if(typeof t!="boolean"&&(t=Ue(t)),arguments.length<3)return C;e=e??"";let f=U(a),L=t?f.filter(R=>R):f;if(Array.isArray(e)){e=U(e);let R=L.map(re=>[re]),z=0;for(let re=0;re<R.length-1;re++)R[re].push(e[z]),z++,z===e.length&&(z=0);return L=U(R),L.join("")}return L.join(e)},c.TIME=function(e,t,a){return ae(e=Y(e),t=Y(t),a=Y(a))?u:e<0||t<0||a<0?h:(3600*e+60*t+a)/86400},c.TIMEVALUE=function(e){return(e=Be(e))instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},c.TINV=jo,c.TODAY=function(){return kt(new Date)},c.TRANSPOSE=function(e){return e?xe(G(e)):C},c.TREND=function(e,t,a){if(ae(e=Le(U(e)),t=Le(U(t)),a=Le(U(a))))return u;const f=ce(e,t),L=f[0],R=f[1],z=[];return a.forEach(re=>{z.push(L*re+R)}),z},c.TRIM=function(e){return(e=qe(e))instanceof Error?e:e.replace(/\s+/g," ").trim()},c.TRIMMEAN=function(e,t){if(ae(e=Le(U(e)),t=Y(t)))return u;const a=Ct(e.length*t,2)/2;return b.mean((L=(L=a)||1,(f=ie(e.sort((R,z)=>R-z),a))&&typeof f.slice=="function"?f.slice(0,f.length-L):f));var f,L},c.TRUE=function(){return!0},c.TRUNC=function(e,t){return ve(e=Y(e),t=Y(t))||(e>0?1:-1)*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},c.TTEST=vo,c.TYPE=function(e){return Tt(e)?1:w(e)?2:Ft(e)?4:ft(e)?16:Array.isArray(e)?64:void 0},c.UNICHAR=mn,c.UNICODE=bn,c.UNIQUE=E,c.UPPER=function(e){return(e=qe(e))instanceof Error?e:e.toUpperCase()},c.VALUE=function(e){const t=ve(e);if(t)return t;if(typeof e=="number")return e;if(Me(e)||(e=""),typeof e!="string")return u;const a=/(%)$/.test(e)||/^(%)/.test(e);if((e=(e=(e=e.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let f=Number(e);return isNaN(f)?u:(f=f||0,a&&(f*=.01),f)},c.VAR=je,c.VARA=Ce,c.VARP=yo,c.VARPA=He,c.VARS=xo,c.VDB=function(){throw new Error("VDB is not implemented")},c.VLOOKUP=l,c.WEEKDAY=function(e,t){if((e=Be(e))instanceof Error)return e;t===void 0&&(t=1);const a=e.getDay();return hn[t][a]},c.WEEKNUM=function(e,t){if((e=Be(e))instanceof Error)return e;if(t===void 0&&(t=1),t===21)return en(e);const a=pn[t];let f=new Date(e.getFullYear(),0,1);const L=f.getDay()<a?1:0;return f-=24*Math.abs(f.getDay()-a)*60*60*1e3,Math.floor((e-f)/864e5/7+1)+L},c.WEIBULL=tt,c.WEIBULLDIST=wo,c.WORKDAY=Ht,c.WORKDAYINTL=Co,c.XIRR=function(e,t,a){if(ae(e=Le(U(e)),t=lt(U(t)),a=Y(a)))return u;const f=(Re,Xe,et)=>{const nt=et+1;let gt=Re[0];for(let ut=1;ut<Re.length;ut++)gt+=Re[ut]/Math.pow(nt,At(Xe[ut],Xe[0])/365);return gt},L=(Re,Xe,et)=>{const nt=et+1;let gt=0;for(let ut=1;ut<Re.length;ut++){const wt=At(Xe[ut],Xe[0])/365;gt-=wt*Re[ut]/Math.pow(nt,wt+1)}return gt};let R=!1,z=!1;for(let Re=0;Re<e.length;Re++)e[Re]>0&&(R=!0),e[Re]<0&&(z=!0);if(!R||!z)return h;let re,pe,Ee,Se=a=a||.1,_e=!0;do Ee=f(e,t,Se),re=Se-Ee/L(e,t,Se),pe=Math.abs(re-Se),Se=re,_e=pe>1e-10&&Math.abs(Ee)>1e-10;while(_e);return Se},c.XNPV=function(e,t,a){if(ae(e=Y(e),t=Le(U(t)),a=lt(U(a))))return u;let f=0;for(let L=0;L<t.length;L++)f+=t[L]/Math.pow(1+e,At(a[L],a[0])/365);return f},c.XOR=function(){const e=U(arguments);let t=u;for(let a=0;a<e.length;a++){if(e[a]instanceof Error)return e[a];e[a]!==void 0&&e[a]!==null&&typeof e[a]!="string"&&(t===u&&(t=0),e[a]&&t++)}return t===u?t:!!(1&Math.floor(Math.abs(t)))},c.YEAR=function(e){return(e=Be(e))instanceof Error?e:e.getFullYear()},c.YEARFRAC=Ut,c.YIELD=function(){throw new Error("YIELD is not implemented")},c.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},c.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},c.Z=$e,c.ZTEST=Eo,c.utils=Ao}},p={};function A(q){var c=p[q];if(c!==void 0)return c.exports;var r=p[q]={exports:{}};return d[q].call(r.exports,r,r.exports,A),r.exports}A.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}();var k=A(960);s=k}(),s)},138:function(module,__unused_webpack_exports,__webpack_require__){if(!formula)var formula=__webpack_require__(243);var factory;factory=function(){var Version=(info={title:"Jspreadsheet",version:"4.13.2",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}},function(){return info}),info,isFormula=function(n){var s=(""+n)[0];return s=="="||s=="#"},getMask=function(n){if(n.format||n.mask||n.locale){var s={};return n.mask?s.mask=n.mask:n.format?s.mask=n.format:(s.locale=n.locale,s.options=n.options),n.decimal&&(s.options||(s.options={}),s.options={decimal:n.decimal}),s}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if(el.tagName=="TABLE"){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text")for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==1&&obj.options.tableOverflow==0&&obj.options.fullscreen==0&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(n){n==null&&(n=!obj.options.fullscreen),obj.options.fullscreen!=n&&(obj.options.fullscreen=n,n==1?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(n){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var s=obj.options.onevent.apply(this,arguments);typeof obj.options[n]=="function"&&(s=obj.options[n].apply(this,Array.prototype.slice.call(arguments,1)))}if(n=="onafterchanges"&&obj.options.persistance){var d=obj.options.persistance==1?obj.options.url:obj.options.persistance,p=obj.prepareJson(arguments[2]);obj.save(d,p)}return s},obj.prepareTable=function(){var n=obj.options.columns.length;if(obj.options.data&&obj.options.data[0]!==void 0){var s=Object.keys(obj.options.data[0]);s.length>n&&(n=s.length)}obj.options.minDimensions[0]>n&&(n=obj.options.minDimensions[0]);for(var d=[],p=0;p<n;p++)obj.options.colHeaders[p]||(obj.options.colHeaders[p]=""),obj.options.colWidths[p]||(obj.options.colWidths[p]=obj.options.defaultColWidth),obj.options.colAlignments[p]||(obj.options.colAlignments[p]=obj.options.defaultColAlign),obj.options.columns[p]?obj.options.columns[p].type||(obj.options.columns[p].type="text"):obj.options.columns[p]={type:"text"},obj.options.columns[p].name||(obj.options.columns[p].name=s&&s[p]?s[p]:p),obj.options.columns[p].source||(obj.options.columns[p].source=[]),obj.options.columns[p].options||(obj.options.columns[p].options=[]),obj.options.columns[p].editor||(obj.options.columns[p].editor=null),obj.options.columns[p].allowEmpty||(obj.options.columns[p].allowEmpty=!1),obj.options.columns[p].title||(obj.options.columns[p].title=obj.options.colHeaders[p]?obj.options.colHeaders[p]:""),obj.options.columns[p].width||(obj.options.columns[p].width=obj.options.colWidths[p]?obj.options.colWidths[p]:obj.options.defaultColWidth),obj.options.columns[p].align||(obj.options.columns[p].align=obj.options.colAlignments[p]?obj.options.colAlignments[p]:"center"),obj.options.columns[p].type=="autocomplete"||obj.options.columns[p].type=="dropdown"?obj.options.columns[p].url&&d.push({url:obj.options.columns[p].url,index:p,method:"GET",dataType:"json",success:function(A){for(var k=0;k<A.length;k++)obj.options.columns[this.index].source.push(A[k])}}):obj.options.columns[p].type=="calendar"&&(obj.options.columns[p].options.format||(obj.options.columns[p].options.format="DD/MM/YYYY"));d.length?jSuites.ajax(d,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(h){obj.scrollControls(h)},obj.content.onwheel=function(h){obj.wheelControls(h)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var n=document.createElement("div"),s=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),n.appendChild(s),n.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var d=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var p=0;p<obj.options.paginationOptions.length;p++){var A=document.createElement("option");A.value=obj.options.paginationOptions[p],A.innerHTML=obj.options.paginationOptions[p],obj.paginationDropdown.appendChild(A)}obj.paginationDropdown.value=obj.options.pagination,d.appendChild(document.createTextNode(obj.options.text.show)),d.appendChild(obj.paginationDropdown),d.appendChild(document.createTextNode(obj.options.text.entries))}var k,q=document.createElement("div");if(q.classList.add("jexcel_filter"),q.appendChild(d),q.appendChild(n),obj.colgroupContainer=document.createElement("colgroup"),(k=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(k),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var c=0;c<obj.options.nestedHeaders.length;c++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[c]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(k=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(k),p=0;p<obj.options.columns.length;p++)obj.createCellHeader(p),obj.headerContainer.appendChild(obj.headers[p]),obj.colgroupContainer.appendChild(obj.colgroup[p]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==1){obj.filter=document.createElement("tr");var r=document.createElement("td");for(obj.filter.appendChild(r),p=0;p<obj.options.columns.length;p++)(r=document.createElement("td")).innerHTML="&nbsp;",r.setAttribute("data-x",p),r.className="jexcel_column_filter",obj.options.columns[p].type=="hidden"&&(r.style.display="none"),obj.filter.appendChild(r);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==0&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var b=document.createElement("a");b.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if(typeof sessionStorage<"u"&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var H=document.createElement("img");H.src="//bossanova.uk/jspreadsheet/logo.png",b.appendChild(H)}}catch{}var _=document.createElement("span");_.innerHTML="Jspreadsheet CE",b.appendChild(_),obj.ads.appendChild(b),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var g=document.createElement("div"),u=document.createElement("div");if(obj.pagination.appendChild(g),obj.pagination.appendChild(u),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==1&&el.appendChild(q),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==1?el.classList.add("fullscreen"):obj.options.tableOverflow==1&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=1&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==1&&obj.thead.classList.add("draggable"),obj.options.columnResize==1&&obj.thead.classList.add("resizable"),obj.options.rowDrag==1&&obj.tbody.classList.add("draggable"),obj.options.rowResize==1&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var m=Object.keys(obj.options.classes);for(p=0;p<m.length;p++){var j=jexcel.getIdFromColumnName(m[p],!0);obj.records[j[1]][j[0]].classList.add(obj.options.classes[m[p]])}}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.setData(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(n){if(n&&(typeof n=="string"&&(n=JSON.parse(n)),obj.options.data=n),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){n=[];for(var s=0;s<obj.options.data.length;s++){for(var d=[],p=0;p<obj.options.columns.length;p++)d[p]=obj.options.data[s][obj.options.columns[p].name];n.push(d)}obj.options.data=n}s=0,p=0;var A=obj.options.columns.length,k=obj.options.data.length,q=obj.options.minDimensions[0],c=obj.options.minDimensions[1],r=q>A?q:A,b=c>k?c:k;for(s=0;s<b;s++)for(p=0;p<r;p++)obj.options.data[s]==null&&(obj.options.data[s]=[]),obj.options.data[s][p]==null&&(obj.options.data[s][p]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==1){var H=0,_=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,H=obj.options.pagination*obj.pageNumber,_=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<_&&(_=obj.options.data.length)):(H=0,_=obj.options.data.length);for(s=0;s<obj.options.data.length;s++){var g=obj.createRow(s,obj.options.data[s]);s>=H&&s<_&&obj.tbody.appendChild(g)}if(obj.options.lazyLoading==1||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var u=Object.keys(obj.options.mergeCells);for(p=0;p<u.length;p++){var m=obj.options.mergeCells[u[p]];obj.setMerge(u[p],m[0],m[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(n,s){for(var d=[],p=0,A=0,k=s==1||obj.options.copyCompatibility==0,q=obj.options.columns.length,c=obj.options.data.length,r=0;r<c;r++){p=0;for(var b=0;b<q;b++)n&&!obj.records[r][b].classList.contains("highlight")||(d[A]||(d[A]=[]),d[A][p]=k?obj.options.data[r][b]:obj.records[r][b].innerHTML,p++);p>0&&A++}return d},obj.getJsonRow=function(n){for(var s=obj.options.data[n],d=obj.options.columns.length,p={},A=0;A<d;A++)obj.options.columns[A].name||(obj.options.columns[A].name=A),p[obj.options.columns[A].name]=s[A];return p},obj.getJson=function(n){for(var s=[],d=obj.options.columns.length,p=obj.options.data.length,A=0;A<p;A++){for(var k=null,q=0;q<d;q++)n&&!obj.records[A][q].classList.contains("highlight")||(k==null&&(k={}),obj.options.columns[q].name||(obj.options.columns[q].name=q),k[obj.options.columns[q].name]=obj.options.data[A][q]);k!=null&&s.push(k)}return s},obj.prepareJson=function(n){for(var s=[],d=0;d<n.length;d++){var p=n[d].x,A=n[d].y,k=obj.options.columns[p].name?obj.options.columns[p].name:p;s[A]||(s[A]={row:A,data:{}}),s[A].data[k]=n[d].newValue}return s.filter(function(q){return q!=null})},obj.save=function(n,s){var d=obj.dispatch("onbeforesave",el,obj,s);if(d)s=d;else if(d===!1)return!1;jSuites.ajax({url:n,method:"POST",dataType:"json",data:{data:JSON.stringify(s)},success:function(p){obj.dispatch("onsave",el,obj,s)}})},obj.getRowData=function(n){return obj.options.data[n]},obj.setRowData=function(n,s){for(var d=0;d<obj.headers.length;d++){var p=jexcel.getColumnNameFromId([d,n]);s[d]!=null&&obj.setValue(p,s[d])}},obj.getColumnData=function(n){for(var s=[],d=0;d<obj.options.data.length;d++)s.push(obj.options.data[d][n]);return s},obj.setColumnData=function(n,s){for(var d=0;d<obj.rows.length;d++){var p=jexcel.getColumnNameFromId([n,d]);s[d]!=null&&obj.setValue(p,s[d])}},obj.createRow=function(n,s){obj.records[n]||(obj.records[n]=[]),s||(s=obj.options.data[n]),obj.rows[n]=document.createElement("tr"),obj.rows[n].setAttribute("data-y",n);var d=null;obj.options.defaultRowHeight&&(obj.rows[n].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[n]&&(obj.options.rows[n].height&&(obj.rows[n].style.height=obj.options.rows[n].height),obj.options.rows[n].title&&(d=obj.options.rows[n].title)),d||(d=parseInt(n+1));var p=document.createElement("td");p.innerHTML=d,p.setAttribute("data-y",n),p.className="jexcel_row",obj.rows[n].appendChild(p);for(var A=0;A<obj.options.columns.length;A++)obj.records[n][A]=obj.createCell(A,n,s[A]),obj.rows[n].appendChild(obj.records[n][A]);return obj.rows[n]},obj.parseValue=function(n,s,d,p){(""+d).substr(0,1)=="="&&obj.options.parseFormulas==1&&(d=obj.executeFormula(d,n,s));var A=obj.options.columns[n];if(A&&!isFormula(d)){var k=null;if(k=getMask(A)){d&&d==Number(d)&&(d=Number(d));var q=jSuites.mask.render(d,k,!0);if(p&&k.mask){var c=k.mask.split(";");c[1]&&(c[1].match(new RegExp("\\[Red\\]","gi"))&&(d<0?p.classList.add("red"):p.classList.remove("red")),c[1].match(new RegExp("\\(","gi"))&&d<0&&(q="("+q+")"))}q&&(d=q)}}return d};var validDate=function(n){return(n=""+n).substr(4,1)=="-"&&n.substr(7,1)=="-"||(n=n.split("-"))[0].length==4&&n[0]==Number(n[0])&&n[1].length==2&&n[1]==Number(n[1])};obj.createCell=function(n,s,d){var p=document.createElement("td");if(p.setAttribute("data-x",n),p.setAttribute("data-y",s),(""+d).substr(0,1)=="="&&obj.options.secureFormulas==1){var A=secureFormula(d);A!=d&&(d=A)}if(obj.options.columns[n].editor)obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?p.innerHTML=d:p.textContent=d,typeof obj.options.columns[n].editor.createCell=="function"&&(p=obj.options.columns[n].editor.createCell(p));else if(obj.options.columns[n].type=="hidden")p.style.display="none",p.textContent=d;else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){var k=document.createElement("input");k.type=obj.options.columns[n].type,k.name="c"+n,k.checked=d==1||d==1||d=="true",k.onclick=function(){obj.setValue(p,this.checked)},obj.options.columns[n].readOnly!=1&&obj.options.editable!=0||k.setAttribute("disabled","disabled"),p.appendChild(k),obj.options.data[s][n]=k.checked}else if(obj.options.columns[n].type=="calendar"){var q=null;if(!validDate(d)){var c=jSuites.calendar.extractDateFromString(d,obj.options.columns[n].options.format);c&&(q=c)}p.textContent=jSuites.calendar.getDateString(q||d,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")p.classList.add("jexcel_dropdown"),p.textContent=obj.getDropDownValue(n,d);else if(obj.options.columns[n].type=="color")if(obj.options.columns[n].render=="square"){var r=document.createElement("div");r.className="color",r.style.backgroundColor=d,p.appendChild(r)}else p.style.color=d,p.textContent=d;else if(obj.options.columns[n].type=="image"){if(d&&d.substr(0,10)=="data:image"){var b=document.createElement("img");b.src=d,p.appendChild(b)}}else obj.options.columns[n].type=="html"||obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?p.innerHTML=stripScript(obj.parseValue(n,s,d,p)):p.textContent=obj.parseValue(n,s,d,p);obj.options.columns[n].readOnly==1&&(p.className="readonly");var H=obj.options.columns[n].align?obj.options.columns[n].align:"center";return p.style.textAlign=H,obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||p.innerHTML.length>200)&&(p.style.whiteSpace="pre-wrap"),n>0&&this.options.textOverflow==1&&(d||p.innerHTML?obj.records[s][n-1].style.overflow="hidden":n==obj.options.columns.length-1&&(p.style.overflow="hidden")),p},obj.createCellHeader=function(n){var s=obj.options.columns[n].width?obj.options.columns[n].width:obj.options.defaultColWidth,d=obj.options.columns[n].align?obj.options.columns[n].align:obj.options.defaultColAlign;obj.headers[n]=document.createElement("td"),obj.options.stripHTML?obj.headers[n].textContent=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n):obj.headers[n].innerHTML=obj.options.columns[n].title?obj.options.columns[n].title:jexcel.getColumnName(n),obj.headers[n].setAttribute("data-x",n),obj.headers[n].style.textAlign=d,obj.options.columns[n].title&&obj.headers[n].setAttribute("title",obj.headers[n].innerText),obj.options.columns[n].id&&obj.headers[n].setAttribute("id",obj.options.columns[n].id),obj.colgroup[n]=document.createElement("col"),obj.colgroup[n].setAttribute("width",s),obj.options.columns[n].type=="hidden"&&(obj.headers[n].style.display="none",obj.colgroup[n].style.display="none")},obj.updateNestedHeader=function(n,s,d){obj.options.nestedHeaders[s][n].title&&(obj.options.nestedHeaders[s][n].title=d,obj.options.nestedHeaders[s].element.children[n+1].textContent=d)},obj.createNestedHeader=function(n){var s=document.createElement("tr");s.classList.add("jexcel_nested");var d=document.createElement("td");s.appendChild(d),n.element=s;for(var p=0,A=0;A<n.length;A++){n[A].colspan||(n[A].colspan=1),n[A].align||(n[A].align="center"),n[A].title||(n[A].title=""),n[A].id||(n[A].id="");for(var k=n[A].colspan,q=[],c=0;c<k;c++)obj.options.columns[p]&&obj.options.columns[p].type=="hidden"&&k++,q.push(p),p++;(d=document.createElement("td")).setAttribute("data-column",q.join(",")),d.setAttribute("colspan",n[A].colspan),d.setAttribute("align",n[A].align),d.setAttribute("id",n[A].id),d.textContent=n[A].title,s.appendChild(d)}return s},obj.createToolbar=function(n){n?obj.options.toolbar=n:n=obj.options.toolbar;for(var s=0;s<n.length;s++)if(n[s].type=="i")(k=document.createElement("i")).classList.add("jexcel_toolbar_item"),k.classList.add("material-icons"),k.setAttribute("data-k",n[s].k),k.setAttribute("data-v",n[s].v),k.setAttribute("id",n[s].id),n[s].tooltip&&k.setAttribute("title",n[s].tooltip),n[s].onclick&&(n[s].onclick,1)?k.onclick=function(q){var c=q;return function(){n[c].onclick(el,obj,this)}}(s):k.onclick=function(){var q=this.getAttribute("data-k"),c=this.getAttribute("data-v");obj.setStyle(obj.highlighted,q,c)},k.textContent=n[s].content,obj.toolbar.appendChild(k);else if(n[s].type=="select"){var d=!1;(k=document.createElement("select")).classList.add("jexcel_toolbar_item"),k.setAttribute("data-k",n[s].k),n[s].tooltip&&k.setAttribute("title",n[s].tooltip),n[s].onchange&&(n[s].onchange,1)?(k.onchange=n[s].onchange,d=!0):k.onchange=function(){var q=this.getAttribute("data-k");obj.setStyle(obj.highlighted,q,this.value)};for(var p=0;p<n[s].v.length;p++){var A=document.createElement("option");A.value=n[s].v[p],A.textContent=n[s].v[p],n[s].selectedValue&&A.value===n[s].selectedValue&&(A.selected=!0),k.appendChild(A)}d&&k.dispatchEvent(new Event("change")),obj.toolbar.appendChild(k)}else if(n[s].type=="color"){var k;(k=document.createElement("i")).classList.add("jexcel_toolbar_item"),k.classList.add("material-icons"),k.setAttribute("data-k",n[s].k),k.setAttribute("data-v",""),n[s].tooltip&&k.setAttribute("title",n[s].tooltip),obj.toolbar.appendChild(k),k.textContent=n[s].content,jSuites.color(k,{onchange:function(q,c){var r=q.getAttribute("data-k");obj.setStyle(obj.highlighted,r,c)}})}},obj.setMerge=function(n,s,d,p){var A=!1;if(!n){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var k=parseInt(obj.highlighted[0].getAttribute("data-x")),q=parseInt(obj.highlighted[0].getAttribute("data-y")),c=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),r=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));n=jexcel.getColumnNameFromId([k,q]),s=c-k+1,d=r-q+1}var b=jexcel.getIdFromColumnName(n,!0);if(obj.options.mergeCells[n])obj.records[b[1]][b[0]].getAttribute("data-merged")&&(A=obj.options.text.cellAlreadyMerged);else if((!s||s<2)&&(!d||d<2))A=obj.options.text.invalidMergeProperties;else for(var H=b[1];H<b[1]+d;H++)for(var _=b[0];_<b[0]+s;_++)jexcel.getColumnNameFromId([_,H]),obj.records[H][_].getAttribute("data-merged")&&(A=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(A)alert(A);else{s>1?obj.records[b[1]][b[0]].setAttribute("colspan",s):s=1,d>1?obj.records[b[1]][b[0]].setAttribute("rowspan",d):d=1,obj.options.mergeCells[n]=[s,d,[]],obj.records[b[1]][b[0]].setAttribute("data-merged","true"),obj.records[b[1]][b[0]].style.overflow="hidden";for(var g=[],u=b[1];u<b[1]+d;u++)for(var m=b[0];m<b[0]+s;m++)b[0]==m&&b[1]==u||(g.push(obj.options.data[u][m]),obj.updateCell(m,u,"",!0),obj.options.mergeCells[n][2].push(obj.records[u][m]),obj.records[u][m].style.display="none",obj.records[u][m]=obj.records[b[1]][b[0]]);obj.updateSelection(obj.records[b[1]][b[0]]),p||(obj.setHistory({action:"setMerge",column:n,colspan:s,rowspan:d,data:g}),obj.dispatch("onmerge",el,n,s,d))}},obj.getMerge=function(n){var s={};if(n)s=obj.options.mergeCells[n]?[obj.options.mergeCells[n][0],obj.options.mergeCells[n][1]]:null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var d=Object.keys(obj.options.mergeCells),p=0;p<d.length;p++)s[d[p]]=[obj.options.mergeCells[d[p]][0],obj.options.mergeCells[d[p]][1]]}return s},obj.removeMerge=function(n,s,d){if(obj.options.mergeCells[n]){var p=jexcel.getIdFromColumnName(n,!0);obj.records[p[1]][p[0]].removeAttribute("colspan"),obj.records[p[1]][p[0]].removeAttribute("rowspan"),obj.records[p[1]][p[0]].removeAttribute("data-merged");for(var A=obj.options.mergeCells[n],k=0,q=0;q<A[1];q++)for(var c=0;c<A[0];c++)(q>0||c>0)&&(obj.records[p[1]+q][p[0]+c]=A[2][k],obj.records[p[1]+q][p[0]+c].style.display="",s&&s[k]&&obj.updateCell(p[0]+c,p[1]+q,s[k]),k++);obj.updateSelection(obj.records[p[1]][p[0]],obj.records[p[1]+q-1][p[0]+c-1]),d||delete obj.options.mergeCells[n]}},obj.destroyMerged=function(n){if(obj.options.mergeCells){obj.options.mergeCells;for(var s=Object.keys(obj.options.mergeCells),d=0;d<s.length;d++)obj.removeMerge(s[d],null,n)}},obj.isColMerged=function(n,s){var d=[];if(obj.options.mergeCells)for(var p=Object.keys(obj.options.mergeCells),A=0;A<p.length;A++){var k=jexcel.getIdFromColumnName(p[A],!0),q=obj.options.mergeCells[p[A]][0],c=k[0],r=k[0]+(q>1?q-1:0);s==null?c<=n&&r>=n&&d.push(p[A]):s?c<n&&r>=n&&d.push(p[A]):c<=n&&r>n&&d.push(p[A])}return d},obj.isRowMerged=function(n,s){var d=[];if(obj.options.mergeCells)for(var p=Object.keys(obj.options.mergeCells),A=0;A<p.length;A++){var k=jexcel.getIdFromColumnName(p[A],!0),q=obj.options.mergeCells[p[A]][1],c=k[1],r=k[1]+(q>1?q-1:0);s==null?c<=n&&r>=n&&d.push(p[A]):s?c<n&&r>=n&&d.push(p[A]):c<=n&&r>n&&d.push(p[A])}return d},obj.openFilter=function(n){if(obj.options.filters){n=parseInt(n),obj.resetSelection();var s=[];if(obj.options.columns[n].type=="checkbox")s.push({id:"true",name:"True"}),s.push({id:"false",name:"False"});else{for(var d=[],p=!1,A=0;A<obj.options.data.length;A++){var k=obj.options.data[A][n],q=obj.records[A][n].innerHTML;k&&q?d[k]=q:p=!0}var c=Object.keys(d);for(s=[],A=0;A<c.length;A++)s.push({id:c[A],name:d[c[A]]});p&&s.push({value:"",id:"",name:"(Blanks)"})}var r=document.createElement("div");obj.filter.children[n+1].innerHTML="",obj.filter.children[n+1].appendChild(r),obj.filter.children[n+1].style.paddingLeft="0px",obj.filter.children[n+1].style.paddingRight="0px",obj.filter.children[n+1].style.overflow="initial";var b={data:s,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[n]!==void 0?obj.filters[n]:null,width:"100%",position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(H){obj.resetFilters(),obj.filters[n]=H.dropdown.getValue(!0),obj.filter.children[n+1].innerHTML=H.dropdown.getText(),obj.filter.children[n+1].style.paddingLeft="",obj.filter.children[n+1].style.paddingRight="",obj.filter.children[n+1].style.overflow="",obj.closeFilter(n),obj.refreshSelection()}};jSuites.dropdown(r,b)}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var n=0;n<obj.filter.children.length;n++)obj.filter.children[n].innerHTML="&nbsp;",obj.filters[n]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(n){if(!n)for(var s=0;s<obj.filter.children.length;s++)obj.filters[s]&&(n=s);var d=function(k,q,c){for(var r=0;r<k.length;r++){var b=""+obj.options.data[c][q],H=""+obj.records[c][q].innerHTML;if(k[r]==b||k[r]==H)return!0}return!1},p=obj.filters[n];obj.results=[];for(var A=0;A<obj.options.data.length;A++)d(p,n,A)&&obj.results.push(A);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(n,s,d){var p=n.getAttribute("data-y"),A=n.getAttribute("data-x");obj.dispatch("oneditionstart",el,n,A,p),A>0&&(obj.records[p][A-1].style.overflow="hidden");var k=function(T){var I=n.getBoundingClientRect(),B=document.createElement(T);return B.style.width=I.width+"px",B.style.height=I.height-2+"px",B.style.minHeight=I.height-2+"px",n.classList.add("editor"),n.innerHTML="",n.appendChild(B),obj.dispatch("oncreateeditor",el,n,A,p,B),B};if(n.classList.contains("readonly")!=1){if(obj.edition=[obj.records[p][A],obj.records[p][A].innerHTML,A,p],obj.options.columns[A].editor)obj.options.columns[A].editor.openEditor(n,el,s,d);else if(obj.options.columns[A].type!="hidden")if(obj.options.columns[A].type=="checkbox"||obj.options.columns[A].type=="radio"){var q=!n.children[0].checked;obj.setValue(n,q),obj.edition=null}else if(obj.options.columns[A].type=="dropdown"||obj.options.columns[A].type=="autocomplete"){if(q=obj.options.data[p][A],obj.options.columns[A].multiple&&!Array.isArray(q)&&(q=q.split(";")),typeof obj.options.columns[A].filter=="function")var c=obj.options.columns[A].filter(el,n,A,p,obj.options.columns[A].source);else c=obj.options.columns[A].source;for(var r=[],b=0;b<c.length;b++)r.push(c[b]);var H=k("div"),_={data:r,multiple:!!obj.options.columns[A].multiple,autocomplete:!(!obj.options.columns[A].autocomplete&&obj.options.columns[A].type!="autocomplete"),opened:!0,value:q,width:"100%",height:H.style.minHeight,position:obj.options.tableOverflow==1||obj.options.fullscreen==1,onclose:function(){obj.closeEditor(n,!0)}};obj.options.columns[A].options&&obj.options.columns[A].options.type&&(_.type=obj.options.columns[A].options.type),jSuites.dropdown(H,_)}else if(obj.options.columns[A].type=="calendar"||obj.options.columns[A].type=="color")q=obj.options.data[p][A],(H=k("input")).value=q,obj.options.tableOverflow!=1&&obj.options.fullscreen!=1||(obj.options.columns[A].options.position=!0),obj.options.columns[A].options.value=obj.options.data[p][A],obj.options.columns[A].options.opened=!0,obj.options.columns[A].options.onclose=function(T,I){obj.closeEditor(n,!0)},obj.options.columns[A].type=="color"?jSuites.color(H,obj.options.columns[A].options):jSuites.calendar(H,obj.options.columns[A].options),H.focus();else if(obj.options.columns[A].type=="html"){q=obj.options.data[p][A],(H=k("div")).style.position="relative",(m=document.createElement("div")).classList.add("jexcel_richtext"),H.appendChild(m),jSuites.editor(m,{focus:!0,value:q});var g=n.getBoundingClientRect(),u=m.getBoundingClientRect();window.innerHeight<g.bottom+u.height?m.style.top=g.top-(u.height+2)+"px":m.style.top=g.top+"px"}else if(obj.options.columns[A].type=="image"){var m,j=n.children[0];(H=k("div")).style.position="relative",(m=document.createElement("div")).classList.add("jclose"),j&&j.src&&m.appendChild(j),H.appendChild(m),jSuites.image(m,obj.options.imageOptions),g=n.getBoundingClientRect(),u=m.getBoundingClientRect(),window.innerHeight<g.bottom+u.height?m.style.top=g.top-(u.height+2)+"px":m.style.top=g.top+"px"}else{q=s==1?"":obj.options.data[p][A],obj.options.columns[A].wordWrap==0||obj.options.wordWrap!=1&&obj.options.columns[A].wordWrap!=1?H=k("input"):H=k("textarea"),H.focus(),H.value=q,_=obj.options.columns[A];var h=null;if(!isFormula(q)&&(h=getMask(_))){if(!_.disabledMaskOnEdition)if(_.mask){var C=_.mask.split(";");H.setAttribute("data-mask",C[0])}else _.locale&&H.setAttribute("data-locale",_.locale);h.input=H,H.mask=h,jSuites.mask.render(q,h,!1)}H.onblur=function(){obj.closeEditor(n,!0)},H.scrollLeft=H.scrollWidth}}},obj.closeEditor=function(n,s){var d=parseInt(n.getAttribute("data-x")),p=parseInt(n.getAttribute("data-y"));if(s==1){if(obj.options.columns[d].editor)var A=obj.options.columns[d].editor.closeEditor(n,s);else if(!(obj.options.columns[d].type=="checkbox"||obj.options.columns[d].type=="radio"||obj.options.columns[d].type=="hidden"))if(obj.options.columns[d].type=="dropdown"||obj.options.columns[d].type=="autocomplete")A=n.children[0].dropdown.close(!0);else if(obj.options.columns[d].type=="calendar")A=n.children[0].calendar.close(!0);else if(obj.options.columns[d].type=="color")A=n.children[0].color.close(!0);else if(obj.options.columns[d].type=="html")A=n.children[0].children[0].editor.getData();else if(obj.options.columns[d].type=="image"){var k=n.children[0].children[0].children[0];A=k&&k.tagName=="IMG"?k.src:""}else if(obj.options.columns[d].type=="numeric")(""+(A=n.children[0].value)).substr(0,1)!="="&&A==""&&(A=obj.options.columns[d].allowEmpty?"":0),n.children[0].onblur=null;else{A=n.children[0].value,n.children[0].onblur=null;var q,c=obj.options.columns[d];if((q=getMask(c))&&A!==""&&!isFormula(A)&&typeof A!="number"){var r=jSuites.mask.extract(A,q,!0);r&&r.value!==""&&(A=r.value)}}obj.options.data[p][d]==A?n.innerHTML=obj.edition[1]:obj.setValue(n,A)}else obj.options.columns[d].editor?obj.options.columns[d].editor.closeEditor(n,s):obj.options.columns[d].type=="dropdown"||obj.options.columns[d].type=="autocomplete"?n.children[0].dropdown.close(!0):obj.options.columns[d].type=="calendar"?n.children[0].calendar.close(!0):obj.options.columns[d].type=="color"?n.children[0].color.close(!0):n.children[0].onblur=null,n.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,n,d,p,A,s),n.classList.remove("editor"),obj.edition=null},obj.getCell=function(n){var s=(n=jexcel.getIdFromColumnName(n,!0))[0],d=n[1];return obj.records[d][s]},obj.getColumnOptions=function(n,s){var d=obj.options.columns[n];return d||(d={type:"text"}),d},obj.getCellFromCoords=function(n,s){return obj.records[s][n]},obj.getLabel=function(n){var s=(n=jexcel.getIdFromColumnName(n,!0))[0],d=n[1];return obj.records[d][s].innerHTML},obj.getLabelFromCoords=function(n,s){return obj.records[s][n].innerHTML},obj.getValue=function(n,s){if(typeof n=="object")var d=n.getAttribute("data-x"),p=n.getAttribute("data-y");else d=(n=jexcel.getIdFromColumnName(n,!0))[0],p=n[1];var A=null;return d!=null&&p!=null&&(obj.records[p]&&obj.records[p][d]&&(s||obj.options.copyCompatibility==1)?A=obj.records[p][d].innerHTML:obj.options.data[p]&&obj.options.data[p][d]!="undefined"&&(A=obj.options.data[p][d])),A},obj.getValueFromCoords=function(n,s,d){var p=null;return n!=null&&s!=null&&(obj.records[s]&&obj.records[s][n]&&d||obj.options.copyCompatibility==1?p=obj.records[s][n].innerHTML:obj.options.data[s]&&obj.options.data[s][n]!="undefined"&&(p=obj.options.data[s][n])),p},obj.setValue=function(n,s,d){var p=[];if(typeof n=="string"){var A=(r=jexcel.getIdFromColumnName(n,!0))[0],k=r[1];p.push(obj.updateCell(A,k,s,d)),obj.updateFormulaChain(A,k,p)}else if(A=null,k=null,n&&n.getAttribute&&(A=n.getAttribute("data-x"),k=n.getAttribute("data-y")),A!=null&&k!=null)p.push(obj.updateCell(A,k,s,d)),obj.updateFormulaChain(A,k,p);else{var q=Object.keys(n);if(q.length>0)for(var c=0;c<q.length;c++){var r;typeof n[c]=="string"?(A=(r=jexcel.getIdFromColumnName(n[c],!0))[0],k=r[1]):n[c].x!=null&&n[c].y!=null?(A=n[c].x,k=n[c].y,n[c].newValue!=null?s=n[c].newValue:n[c].value!=null&&(s=n[c].value)):(A=n[c].getAttribute("data-x"),k=n[c].getAttribute("data-y")),A!=null&&k!=null&&(p.push(obj.updateCell(A,k,s,d)),obj.updateFormulaChain(A,k,p))}}obj.setHistory({action:"setValue",records:p,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,p)},obj.setValueFromCoords=function(n,s,d,p){var A=[];A.push(obj.updateCell(n,s,d,p)),obj.updateFormulaChain(n,s,A),obj.setHistory({action:"setValue",records:A,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,A)},obj.setCheckRadioValue=function(){for(var n=[],s=Object.keys(obj.highlighted),d=0;d<s.length;d++){var p=obj.highlighted[d].getAttribute("data-x"),A=obj.highlighted[d].getAttribute("data-y");obj.options.columns[p].type!="checkbox"&&obj.options.columns[p].type!="radio"||n.push(obj.updateCell(p,A,!obj.options.data[A][p]))}n.length&&(obj.setHistory({action:"setValue",records:n,selection:obj.selectedCell}),obj.onafterchanges(el,n))};var stripScript=function(n){var s=new Option;s.innerHTML=n;var d=null;for(n=s.getElementsByTagName("script");d=n[0];)d.parentNode.removeChild(d);return s.innerHTML};obj.updateCell=function(n,s,d,p){if(obj.records[s][n].classList.contains("readonly")!=1||p){var A;(""+d).substr(0,1)=="="&&obj.options.secureFormulas==1&&(A=secureFormula(d))!=d&&(d=A),(A=obj.dispatch("onbeforechange",el,obj.records[s][n],n,s,d))!=null&&(d=A),obj.options.columns[n].editor&&typeof obj.options.columns[n].editor.updateCell=="function"&&(d=obj.options.columns[n].editor.updateCell(obj.records[s][n],d,p)),H={x:n,y:s,col:n,row:s,newValue:d,oldValue:obj.options.data[s][n]};let _=obj.options.columns[n].editor;if(_)obj.options.data[s][n]=d,typeof _.setValue=="function"&&_.setValue(obj.records[s][n],d);else if(obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio"){if(obj.options.columns[n].type=="radio")for(var k=0;k<obj.options.data.length;k++)obj.options.data[k][n]=!1;obj.records[s][n].children[0].checked=d==1||d==1||d=="true"||d=="TRUE",obj.options.data[s][n]=obj.records[s][n].children[0].checked}else if(obj.options.columns[n].type=="dropdown"||obj.options.columns[n].type=="autocomplete")obj.options.data[s][n]=d,obj.records[s][n].textContent=obj.getDropDownValue(n,d);else if(obj.options.columns[n].type=="calendar"){var q=null;if(!validDate(d)){var c=jSuites.calendar.extractDateFromString(d,obj.options.columns[n].options.format);c&&(q=c)}obj.options.data[s][n]=d,obj.records[s][n].textContent=jSuites.calendar.getDateString(q||d,obj.options.columns[n].options.format)}else if(obj.options.columns[n].type=="color")if(obj.options.data[s][n]=d,obj.options.columns[n].render=="square"){var r=document.createElement("div");r.className="color",r.style.backgroundColor=d,obj.records[s][n].textContent="",obj.records[s][n].appendChild(r)}else obj.records[s][n].style.color=d,obj.records[s][n].textContent=d;else if(obj.options.columns[n].type=="image"){if(d=""+d,obj.options.data[s][n]=d,obj.records[s][n].innerHTML="",d&&d.substr(0,10)=="data:image"){var b=document.createElement("img");b.src=d,obj.records[s][n].appendChild(b)}}else obj.options.data[s][n]=d,obj.options.columns[n].type=="html"?obj.records[s][n].innerHTML=stripScript(obj.parseValue(n,s,d)):obj.options.stripHTML===!1||obj.options.columns[n].stripHTML===!1?obj.records[s][n].innerHTML=stripScript(obj.parseValue(n,s,d,obj.records[s][n])):obj.records[s][n].textContent=obj.parseValue(n,s,d,obj.records[s][n]),obj.options.columns[n].wordWrap!=0&&(obj.options.wordWrap==1||obj.options.columns[n].wordWrap==1||obj.records[s][n].innerHTML.length>200)?obj.records[s][n].style.whiteSpace="pre-wrap":obj.records[s][n].style.whiteSpace="";n>0&&(obj.records[s][n-1].style.overflow=d?"hidden":""),obj.dispatch("onchange",el,obj.records[s]&&obj.records[s][n]?obj.records[s][n]:null,n,s,d,H.oldValue)}else var H={x:n,y:s,col:n,row:s};return H},obj.copyData=function(n,s){var d=obj.getData(!0,!0),p=obj.selectedContainer,A=parseInt(n.getAttribute("data-x")),k=parseInt(n.getAttribute("data-y")),q=parseInt(s.getAttribute("data-x")),c=parseInt(s.getAttribute("data-y")),r=[],b=!1;if(p[0]==A){if(k<p[1])var H=k-p[1];else H=1;var _=0}else _=A<p[0]?A-p[0]:1,H=0;for(var g=0,u=0,m=k;m<=c;m++)if(!obj.rows[m]||obj.rows[m].style.display!="none"){d[u]==null&&(u=0),g=0,p[0]!=A&&(_=A<p[0]?A-p[0]:1);for(var j=A;j<=q;j++){if(obj.records[m][j]&&!obj.records[m][j].classList.contains("readonly")&&obj.records[m][j].style.display!="none"&&b==0){if(!obj.selection.length&&obj.options.data[m][j]!=""){b=!0;continue}(d[u]==null||d[u][g]==null)&&(g=0);var h=d[u][g];if(h&&!d[1]&&obj.options.autoIncrement==1){if(obj.options.columns[j].type=="text"||obj.options.columns[j].type=="number")if((""+h).substr(0,1)=="="){var C=h.match(/([A-Z]+[0-9]+)/g);if(C){for(var T=[],I=0;I<C.length;I++){var B=jexcel.getIdFromColumnName(C[I],1);B[0]+=_,B[1]+=H,B[1]<0&&(B[1]=0);var S=jexcel.getColumnNameFromId([B[0],B[1]]);S!=C[I]&&(T[C[I]]=S)}T&&(h=obj.updateFormula(h,T))}}else h==Number(h)&&(h=Number(h)+H);else if(obj.options.columns[j].type=="calendar"){var N=new Date(h);N.setDate(N.getDate()+H),h=N.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(N.getMonth()+1))+"-"+jexcel.doubleDigitFormat(N.getDate())+" 00:00:00"}}r.push(obj.updateCell(j,m,h)),obj.updateFormulaChain(j,m,r)}g++,p[0]!=A&&_++}u++,H++}obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(n,s,d){if(n==1){if(obj.selectedCell&&(s>=obj.selectedCell[1]&&s<=obj.selectedCell[3]||d>=obj.selectedCell[1]&&d<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(s>=obj.selectedCell[0]&&s<=obj.selectedCell[2]||d>=obj.selectedCell[0]&&d<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(n){if(obj.highlighted.length){b=1;for(var s=0;s<obj.highlighted.length;s++){obj.highlighted[s].classList.remove("highlight"),obj.highlighted[s].classList.remove("highlight-left"),obj.highlighted[s].classList.remove("highlight-right"),obj.highlighted[s].classList.remove("highlight-top"),obj.highlighted[s].classList.remove("highlight-bottom"),obj.highlighted[s].classList.remove("highlight-selected");var d=parseInt(obj.highlighted[s].getAttribute("data-x")),p=parseInt(obj.highlighted[s].getAttribute("data-y"));if(obj.highlighted[s].getAttribute("data-merged"))var A=parseInt(obj.highlighted[s].getAttribute("colspan")),k=parseInt(obj.highlighted[s].getAttribute("rowspan")),q=A>0?d+(A-1):d,c=k>0?p+(k-1):p;else q=d,c=p;for(var r=d;r<=q;r++)obj.headers[r]&&obj.headers[r].classList.remove("selected");for(r=p;r<=c;r++)obj.rows[r]&&obj.rows[r].classList.remove("selected")}}else var b=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",n==1&&b==1&&obj.dispatch("onblur",el),b},obj.updateSelection=function(n,s,d){var p=n.getAttribute("data-x"),A=n.getAttribute("data-y");if(s)var k=s.getAttribute("data-x"),q=s.getAttribute("data-y");else k=p,q=A;obj.updateSelectionFromCoords(p,A,k,q,d)},obj.updateSelectionFromCoords=function(n,s,d,p,A){var k=obj.resetSelection();if(s==null&&(s=0,p=obj.rows.length-1),d==null&&(d=n),p==null&&(p=s),n>=obj.headers.length&&(n=obj.headers.length-1),s>=obj.rows.length&&(s=obj.rows.length-1),d>=obj.headers.length&&(d=obj.headers.length-1),p>=obj.rows.length&&(p=obj.rows.length-1),obj.selectedCell=[n,s,d,p],n!=null){if(obj.records[s][n]&&obj.records[s][n].classList.add("highlight-selected"),parseInt(n)<parseInt(d))var q=parseInt(n),c=parseInt(d);else q=parseInt(d),c=parseInt(n);if(parseInt(s)<parseInt(p))var r=parseInt(s),b=parseInt(p);else r=parseInt(p),b=parseInt(s);for(var H=q;H<=c;H++)for(var _=r;_<=b;_++)if(obj.records[_][H]&&obj.records[_][H].getAttribute("data-merged")){var g=parseInt(obj.records[_][H].getAttribute("data-x")),u=parseInt(obj.records[_][H].getAttribute("data-y")),m=parseInt(obj.records[_][H].getAttribute("colspan")),j=parseInt(obj.records[_][H].getAttribute("rowspan"));m>1&&(g<q&&(q=g),g+m>c&&(c=g+m-1)),j&&(u<r&&(r=u),u+j>b&&(b=u+j-1))}var h=null,C=null,T=null,I=null;for(_=r;_<=b;_++)obj.rows[_].style.display!="none"&&(T==null&&(T=_),I=_);for(H=q;H<=c;H++){for(_=r;_<=b;_++)obj.rows[_].style.display!="none"&&obj.records[_][H].style.display!="none"&&(obj.records[_][H].classList.add("highlight"),obj.highlighted.push(obj.records[_][H]));obj.options.columns[H].type!="hidden"&&(h==null&&(h=H),C=H)}for(h||(h=0),C||(C=0),H=h;H<=C;H++)obj.options.columns[H].type!="hidden"&&(obj.records[T]&&obj.records[T][H]&&obj.records[T][H].classList.add("highlight-top"),obj.records[I]&&obj.records[I][H]&&obj.records[I][H].classList.add("highlight-bottom"),obj.headers[H].classList.add("selected"));for(_=T;_<=I;_++)obj.rows[_]&&obj.rows[_].style.display!="none"&&(obj.records[_][h].classList.add("highlight-left"),obj.records[_][C].classList.add("highlight-right"),obj.rows[_].classList.add("selected"));obj.selectedContainer=[h,T,C,I]}k==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,h,T,C,I,A),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var n=0;n<obj.selection.length;n++)obj.selection[n].classList.remove("selection"),obj.selection[n].classList.remove("selection-left"),obj.selection[n].classList.remove("selection-right"),obj.selection[n].classList.remove("selection-top"),obj.selection[n].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(n,s){obj.removeCopySelection();var d=obj.selectedContainer[0],p=obj.selectedContainer[1],A=obj.selectedContainer[2],k=obj.selectedContainer[3];if(n!=null&&s!=null){if(n-A>0)var q=parseInt(A)+1,c=parseInt(n);else q=parseInt(n),c=parseInt(d)-1;if(s-k>0)var r=parseInt(k)+1,b=parseInt(s);else r=parseInt(s),b=parseInt(p)-1;c-q<=b-r?(q=parseInt(d),c=parseInt(A)):(r=parseInt(p),b=parseInt(k));for(var H=r;H<=b;H++)for(var _=q;_<=c;_++)obj.records[H][_]&&obj.rows[H].style.display!="none"&&obj.records[H][_].style.display!="none"&&(obj.records[H][_].classList.add("selection"),obj.records[r][_].classList.add("selection-top"),obj.records[b][_].classList.add("selection-bottom"),obj.records[H][q].classList.add("selection-left"),obj.records[H][c].classList.add("selection-right"),obj.selection.push(obj.records[H][_]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var n=obj.highlighted[obj.highlighted.length-1],s=n.getAttribute("data-x"),d=obj.content.getBoundingClientRect(),p=d.left,A=d.top,k=n.getBoundingClientRect(),q=k.left,c=k.top,r=k.width,b=k.height,H=q-p+obj.content.scrollLeft+r-4,_=c-A+obj.content.scrollTop+b-4;if(obj.corner.style.top=_+"px",obj.corner.style.left=H+"px",obj.options.freezeColumns){var g=obj.getFreezeWidth();s>obj.options.freezeColumns-1&&q-p+r<g?obj.corner.style.display="none":obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.options.selectionCopy==1&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(n){var s=obj.content.getBoundingClientRect(),d=s.left,p=s.top,A=s.width,k=s.height,q=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),c=q.left,r=q.top,b=q.width,H=q.height;if(n==0||n==1)var _=c-d+obj.content.scrollLeft,g=r-p+obj.content.scrollTop-2;else _=c-d+obj.content.scrollLeft+b,g=r-p+obj.content.scrollTop+H;g>obj.content.scrollTop+30&&g<obj.content.scrollTop+k||(g<obj.content.scrollTop+30?obj.content.scrollTop=g-H:obj.content.scrollTop=g-(k-2));var u=obj.getFreezeWidth();_>obj.content.scrollLeft+u&&_<obj.content.scrollLeft+A||(_<obj.content.scrollLeft+30?(obj.content.scrollLeft=_,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):_<obj.content.scrollLeft+u?obj.content.scrollLeft=_-u-1:obj.content.scrollLeft=_-(A-20))},obj.getWidth=function(n){if(n===void 0)for(var s=[],d=0;d<obj.headers.length;d++)s.push(obj.options.columns[d].width);else typeof n=="object"&&(n=n.getAttribute("data-x")),s=obj.colgroup[n].getAttribute("width");return s},obj.setWidth=function(n,s,d){if(s){if(Array.isArray(n)){d||(d=[]);for(var p=0;p<n.length;p++){d[p]||(d[p]=obj.colgroup[n[p]].getAttribute("width"));var A=Array.isArray(s)&&s[p]?s[p]:s;obj.colgroup[n[p]].setAttribute("width",A),obj.options.columns[n[p]].width=A}}else d||(d=obj.colgroup[n].getAttribute("width")),obj.colgroup[n].setAttribute("width",s),obj.options.columns[n].width=s;obj.setHistory({action:"setWidth",column:n,oldValue:d,newValue:s}),obj.dispatch("onresizecolumn",el,n,s,d),obj.updateCornerPosition()}},obj.setHeight=function(n,s,d){s>0&&(typeof n=="object"&&(n=n.getAttribute("data-y")),d||(d=obj.rows[n].getAttribute("height"))||(d=obj.rows[n].getBoundingClientRect().height),s=parseInt(s),obj.rows[n].style.height=s+"px",obj.options.rows[n]||(obj.options.rows[n]={}),obj.options.rows[n].height=s,obj.setHistory({action:"setHeight",row:n,oldValue:d,newValue:s}),obj.dispatch("onresizerow",el,n,s,d),obj.updateCornerPosition())},obj.getHeight=function(n){if(n===void 0)for(var s=[],d=0;d<obj.rows.length;d++){var p=obj.rows[d].style.height;p&&(s[d]=p)}else typeof n=="object"&&(n=$(n).getAttribute("data-y")),s=obj.rows[n].style.height;return s},obj.setFooter=function(n){if(n&&(obj.options.footers=n),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var s=0;s<obj.options.footers.length;s++){if(obj.tfoot.children[s])var d=obj.tfoot.children[s];else{d=document.createElement("tr");var p=document.createElement("td");d.appendChild(p),obj.tfoot.appendChild(d)}for(var A=0;A<obj.headers.length;A++){if(obj.options.footers[s][A]||(obj.options.footers[s][A]=""),obj.tfoot.children[s].children[A+1])p=obj.tfoot.children[s].children[A+1];else{p=document.createElement("td"),d.appendChild(p);var k=obj.options.columns[A].align?obj.options.columns[A].align:"center";p.style.textAlign=k}p.textContent=obj.parseValue(+obj.records.length+A,s,obj.options.footers[s][A]),p.style.display=obj.colgroup[A].style.display}}}},obj.getHeader=function(n){return obj.headers[n].textContent},obj.setHeader=function(n,s){if(obj.headers[n]){var d=obj.headers[n].textContent;s||(s=prompt(obj.options.text.columnName,d)),s&&(obj.headers[n].textContent=s,obj.headers[n].setAttribute("title",s),obj.options.columns[n].title=s),obj.setHistory({action:"setHeader",column:n,oldValue:d,newValue:s}),obj.dispatch("onchangeheader",el,n,d,s)}},obj.getHeaders=function(n){for(var s=[],d=0;d<obj.headers.length;d++)s.push(obj.getHeader(d));return n?s:s.join(obj.options.csvDelimiter)},obj.getMeta=function(n,s){return n?s?obj.options.meta[n]&&obj.options.meta[n][s]?obj.options.meta[n][s]:null:obj.options.meta[n]?obj.options.meta[n]:null:obj.options.meta},obj.setMeta=function(n,s,d){if(obj.options.meta||(obj.options.meta={}),s&&d)obj.options.meta[n]||(obj.options.meta[n]={}),obj.options.meta[n][s]=d;else for(var p=Object.keys(n),A=0;A<p.length;A++){obj.options.meta[p[A]]||(obj.options.meta[p[A]]={});for(var k=Object.keys(n[p[A]]),q=0;q<k.length;q++)obj.options.meta[p[A]][k[q]]=n[p[A]][k[q]]}obj.dispatch("onchangemeta",el,n,s,d)},obj.updateMeta=function(n){if(obj.options.meta){for(var s={},d=Object.keys(obj.options.meta),p=0;p<d.length;p++)n[d[p]]?s[n[d[p]]]=obj.options.meta[d[p]]:s[d[p]]=obj.options.meta[d[p]];obj.options.meta=s}},obj.getStyle=function(n,s){if(n)return n=jexcel.getIdFromColumnName(n,!0),s?obj.records[n[1]][n[0]].style[s]:obj.records[n[1]][n[0]].getAttribute("style");for(var d={},p=obj.options.data[0].length,A=obj.options.data.length,k=0;k<A;k++)for(var q=0;q<p;q++){var c=s?obj.records[k][q].style[s]:obj.records[k][q].getAttribute("style");c&&(d[jexcel.getColumnNameFromId([q,k])]=c)}return d},obj.resetStyle=function(n,s){for(var d=Object.keys(n),p=0;p<d.length;p++){var A=jexcel.getIdFromColumnName(d[p],!0);obj.records[A[1]]&&obj.records[A[1]][A[0]]&&obj.records[A[1]][A[0]].setAttribute("style","")}obj.setStyle(n,null,null,null,s)},obj.setStyle=function(n,s,d,p,A){var k={},q={},c=function(h,C,T){var I=jexcel.getIdFromColumnName(h,!0);if(obj.records[I[1]]&&obj.records[I[1]][I[0]]&&(obj.records[I[1]][I[0]].classList.contains("readonly")==0||p)){var B=obj.records[I[1]][I[0]].style[C];B!=T||p?obj.records[I[1]][I[0]].style[C]=T:(T="",obj.records[I[1]][I[0]].style[C]=""),q[h]||(q[h]=[]),k[h]||(k[h]=[]),q[h].push([C+":"+B]),k[h].push([C+":"+T])}};if(s&&d)if(typeof n=="string")c(n,s,d);else for(var r=[],b=0;b<n.length;b++){var H=n[b].getAttribute("data-x"),_=n[b].getAttribute("data-y"),g=jexcel.getColumnNameFromId([H,_]);r[g]||(c(g,s,d),r[g]=!0)}else{var u=Object.keys(n);for(b=0;b<u.length;b++){var m=n[u[b]];typeof m=="string"&&(m=m.split(";"));for(var j=0;j<m.length;j++)typeof m[j]=="string"&&(m[j]=m[j].split(":")),m[j][0].trim()&&c(u[b],m[j][0].trim(),m[j][1])}}for(u=Object.keys(q),b=0;b<u.length;b++)q[u[b]]=q[u[b]].join(";");for(u=Object.keys(k),b=0;b<u.length;b++)k[u[b]]=k[u[b]].join(";");A||obj.setHistory({action:"setStyle",oldValue:q,newValue:k}),obj.dispatch("onchangestyle",el,n,s,d)},obj.getComments=function(n,s){if(n)return typeof n=="string"&&(n=jexcel.getIdFromColumnName(n,!0)),s?[obj.records[n[1]][n[0]].getAttribute("title"),obj.records[n[1]][n[0]].getAttribute("author")]:obj.records[n[1]][n[0]].getAttribute("title")||"";for(var d={},p=0;p<obj.options.data.length;p++)for(var A=0;A<obj.options.columns.length;A++){var k=obj.records[p][A].getAttribute("title");k&&(d[n=jexcel.getColumnNameFromId([A,p])]=k)}return d},obj.setComments=function(n,s,d){if(typeof n=="string")var p=jexcel.getIdFromColumnName(n,!0);else p=n;var A=obj.records[p[1]][p[0]].getAttribute("title"),k=[A,d=obj.records[p[1]][p[0]].getAttribute("data-author")];obj.records[p[1]][p[0]].setAttribute("title",s||""),obj.records[p[1]][p[0]].setAttribute("data-author",d||""),s?obj.records[p[1]][p[0]].classList.add("jexcel_comments"):obj.records[p[1]][p[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:n,newValue:[s,d],oldValue:k}),obj.dispatch("oncomments",el,s,A,p,p[0],p[1])},obj.getConfig=function(){var n=obj.options;return n.style=obj.getStyle(),n.mergeCells=obj.getMerge(),n.comments=obj.getComments(),n},obj.orderBy=function(n,s){if(n>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}s=s==null?obj.headers[n].classList.contains("arrow-down")?1:0:s?1:0;var d=[];if(obj.options.columns[n].type=="number"||obj.options.columns[n].type=="numeric"||obj.options.columns[n].type=="percentage"||obj.options.columns[n].type=="autonumber"||obj.options.columns[n].type=="color")for(var p=0;p<obj.options.data.length;p++)d[p]=[p,Number(obj.options.data[p][n])];else if(obj.options.columns[n].type=="calendar"||obj.options.columns[n].type=="checkbox"||obj.options.columns[n].type=="radio")for(p=0;p<obj.options.data.length;p++)d[p]=[p,obj.options.data[p][n]];else for(p=0;p<obj.options.data.length;p++)d[p]=[p,obj.records[p][n].textContent.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(k){return function(q,c){var r=q[1],b=c[1];return k?r===""&&b!==""?1:r!==""&&b===""||r>b?-1:r<b?1:0:r===""&&b!==""?1:r!==""&&b===""?-1:r>b?1:r<b?-1:0}}),d=d.sort(obj.options.sorting(s));var A=[];for(p=0;p<d.length;p++)A[p]=d[p][0];return obj.setHistory({action:"orderBy",rows:A,column:n,order:s}),obj.updateOrderArrow(n,s),obj.updateOrder(A),obj.dispatch("onsort",el,n,s),!0}},obj.updateOrderArrow=function(n,s){for(var d=0;d<obj.headers.length;d++)obj.headers[d].classList.remove("arrow-up"),obj.headers[d].classList.remove("arrow-down");s?obj.headers[n].classList.add("arrow-up"):obj.headers[n].classList.add("arrow-down")},obj.updateOrder=function(n){for(var s=[],d=0;d<n.length;d++)s[d]=obj.options.data[n[d]];for(obj.options.data=s,s=[],d=0;d<n.length;d++)s[d]=obj.records[n[d]];for(obj.records=s,s=[],d=0;d<n.length;d++)s[d]=obj.rows[n[d]];if(obj.rows=s,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==1)obj.loadPage(0);else for(d=0;d<obj.rows.length;d++)obj.tbody.appendChild(obj.rows[d])},obj.moveRow=function(n,s,d){if(Object.keys(obj.options.mergeCells).length>0){if(n>s)var p=1;else p=0;if(obj.isRowMerged(n).length||obj.isRowMerged(s,p).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}d||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[s])>=0?n>s?obj.tbody.insertBefore(obj.rows[n],obj.rows[s]):obj.tbody.insertBefore(obj.rows[n],obj.rows[s].nextSibling):obj.tbody.removeChild(obj.rows[n])),obj.rows.splice(s,0,obj.rows.splice(n,1)[0]),obj.records.splice(s,0,obj.records.splice(n,1)[0]),obj.options.data.splice(s,0,obj.options.data.splice(n,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:n,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,n,s)},obj.insertRow=function(n,s,d){if(obj.options.allowInsertRow==1){var p=[];if(n>0)var A=n;else A=1,n&&(p=n);d=!!d;var k=obj.options.data.length-1;if((s==null||s>=parseInt(k)||s<0)&&(s=k),obj.dispatch("onbeforeinsertrow",el,s,A,d)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(s,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var q=d?s:s+1,c=obj.records.splice(q),r=obj.options.data.splice(q),b=obj.rows.splice(q),H=[],_=[],g=[],u=q;u<A+q;u++){obj.options.data[u]=[];for(var m=0;m<obj.options.columns.length;m++)obj.options.data[u][m]=p[m]?p[m]:"";var j=obj.createRow(u,obj.options.data[u]);b[0]?Array.prototype.indexOf.call(obj.tbody.children,b[0])>=0&&obj.tbody.insertBefore(j,b[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[s])>=0&&obj.tbody.appendChild(j),H.push(obj.records[u]),_.push(obj.options.data[u]),g.push(j)}Array.prototype.push.apply(obj.records,c),Array.prototype.push.apply(obj.options.data,r),Array.prototype.push.apply(obj.rows,b),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:s,numOfRows:A,insertBefore:d,rowRecords:H,rowData:_,rowNode:g}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,s,A,H,d)}},obj.deleteRow=function(n,s){if(obj.options.allowDeleteRow==1)if(obj.options.allowDeletingAllRows==1||obj.options.data.length>1){if(n==null){var d=obj.getSelectedRows();d[0]?(n=parseInt(d[0].getAttribute("data-y")),s=d.length):(n=obj.options.data.length-1,s=1)}var p=obj.options.data.length-1;if((n==null||n>p||n<0)&&(n=p),s||(s=1),n+s>=obj.options.data.length&&(s=obj.options.data.length-n),obj.dispatch("onbeforedeleterow",el,n,s)===!1)return!1;if(parseInt(n)>-1){var A=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var k=n;k<n+s;k++)obj.isRowMerged(k,!1).length&&(A=!0);if(A){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(obj.options.search==1){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(obj.options.allowDeletingAllRows==0&&p+1===s&&(s--,console.error("Jspreadsheet: It is not possible to delete the last row")),k=n;k<n+s;k++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[k])>=0&&(obj.rows[k].className="",obj.rows[k].parentNode.removeChild(obj.rows[k]));var q=obj.records.splice(n,s),c=obj.options.data.splice(n,s),r=obj.rows.splice(n,s);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,n,n+s-1),obj.setHistory({action:"deleteRow",rowNumber:n,numOfRows:s,insertBefore:1,rowRecords:q,rowData:c,rowNode:r}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,n,s,q)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(n,s){if(Object.keys(obj.options.mergeCells).length>0){if(n>s)var d=1;else d=0;if(obj.isColMerged(n).length||obj.isColMerged(s,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((n=parseInt(n))>(s=parseInt(s))){obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s]),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s]);for(var p=0;p<obj.rows.length;p++)obj.rows[p].insertBefore(obj.records[p][n],obj.records[p][s])}else for(obj.headerContainer.insertBefore(obj.headers[n],obj.headers[s].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[n],obj.colgroup[s].nextSibling),p=0;p<obj.rows.length;p++)obj.rows[p].insertBefore(obj.records[p][n],obj.records[p][s].nextSibling);for(obj.options.columns.splice(s,0,obj.options.columns.splice(n,1)[0]),obj.headers.splice(s,0,obj.headers.splice(n,1)[0]),obj.colgroup.splice(s,0,obj.colgroup.splice(n,1)[0]),p=0;p<obj.rows.length;p++)obj.options.data[p].splice(s,0,obj.options.data[p].splice(n,1)[0]),obj.records[p].splice(s,0,obj.records[p].splice(n,1)[0]);if(obj.options.footers)for(p=0;p<obj.options.footers.length;p++)obj.options.footers[p].splice(s,0,obj.options.footers[p].splice(n,1)[0]);obj.setHistory({action:"moveColumn",oldValue:n,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,n,s)},obj.insertColumn=function(n,s,d,p){if(obj.options.allowInsertColumn==1){var A=[];if(n>0)var k=n;else k=1,n&&(A=n);d=!!d;var q=obj.options.columns.length-1;if((s==null||s>=parseInt(q)||s<0)&&(s=q),obj.dispatch("onbeforeinsertcolumn",el,s,k,d)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(s,d).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}p||(p=[]);for(var c=0;c<k;c++)p[c]||(p[c]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var r=d?s:s+1;obj.options.columns=jexcel.injectArray(obj.options.columns,r,p);for(var b=obj.headers.splice(r),H=obj.colgroup.splice(r),_=[],g=[],u=[],m=[],j=[],h=r;h<k+r;h++)obj.createCellHeader(h),obj.headerContainer.insertBefore(obj.headers[h],obj.headerContainer.children[h+1]),obj.colgroupContainer.insertBefore(obj.colgroup[h],obj.colgroupContainer.children[h+1]),_.push(obj.headers[h]),g.push(obj.colgroup[h]);if(obj.options.footers)for(var C=0;C<obj.options.footers.length;C++){for(j[C]=[],c=0;c<k;c++)j[C].push("");obj.options.footers[C].splice(r,0,j[C])}for(var T=0;T<obj.options.data.length;T++){var I=obj.options.data[T].splice(r),B=obj.records[T].splice(r);for(m[T]=[],u[T]=[],h=r;h<k+r;h++){var S=A[T]?A[T]:"";obj.options.data[T][h]=S;var N=obj.createCell(h,T,obj.options.data[T][h]);obj.records[T][h]=N,obj.rows[T]&&obj.rows[T].insertBefore(N,obj.rows[T].children[h+1]),m[T].push(S),u[T].push(N)}Array.prototype.push.apply(obj.options.data[T],I),Array.prototype.push.apply(obj.records[T],B)}if(Array.prototype.push.apply(obj.headers,b),Array.prototype.push.apply(obj.colgroup,H),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(C=0;C<obj.options.nestedHeaders.length;C++){var F=parseInt(obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan)+k;obj.options.nestedHeaders[C][obj.options.nestedHeaders[C].length-1].colspan=F,obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("colspan",F);var G=obj.thead.children[C].children[obj.thead.children[C].children.length-1].getAttribute("data-column");for(G=G.split(","),h=r;h<k+r;h++)G.push(h);obj.thead.children[C].children[obj.thead.children[C].children.length-1].setAttribute("data-column",G)}else F=parseInt(obj.options.nestedHeaders[0].colspan)+k,obj.options.nestedHeaders[0].colspan=F,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",F);obj.setHistory({action:"insertColumn",columnNumber:s,numOfColumns:k,insertBefore:d,columns:p,headers:_,colgroup:g,records:u,footers:j,data:m}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,s,k,u,d)}},obj.deleteColumn=function(n,s){if(obj.options.allowDeleteColumn==1)if(obj.headers.length>1){if(n==null){var d=obj.getSelectedColumns(!0);d.length?(n=parseInt(d[0]),s=parseInt(d.length)):(n=obj.headers.length-1,s=1)}var p=obj.options.data[0].length-1;if((n==null||n>p||n<0)&&(n=p),s||(s=1),s>obj.options.data[0].length-n&&(s=obj.options.data[0].length-n),obj.dispatch("onbeforedeletecolumn",el,n,s)===!1)return!1;if(parseInt(n)>-1){var A=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var k=n;k<n+s;k++)obj.isColMerged(k,!1).length&&(A=!0);if(A){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var q=obj.options.columns.splice(n,s);for(k=n;k<n+s;k++)obj.colgroup[k].className="",obj.headers[k].className="",obj.colgroup[k].parentNode.removeChild(obj.colgroup[k]),obj.headers[k].parentNode.removeChild(obj.headers[k]);for(var c=obj.headers.splice(n,s),r=obj.colgroup.splice(n,s),b=[],H=[],_=[],g=0;g<obj.options.data.length;g++)for(k=n;k<n+s;k++)obj.records[g][k].className="",obj.records[g][k].parentNode.removeChild(obj.records[g][k]);for(g=0;g<obj.options.data.length;g++)H[g]=obj.options.data[g].splice(n,s),b[g]=obj.records[g].splice(n,s);if(obj.options.footers)for(g=0;g<obj.options.footers.length;g++)_[g]=obj.options.footers[g].splice(n,s);if(obj.conditionalSelectionUpdate(0,n,n+s-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var u=0;u<obj.options.nestedHeaders.length;u++){var m=parseInt(obj.options.nestedHeaders[u][obj.options.nestedHeaders[u].length-1].colspan)-s;obj.options.nestedHeaders[u][obj.options.nestedHeaders[u].length-1].colspan=m,obj.thead.children[u].children[obj.thead.children[u].children.length-1].setAttribute("colspan",m)}else m=parseInt(obj.options.nestedHeaders[0].colspan)-s,obj.options.nestedHeaders[0].colspan=m,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",m);obj.setHistory({action:"deleteColumn",columnNumber:n,numOfColumns:s,insertBefore:1,columns:q,headers:c,colgroup:r,records:b,footers:_,data:H}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,n,s,b)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(n){for(var s=[],d=0;d<obj.rows.length;d++)obj.rows[d].classList.contains("selected")&&(n?s.push(d):s.push(obj.rows[d]));return s},obj.getSelectedColumns=function(){for(var n=[],s=0;s<obj.headers.length;s++)obj.headers[s].classList.contains("selected")&&n.push(s);return n},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var n=0;n<obj.headers.length;n++)(k=obj.headers[n].getAttribute("data-x"))!=n&&(obj.headers[n].setAttribute("data-x",n),obj.headers[n].getAttribute("title")||(obj.headers[n].innerHTML=jexcel.getColumnName(n)));for(var s=0;s<obj.rows.length;s++)obj.rows[s]&&(q=obj.rows[s].getAttribute("data-y"))!=s&&(obj.rows[s].setAttribute("data-y",s),obj.rows[s].children[0].setAttribute("data-y",s),obj.rows[s].children[0].innerHTML=s+1);var d=[],p=[],A=function(u,m,j,h){if(u!=j&&obj.records[h][j].setAttribute("data-x",j),m!=h&&obj.records[h][j].setAttribute("data-y",h),u!=j||m!=h){var C=jexcel.getColumnNameFromId([u,m]),T=jexcel.getColumnNameFromId([j,h]);d[C]=T}};for(s=0;s<obj.records.length;s++)for(n=0;n<obj.records[0].length;n++)if(obj.records[s][n]){var k=obj.records[s][n].getAttribute("data-x"),q=obj.records[s][n].getAttribute("data-y");if(obj.records[s][n].getAttribute("data-merged")){var c=jexcel.getColumnNameFromId([k,q]),r=jexcel.getColumnNameFromId([n,s]);if(p[c]==null)if(c==r)p[c]=!1;else{var b=parseInt(n-k),H=parseInt(s-q);p[c]=[r,b,H]}}else A(k,q,n,s)}var _=Object.keys(p);if(_.length){for(n=0;n<_.length;n++)if(p[_[n]]){var g=jexcel.getIdFromColumnName(_[n],!0);for(A(k=g[0],q=g[1],k+p[_[n]][1],q+p[_[n]][2]),c=_[n],r=p[_[n]][0],s=0;s<obj.options.mergeCells[c][2].length;s++)k=parseInt(obj.options.mergeCells[c][2][s].getAttribute("data-x")),q=parseInt(obj.options.mergeCells[c][2][s].getAttribute("data-y")),obj.options.mergeCells[c][2][s].setAttribute("data-x",k+p[_[n]][1]),obj.options.mergeCells[c][2][s].setAttribute("data-y",q+p[_[n]][2]);obj.options.mergeCells[r]=obj.options.mergeCells[c],delete obj.options.mergeCells[c]}}obj.updateFormulas(d),obj.updateMeta(d),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var n=0,s=obj.rows.length-1;s>=0;s--){for(var d=!1,p=0;p<obj.headers.length;p++)obj.options.data[s][p]&&(d=!0);if(d)break;n++}obj.options.minSpareRows-n>0&&obj.insertRow(obj.options.minSpareRows-n)}if(obj.options.minSpareCols>0){var A=0;for(p=obj.headers.length-1;p>=0;p--){for(d=!1,s=0;s<obj.rows.length;s++)obj.options.data[s][p]&&(d=!0);if(d)break;A++}obj.options.minSpareCols-A>0&&obj.insertColumn(obj.options.minSpareCols-A)}if(typeof obj.options.updateTable=="function"){for(obj.options.detachForUpdates&&el.removeChild(obj.content),s=0;s<obj.rows.length;s++)for(p=0;p<obj.headers.length;p++)obj.options.updateTable(el,obj.records[s][p],p,s,obj.options.data[s][p],obj.records[s][p].textContent,jexcel.getColumnNameFromId([p,s]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(n){if(n=obj.getCell(n))return!!n.classList.contains("readonly")},obj.setReadOnly=function(n,s){(n=obj.getCell(n))&&(s?n.classList.add("readonly"):n.classList.remove("readonly"))},obj.showRow=function(n){obj.rows[n].style.display=""},obj.hideRow=function(n){obj.rows[n].style.display="none"},obj.showColumn=function(n){obj.headers[n].style.display="",obj.colgroup[n].style.display="",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="");for(var s=0;s<obj.options.data.length;s++)obj.records[s][n].style.display="";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.hideColumn=function(n){obj.headers[n].style.display="none",obj.colgroup[n].style.display="none",obj.filter&&obj.filter.children.length>n+1&&(obj.filter.children[n+1].style.display="none");for(var s=0;s<obj.options.data.length;s++)obj.records[s][n].style.display="none";obj.options.footers&&obj.setFooter(),obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(n,s,d){var p=jexcel.getColumnNameFromId([n,s]);if(obj.formula[p]&&obj.formula[p].length>0)if(chainLoopProtection[p])obj.records[s][n].innerHTML="#ERROR",obj.formula[p]="";else{chainLoopProtection[p]=!0;for(var A=0;A<obj.formula[p].length;A++){var k=jexcel.getIdFromColumnName(obj.formula[p][A],!0),q=""+obj.options.data[k[1]][k[0]];q.substr(0,1)=="="?d.push(obj.updateCell(k[0],k[1],q,!0)):Object.keys(obj.formula)[A]=null,obj.updateFormulaChain(k[0],k[1],d)}}chainLoopProtection=[]},obj.updateFormulas=function(n){for(var s=0;s<obj.options.data.length;s++)for(var d=0;d<obj.options.data[0].length;d++)if((c=""+obj.options.data[s][d]).substr(0,1)=="="){var p=obj.updateFormula(c,n);p!=c&&(obj.options.data[s][d]=p)}var A=[],k=Object.keys(obj.formula);for(s=0;s<k.length;s++){var q=k[s],c=obj.formula[q];for(n[q]&&(q=n[q]),A[q]=[],d=0;d<c.length;d++){var r=c[d];n[r]&&(r=n[r]),A[q].push(r)}}obj.formula=A},obj.updateFormula=function(n,s){for(var d=/[A-Z]/,p=/[0-9]/,A="",k=null,q=null,c="",r=0;r<n.length;r++)d.exec(n[r])?(k=1,q=0,c+=n[r]):p.exec(n[r])?(q=k?1:0,c+=n[r]):(k&&q&&(c=s[c]?s[c]:c),A+=c,A+=n[r],k=0,q=0,c="");return c&&(k&&q&&(c=s[c]?s[c]:c),A+=c),A};var secureFormula=function(n){for(var s="",d=0,p=0;p<n.length;p++)n[p]=='"'&&(d=d==0?1:0),s+=d==1?n[p]:n[p].toUpperCase();return s};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(n){for(var s=0;s<n.length;s++){var d=[],p=n[s].split(":"),A=jexcel.getIdFromColumnName(p[0],!0),k=jexcel.getIdFromColumnName(p[1],!0);if(A[0]<=k[0])var q=A[0],c=k[0];else q=k[0],c=A[0];if(A[1]<=k[1])var r=A[1],b=k[1];else r=k[1],b=A[1];for(var H=r;H<=b;H++)for(var _=q;_<=c;_++)d.push(jexcel.getColumnNameFromId([_,H]));expression=expression.replace(n[s],d.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(obj.options.data[position[1]]!==void 0&&obj.options.data[position[1]][position[0]]!==void 0)var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==1)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==1&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(n){var res="#ERROR";console.log(n)}return res};return execute(expression,x,y)},obj.parseNumber=function(n,s){var d=s&&obj.options.columns[s].decimal?obj.options.columns[s].decimal:".",p=""+n;return(p=p.split(d))[0]=p[0].match(/[+-]?[0-9]/g),p[0]&&(p[0]=p[0].join("")),p[1]&&(p[1]=p[1].match(/[0-9]*/g).join("")),p[0]&&Number.isInteger(Number(p[0]))?p[1]?n=+(p[0]+"."+p[1]):n=+(p[0]+".00"):n=null,n},obj.row=function(n){},obj.col=function(n){},obj.up=function(n,s){if(n?obj.selectedCell[3]>0&&obj.up.visible(1,s?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var d=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-d<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var p=obj.whichPage(obj.selectedCell[3]);p!=obj.pageNumber&&obj.page(p)}obj.updateScroll(1)},obj.up.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),p=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),p=parseInt(obj.selectedCell[3]);if(s==0){for(var A=0;A<p;A++)if(obj.records[A][d].style.display!="none"&&obj.rows[A].style.display!="none"){p=A;break}}else p=obj.up.get(d,p);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=p):(obj.selectedCell[2]=d,obj.selectedCell[3]=p)},obj.up.get=function(n,s){n=parseInt(n);for(var d=(s=parseInt(s))-1;d>=0;d--)if(obj.records[d][n].style.display!="none"&&obj.rows[d].style.display!="none"){if(obj.records[d][n].getAttribute("data-merged")&&obj.records[d][n]==obj.records[s][n])continue;s=d;break}return s},obj.down=function(n,s){if(n?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,s?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==1)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}obj.updateScroll(3)},obj.down.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),p=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),p=parseInt(obj.selectedCell[3]);if(s==0){for(var A=obj.rows.length-1;A>p;A--)if(obj.records[A][d].style.display!="none"&&obj.rows[A].style.display!="none"){p=A;break}}else p=obj.down.get(d,p);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=p):(obj.selectedCell[2]=d,obj.selectedCell[3]=p)},obj.down.get=function(n,s){n=parseInt(n);for(var d=(s=parseInt(s))+1;d<obj.rows.length;d++)if(obj.records[d][n].style.display!="none"&&obj.rows[d].style.display!="none"){if(obj.records[d][n].getAttribute("data-merged")&&obj.records[d][n]==obj.records[s][n])continue;s=d;break}return s},obj.right=function(n,s){n?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,s?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),p=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),p=parseInt(obj.selectedCell[3]);if(s==0){for(var A=obj.headers.length-1;A>d;A--)if(obj.records[p][A].style.display!="none"){d=A;break}}else d=obj.right.get(d,p);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=p):(obj.selectedCell[2]=d,obj.selectedCell[3]=p)},obj.right.get=function(n,s){n=parseInt(n),s=parseInt(s);for(var d=n+1;d<obj.headers.length;d++)if(obj.records[s][d].style.display!="none"){if(obj.records[s][d].getAttribute("data-merged")&&obj.records[s][d]==obj.records[s][n])continue;n=d;break}return n},obj.left=function(n,s){n?obj.selectedCell[2]>0&&obj.left.visible(1,s?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,s?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(n,s){if(n==0)var d=parseInt(obj.selectedCell[0]),p=parseInt(obj.selectedCell[1]);else d=parseInt(obj.selectedCell[2]),p=parseInt(obj.selectedCell[3]);if(s==0){for(var A=0;A<d;A++)if(obj.records[p][A].style.display!="none"){d=A;break}}else d=obj.left.get(d,p);n==0?(obj.selectedCell[0]=d,obj.selectedCell[1]=p):(obj.selectedCell[2]=d,obj.selectedCell[3]=p)},obj.left.get=function(n,s){n=parseInt(n),s=parseInt(s);for(var d=n-1;d>=0;d--)if(obj.records[s][d].style.display!="none"){if(obj.records[s][d].getAttribute("data-merged")&&obj.records[s][d]==obj.records[s][n])continue;n=d;break}return n},obj.first=function(n,s){if(n?s?obj.selectedCell[3]=0:obj.left.visible(1,0):(s?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=0&&obj.selectedCell[3]!=0){if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(n,s){if(n?s?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(s?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading!=1||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var d=obj.whichPage(obj.selectedCell[3]);d!=obj.pageNumber&&obj.page(d)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(n){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)s=obj.rows;else var s=obj.results;var d=100;n!=null&&n!=-1||(n=Math.ceil(s.length/d)-1);var p=n*d,A=n*d+d;A>s.length&&(A=s.length),(p=A-100)<0&&(p=0);for(var k=p;k<A;k++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[k]):obj.tbody.appendChild(obj.rows[s[k]]),obj.tbody.children.length>d&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var s=0;if(n.length>100){var d=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(d=n.indexOf(d)),d>0)for(var p=0;p<30;p++)(d-=1)>-1&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.insertBefore(obj.rows[d],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[n[d]],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),s=1))}return s},obj.loadDown=function(){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows;else var n=obj.results;var s=0;if(n.length>100){var d=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search!=1&&obj.options.filters!=1||!obj.results||(d=n.indexOf(d)),d<obj.rows.length-1)for(var p=0;p<=30;p++)d<n.length&&(obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[d]):obj.tbody.appendChild(obj.rows[n[d]]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),s=1)),d+=1}return s},obj.loadValidation=function(){if(obj.selectedCell){var n=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,s=parseInt(obj.selectedCell[3]/100),d=parseInt(obj.rows.length/100);if(n!=s&&s<=d&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(s),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(n){if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],n){var s=function(p){obj.results.indexOf(p)==-1&&obj.results.push(p)},d=n.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");d=new RegExp(d,"i"),obj.options.data.forEach(function(p,A){if(function(b,H,_){for(var g=0;g<b.length;g++)if((""+b[g]).toLowerCase().search(H)>=0||(""+obj.records[_][g].innerHTML).toLowerCase().search(H)>=0)return!0;return!1}(p,d,A)){var k=obj.isRowMerged(A);if(k.length)for(var q=0;q<k.length;q++)for(var c=jexcel.getIdFromColumnName(k[q],!0),r=0;r<obj.options.mergeCells[k[q]][1];r++)s(c[1]+r);else s(A)}})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var n,s=0;for(n=obj.options.lazyLoading==1?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var d=0;d<obj.rows.length;d++)!obj.results||obj.results.indexOf(d)>-1?(s<n&&(obj.tbody.appendChild(obj.rows[d]),s++),obj.rows[d].style.display=""):obj.rows[d].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),n},obj.whichPage=function(n){return obj.options.search!=1&&obj.options.filters!=1||!obj.results||(n=obj.results.indexOf(n)),Math.ceil((parseInt(n)+1)/parseInt(obj.options.pagination))-1},obj.page=function(n){var s=obj.pageNumber;if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)d=obj.rows;else var d=obj.results;var p=parseInt(obj.options.pagination);n!=null&&n!=-1||(n=Math.ceil(d.length/p)-1),obj.pageNumber=n;var A=n*p,k=n*p+p;for(k>d.length&&(k=d.length),A<0&&(A=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var q=A;q<k;q++)obj.options.search!=1&&obj.options.filters!=1||!obj.results?obj.tbody.appendChild(obj.rows[q]):obj.tbody.appendChild(obj.rows[d[q]]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,n,s)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search!=1&&obj.options.filters!=1||!obj.results)n=obj.rows.length;else var n=obj.results.length;if(n){var s=Math.ceil(n/obj.options.pagination);if(obj.pageNumber<6)var d=1,p=s<10?s:10;else s-obj.pageNumber<5?(p=s,(d=s-9)<1&&(d=1)):(d=obj.pageNumber-4,p=obj.pageNumber+5);d>1&&((k=document.createElement("div")).className="jexcel_page",k.innerHTML="<",k.title=1,obj.pagination.children[1].appendChild(k));for(var A=d;A<=p;A++){var k;(k=document.createElement("div")).className="jexcel_page",k.innerHTML=A,obj.pagination.children[1].appendChild(k),obj.pageNumber==A-1&&k.classList.add("jexcel_page_selected")}p<s&&((k=document.createElement("div")).className="jexcel_page",k.innerHTML=">",k.title=s,obj.pagination.children[1].appendChild(k)),obj.pagination.children[0].innerHTML=function(q){var c=Array.prototype.slice.call(arguments,1);return q.replace(/{(\d+)}/g,function(r,b){return c[b]!==void 0?c[b]:r})}(obj.options.text.showingPage,obj.pageNumber+1,s)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(n){if(obj.options.allowExport==0)console.error("Export not allowed");else{var s="";s+=obj.copy(!1,obj.options.csvDelimiter,!0,n,!0);var d=new Blob(["\uFEFF"+s],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(d,obj.options.csvFileName+".csv");else{var p=document.createElement("a"),A=URL.createObjectURL(d);p.href=A,p.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(p),p.click(),p.parentNode.removeChild(p)}}},obj.setHistory=function(n){if(obj.ignoreHistory!=1){var s=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,s+1),obj.history[s]=n}},obj.copy=function(n,s,d,p,A){s||(s="	");for(var k=new RegExp(s,"ig"),q=[],c=[],r=[],b=[],H=[],_=obj.options.data[0].length,g=obj.options.data.length,u="",m=!1,j="",h="",C=0,T=0,I=0,B=0,S=!0,N=0;N<g;N++)for(var F=0;F<_;F++)n&&!obj.records[N][F].classList.contains("highlight")||(I<=F&&(I=F),B<=N&&(B=N));if(_===I+1&&g===B+1&&(S=!1),A&&obj.options.includeHeadersOnDownload==1||!A&&obj.options.includeHeadersOnCopy==1&&!S||p){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)for(u=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders],N=0;N<u.length;N++){var G=[];for(F=0;F<u[N].length;F++){var U=parseInt(u[N][F].colspan);G.push(u[N][F].title);for(var se=0;se<U-1;se++)G.push("")}h+=G.join(s)+`\r
`}m=!0}for(obj.style=[],N=0;N<g;N++){for(c=[],r=[],F=0;F<_;F++)if(!n||obj.records[N][F].classList.contains("highlight")){m==1&&q.push(obj.headers[F].textContent);var ge=obj.options.data[N][F];if(ge.match&&(ge.match(k)||ge.match(/,/g)||ge.match(/\n/)||ge.match(/\"/))&&(ge='"'+(ge=ge.replace(new RegExp('"',"g"),'""'))+'"'),c.push(ge),obj.options.columns[F].type=="checkbox"||obj.options.columns[F].type=="radio")var ie=ge;else(ie=obj.options.stripHTMLOnCopy==1?obj.records[N][F].textContent:obj.records[N][F].innerHTML).match&&(ie.match(k)||ie.match(/,/g)||ie.match(/\n/)||ie.match(/\"/))&&(ie='"'+(ie=ie.replace(new RegExp('"',"g"),'""'))+'"');r.push(ie),u=(u=obj.records[N][F].getAttribute("style")).replace("display: none;",""),obj.style.push(u||"")}c.length&&(m&&(C=c.length,b.push(q.join(s))),b.push(c.join(s))),r.length&&(T++,m&&(H.push(q.join(s)),m=!1),H.push(r.join(s)))}_==C&&g==T&&(j=h);var xe=j+b.join(`\r
`),Te=j+H.join(`\r
`);if(d||(obj.options.copyCompatibility==1?obj.textarea.value=Te:obj.textarea.value=xe,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==1?obj.data=Te:obj.data=xe,obj.hashString=obj.hash(obj.data),!d){if(obj.removeCopyingSelection(),obj.highlighted)for(F=0;F<obj.highlighted.length;F++)obj.highlighted[F].classList.add("copying"),obj.highlighted[F].classList.contains("highlight-left")&&obj.highlighted[F].classList.add("copying-left"),obj.highlighted[F].classList.contains("highlight-right")&&obj.highlighted[F].classList.add("copying-right"),obj.highlighted[F].classList.contains("highlight-top")&&obj.highlighted[F].classList.add("copying-top"),obj.highlighted[F].classList.contains("highlight-bottom")&&obj.highlighted[F].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==1?H:b,obj.hashString)}return obj.data},obj.paste=function(n,s,d){var p=obj.dispatch("onbeforepaste",el,d,n,s);if(p===!1)return!1;p&&(d=p);var A=obj.hash(d),k=A==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==1&&A==obj.hashString&&(d=obj.data),d=obj.parseCSV(d,"	"),n!=null&&s!=null&&d){for(var q=0,c=0,r=[],b={},H={},_=0,g=parseInt(n),u=parseInt(s),m=null;m=d[c];){for(q=0,g=parseInt(n);m[q]!=null;){var j=obj.updateCell(g,u,m[q]);if(r.push(j),obj.updateFormulaChain(g,u,r),k&&k[_]){var h=jexcel.getColumnNameFromId([g,u]);b[h]=k[_],H[h]=obj.getStyle(h),obj.records[u][g].setAttribute("style",k[_]),_++}if(m[++q]!=null){if(g>=obj.headers.length-1){if(obj.options.allowInsertColumn!=1)break;obj.insertColumn()}g=obj.right.get(g,u)}}if(d[++c]){if(u>=obj.rows.length-1){if(obj.options.allowInsertRow!=1)break;obj.insertRow()}u=obj.down.get(n,u)}}obj.updateSelectionFromCoords(n,s,g,u),obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell,newStyle:b,oldStyle:H}),obj.updateTable(),obj.dispatch("onpaste",el,d),obj.onafterchanges(el,r)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var n=document.querySelectorAll(".jexcel .copying"),s=0;s<n.length;s++)n[s].classList.remove("copying"),n[s].classList.remove("copying-left"),n[s].classList.remove("copying-right"),n[s].classList.remove("copying-top"),n[s].classList.remove("copying-bottom")},obj.historyProcessRow=function(n,s){var d=s.insertBefore?+s.rowNumber:s.rowNumber+1;if(obj.options.search==1&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),n==1){for(var p=s.numOfRows,A=d;A<p+d;A++)obj.rows[A].parentNode.removeChild(obj.rows[A]);obj.records.splice(d,p),obj.options.data.splice(d,p),obj.rows.splice(d,p),obj.conditionalSelectionUpdate(1,d,p+d-1)}else{obj.records=jexcel.injectArray(obj.records,d,s.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,d,s.rowData),obj.rows=jexcel.injectArray(obj.rows,d,s.rowNode);var k=0;for(A=d;A<s.numOfRows+d;A++)obj.tbody.insertBefore(s.rowNode[k],obj.tbody.children[A]),k++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(n,s){var d=s.insertBefore?s.columnNumber:s.columnNumber+1;if(n==1){var p=s.numOfColumns;obj.options.columns.splice(d,p);for(var A=d;A<p+d;A++)obj.headers[A].parentNode.removeChild(obj.headers[A]),obj.colgroup[A].parentNode.removeChild(obj.colgroup[A]);obj.headers.splice(d,p),obj.colgroup.splice(d,p);for(var k=0;k<s.data.length;k++){for(A=d;A<p+d;A++)obj.records[k][A].parentNode.removeChild(obj.records[k][A]);obj.records[k].splice(d,p),obj.options.data[k].splice(d,p)}if(obj.options.footers)for(k=0;k<obj.options.footers.length;k++)obj.options.footers[k].splice(d,p)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,d,s.columns),obj.headers=jexcel.injectArray(obj.headers,d,s.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,d,s.colgroup);var q=0;for(A=d;A<s.numOfColumns+d;A++)obj.headerContainer.insertBefore(s.headers[q],obj.headerContainer.children[A+1]),obj.colgroupContainer.insertBefore(s.colgroup[q],obj.colgroupContainer.children[A+1]),q++;for(k=0;k<s.data.length;k++)for(obj.options.data[k]=jexcel.injectArray(obj.options.data[k],d,s.data[k]),obj.records[k]=jexcel.injectArray(obj.records[k],d,s.records[k]),q=0,A=d;A<s.numOfColumns+d;A++)obj.rows[k].insertBefore(s.records[k][q],obj.rows[k].children[A+1]),q++;if(obj.options.footers)for(k=0;k<obj.options.footers.length;k++)obj.options.footers[k]=jexcel.injectArray(obj.options.footers[k],d,s.footers[k])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(k=0;k<obj.options.nestedHeaders.length;k++){if(n==1)var c=parseInt(obj.options.nestedHeaders[k][obj.options.nestedHeaders[k].length-1].colspan)-s.numOfColumns;else c=parseInt(obj.options.nestedHeaders[k][obj.options.nestedHeaders[k].length-1].colspan)+s.numOfColumns;obj.options.nestedHeaders[k][obj.options.nestedHeaders[k].length-1].colspan=c,obj.thead.children[k].children[obj.thead.children[k].children.length-1].setAttribute("colspan",c)}else c=n==1?parseInt(obj.options.nestedHeaders[0].colspan)-s.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+s.numOfColumns,obj.options.nestedHeaders[0].colspan=c,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",c);obj.updateTableReferences()},obj.undo=function(){var n=!!obj.ignoreEvents,s=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var d=[];if(obj.historyIndex>=0){var p=obj.history[obj.historyIndex--];if(p.action=="insertRow")obj.historyProcessRow(1,p);else if(p.action=="deleteRow")obj.historyProcessRow(0,p);else if(p.action=="insertColumn")obj.historyProcessColumn(1,p);else if(p.action=="deleteColumn")obj.historyProcessColumn(0,p);else if(p.action=="moveRow")obj.moveRow(p.newValue,p.oldValue);else if(p.action=="moveColumn")obj.moveColumn(p.newValue,p.oldValue);else if(p.action=="setMerge")obj.removeMerge(p.column,p.data);else if(p.action=="setStyle")obj.setStyle(p.oldValue,null,null,1);else if(p.action=="setWidth")obj.setWidth(p.column,p.oldValue);else if(p.action=="setHeight")obj.setHeight(p.row,p.oldValue);else if(p.action=="setHeader")obj.setHeader(p.column,p.oldValue);else if(p.action=="setComments")obj.setComments(p.column,p.oldValue[0],p.oldValue[1]);else if(p.action=="orderBy"){for(var A=[],k=0;k<p.rows.length;k++)A[p.rows[k]]=k;obj.updateOrderArrow(p.column,p.order?0:1),obj.updateOrder(A)}else if(p.action=="setValue"){for(var q=0;q<p.records.length;q++)d.push({x:p.records[q].x,y:p.records[q].y,newValue:p.records[q].oldValue}),p.oldStyle&&obj.resetStyle(p.oldStyle);obj.setValue(d),p.selection&&obj.updateSelectionFromCoords(p.selection[0],p.selection[1],p.selection[2],p.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=s,obj.dispatch("onundo",el,p)},obj.redo=function(){var n=!!obj.ignoreEvents,s=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var d=obj.history[++obj.historyIndex];if(d.action=="insertRow")obj.historyProcessRow(0,d);else if(d.action=="deleteRow")obj.historyProcessRow(1,d);else if(d.action=="insertColumn")obj.historyProcessColumn(0,d);else if(d.action=="deleteColumn")obj.historyProcessColumn(1,d);else if(d.action=="moveRow")obj.moveRow(d.oldValue,d.newValue);else if(d.action=="moveColumn")obj.moveColumn(d.oldValue,d.newValue);else if(d.action=="setMerge")obj.setMerge(d.column,d.colspan,d.rowspan,1);else if(d.action=="setStyle")obj.setStyle(d.newValue,null,null,1);else if(d.action=="setWidth")obj.setWidth(d.column,d.newValue);else if(d.action=="setHeight")obj.setHeight(d.row,d.newValue);else if(d.action=="setHeader")obj.setHeader(d.column,d.newValue);else if(d.action=="setComments")obj.setComments(d.column,d.newValue[0],d.newValue[1]);else if(d.action=="orderBy")obj.updateOrderArrow(d.column,d.order),obj.updateOrder(d.rows);else if(d.action=="setValue"){obj.setValue(d.records);for(var p=0;p<d.records.length;p++)d.oldStyle&&obj.resetStyle(d.newStyle);d.selection&&obj.updateSelectionFromCoords(d.selection[0],d.selection[1],d.selection[2],d.selection[3])}}obj.ignoreEvents=n,obj.ignoreHistory=s,obj.dispatch("onredo",el,d)},obj.getDropDownValue=function(n,s){var d=[];if(obj.options.columns[n]&&obj.options.columns[n].source){for(var p=[],A=obj.options.columns[n].source,k=0;k<A.length;k++)typeof A[k]=="object"?p[A[k].id]=A[k].name:p[A[k]]=A[k];var q=Array.isArray(s)?s:(""+s).split(";");for(k=0;k<q.length;k++)typeof q[k]=="object"?d.push(p[q[k].id]):p[q[k]]&&d.push(p[q[k]])}else console.error("Invalid column");return d.length>0?d.join("; "):""},obj.parseCSV=function(n,s){(n=n.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(n.length-1)==9&&(n+="\0"),s=s||",";for(var d=[],p=!1,A=0,k=0,q=0;q<n.length;q++){var c=n[q],r=n[q+1];d[A]=d[A]||[],d[A][k]=d[A][k]||"",c=='"'&&p&&r=='"'?(d[A][k]+=c,++q):c!='"'?c!=s||p?c!="\r"||r!=`
`||p?c==`
`&&!p||c=="\r"&&!p?(++A,k=0):d[A][k]+=c:(++A,k=0,++q):++k:p=!p}return d},obj.hash=function(n){var s,d=0;if(n.length===0)return d;for(s=0;s<n.length;s++)d=(d<<5)-d+n.charCodeAt(s),d|=0;return d},obj.onafterchanges=function(n,s){obj.dispatch("onafterchanges",n,s)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(n){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(n){var s=obj.parseCSV(n,obj.options.csvDelimiter);if(obj.options.csvHeaders==1&&s.length>0)for(var d=s.shift(),p=0;p<d.length;p++)obj.options.columns[p]||(obj.options.columns[p]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),obj.options.columns[p].title===void 0&&(obj.options.columns[p].title=d[p]);obj.options.data=s,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==1&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(n){obj.options.data=n.data?n.data:n,obj.prepareTable(),obj.options.loadingSpin==1&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(n,s,d,p){var A=[];if(d==null)obj.options.allowInsertColumn==1&&A.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(s),1)}}),obj.options.allowInsertColumn==1&&A.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(s),0)}}),obj.options.allowDeleteColumn==1&&A.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(s))}}),obj.options.allowRenameColumn==1&&A.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(s)}}),obj.options.columnSorting==1&&(A.push({type:"line"}),A.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(s,0)}}),A.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(s,1)}}));else if(obj.options.allowInsertRow==1&&(A.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(d),1)}}),A.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(d))}})),obj.options.allowDeleteRow==1&&A.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(d))}}),s&&obj.options.allowComments==1){A.push({type:"line"});var k=obj.records[d][s].getAttribute("title")||"";A.push({title:k?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var q=prompt(obj.options.text.comments,k);q&&obj.setComments([s,d],q)}}),k&&A.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([s,d],"")}})}return A.push({type:"line"}),A.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&A.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(q){q&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],q)})}}),obj.options.allowExport&&A.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&A.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),A},obj.scrollControls=function(n){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),obj.options.lazyLoading!=1&&obj.options.tableOverflow!=1||obj.edition&&n.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(n){obj.options.lazyLoading==1&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var n=0;if(obj.options.freezeColumns>0)for(var s=0;s<obj.options.freezeColumns;s++)n+=parseInt(obj.options.columns[s].width);return n};var scrollLeft=0;return obj.updateFreezePosition=function(){var n=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var s=0;s<obj.options.freezeColumns;s++){s>0&&obj.options.columns[s-1].type!=="hidden"&&(n+=parseInt(obj.options.columns[s-1].width)),obj.headers[s].classList.add("jexcel_freezed"),obj.headers[s].style.left=n+"px";for(var d=0;d<obj.rows.length;d++)if(obj.rows[d]&&obj.records[d][s]){var p=scrollLeft+(s>0?obj.records[d][s-1].style.width:0)-51+"px";obj.records[d][s].classList.add("jexcel_freezed"),obj.records[d][s].style.left=p}}else for(s=0;s<obj.options.freezeColumns;s++)for(obj.headers[s].classList.remove("jexcel_freezed"),obj.headers[s].style.left="",d=0;d<obj.rows.length;d++)obj.records[d][s]&&(obj.records[d][s].classList.remove("jexcel_freezed"),obj.records[d][s].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};jexcel.setDictionary=function(n){jSuites.setDictionary(n)},jexcel.setExtensions=function(n){for(var s=Object.keys(n),d=0;d<s.length;d++)typeof n[s[d]]=="function"&&(jexcel[s[d]]=n[s[d]],jexcel.license&&typeof n[s[d]].license=="function"&&n[s[d]].license(jexcel.license))},formula!==void 0&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null;const destroyEvents=function(n){n.removeEventListener("mouseup",jexcel.mouseUpControls),n.removeEventListener("mousedown",jexcel.mouseDownControls),n.removeEventListener("mousemove",jexcel.mouseMoveControls),n.removeEventListener("mouseover",jexcel.mouseOverControls),n.removeEventListener("dblclick",jexcel.doubleClickControls),n.removeEventListener("paste",jexcel.pasteControls),n.removeEventListener("contextmenu",jexcel.contextMenuControls),n.removeEventListener("touchstart",jexcel.touchStartControls),n.removeEventListener("touchend",jexcel.touchEndControls),n.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls)};var component;return jexcel.destroy=function(n,s){if(n.jexcel){var d=n.jexcel.options.root?n.jexcel.options.root:document;n.removeEventListener("DOMMouseScroll",n.jexcel.scrollControls),n.removeEventListener("mousewheel",n.jexcel.scrollControls),n.jexcel=null,n.innerHTML="",s&&(destroyEvents(d),jexcel=null)}},jexcel.build=function(n){destroyEvents(n),n.addEventListener("mouseup",jexcel.mouseUpControls),n.addEventListener("mousedown",jexcel.mouseDownControls),n.addEventListener("mousemove",jexcel.mouseMoveControls),n.addEventListener("mouseover",jexcel.mouseOverControls),n.addEventListener("dblclick",jexcel.doubleClickControls),n.addEventListener("paste",jexcel.pasteControls),n.addEventListener("contextmenu",jexcel.contextMenuControls),n.addEventListener("touchstart",jexcel.touchStartControls),n.addEventListener("touchend",jexcel.touchEndControls),n.addEventListener("touchcancel",jexcel.touchEndControls),n.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(n){if(jexcel.current){if(jexcel.current.edition)if(n.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),n.preventDefault();else if(n.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==1||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==1||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&n.altKey){var s=jexcel.current.edition[0].children[0],d=jexcel.current.edition[0].children[0].value,p=s.selectionStart;d=d.slice(0,p)+`
`+d.slice(p),s.value=d,s.focus(),s.selectionStart=p+1,s.selectionEnd=p+1}else jexcel.current.edition[0].children[0].blur()}else n.which==9&&(["calendar","html"].includes(jexcel.current.options.columns[jexcel.current.edition[2]].type)?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(n.which==37)jexcel.current.left(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==39)jexcel.current.right(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==38)jexcel.current.up(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==40)jexcel.current.down(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==36)jexcel.current.first(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==35)jexcel.current.last(n.shiftKey,n.ctrlKey),n.preventDefault();else if(n.which==46)jexcel.current.options.editable==1&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==1&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(n.which==13)n.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==1&&jexcel.current.options.allowManualInsertRow==1&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),n.preventDefault();else if(n.which==9)n.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==1&&jexcel.current.options.allowManualInsertColumn==1&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),n.preventDefault();else if(!n.ctrlKey&&!n.metaKey||n.shiftKey){if(jexcel.current.selectedCell&&jexcel.current.options.editable==1){var A=jexcel.current.selectedCell[1],k=jexcel.current.selectedCell[0];jexcel.current.options.columns[k].type!="readonly"&&(n.keyCode==32?(n.preventDefault(),jexcel.current.options.columns[k].type=="checkbox"||jexcel.current.options.columns[k].type=="radio"?jexcel.current.setCheckRadioValue():jexcel.current.openEditor(jexcel.current.records[A][k],!0)):n.keyCode==113?jexcel.current.openEditor(jexcel.current.records[A][k],!1):(n.keyCode==8||n.keyCode>=48&&n.keyCode<=57||n.keyCode>=96&&n.keyCode<=111||n.keyCode>=187&&n.keyCode<=190||(String.fromCharCode(n.keyCode)==n.key||String.fromCharCode(n.keyCode).toLowerCase()==n.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(n.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[A][k],!0),jexcel.current.options.columns[k].type=="calendar"&&n.preventDefault()))}}else n.which==65?(jexcel.current.selectAll(),n.preventDefault()):n.which==83?(jexcel.current.download(),n.preventDefault()):n.which==89?(jexcel.current.redo(),n.preventDefault()):n.which==90?(jexcel.current.undo(),n.preventDefault()):n.which==67?(jexcel.current.copy(!0),n.preventDefault()):n.which==88?(jexcel.current.options.editable==1?jexcel.cutControls():jexcel.copyControls(),n.preventDefault()):n.which==86&&jexcel.pasteControls();else n.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(n.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;var d=jexcel.getElement(n.target);if(d[0]?jexcel.current!=d[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=d[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&s==1){if(n.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(n.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==1&&(jexcel.current.selectedCorner=!0);else{if(d[1]==1){if(u=n.target.getAttribute("data-x")){var p=n.target.getBoundingClientRect();if(jexcel.current.options.columnResize==1&&p.width-n.offsetX<6){jexcel.current.resizing={mousePosition:n.pageX,column:u,width:p.width},jexcel.current.headers[u].classList.add("resizing");for(var A=0;A<jexcel.current.records.length;A++)jexcel.current.records[A][u]&&jexcel.current.records[A][u].classList.add("resizing")}else if(jexcel.current.options.columnDrag==1&&p.height-n.offsetY<6)if(jexcel.current.isColMerged(u).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target,column:u,destination:u},jexcel.current.headers[u].classList.add("dragging"),A=0;A<jexcel.current.records.length;A++)jexcel.current.records[A][u]&&jexcel.current.records[A][u].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(n.shiftKey||n.ctrlKey))var k=jexcel.current.selectedHeader,q=u;else jexcel.current.selectedHeader==u&&jexcel.current.options.allowRenameColumn==1&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(u)},800)),jexcel.current.selectedHeader=u,k=u,q=u;jexcel.current.updateSelectionFromCoords(k,0,q,jexcel.current.options.data.length-1)}}else if(n.target.parentNode.classList.contains("jexcel_nested")){if(n.target.getAttribute("data-column"))var c=n.target.getAttribute("data-column").split(","),r=parseInt(c[0]),b=parseInt(c[c.length-1]);else r=0,b=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(r,0,b,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(d[1]==2){var H=n.target.getAttribute("data-y");if(n.target.classList.contains("jexcel_row"))p=n.target.getBoundingClientRect(),jexcel.current.options.rowResize==1&&p.height-n.offsetY<6?(jexcel.current.resizing={element:n.target.parentNode,mousePosition:n.pageY,row:H,height:p.height},n.target.parentNode.classList.add("resizing")):jexcel.current.options.rowDrag==1&&p.width-n.offsetX<6?jexcel.current.isRowMerged(H).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==1&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:n.target.parentNode,row:H,destination:H},n.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(n.shiftKey||n.ctrlKey)?(k=jexcel.current.selectedRow,q=H):(jexcel.current.selectedRow=H,k=H,q=H),jexcel.current.updateSelectionFromCoords(0,k,jexcel.current.options.data[0].length-1,q));else if(n.target.classList.contains("jclose")&&n.target.clientWidth-n.offsetX<50&&n.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var _=function(m){var j=m.getAttribute("data-x"),h=m.getAttribute("data-y");return j&&h?[j,h]:m.parentNode?_(m.parentNode):void 0},g=_(n.target);if(g){var u=g[0];H=g[1],jexcel.current.edition&&(jexcel.current.edition[2]==u&&jexcel.current.edition[3]==H||jexcel.current.closeEditor(jexcel.current.edition[0],!0)),jexcel.current.edition||(n.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],u,H):jexcel.current.updateSelectionFromCoords(u,H)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;n.target.classList.contains("jexcel_page")&&(n.target.textContent=="<"?jexcel.current.page(0):n.target.textContent==">"?jexcel.current.page(n.target.getAttribute("title")-1):jexcel.current.page(n.target.textContent-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(n){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var s=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),d=jexcel.current.getSelectedColumns();if(d.length>1){for(var p=[],A=0;A<d.length;A++)p.push(parseInt(jexcel.current.colgroup[d[A]].getAttribute("width")));p[d.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(d,s,p)}else jexcel.current.setWidth(jexcel.current.resizing.column,s,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var k=0;k<jexcel.current.records.length;k++)jexcel.current.records[k][jexcel.current.resizing.column]&&jexcel.current.records[k][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var q=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,q,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var c=n.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),k=0;k<jexcel.current.rows.length;k++)jexcel.current.records[k][jexcel.current.dragging.column]&&jexcel.current.records[k][jexcel.current.dragging.column].classList.remove("dragging");for(A=0;A<jexcel.current.headers.length;A++)jexcel.current.headers[A].classList.remove("dragging-left"),jexcel.current.headers[A].classList.remove("dragging-right");c&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var r=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<r&&(r-=1)}else r=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,r,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;if(s||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==1){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var d=n.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+d>0){var p=jexcel.current.resizing.width+d;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",p),jexcel.current.updateCornerPosition()}}else{var A=n.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+A>0){var k=jexcel.current.resizing.height+A;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",k),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var q=n.target.getAttribute("data-x");if(q)if(jexcel.current.isColMerged(q).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var c=0;c<jexcel.current.headers.length;c++)jexcel.current.headers[c].classList.remove("dragging-left"),jexcel.current.headers[c].classList.remove("dragging-right");jexcel.current.dragging.column==q?jexcel.current.dragging.destination=parseInt(q):n.target.clientWidth/2>n.offsetX?(jexcel.current.dragging.column<q?jexcel.current.dragging.destination=parseInt(q)-1:jexcel.current.dragging.destination=parseInt(q),jexcel.current.headers[q].classList.add("dragging-left")):(jexcel.current.dragging.column<q?jexcel.current.dragging.destination=parseInt(q):jexcel.current.dragging.destination=parseInt(q)+1,jexcel.current.headers[q].classList.add("dragging-right"))}}else{var r=n.target.getAttribute("data-y");if(r)if(jexcel.current.isRowMerged(r).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var b=n.target.clientHeight/2>n.offsetY?n.target.parentNode.nextSibling:n.target.parentNode;jexcel.current.dragging.element!=b&&(n.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,b),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var H=n.target.getAttribute("data-x"),_=n.target.getAttribute("data-y"),g=n.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),n.target.parentNode.parentNode&&n.target.parentNode.parentNode.className&&(n.target.parentNode.parentNode.classList.contains("resizable")&&(n.target&&H&&!_&&g.width-(n.clientX-g.left)<6?(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="col-resize"):n.target&&!H&&_&&g.height-(n.clientY-g.top)<6&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="row-resize")),n.target.parentNode.parentNode.classList.contains("draggable")&&(n.target&&!H&&_&&g.width-(n.clientX-g.left)<6||n.target&&H&&!_&&g.height-(n.clientY-g.top)<6)&&(jexcel.current.cursor=n.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(n){if((n=n||window.event).buttons)var s=n.buttons;else s=n.button?n.button:n.which;if(s||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==1){var d=jexcel.getElement(n.target);if(d[0]){if(jexcel.current!=d[0].jexcel&&jexcel.current)return!1;var p=n.target.getAttribute("data-x"),A=n.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(d[1]==1&&jexcel.current.selectedHeader){p=n.target.getAttribute("data-x");var k=jexcel.current.selectedHeader,q=p;jexcel.current.updateSelectionFromCoords(k,0,q,jexcel.current.options.data.length-1)}d[1]==2&&(n.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&(k=jexcel.current.selectedRow,q=A,jexcel.current.updateSelectionFromCoords(0,k,jexcel.current.options.data[0].length-1,q)):jexcel.current.edition||p&&A&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(p,A):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],p,A)))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(n){if(jexcel.current)if(n.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var s=jexcel.current.highlighted[0].getAttribute("data-x"),d=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,p=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),A=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[d][s],jexcel.current.records[A][p])}}else if(n.target.classList.contains("jexcel_column_filter")){var k=n.target.getAttribute("data-x");jexcel.current.openFilter(k)}else{var q=jexcel.getElement(n.target);if(q[1]==1&&jexcel.current.options.columnSorting==1&&(k=n.target.getAttribute("data-x"))&&jexcel.current.orderBy(k),q[1]==2&&jexcel.current.options.editable==1&&!jexcel.current.edition){var c=function(b){if(b.parentNode){var H=b.getAttribute("data-x"),_=b.getAttribute("data-y");return H&&_?b:c(b.parentNode)}},r=c(n.target);r&&r.classList.contains("highlight")&&jexcel.current.openEditor(r)}}},jexcel.copyControls=function(n){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(n){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==1&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(n){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==1&&(n&&n.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],n.clipboardData.getData("text")),n.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(n){if("buttons"in(n=n||window.event)?n.buttons:n.which||n.button,jexcel.current){if(jexcel.current.edition)n.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var s=n.target.getAttribute("data-x"),d=n.target.getAttribute("data-y");if(s||d){(s<parseInt(jexcel.current.selectedCell[0])||s>parseInt(jexcel.current.selectedCell[2])||d<parseInt(jexcel.current.selectedCell[1])||d>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(s,d,s,d);var p=jexcel.current.options.contextMenu(jexcel.current,s,d,n);jexcel.current.contextMenu.contextmenu.open(n,p),n.preventDefault()}}}},jexcel.touchStartControls=function(n){var s=jexcel.getElement(n.target);if(s[0]?jexcel.current!=s[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=s[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var d=n.target.getAttribute("data-x"),p=n.target.getAttribute("data-y");d&&p&&(jexcel.current.updateSelectionFromCoords(d,p),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[d].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=n.target,jexcel.current.openEditor(n.target,!1,n)},500))}},jexcel.touchEndControls=function(n){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(n,s){var d=[];if(n.classList.contains("jexcel_tabs"))A=n.children[0],k=n.children[1];else{n.innerHTML="",n.classList.add("jexcel_tabs"),n.jexcel=[];var p=document.createElement("div"),A=n.appendChild(p),k=(p=document.createElement("div"),n.appendChild(p))}for(var q=[],c=[],r=0;r<s.length;r++){q[r]=document.createElement("div"),q[r].classList.add("jexcel_tab");var b=jexcel(q[r],s[r]);k.appendChild(q[r]),d[r]=n.jexcel.push(b),c[r]=document.createElement("div"),c[r].classList.add("jexcel_tab_link"),c[r].setAttribute("data-spreadsheet",n.jexcel.length-1),c[r].innerHTML=s[r].sheetName,c[r].onclick=function(){for(var _=0;_<A.children.length;_++)A.children[_].classList.remove("selected"),k.children[_].style.display="none";var g=this.getAttribute("data-spreadsheet");k.children[g].style.display="block",A.children[g].classList.add("selected")},A.appendChild(c[r])}for(var H=0;H<A.children.length;H++)A.children[H].classList.remove("selected"),k.children[H].style.display="none";return A.children[A.children.length-1].classList.add("selected"),k.children[A.children.length-1].style.display="block",d},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(n,s){var d,p=function(A){var k=[];return A.SheetNames.forEach(function(q){var c={rows:[],columns:[],data:[],style:{}};if(c.sheetName=q,(h=A.Sheets[q]["!cols"])&&h.length)for(var r=0;r<h.length;r++)c.columns[r]={},h[r]&&h[r].wpx&&(c.columns[r].width=h[r].wpx+"px");if((h=A.Sheets[q]["!rows"])&&h.length)for(r=0;r<h.length;r++)h[r]&&h[r].hpx&&(c.rows[r]={},c.rows[r].height=h[r].hpx+"px");if((h=A.Sheets[q]["!merges"])&&h.length>0)for(c.mergeCells=[],r=0;r<h.length;r++){var b=h[r].s.c,H=h[r].s.r,_=h[r].e.c,g=h[r].e.r,u=jexcel.getColumnNameFromId([b,H]);c.mergeCells[u]=[_-b+1,g-H+1]}var m=0,j=0,h=Object.keys(A.Sheets[q]);for(r=0;r<h.length;r++)if(h[r].substr(0,1)!="!"){var C=A.Sheets[q][h[r]],T=jexcel.getIdFromColumnName(h[r],!0);c.data[T[1]]||(c.data[T[1]]=[]),c.data[T[1]][T[0]]=C.f?"="+C.f:C.w,m<T[0]&&(m=T[0]),j<T[1]&&(j=T[1]),C.style&&Object.keys(C.style).length>0&&(c.style[h[r]]=C.style),C.s&&C.s.fgColor&&(c.style[h[r]]&&(c.style[h[r]]+=";"),c.style[h[r]]+="background-color:#"+C.s.fgColor.rgb)}for(var I=c.columns,B=0;B<=j;B++)for(r=0;r<=m;r++)c.data[B]||(c.data[B]=[]),c.data[B][r]||I<r&&(c.data[B][r]="");k.push(c)}),k};(d=new XMLHttpRequest).open("GET",n,!0),typeof Uint8Array<"u"?(d.responseType="arraybuffer",d.onload=function(A){var k=d.response,q=new Uint8Array(k),c=XLSX.read(q,{type:"array",cellFormula:!0,cellStyles:!0});s(p(c))}):(d.setRequestHeader("Accept-Charset","x-user-defined"),d.onreadystatechange=function(){if(d.readyState==4&&d.status==200){var A=convertResponseBodyToText(d.responseBody),k=XLSX.read(A,{type:"binary",cellFormula:!0,cellStyles:!0});s(p(k))}}),d.send()},jexcel.validLetter=function(n){return n.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(n,s,d){return n.slice(0,s).concat(d).concat(n.slice(s))},jexcel.getColumnName=function(n){var s="";return n>701?(s+=String.fromCharCode(64+parseInt(n/676)),s+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(s+=String.fromCharCode(64+parseInt(n/26))),s+String.fromCharCode(65+n%26)},jexcel.getIdFromColumnName=function(n,s){var d=/^[a-zA-Z]+/.exec(n);if(d){for(var p=0,A=0;A<d[0].length;A++)p+=parseInt(d[0].charCodeAt(A)-64)*Math.pow(26,d[0].length-1-A);--p<0&&(p=0);var k=parseInt(/[0-9]+$/.exec(n));k>0&&k--,n=s==1?[p,k]:p+"-"+k}return n},jexcel.getColumnNameFromId=function(n){return Array.isArray(n)||(n=n.split("-")),jexcel.getColumnName(parseInt(n[0]))+(parseInt(n[1])+1)},jexcel.getElement=function(n){var s=0,d=0;return function p(A){A.className&&A.classList.contains("jexcel_container")&&(d=A),A.tagName=="THEAD"?s=1:A.tagName=="TBODY"&&(s=2),A.parentNode&&(d||p(A.parentNode))}(n),[d,s]},jexcel.doubleDigitFormat=function(n){return(n=""+n).length==1&&(n="0"+n),n},jexcel.createFromTable=function(n,s){if(n.tagName=="TABLE"){s||(s={}),s.columns=[],s.data=[];var d=n.querySelectorAll("colgroup > col");if(d.length)for(var p=0;p<d.length;p++){if(!(A=d[p].style.width))var A=d[p].getAttribute("width");A&&(s.columns[p]||(s.columns[p]={}),s.columns[p].width=A)}var k=function(xe){var Te=xe.getBoundingClientRect(),ve=Te.width>50?Te.width:50;s.columns[p]||(s.columns[p]={}),xe.getAttribute("data-celltype")?s.columns[p].type=xe.getAttribute("data-celltype"):s.columns[p].type="text",s.columns[p].width=ve+"px",s.columns[p].title=xe.innerHTML,s.columns[p].align=xe.style.textAlign||"center",(Te=xe.getAttribute("name"))&&(s.columns[p].name=Te),(Te=xe.getAttribute("id"))&&(s.columns[p].id=Te),(Te=xe.getAttribute("data-mask"))&&(s.columns[p].mask=Te)},q=[],c=n.querySelectorAll(":scope > thead > tr");if(c.length){for(var r=0;r<c.length-1;r++){var b=[];for(p=0;p<c[r].children.length;p++){var H={title:c[r].children[p].textContent,colspan:c[r].children[p].getAttribute("colspan")||1};b.push(H)}q.push(b)}for(c=c[c.length-1].children,p=0;p<c.length;p++)k(c[p])}var _=0,g={},u={},m={},j={},h=n.querySelectorAll(":scope > tr, :scope > tbody > tr");for(r=0;r<h.length;r++)if(s.data[_]=[],s.parseTableFirstRowAsHeader!=1||c.length||r!=0){for(p=0;p<h[r].children.length;p++){if(C=h[r].children[p].getAttribute("data-formula"))C.substr(0,1)!="="&&(C="="+C);else var C=h[r].children[p].innerHTML;s.data[_].push(C);var T=jexcel.getColumnNameFromId([p,r]),I=h[r].children[p].getAttribute("class");I&&(j[T]=I);var B=parseInt(h[r].children[p].getAttribute("colspan"))||0,S=parseInt(h[r].children[p].getAttribute("rowspan"))||0;(B||S)&&(g[T]=[B||1,S||1]),h[r].children[p].style&&h[r].children[p].style.display=="none"&&(h[r].children[p].style.display="");var N=h[r].children[p].getAttribute("style");N&&(m[T]=N),h[r].children[p].classList.contains("styleBold")&&(m[T]?m[T]+="; font-weight:bold;":m[T]="font-weight:bold;")}h[r].style&&h[r].style.height&&(u[r]={height:h[r].style.height}),_++}else for(p=0;p<h[r].children.length;p++)k(h[r].children[p]);if(Object.keys(q).length>0&&(s.nestedHeaders=q),Object.keys(m).length>0&&(s.style=m),Object.keys(g).length>0&&(s.mergeCells=g),Object.keys(u).length>0&&(s.rows=u),Object.keys(j).length>0&&(s.classes=j),(h=n.querySelectorAll("tfoot tr")).length){var F=[];for(r=0;r<h.length;r++){var G=[];for(p=0;p<h[r].children.length;p++)G.push(h[r].children[p].textContent);F.push(G)}Object.keys(F).length>0&&(s.footers=F)}if(s.parseTableAutoCellType==1){var U=[];for(p=0;p<s.columns.length;p++){var se=!0,ge=!0;for(U[p]=[],r=0;r<s.data.length;r++)C=s.data[r][p],U[p][C]||(U[p][C]=0),U[p][C]++,C.length>25&&(se=!1),C.length==10&&C.substr(4,1)=="-"&&C.substr(7,1)=="-"||(ge=!1);var ie=Object.keys(U[p]).length;ge?s.columns[p].type="calendar":se==1&&ie>1&&ie<=parseInt(.1*s.data.length)&&(s.columns[p].type="dropdown",s.columns[p].source=Object.keys(U[p]))}}return s}console.log("Element is not a table")},jexcel.helpers=(component={getCaretIndex:function(n){if(this.config.root)var s=this.config.root;else s=window;var d=0,p=s.getSelection();if(p&&p.rangeCount!==0){var A=p.getRangeAt(0),k=A.cloneRange();k.selectNodeContents(n),k.setEnd(A.endContainer,A.endOffset),d=k.toString().length}return d},invert:function(n){for(var s=[],d=Object.keys(n),p=0;p<d.length;p++)s[n[d[p]]]=d[p];return s},getColumnName:function(n){var s="";return n>701?(s+=String.fromCharCode(64+parseInt(n/676)),s+=String.fromCharCode(64+parseInt(n%676/26))):n>25&&(s+=String.fromCharCode(64+parseInt(n/26))),s+String.fromCharCode(65+n%26)},getColumnNameFromCoords:function(n,s){return component.getColumnName(parseInt(n))+(parseInt(s)+1)},getCoordsFromColumnName:function(n){var s=/^[a-zA-Z]+/.exec(n);if(s){for(var d=0,p=0;p<s[0].length;p++)d+=parseInt(s[0].charCodeAt(p)-64)*Math.pow(26,s[0].length-1-p);--d<0&&(d=0);var A=parseInt(/[0-9]+$/.exec(n))||null;return A>0&&A--,[d,A]}},createFromTable:function(){},injectArray:function(n,s,d){return n.slice(0,s).concat(d).concat(n.slice(s))},parseCSV:function(n,s){s=s||",";for(var d=0,p=0,A=[[]],k=0,q=null,c=!1,r=!1,b=0;b<n.length;b++)if(A[p]||(A[p]=[]),A[p][d]||(A[p][d]=""),n[b]!="\r")if(n[b]!=`
`&&n[b]!=s||c!=0&&r!=1&&q){if(n[b]=='"'&&(c=!c),q===null){if((q=c)==1)continue}else if(q===!0&&!r&&n[b]=='"'){n[b+1]=='"'?(c=!0,A[p][d]+=n[b],b++):r=!0;continue}A[p][d]+=n[b]}else{if(q=null,c=!1,r=!1,A[p][d][0]=='"'){var H=A[p][d].trim();H[H.length-1]=='"'&&(A[p][d]=H.substr(1,H.length-2))}n[b]==`
`?(d=0,p++):++d>k&&(k=d)}for(var _=0;_<A.length;_++)for(b=0;b<=k;b++)A[_][b]===void 0&&(A[_][b]="");return A}},component),typeof jQuery<"u"&&function(n){n.fn.jspreadsheet=n.fn.jexcel=function(s){var d=n(this).get(0);return d.jexcel?Array.isArray(d.jexcel)?d.jexcel[s][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):d.jexcel[s].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(n(this).get(0),arguments[0])}}(jQuery),jexcel},module.exports=factory()}},__webpack_module_cache__={};function __webpack_require__(n){var s=__webpack_module_cache__[n];if(s!==void 0)return s.exports;var d=__webpack_module_cache__[n]={exports:{}};return __webpack_modules__[n].call(d.exports,d,d.exports,__webpack_require__),d.exports}var __webpack_exports__=__webpack_require__(138);return __webpack_exports__}()})})(dist);var distExports=dist.exports;const jSpreadSheet=getDefaultExportFromCjs(distExports);export{jSpreadSheet as j};
